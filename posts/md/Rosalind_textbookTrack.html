<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Taeyoon Kim">
<meta name="dcterms.date" content="2024-09-28">

<title>Rosalind Textbook track 문제풀이 – tomorrow-lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-31EWCYNR0V"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-31EWCYNR0V', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<meta name="google-site-verification" content="z2S1Xqj9hfJiC31aNGCnOA1gYpL_8MoZpPI2avrWMvg">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Rosalind Textbook track 문제풀이 – tomorrow-lab">
<meta property="og:description" content="The future of scientific discovery lies at the convergence of computational power and biological complexity. Our mission is to provide a platform where enthusiasts, researchers, and professionals can learn about and contribute to the rapidly evolving fields of bioinformatics, computational biology, and systems biology.">
<meta property="og:site_name" content="tomorrow-lab">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">tomorrow-lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../book.html"> 
<span class="menu-text">Book</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://partrita.github.io"> <i class="bi bi-sign-do-not-enter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/partrita"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/partrita"> <i class="bi bi-twitter-x" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<div style="padding-bottom: 30px;">
    <script async="" src="https://eocampaign1.com/form/2616a818-1ef8-11ef-b372-4587d096212f.js" data-form="2616a818-1ef8-11ef-b372-4587d096212f"></script>
</div>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#compute-the-number-of-times-a-pattern-appears-in-a-text" id="toc-compute-the-number-of-times-a-pattern-appears-in-a-text" class="nav-link active" data-scroll-target="#compute-the-number-of-times-a-pattern-appears-in-a-text"><span class="header-section-number">0.1</span> Compute the Number of Times a Pattern Appears in a Text</a></li>
  <li><a href="#sample-dataset" id="toc-sample-dataset" class="nav-link" data-scroll-target="#sample-dataset"><span class="header-section-number">0.2</span> Sample Dataset</a></li>
  <li><a href="#sample-output" id="toc-sample-output" class="nav-link" data-scroll-target="#sample-output"><span class="header-section-number">0.3</span> Sample Output</a></li>
  <li><a href="#solution" id="toc-solution" class="nav-link" data-scroll-target="#solution"><span class="header-section-number">0.4</span> Solution</a></li>
  <li><a href="#find-the-most-frequent-words-in-a-string" id="toc-find-the-most-frequent-words-in-a-string" class="nav-link" data-scroll-target="#find-the-most-frequent-words-in-a-string"><span class="header-section-number">1</span> Find the Most Frequent Words in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-1" id="toc-sample-dataset-1" class="nav-link" data-scroll-target="#sample-dataset-1"><span class="header-section-number">1.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-1" id="toc-sample-output-1" class="nav-link" data-scroll-target="#sample-output-1"><span class="header-section-number">1.2</span> Sample Output</a></li>
  <li><a href="#solution-1" id="toc-solution-1" class="nav-link" data-scroll-target="#solution-1"><span class="header-section-number">1.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-reverse-complement-of-a-string" id="toc-find-the-reverse-complement-of-a-string" class="nav-link" data-scroll-target="#find-the-reverse-complement-of-a-string"><span class="header-section-number">2</span> Find the Reverse Complement of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-2" id="toc-sample-dataset-2" class="nav-link" data-scroll-target="#sample-dataset-2"><span class="header-section-number">2.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-2" id="toc-sample-output-2" class="nav-link" data-scroll-target="#sample-output-2"><span class="header-section-number">2.2</span> Sample Output</a></li>
  <li><a href="#solution-2" id="toc-solution-2" class="nav-link" data-scroll-target="#solution-2"><span class="header-section-number">2.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-occurrences-of-a-pattern-in-a-string" id="toc-find-all-occurrences-of-a-pattern-in-a-string" class="nav-link" data-scroll-target="#find-all-occurrences-of-a-pattern-in-a-string"><span class="header-section-number">3</span> Find All Occurrences of a Pattern in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-3" id="toc-sample-dataset-3" class="nav-link" data-scroll-target="#sample-dataset-3"><span class="header-section-number">3.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-3" id="toc-sample-output-3" class="nav-link" data-scroll-target="#sample-output-3"><span class="header-section-number">3.2</span> Sample Output</a></li>
  <li><a href="#solution-3" id="toc-solution-3" class="nav-link" data-scroll-target="#solution-3"><span class="header-section-number">3.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-patterns-forming-clumps-in-a-string" id="toc-find-patterns-forming-clumps-in-a-string" class="nav-link" data-scroll-target="#find-patterns-forming-clumps-in-a-string"><span class="header-section-number">4</span> Find Patterns Forming Clumps in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-4" id="toc-sample-dataset-4" class="nav-link" data-scroll-target="#sample-dataset-4"><span class="header-section-number">4.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-4" id="toc-sample-output-4" class="nav-link" data-scroll-target="#sample-output-4"><span class="header-section-number">4.2</span> Sample Output</a></li>
  <li><a href="#solution-4" id="toc-solution-4" class="nav-link" data-scroll-target="#solution-4"><span class="header-section-number">4.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-position-in-a-genome-minimizing-the-skew" id="toc-find-a-position-in-a-genome-minimizing-the-skew" class="nav-link" data-scroll-target="#find-a-position-in-a-genome-minimizing-the-skew"><span class="header-section-number">5</span> Find a Position in a Genome Minimizing the Skew</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-5" id="toc-sample-dataset-5" class="nav-link" data-scroll-target="#sample-dataset-5"><span class="header-section-number">5.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-5" id="toc-sample-output-5" class="nav-link" data-scroll-target="#sample-output-5"><span class="header-section-number">5.2</span> Sample Output</a></li>
  <li><a href="#solution-5" id="toc-solution-5" class="nav-link" data-scroll-target="#solution-5"><span class="header-section-number">5.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-hamming-distance-between-two-strings" id="toc-compute-the-hamming-distance-between-two-strings" class="nav-link" data-scroll-target="#compute-the-hamming-distance-between-two-strings"><span class="header-section-number">6</span> Compute the Hamming Distance Between Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-6" id="toc-sample-dataset-6" class="nav-link" data-scroll-target="#sample-dataset-6"><span class="header-section-number">6.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-6" id="toc-sample-output-6" class="nav-link" data-scroll-target="#sample-output-6"><span class="header-section-number">6.2</span> Sample Output</a></li>
  <li><a href="#solution-6" id="toc-solution-6" class="nav-link" data-scroll-target="#solution-6"><span class="header-section-number">6.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-approximate-occurrences-of-a-pattern-in-a-string" id="toc-find-all-approximate-occurrences-of-a-pattern-in-a-string" class="nav-link" data-scroll-target="#find-all-approximate-occurrences-of-a-pattern-in-a-string"><span class="header-section-number">7</span> Find All Approximate Occurrences of a Pattern in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-7" id="toc-sample-dataset-7" class="nav-link" data-scroll-target="#sample-dataset-7"><span class="header-section-number">7.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-7" id="toc-sample-output-7" class="nav-link" data-scroll-target="#sample-output-7"><span class="header-section-number">7.2</span> Sample Output</a></li>
  <li><a href="#solution-7" id="toc-solution-7" class="nav-link" data-scroll-target="#solution-7"><span class="header-section-number">7.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-most-frequent-words-with-mismatches-in-a-string" id="toc-find-the-most-frequent-words-with-mismatches-in-a-string" class="nav-link" data-scroll-target="#find-the-most-frequent-words-with-mismatches-in-a-string"><span class="header-section-number">8</span> Find the Most Frequent Words with Mismatches in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-8" id="toc-sample-dataset-8" class="nav-link" data-scroll-target="#sample-dataset-8"><span class="header-section-number">8.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-8" id="toc-sample-output-8" class="nav-link" data-scroll-target="#sample-output-8"><span class="header-section-number">8.2</span> Sample Output</a></li>
  <li><a href="#solution-8" id="toc-solution-8" class="nav-link" data-scroll-target="#solution-8"><span class="header-section-number">8.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-frequent-words-with-mismatches-and-reverse-complements" id="toc-find-frequent-words-with-mismatches-and-reverse-complements" class="nav-link" data-scroll-target="#find-frequent-words-with-mismatches-and-reverse-complements"><span class="header-section-number">9</span> Find Frequent Words with Mismatches and Reverse Complements</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-9" id="toc-sample-dataset-9" class="nav-link" data-scroll-target="#sample-dataset-9"><span class="header-section-number">9.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-9" id="toc-sample-output-9" class="nav-link" data-scroll-target="#sample-output-9"><span class="header-section-number">9.2</span> Sample Output</a></li>
  <li><a href="#solution-9" id="toc-solution-9" class="nav-link" data-scroll-target="#solution-9"><span class="header-section-number">9.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-frequency-array-of-a-string" id="toc-generate-the-frequency-array-of-a-string" class="nav-link" data-scroll-target="#generate-the-frequency-array-of-a-string"><span class="header-section-number">10</span> Generate the Frequency Array of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-10" id="toc-sample-dataset-10" class="nav-link" data-scroll-target="#sample-dataset-10"><span class="header-section-number">10.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-10" id="toc-sample-output-10" class="nav-link" data-scroll-target="#sample-output-10"><span class="header-section-number">10.2</span> Sample Output</a></li>
  <li><a href="#solution-10" id="toc-solution-10" class="nav-link" data-scroll-target="#solution-10"><span class="header-section-number">10.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-patterntonumber" id="toc-implement-patterntonumber" class="nav-link" data-scroll-target="#implement-patterntonumber"><span class="header-section-number">11</span> Implement PatternToNumber</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-11" id="toc-sample-dataset-11" class="nav-link" data-scroll-target="#sample-dataset-11"><span class="header-section-number">11.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-11" id="toc-sample-output-11" class="nav-link" data-scroll-target="#sample-output-11"><span class="header-section-number">11.2</span> Sample Output</a></li>
  <li><a href="#solution-11" id="toc-solution-11" class="nav-link" data-scroll-target="#solution-11"><span class="header-section-number">11.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-numbertopattern" id="toc-implement-numbertopattern" class="nav-link" data-scroll-target="#implement-numbertopattern"><span class="header-section-number">12</span> Implement NumberToPattern</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-12" id="toc-sample-dataset-12" class="nav-link" data-scroll-target="#sample-dataset-12"><span class="header-section-number">12.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-12" id="toc-sample-output-12" class="nav-link" data-scroll-target="#sample-output-12"><span class="header-section-number">12.2</span> Sample Output</a></li>
  <li><a href="#solution-12" id="toc-solution-12" class="nav-link" data-scroll-target="#solution-12"><span class="header-section-number">12.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-d-neighborhood-of-a-string" id="toc-generate-the-d-neighborhood-of-a-string" class="nav-link" data-scroll-target="#generate-the-d-neighborhood-of-a-string"><span class="header-section-number">13</span> Generate the d-Neighborhood of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-13" id="toc-sample-dataset-13" class="nav-link" data-scroll-target="#sample-dataset-13"><span class="header-section-number">13.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-13" id="toc-sample-output-13" class="nav-link" data-scroll-target="#sample-output-13"><span class="header-section-number">13.2</span> Sample Output</a></li>
  <li><a href="#solution-13" id="toc-solution-13" class="nav-link" data-scroll-target="#solution-13"><span class="header-section-number">13.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-a-hidden-path" id="toc-compute-the-probability-of-a-hidden-path" class="nav-link" data-scroll-target="#compute-the-probability-of-a-hidden-path"><span class="header-section-number">14</span> Compute the Probability of a Hidden Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-14" id="toc-sample-dataset-14" class="nav-link" data-scroll-target="#sample-dataset-14"><span class="header-section-number">14.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-14" id="toc-sample-output-14" class="nav-link" data-scroll-target="#sample-output-14"><span class="header-section-number">14.2</span> Sample Output</a></li>
  <li><a href="#solution-14" id="toc-solution-14" class="nav-link" data-scroll-target="#solution-14"><span class="header-section-number">14.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-an-outcome-given-a-hidden-path" id="toc-compute-the-probability-of-an-outcome-given-a-hidden-path" class="nav-link" data-scroll-target="#compute-the-probability-of-an-outcome-given-a-hidden-path"><span class="header-section-number">15</span> Compute the Probability of an Outcome Given a Hidden Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-15" id="toc-sample-dataset-15" class="nav-link" data-scroll-target="#sample-dataset-15"><span class="header-section-number">15.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-15" id="toc-sample-output-15" class="nav-link" data-scroll-target="#sample-output-15"><span class="header-section-number">15.2</span> Sample Output</a></li>
  <li><a href="#solution-15" id="toc-solution-15" class="nav-link" data-scroll-target="#solution-15"><span class="header-section-number">15.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-the-viterbi-algorithm" id="toc-implement-the-viterbi-algorithm" class="nav-link" data-scroll-target="#implement-the-viterbi-algorithm"><span class="header-section-number">16</span> Implement the Viterbi Algorithm</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-16" id="toc-sample-dataset-16" class="nav-link" data-scroll-target="#sample-dataset-16"><span class="header-section-number">16.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-16" id="toc-sample-output-16" class="nav-link" data-scroll-target="#sample-output-16"><span class="header-section-number">16.2</span> Sample Output</a></li>
  <li><a href="#solution-16" id="toc-solution-16" class="nav-link" data-scroll-target="#solution-16"><span class="header-section-number">16.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-a-string-emitted-by-an-hmm" id="toc-compute-the-probability-of-a-string-emitted-by-an-hmm" class="nav-link" data-scroll-target="#compute-the-probability-of-a-string-emitted-by-an-hmm"><span class="header-section-number">17</span> Compute the Probability of a String Emitted by an HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-17" id="toc-sample-dataset-17" class="nav-link" data-scroll-target="#sample-dataset-17"><span class="header-section-number">17.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-17" id="toc-sample-output-17" class="nav-link" data-scroll-target="#sample-output-17"><span class="header-section-number">17.2</span> Sample Output</a></li>
  <li><a href="#solution-17" id="toc-solution-17" class="nav-link" data-scroll-target="#solution-17"><span class="header-section-number">17.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-profile-hmm" id="toc-construct-a-profile-hmm" class="nav-link" data-scroll-target="#construct-a-profile-hmm"><span class="header-section-number">18</span> Construct a Profile HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-18" id="toc-sample-dataset-18" class="nav-link" data-scroll-target="#sample-dataset-18"><span class="header-section-number">18.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-18" id="toc-sample-output-18" class="nav-link" data-scroll-target="#sample-output-18"><span class="header-section-number">18.2</span> Sample Output</a></li>
  <li><a href="#solution-18" id="toc-solution-18" class="nav-link" data-scroll-target="#solution-18"><span class="header-section-number">18.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-profile-hmm-with-pseudocounts" id="toc-construct-a-profile-hmm-with-pseudocounts" class="nav-link" data-scroll-target="#construct-a-profile-hmm-with-pseudocounts"><span class="header-section-number">19</span> Construct a Profile HMM with Pseudocounts</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-19" id="toc-sample-dataset-19" class="nav-link" data-scroll-target="#sample-dataset-19"><span class="header-section-number">19.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-19" id="toc-sample-output-19" class="nav-link" data-scroll-target="#sample-output-19"><span class="header-section-number">19.2</span> Sample Output</a></li>
  <li><a href="#solution-19" id="toc-solution-19" class="nav-link" data-scroll-target="#solution-19"><span class="header-section-number">19.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#perform-a-multiple-sequence-alignment-with-a-profile-hmm" id="toc-perform-a-multiple-sequence-alignment-with-a-profile-hmm" class="nav-link" data-scroll-target="#perform-a-multiple-sequence-alignment-with-a-profile-hmm"><span class="header-section-number">20</span> Perform a Multiple Sequence Alignment with a Profile HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-20" id="toc-sample-dataset-20" class="nav-link" data-scroll-target="#sample-dataset-20"><span class="header-section-number">20.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-20" id="toc-sample-output-20" class="nav-link" data-scroll-target="#sample-output-20"><span class="header-section-number">20.2</span> Sample Output</a></li>
  <li><a href="#solution-20" id="toc-solution-20" class="nav-link" data-scroll-target="#solution-20"><span class="header-section-number">20.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#estimate-the-parameters-of-an-hmm" id="toc-estimate-the-parameters-of-an-hmm" class="nav-link" data-scroll-target="#estimate-the-parameters-of-an-hmm"><span class="header-section-number">21</span> Estimate the Parameters of an HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-21" id="toc-sample-dataset-21" class="nav-link" data-scroll-target="#sample-dataset-21"><span class="header-section-number">21.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-21" id="toc-sample-output-21" class="nav-link" data-scroll-target="#sample-output-21"><span class="header-section-number">21.2</span> Sample Output</a></li>
  <li><a href="#solution-21" id="toc-solution-21" class="nav-link" data-scroll-target="#solution-21"><span class="header-section-number">21.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-viterbi-learning" id="toc-implement-viterbi-learning" class="nav-link" data-scroll-target="#implement-viterbi-learning"><span class="header-section-number">22</span> Implement Viterbi Learning</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-22" id="toc-sample-dataset-22" class="nav-link" data-scroll-target="#sample-dataset-22"><span class="header-section-number">22.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-22" id="toc-sample-output-22" class="nav-link" data-scroll-target="#sample-output-22"><span class="header-section-number">22.2</span> Sample Output</a></li>
  <li><a href="#solution-22" id="toc-solution-22" class="nav-link" data-scroll-target="#solution-22"><span class="header-section-number">22.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#solve-the-soft-decoding-problem" id="toc-solve-the-soft-decoding-problem" class="nav-link" data-scroll-target="#solve-the-soft-decoding-problem"><span class="header-section-number">23</span> Solve the Soft Decoding Problem</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-23" id="toc-sample-dataset-23" class="nav-link" data-scroll-target="#sample-dataset-23"><span class="header-section-number">23.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-23" id="toc-sample-output-23" class="nav-link" data-scroll-target="#sample-output-23"><span class="header-section-number">23.2</span> Sample Output</a></li>
  <li><a href="#solution-23" id="toc-solution-23" class="nav-link" data-scroll-target="#solution-23"><span class="header-section-number">23.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-baum-welch-learning" id="toc-implement-baum-welch-learning" class="nav-link" data-scroll-target="#implement-baum-welch-learning"><span class="header-section-number">24</span> Implement Baum-Welch Learning</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-24" id="toc-sample-dataset-24" class="nav-link" data-scroll-target="#sample-dataset-24"><span class="header-section-number">24.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-24" id="toc-sample-output-24" class="nav-link" data-scroll-target="#sample-output-24"><span class="header-section-number">24.2</span> Sample Output</a></li>
  <li><a href="#solution-24" id="toc-solution-24" class="nav-link" data-scroll-target="#solution-24"><span class="header-section-number">24.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-graph-of-a-spectrum" id="toc-construct-the-graph-of-a-spectrum" class="nav-link" data-scroll-target="#construct-the-graph-of-a-spectrum"><span class="header-section-number">25</span> Construct the Graph of a Spectrum</a>
  <ul class="collapse">
  <li><a href="#spectrum-graph-construction" id="toc-spectrum-graph-construction" class="nav-link" data-scroll-target="#spectrum-graph-construction"><span class="header-section-number">25.1</span> Spectrum Graph Construction</a></li>
  <li><a href="#sample-dataset-25" id="toc-sample-dataset-25" class="nav-link" data-scroll-target="#sample-dataset-25"><span class="header-section-number">25.2</span> Sample Dataset</a></li>
  <li><a href="#sample-output-25" id="toc-sample-output-25" class="nav-link" data-scroll-target="#sample-output-25"><span class="header-section-number">25.3</span> Sample Output</a></li>
  <li><a href="#solution-25" id="toc-solution-25" class="nav-link" data-scroll-target="#solution-25"><span class="header-section-number">25.4</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-motifenumeration" id="toc-implement-motifenumeration" class="nav-link" data-scroll-target="#implement-motifenumeration"><span class="header-section-number">26</span> Implement MotifEnumeration</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-26" id="toc-sample-dataset-26" class="nav-link" data-scroll-target="#sample-dataset-26"><span class="header-section-number">26.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-26" id="toc-sample-output-26" class="nav-link" data-scroll-target="#sample-output-26"><span class="header-section-number">26.2</span> Sample Output</a></li>
  <li><a href="#solution-26" id="toc-solution-26" class="nav-link" data-scroll-target="#solution-26"><span class="header-section-number">26.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-median-string" id="toc-find-a-median-string" class="nav-link" data-scroll-target="#find-a-median-string"><span class="header-section-number">27</span> Find a Median String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-27" id="toc-sample-dataset-27" class="nav-link" data-scroll-target="#sample-dataset-27"><span class="header-section-number">27.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-27" id="toc-sample-output-27" class="nav-link" data-scroll-target="#sample-output-27"><span class="header-section-number">27.2</span> Sample Output</a></li>
  <li><a href="#solution-27" id="toc-solution-27" class="nav-link" data-scroll-target="#solution-27"><span class="header-section-number">27.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-profile-most-probable-k-mer-in-a-string" id="toc-find-a-profile-most-probable-k-mer-in-a-string" class="nav-link" data-scroll-target="#find-a-profile-most-probable-k-mer-in-a-string"><span class="header-section-number">28</span> Find a Profile-most Probable k-mer in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-28" id="toc-sample-dataset-28" class="nav-link" data-scroll-target="#sample-dataset-28"><span class="header-section-number">28.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-28" id="toc-sample-output-28" class="nav-link" data-scroll-target="#sample-output-28"><span class="header-section-number">28.2</span> Sample Output</a></li>
  <li><a href="#solution-28" id="toc-solution-28" class="nav-link" data-scroll-target="#solution-28"><span class="header-section-number">28.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-greedymotifsearch" id="toc-implement-greedymotifsearch" class="nav-link" data-scroll-target="#implement-greedymotifsearch"><span class="header-section-number">29</span> Implement GreedyMotifSearch</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-29" id="toc-sample-dataset-29" class="nav-link" data-scroll-target="#sample-dataset-29"><span class="header-section-number">29.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-29" id="toc-sample-output-29" class="nav-link" data-scroll-target="#sample-output-29"><span class="header-section-number">29.2</span> Sample Output</a></li>
  <li><a href="#solution-29" id="toc-solution-29" class="nav-link" data-scroll-target="#solution-29"><span class="header-section-number">29.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-greedymotifsearch-with-pseudocounts" id="toc-implement-greedymotifsearch-with-pseudocounts" class="nav-link" data-scroll-target="#implement-greedymotifsearch-with-pseudocounts"><span class="header-section-number">30</span> Implement GreedyMotifSearch with Pseudocounts</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-30" id="toc-sample-dataset-30" class="nav-link" data-scroll-target="#sample-dataset-30"><span class="header-section-number">30.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-30" id="toc-sample-output-30" class="nav-link" data-scroll-target="#sample-output-30"><span class="header-section-number">30.2</span> Sample Output</a></li>
  <li><a href="#solution-30" id="toc-solution-30" class="nav-link" data-scroll-target="#solution-30"><span class="header-section-number">30.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-randomizedmotifsearch" id="toc-implement-randomizedmotifsearch" class="nav-link" data-scroll-target="#implement-randomizedmotifsearch"><span class="header-section-number">31</span> Implement RandomizedMotifSearch</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-31" id="toc-sample-dataset-31" class="nav-link" data-scroll-target="#sample-dataset-31"><span class="header-section-number">31.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-31" id="toc-sample-output-31" class="nav-link" data-scroll-target="#sample-output-31"><span class="header-section-number">31.2</span> Sample Output</a></li>
  <li><a href="#solution-31" id="toc-solution-31" class="nav-link" data-scroll-target="#solution-31"><span class="header-section-number">31.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-gibbssampler" id="toc-implement-gibbssampler" class="nav-link" data-scroll-target="#implement-gibbssampler"><span class="header-section-number">32</span> Implement GibbsSampler</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-32" id="toc-sample-dataset-32" class="nav-link" data-scroll-target="#sample-dataset-32"><span class="header-section-number">32.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-32" id="toc-sample-output-32" class="nav-link" data-scroll-target="#sample-output-32"><span class="header-section-number">32.2</span> Sample Output</a></li>
  <li><a href="#solution-32" id="toc-solution-32" class="nav-link" data-scroll-target="#solution-32"><span class="header-section-number">32.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-distancebetweenpatternandstrings" id="toc-implement-distancebetweenpatternandstrings" class="nav-link" data-scroll-target="#implement-distancebetweenpatternandstrings"><span class="header-section-number">33</span> Implement DistanceBetweenPatternAndStrings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-33" id="toc-sample-dataset-33" class="nav-link" data-scroll-target="#sample-dataset-33"><span class="header-section-number">33.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-33" id="toc-sample-output-33" class="nav-link" data-scroll-target="#sample-output-33"><span class="header-section-number">33.2</span> Sample Output</a></li>
  <li><a href="#solution-33" id="toc-solution-33" class="nav-link" data-scroll-target="#solution-33"><span class="header-section-number">33.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-k-mer-composition-of-a-string" id="toc-generate-the-k-mer-composition-of-a-string" class="nav-link" data-scroll-target="#generate-the-k-mer-composition-of-a-string"><span class="header-section-number">34</span> Generate the k-mer Composition of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-34" id="toc-sample-dataset-34" class="nav-link" data-scroll-target="#sample-dataset-34"><span class="header-section-number">34.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-34" id="toc-sample-output-34" class="nav-link" data-scroll-target="#sample-output-34"><span class="header-section-number">34.2</span> Sample Output</a></li>
  <li><a href="#solution-34" id="toc-solution-34" class="nav-link" data-scroll-target="#solution-34"><span class="header-section-number">34.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-genome-path" id="toc-reconstruct-a-string-from-its-genome-path" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-genome-path"><span class="header-section-number">35</span> Reconstruct a String from its Genome Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-35" id="toc-sample-dataset-35" class="nav-link" data-scroll-target="#sample-dataset-35"><span class="header-section-number">35.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-35" id="toc-sample-output-35" class="nav-link" data-scroll-target="#sample-output-35"><span class="header-section-number">35.2</span> Sample Output</a></li>
  <li><a href="#solution-35" id="toc-solution-35" class="nav-link" data-scroll-target="#solution-35"><span class="header-section-number">35.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-overlap-graph-of-a-collection-of-k-mers" id="toc-construct-the-overlap-graph-of-a-collection-of-k-mers" class="nav-link" data-scroll-target="#construct-the-overlap-graph-of-a-collection-of-k-mers"><span class="header-section-number">36</span> Construct the Overlap Graph of a Collection of k-mers</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-36" id="toc-sample-dataset-36" class="nav-link" data-scroll-target="#sample-dataset-36"><span class="header-section-number">36.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-36" id="toc-sample-output-36" class="nav-link" data-scroll-target="#sample-output-36"><span class="header-section-number">36.2</span> Sample Output</a></li>
  <li><a href="#solution-36" id="toc-solution-36" class="nav-link" data-scroll-target="#solution-36"><span class="header-section-number">36.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-de-bruijn-graph-of-a-string" id="toc-construct-the-de-bruijn-graph-of-a-string" class="nav-link" data-scroll-target="#construct-the-de-bruijn-graph-of-a-string"><span class="header-section-number">37</span> Construct the De Bruijn Graph of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-37" id="toc-sample-dataset-37" class="nav-link" data-scroll-target="#sample-dataset-37"><span class="header-section-number">37.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-37" id="toc-sample-output-37" class="nav-link" data-scroll-target="#sample-output-37"><span class="header-section-number">37.2</span> Sample Output</a></li>
  <li><a href="#solution-37" id="toc-solution-37" class="nav-link" data-scroll-target="#solution-37"><span class="header-section-number">37.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-de-bruijn-graph-of-a-collection-of-k-mers" id="toc-construct-the-de-bruijn-graph-of-a-collection-of-k-mers" class="nav-link" data-scroll-target="#construct-the-de-bruijn-graph-of-a-collection-of-k-mers"><span class="header-section-number">38</span> Construct the De Bruijn Graph of a Collection of k-mers</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-38" id="toc-sample-dataset-38" class="nav-link" data-scroll-target="#sample-dataset-38"><span class="header-section-number">38.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-38" id="toc-sample-output-38" class="nav-link" data-scroll-target="#sample-output-38"><span class="header-section-number">38.2</span> Sample Output</a></li>
  <li><a href="#solution-38" id="toc-solution-38" class="nav-link" data-scroll-target="#solution-38"><span class="header-section-number">38.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-an-eulerian-cycle-in-a-graph" id="toc-find-an-eulerian-cycle-in-a-graph" class="nav-link" data-scroll-target="#find-an-eulerian-cycle-in-a-graph"><span class="header-section-number">39</span> Find an Eulerian Cycle in a Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-39" id="toc-sample-dataset-39" class="nav-link" data-scroll-target="#sample-dataset-39"><span class="header-section-number">39.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-39" id="toc-sample-output-39" class="nav-link" data-scroll-target="#sample-output-39"><span class="header-section-number">39.2</span> Sample Output</a></li>
  <li><a href="#solution-39" id="toc-solution-39" class="nav-link" data-scroll-target="#solution-39"><span class="header-section-number">39.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-an-eulerian-path-in-a-graph" id="toc-find-an-eulerian-path-in-a-graph" class="nav-link" data-scroll-target="#find-an-eulerian-path-in-a-graph"><span class="header-section-number">40</span> Find an Eulerian Path in a Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-40" id="toc-sample-dataset-40" class="nav-link" data-scroll-target="#sample-dataset-40"><span class="header-section-number">40.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-40" id="toc-sample-output-40" class="nav-link" data-scroll-target="#sample-output-40"><span class="header-section-number">40.2</span> Sample Output</a></li>
  <li><a href="#solution-40" id="toc-solution-40" class="nav-link" data-scroll-target="#solution-40"><span class="header-section-number">40.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-k-mer-composition" id="toc-reconstruct-a-string-from-its-k-mer-composition" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-k-mer-composition"><span class="header-section-number">41</span> Reconstruct a String from its k-mer Composition</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-41" id="toc-sample-dataset-41" class="nav-link" data-scroll-target="#sample-dataset-41"><span class="header-section-number">41.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-41" id="toc-sample-output-41" class="nav-link" data-scroll-target="#sample-output-41"><span class="header-section-number">41.2</span> Sample Output</a></li>
  <li><a href="#solution-41" id="toc-solution-41" class="nav-link" data-scroll-target="#solution-41"><span class="header-section-number">41.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-k-universal-circular-string" id="toc-find-a-k-universal-circular-string" class="nav-link" data-scroll-target="#find-a-k-universal-circular-string"><span class="header-section-number">42</span> Find a k-Universal Circular String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-42" id="toc-sample-dataset-42" class="nav-link" data-scroll-target="#sample-dataset-42"><span class="header-section-number">42.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-42" id="toc-sample-output-42" class="nav-link" data-scroll-target="#sample-output-42"><span class="header-section-number">42.2</span> Sample Output</a></li>
  <li><a href="#solution-42" id="toc-solution-42" class="nav-link" data-scroll-target="#solution-42"><span class="header-section-number">42.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-paired-composition" id="toc-reconstruct-a-string-from-its-paired-composition" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-paired-composition"><span class="header-section-number">43</span> Reconstruct a String from its Paired Composition</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-43" id="toc-sample-dataset-43" class="nav-link" data-scroll-target="#sample-dataset-43"><span class="header-section-number">43.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-43" id="toc-sample-output-43" class="nav-link" data-scroll-target="#sample-output-43"><span class="header-section-number">43.2</span> Sample Output</a></li>
  <li><a href="#solution-43" id="toc-solution-43" class="nav-link" data-scroll-target="#solution-43"><span class="header-section-number">43.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-contigs-from-a-collection-of-reads" id="toc-generate-contigs-from-a-collection-of-reads" class="nav-link" data-scroll-target="#generate-contigs-from-a-collection-of-reads"><span class="header-section-number">44</span> Generate Contigs from a Collection of Reads</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-44" id="toc-sample-dataset-44" class="nav-link" data-scroll-target="#sample-dataset-44"><span class="header-section-number">44.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-44" id="toc-sample-output-44" class="nav-link" data-scroll-target="#sample-output-44"><span class="header-section-number">44.2</span> Sample Output</a></li>
  <li><a href="#solution-44" id="toc-solution-44" class="nav-link" data-scroll-target="#solution-44"><span class="header-section-number">44.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-string-spelled-by-a-gapped-genome-path" id="toc-construct-a-string-spelled-by-a-gapped-genome-path" class="nav-link" data-scroll-target="#construct-a-string-spelled-by-a-gapped-genome-path"><span class="header-section-number">45</span> Construct a String Spelled by a Gapped Genome Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-45" id="toc-sample-dataset-45" class="nav-link" data-scroll-target="#sample-dataset-45"><span class="header-section-number">45.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-45" id="toc-sample-output-45" class="nav-link" data-scroll-target="#sample-output-45"><span class="header-section-number">45.2</span> Sample Output</a></li>
  <li><a href="#solution-45" id="toc-solution-45" class="nav-link" data-scroll-target="#solution-45"><span class="header-section-number">45.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-all-maximal-non-branching-paths-in-a-graph" id="toc-generate-all-maximal-non-branching-paths-in-a-graph" class="nav-link" data-scroll-target="#generate-all-maximal-non-branching-paths-in-a-graph"><span class="header-section-number">46</span> Generate All Maximal Non-Branching Paths in a Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-46" id="toc-sample-dataset-46" class="nav-link" data-scroll-target="#sample-dataset-46"><span class="header-section-number">46.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-46" id="toc-sample-output-46" class="nav-link" data-scroll-target="#sample-output-46"><span class="header-section-number">46.2</span> Sample Output</a></li>
  <li><a href="#solution-46" id="toc-solution-46" class="nav-link" data-scroll-target="#solution-46"><span class="header-section-number">46.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#translate-an-rna-string-into-an-amino-acid-string" id="toc-translate-an-rna-string-into-an-amino-acid-string" class="nav-link" data-scroll-target="#translate-an-rna-string-into-an-amino-acid-string"><span class="header-section-number">47</span> Translate an RNA String into an Amino Acid String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-47" id="toc-sample-dataset-47" class="nav-link" data-scroll-target="#sample-dataset-47"><span class="header-section-number">47.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-47" id="toc-sample-output-47" class="nav-link" data-scroll-target="#sample-output-47"><span class="header-section-number">47.2</span> Sample Output</a></li>
  <li><a href="#solution-47" id="toc-solution-47" class="nav-link" data-scroll-target="#solution-47"><span class="header-section-number">47.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-substrings-of-a-genome-encoding-a-given-amino-acid-string" id="toc-find-substrings-of-a-genome-encoding-a-given-amino-acid-string" class="nav-link" data-scroll-target="#find-substrings-of-a-genome-encoding-a-given-amino-acid-string"><span class="header-section-number">48</span> Find Substrings of a Genome Encoding a Given Amino Acid String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-48" id="toc-sample-dataset-48" class="nav-link" data-scroll-target="#sample-dataset-48"><span class="header-section-number">48.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-48" id="toc-sample-output-48" class="nav-link" data-scroll-target="#sample-output-48"><span class="header-section-number">48.2</span> Sample Output</a></li>
  <li><a href="#solution-48" id="toc-solution-48" class="nav-link" data-scroll-target="#solution-48"><span class="header-section-number">48.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-theoretical-spectrum-of-a-cyclic-peptide" id="toc-generate-the-theoretical-spectrum-of-a-cyclic-peptide" class="nav-link" data-scroll-target="#generate-the-theoretical-spectrum-of-a-cyclic-peptide"><span class="header-section-number">49</span> Generate the Theoretical Spectrum of a Cyclic Peptide</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-49" id="toc-sample-dataset-49" class="nav-link" data-scroll-target="#sample-dataset-49"><span class="header-section-number">49.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-49" id="toc-sample-output-49" class="nav-link" data-scroll-target="#sample-output-49"><span class="header-section-number">49.2</span> Sample Output</a></li>
  <li><a href="#solution-49" id="toc-solution-49" class="nav-link" data-scroll-target="#solution-49"><span class="header-section-number">49.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-number-of-peptides-of-given-total-mass" id="toc-compute-the-number-of-peptides-of-given-total-mass" class="nav-link" data-scroll-target="#compute-the-number-of-peptides-of-given-total-mass"><span class="header-section-number">50</span> Compute the Number of Peptides of Given Total Mass</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-50" id="toc-sample-dataset-50" class="nav-link" data-scroll-target="#sample-dataset-50"><span class="header-section-number">50.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-50" id="toc-sample-output-50" class="nav-link" data-scroll-target="#sample-output-50"><span class="header-section-number">50.2</span> Sample Output</a></li>
  <li><a href="#solution-50" id="toc-solution-50" class="nav-link" data-scroll-target="#solution-50"><span class="header-section-number">50.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-cyclic-peptide-with-theoretical-spectrum-matching-an-ideal-spectrum" id="toc-find-a-cyclic-peptide-with-theoretical-spectrum-matching-an-ideal-spectrum" class="nav-link" data-scroll-target="#find-a-cyclic-peptide-with-theoretical-spectrum-matching-an-ideal-spectrum"><span class="header-section-number">51</span> Find a Cyclic Peptide with Theoretical Spectrum Matching an Ideal Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-51" id="toc-sample-dataset-51" class="nav-link" data-scroll-target="#sample-dataset-51"><span class="header-section-number">51.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-51" id="toc-sample-output-51" class="nav-link" data-scroll-target="#sample-output-51"><span class="header-section-number">51.2</span> Sample Output</a></li>
  <li><a href="#solution-51" id="toc-solution-51" class="nav-link" data-scroll-target="#solution-51"><span class="header-section-number">51.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-score-of-a-cyclic-peptide-against-a-spectrum" id="toc-compute-the-score-of-a-cyclic-peptide-against-a-spectrum" class="nav-link" data-scroll-target="#compute-the-score-of-a-cyclic-peptide-against-a-spectrum"><span class="header-section-number">52</span> Compute the Score of a Cyclic Peptide Against a Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-52" id="toc-sample-dataset-52" class="nav-link" data-scroll-target="#sample-dataset-52"><span class="header-section-number">52.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-52" id="toc-sample-output-52" class="nav-link" data-scroll-target="#sample-output-52"><span class="header-section-number">52.2</span> Sample Output</a></li>
  <li><a href="#solution-52" id="toc-solution-52" class="nav-link" data-scroll-target="#solution-52"><span class="header-section-number">52.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-leaderboardcyclopeptidesequencing" id="toc-implement-leaderboardcyclopeptidesequencing" class="nav-link" data-scroll-target="#implement-leaderboardcyclopeptidesequencing"><span class="header-section-number">53</span> Implement LeaderboardCyclopeptideSequencing</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-53" id="toc-sample-dataset-53" class="nav-link" data-scroll-target="#sample-dataset-53"><span class="header-section-number">53.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-53" id="toc-sample-output-53" class="nav-link" data-scroll-target="#sample-output-53"><span class="header-section-number">53.2</span> Sample Output</a></li>
  <li><a href="#solution-53" id="toc-solution-53" class="nav-link" data-scroll-target="#solution-53"><span class="header-section-number">53.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-convolution-of-a-spectrum" id="toc-generate-the-convolution-of-a-spectrum" class="nav-link" data-scroll-target="#generate-the-convolution-of-a-spectrum"><span class="header-section-number">54</span> Generate the Convolution of a Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-54" id="toc-sample-dataset-54" class="nav-link" data-scroll-target="#sample-dataset-54"><span class="header-section-number">54.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-54" id="toc-sample-output-54" class="nav-link" data-scroll-target="#sample-output-54"><span class="header-section-number">54.2</span> Sample Output</a></li>
  <li><a href="#solution-54" id="toc-solution-54" class="nav-link" data-scroll-target="#solution-54"><span class="header-section-number">54.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-convolutioncyclopeptidesequencing" id="toc-implement-convolutioncyclopeptidesequencing" class="nav-link" data-scroll-target="#implement-convolutioncyclopeptidesequencing"><span class="header-section-number">55</span> Implement ConvolutionCyclopeptideSequencing</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-55" id="toc-sample-dataset-55" class="nav-link" data-scroll-target="#sample-dataset-55"><span class="header-section-number">55.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-55" id="toc-sample-output-55" class="nav-link" data-scroll-target="#sample-output-55"><span class="header-section-number">55.2</span> Sample Output</a></li>
  <li><a href="#solution-55" id="toc-solution-55" class="nav-link" data-scroll-target="#solution-55"><span class="header-section-number">55.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-theoretical-spectrum-of-a-linear-peptide" id="toc-generate-the-theoretical-spectrum-of-a-linear-peptide" class="nav-link" data-scroll-target="#generate-the-theoretical-spectrum-of-a-linear-peptide"><span class="header-section-number">56</span> Generate the Theoretical Spectrum of a Linear Peptide</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-56" id="toc-sample-dataset-56" class="nav-link" data-scroll-target="#sample-dataset-56"><span class="header-section-number">56.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-56" id="toc-sample-output-56" class="nav-link" data-scroll-target="#sample-output-56"><span class="header-section-number">56.2</span> Sample Output</a></li>
  <li><a href="#solution-56" id="toc-solution-56" class="nav-link" data-scroll-target="#solution-56"><span class="header-section-number">56.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-score-of-a-linear-peptide" id="toc-compute-the-score-of-a-linear-peptide" class="nav-link" data-scroll-target="#compute-the-score-of-a-linear-peptide"><span class="header-section-number">57</span> Compute the Score of a Linear Peptide</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-57" id="toc-sample-dataset-57" class="nav-link" data-scroll-target="#sample-dataset-57"><span class="header-section-number">57.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-57" id="toc-sample-output-57" class="nav-link" data-scroll-target="#sample-output-57"><span class="header-section-number">57.2</span> Sample Output</a></li>
  <li><a href="#solution-57" id="toc-solution-57" class="nav-link" data-scroll-target="#solution-57"><span class="header-section-number">57.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#trim-a-peptide-leaderboard" id="toc-trim-a-peptide-leaderboard" class="nav-link" data-scroll-target="#trim-a-peptide-leaderboard"><span class="header-section-number">58</span> Trim a Peptide Leaderboard</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-58" id="toc-sample-dataset-58" class="nav-link" data-scroll-target="#sample-dataset-58"><span class="header-section-number">58.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-58" id="toc-sample-output-58" class="nav-link" data-scroll-target="#sample-output-58"><span class="header-section-number">58.2</span> Sample Output</a></li>
  <li><a href="#solution-58" id="toc-solution-58" class="nav-link" data-scroll-target="#solution-58"><span class="header-section-number">58.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#solve-the-turnpike-problem" id="toc-solve-the-turnpike-problem" class="nav-link" data-scroll-target="#solve-the-turnpike-problem"><span class="header-section-number">59</span> Solve the Turnpike Problem</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-59" id="toc-sample-dataset-59" class="nav-link" data-scroll-target="#sample-dataset-59"><span class="header-section-number">59.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-59" id="toc-sample-output-59" class="nav-link" data-scroll-target="#sample-output-59"><span class="header-section-number">59.2</span> Sample Output</a></li>
  <li><a href="#solution-59" id="toc-solution-59" class="nav-link" data-scroll-target="#solution-59"><span class="header-section-number">59.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-minimum-number-of-coins-needed-to-make-change" id="toc-find-the-minimum-number-of-coins-needed-to-make-change" class="nav-link" data-scroll-target="#find-the-minimum-number-of-coins-needed-to-make-change"><span class="header-section-number">60</span> Find the Minimum Number of Coins Needed to Make Change</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-60" id="toc-sample-dataset-60" class="nav-link" data-scroll-target="#sample-dataset-60"><span class="header-section-number">60.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-60" id="toc-sample-output-60" class="nav-link" data-scroll-target="#sample-output-60"><span class="header-section-number">60.2</span> Sample Output</a></li>
  <li><a href="#solution-60" id="toc-solution-60" class="nav-link" data-scroll-target="#solution-60"><span class="header-section-number">60.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-length-of-a-longest-path-in-a-manhattan-like-grid" id="toc-find-the-length-of-a-longest-path-in-a-manhattan-like-grid" class="nav-link" data-scroll-target="#find-the-length-of-a-longest-path-in-a-manhattan-like-grid"><span class="header-section-number">61</span> Find the Length of a Longest Path in a Manhattan-like Grid</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-61" id="toc-sample-dataset-61" class="nav-link" data-scroll-target="#sample-dataset-61"><span class="header-section-number">61.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-61" id="toc-sample-output-61" class="nav-link" data-scroll-target="#sample-output-61"><span class="header-section-number">61.2</span> Sample Output</a></li>
  <li><a href="#solution-61" id="toc-solution-61" class="nav-link" data-scroll-target="#solution-61"><span class="header-section-number">61.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-longest-common-subsequence-of-two-strings" id="toc-find-a-longest-common-subsequence-of-two-strings" class="nav-link" data-scroll-target="#find-a-longest-common-subsequence-of-two-strings"><span class="header-section-number">62</span> Find a Longest Common Subsequence of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-62" id="toc-sample-dataset-62" class="nav-link" data-scroll-target="#sample-dataset-62"><span class="header-section-number">62.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-62" id="toc-sample-output-62" class="nav-link" data-scroll-target="#sample-output-62"><span class="header-section-number">62.2</span> Sample Output</a></li>
  <li><a href="#solution-62" id="toc-solution-62" class="nav-link" data-scroll-target="#solution-62"><span class="header-section-number">62.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-longest-path-in-a-dag" id="toc-find-the-longest-path-in-a-dag" class="nav-link" data-scroll-target="#find-the-longest-path-in-a-dag"><span class="header-section-number">63</span> Find the Longest Path in a DAG</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-63" id="toc-sample-dataset-63" class="nav-link" data-scroll-target="#sample-dataset-63"><span class="header-section-number">63.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-63" id="toc-sample-output-63" class="nav-link" data-scroll-target="#sample-output-63"><span class="header-section-number">63.2</span> Sample Output</a></li>
  <li><a href="#solution-63" id="toc-solution-63" class="nav-link" data-scroll-target="#solution-63"><span class="header-section-number">63.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-alignment-of-two-strings" id="toc-find-a-highest-scoring-alignment-of-two-strings" class="nav-link" data-scroll-target="#find-a-highest-scoring-alignment-of-two-strings"><span class="header-section-number">64</span> Find a Highest-Scoring Alignment of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-64" id="toc-sample-dataset-64" class="nav-link" data-scroll-target="#sample-dataset-64"><span class="header-section-number">64.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-64" id="toc-sample-output-64" class="nav-link" data-scroll-target="#sample-output-64"><span class="header-section-number">64.2</span> Sample Output</a></li>
  <li><a href="#solution-64" id="toc-solution-64" class="nav-link" data-scroll-target="#solution-64"><span class="header-section-number">64.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-local-alignment-of-two-strings" id="toc-find-a-highest-scoring-local-alignment-of-two-strings" class="nav-link" data-scroll-target="#find-a-highest-scoring-local-alignment-of-two-strings"><span class="header-section-number">65</span> Find a Highest-Scoring Local Alignment of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-65" id="toc-sample-dataset-65" class="nav-link" data-scroll-target="#sample-dataset-65"><span class="header-section-number">65.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-65" id="toc-sample-output-65" class="nav-link" data-scroll-target="#sample-output-65"><span class="header-section-number">65.2</span> Sample Output</a></li>
  <li><a href="#solution-65" id="toc-solution-65" class="nav-link" data-scroll-target="#solution-65"><span class="header-section-number">65.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-edit-distance-between-two-strings" id="toc-compute-the-edit-distance-between-two-strings" class="nav-link" data-scroll-target="#compute-the-edit-distance-between-two-strings"><span class="header-section-number">66</span> Compute the Edit Distance Between Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-66" id="toc-sample-dataset-66" class="nav-link" data-scroll-target="#sample-dataset-66"><span class="header-section-number">66.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-66" id="toc-sample-output-66" class="nav-link" data-scroll-target="#sample-output-66"><span class="header-section-number">66.2</span> Sample Output</a></li>
  <li><a href="#solution-66" id="toc-solution-66" class="nav-link" data-scroll-target="#solution-66"><span class="header-section-number">66.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-fitting-alignment-of-two-strings" id="toc-find-a-highest-scoring-fitting-alignment-of-two-strings" class="nav-link" data-scroll-target="#find-a-highest-scoring-fitting-alignment-of-two-strings"><span class="header-section-number">67</span> Find a Highest-Scoring Fitting Alignment of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-67" id="toc-sample-dataset-67" class="nav-link" data-scroll-target="#sample-dataset-67"><span class="header-section-number">67.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-67" id="toc-sample-output-67" class="nav-link" data-scroll-target="#sample-output-67"><span class="header-section-number">67.2</span> Sample Output</a></li>
  <li><a href="#solution-67" id="toc-solution-67" class="nav-link" data-scroll-target="#solution-67"><span class="header-section-number">67.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-overlap-alignment-of-two-strings" id="toc-find-a-highest-scoring-overlap-alignment-of-two-strings" class="nav-link" data-scroll-target="#find-a-highest-scoring-overlap-alignment-of-two-strings"><span class="header-section-number">68</span> Find a Highest-Scoring Overlap Alignment of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-68" id="toc-sample-dataset-68" class="nav-link" data-scroll-target="#sample-dataset-68"><span class="header-section-number">68.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-68" id="toc-sample-output-68" class="nav-link" data-scroll-target="#sample-output-68"><span class="header-section-number">68.2</span> Sample Output</a></li>
  <li><a href="#solution-68" id="toc-solution-68" class="nav-link" data-scroll-target="#solution-68"><span class="header-section-number">68.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#align-two-strings-using-affine-gap-penalties" id="toc-align-two-strings-using-affine-gap-penalties" class="nav-link" data-scroll-target="#align-two-strings-using-affine-gap-penalties"><span class="header-section-number">69</span> Align Two Strings Using Affine Gap Penalties</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-69" id="toc-sample-dataset-69" class="nav-link" data-scroll-target="#sample-dataset-69"><span class="header-section-number">69.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-69" id="toc-sample-output-69" class="nav-link" data-scroll-target="#sample-output-69"><span class="header-section-number">69.2</span> Sample Output</a></li>
  <li><a href="#solution-69" id="toc-solution-69" class="nav-link" data-scroll-target="#solution-69"><span class="header-section-number">69.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-middle-edge-in-an-alignment-graph-in-linear-space" id="toc-find-a-middle-edge-in-an-alignment-graph-in-linear-space" class="nav-link" data-scroll-target="#find-a-middle-edge-in-an-alignment-graph-in-linear-space"><span class="header-section-number">70</span> Find a Middle Edge in an Alignment Graph in Linear Space</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-70" id="toc-sample-dataset-70" class="nav-link" data-scroll-target="#sample-dataset-70"><span class="header-section-number">70.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-70" id="toc-sample-output-70" class="nav-link" data-scroll-target="#sample-output-70"><span class="header-section-number">70.2</span> Sample Output</a></li>
  <li><a href="#solution-70" id="toc-solution-70" class="nav-link" data-scroll-target="#solution-70"><span class="header-section-number">70.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#align-two-strings-using-linear-space" id="toc-align-two-strings-using-linear-space" class="nav-link" data-scroll-target="#align-two-strings-using-linear-space"><span class="header-section-number">71</span> Align Two Strings Using Linear Space</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-71" id="toc-sample-dataset-71" class="nav-link" data-scroll-target="#sample-dataset-71"><span class="header-section-number">71.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-71" id="toc-sample-output-71" class="nav-link" data-scroll-target="#sample-output-71"><span class="header-section-number">71.2</span> Sample Output</a></li>
  <li><a href="#solution-71" id="toc-solution-71" class="nav-link" data-scroll-target="#solution-71"><span class="header-section-number">71.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-multiple-sequence-alignment" id="toc-find-a-highest-scoring-multiple-sequence-alignment" class="nav-link" data-scroll-target="#find-a-highest-scoring-multiple-sequence-alignment"><span class="header-section-number">72</span> Find a Highest-Scoring Multiple Sequence Alignment</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-72" id="toc-sample-dataset-72" class="nav-link" data-scroll-target="#sample-dataset-72"><span class="header-section-number">72.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-72" id="toc-sample-output-72" class="nav-link" data-scroll-target="#sample-output-72"><span class="header-section-number">72.2</span> Sample Output</a></li>
  <li><a href="#solution-72" id="toc-solution-72" class="nav-link" data-scroll-target="#solution-72"><span class="header-section-number">72.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-topological-ordering-of-a-dag" id="toc-find-a-topological-ordering-of-a-dag" class="nav-link" data-scroll-target="#find-a-topological-ordering-of-a-dag"><span class="header-section-number">73</span> Find a Topological Ordering of a DAG</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-73" id="toc-sample-dataset-73" class="nav-link" data-scroll-target="#sample-dataset-73"><span class="header-section-number">73.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-73" id="toc-sample-output-73" class="nav-link" data-scroll-target="#sample-output-73"><span class="header-section-number">73.2</span> Sample Output</a></li>
  <li><a href="#solution-73" id="toc-solution-73" class="nav-link" data-scroll-target="#solution-73"><span class="header-section-number">73.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-greedysorting-to-sort-a-permutation-by-reversals" id="toc-implement-greedysorting-to-sort-a-permutation-by-reversals" class="nav-link" data-scroll-target="#implement-greedysorting-to-sort-a-permutation-by-reversals"><span class="header-section-number">74</span> Implement GreedySorting to Sort a Permutation by Reversals</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-74" id="toc-sample-dataset-74" class="nav-link" data-scroll-target="#sample-dataset-74"><span class="header-section-number">74.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-74" id="toc-sample-output-74" class="nav-link" data-scroll-target="#sample-output-74"><span class="header-section-number">74.2</span> Sample Output</a></li>
  <li><a href="#solution-74" id="toc-solution-74" class="nav-link" data-scroll-target="#solution-74"><span class="header-section-number">74.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-number-of-breakpoints-in-a-permutation" id="toc-compute-the-number-of-breakpoints-in-a-permutation" class="nav-link" data-scroll-target="#compute-the-number-of-breakpoints-in-a-permutation"><span class="header-section-number">75</span> Compute the Number of Breakpoints in a Permutation</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-75" id="toc-sample-dataset-75" class="nav-link" data-scroll-target="#sample-dataset-75"><span class="header-section-number">75.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-75" id="toc-sample-output-75" class="nav-link" data-scroll-target="#sample-output-75"><span class="header-section-number">75.2</span> Sample Output</a></li>
  <li><a href="#solution-75" id="toc-solution-75" class="nav-link" data-scroll-target="#solution-75"><span class="header-section-number">75.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-2-break-distance-between-a-pair-of-genomes" id="toc-compute-the-2-break-distance-between-a-pair-of-genomes" class="nav-link" data-scroll-target="#compute-the-2-break-distance-between-a-pair-of-genomes"><span class="header-section-number">76</span> Compute the 2-Break Distance Between a Pair of Genomes</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-76" id="toc-sample-dataset-76" class="nav-link" data-scroll-target="#sample-dataset-76"><span class="header-section-number">76.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-76" id="toc-sample-output-76" class="nav-link" data-scroll-target="#sample-output-76"><span class="header-section-number">76.2</span> Sample Output</a></li>
  <li><a href="#solution-76" id="toc-solution-76" class="nav-link" data-scroll-target="#solution-76"><span class="header-section-number">76.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-shortest-transformation-of-one-genome-into-another-by-2-breaks" id="toc-find-a-shortest-transformation-of-one-genome-into-another-by-2-breaks" class="nav-link" data-scroll-target="#find-a-shortest-transformation-of-one-genome-into-another-by-2-breaks"><span class="header-section-number">77</span> Find a Shortest Transformation of One Genome into Another by 2-Breaks</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-77" id="toc-sample-dataset-77" class="nav-link" data-scroll-target="#sample-dataset-77"><span class="header-section-number">77.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-77" id="toc-sample-output-77" class="nav-link" data-scroll-target="#sample-output-77"><span class="header-section-number">77.2</span> Sample Output</a></li>
  <li><a href="#solution-77" id="toc-solution-77" class="nav-link" data-scroll-target="#solution-77"><span class="header-section-number">77.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-shared-k-mers-of-a-pair-of-strings" id="toc-find-all-shared-k-mers-of-a-pair-of-strings" class="nav-link" data-scroll-target="#find-all-shared-k-mers-of-a-pair-of-strings"><span class="header-section-number">78</span> Find All Shared k-mers of a Pair of Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-78" id="toc-sample-dataset-78" class="nav-link" data-scroll-target="#sample-dataset-78"><span class="header-section-number">78.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-78" id="toc-sample-output-78" class="nav-link" data-scroll-target="#sample-output-78"><span class="header-section-number">78.2</span> Sample Output</a></li>
  <li><a href="#solution-78" id="toc-solution-78" class="nav-link" data-scroll-target="#solution-78"><span class="header-section-number">78.3</span> Solution</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Rosalind Textbook track 문제풀이</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Python</div>
    <div class="quarto-category">Rosalind</div>
    <div class="quarto-category">Bioinformatics</div>
    <div class="quarto-category">Tip</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Taeyoon Kim </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 28, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 16, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Rosalind_textbookTrack.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
<p>Phillip Compeau 와 Pavel Pevzner 가 쓴 책 “<a href="https://www.bioinformaticsalgorithms.org/">능동적 접근 방식의 생물정보학 알고리즘</a>” 에서 제공되는 연습 문제 모음입니다.</p>
<p><a href="https://rosalind.info/">Rosalind</a> 는 <a href="http://projecteuler.net/">프로젝트 오일러</a>, <a href="http://code.google.com/codejam">구글 코드 잼</a> 에서 영감을 얻었습니다. 이 프로젝트의 이름은 DNA 이중나선을 발견하는 데 기여한 <a href="http://en.wikipedia.org/wiki/Rosalind_Franklin">로잘린드 프랭클린</a> 에서 따왔습니다. Rosalind 는 프로그래밍 실력을 키우고자 하는 생물학자와 분자생물학의 계산 문제를 접해본 적이 없는 프로그래머들에게 도움이 될 것입니다.</p>
<section id="compute-the-number-of-times-a-pattern-appears-in-a-text" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="compute-the-number-of-times-a-pattern-appears-in-a-text"><span class="header-section-number">0.1</span> Compute the Number of Times a Pattern Appears in a Text</h2>
<p>This is the first problem in a collection of”code challenges”to accompany&nbsp;<a href="http://bioinformaticsalgorithms.org/">Bioinformatics Algorithms: An Active-Learning Approach</a>&nbsp;by Phillip Compeau &amp; Pavel Pevzner.</p>
<p>A&nbsp;<a href="https://rosalind.info/glossary/k-mer/">k-mer</a>&nbsp;is a&nbsp;<a href="https://rosalind.info/glossary/string/">string</a>&nbsp;of length&nbsp;<em>k</em>. We define&nbsp;<em>Count</em>(<em>Text</em>,&nbsp;<em>Pattern</em>) as the number of times that a&nbsp;<em>k</em>-mer&nbsp;<em>Pattern</em>&nbsp;appears as a&nbsp;<a href="https://rosalind.info/glossary/substring/">substring</a>&nbsp;of&nbsp;<em>Text</em>.</p>
<p>For example, We note that&nbsp;<span class="math inline">\(Count(CGATATATCCATAGCGATATATCCATAG,ATAATA)\)</span> is equal to 3 (not 2) since we should account for overlapping occurrences of&nbsp;<em>Pattern</em>&nbsp;in&nbsp;<em>Text</em>.</p>
<p>Given:&nbsp;{DNA strings}}&nbsp;<em>Text</em>&nbsp;and&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;<em>Count</em>(<em>Text</em>,&nbsp;<em>Pattern</em>).</p>
</section>
<section id="sample-dataset" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="sample-dataset"><span class="header-section-number">0.2</span> Sample Dataset</h2>
<pre><code>GCGCG
GCG</code></pre>
</section>
<section id="sample-output" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="sample-output"><span class="header-section-number">0.3</span> Sample Output</h2>
<pre><code>2</code></pre>
</section>
<section id="solution" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="solution"><span class="header-section-number">0.4</span> Solution</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i:i <span class="op">+</span> size]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count how many times the pattern occurs in the text."""</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">GCGCG</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="st">GCG</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>text, pattern <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the count of pattern occurrences in text</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_pattern_occurrences(text, pattern))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="find-the-most-frequent-words-in-a-string" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Find the Most Frequent Words in a String</h1>
<p>We say that&nbsp;<em>Pattern</em>&nbsp;is a&nbsp;<strong>most frequent&nbsp;k-mer</strong>&nbsp;in&nbsp;<em>Text</em>&nbsp;if it maximizes&nbsp;<em>Count</em>(<em>Text</em>,&nbsp;<em>Pattern</em>) among all&nbsp;<a href="https://rosalind.info/glossary/k-mer/">k-mers</a>. For example,“ACTAT”is a most frequent 5-mer in”ACAACTATGCATCACTATCGGGAACTATCCT”, and”ATA”is a most frequent 3-mer of”CGATATATCCATAG”.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Text</em>&nbsp;and an integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;All most frequent&nbsp;<em>k</em>-mers in&nbsp;<em>Text</em>&nbsp;(in any order).</p>
<section id="sample-dataset-1" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="sample-dataset-1"><span class="header-section-number">1.1</span> Sample Dataset</h2>
<pre><code>ACGTTGCATGTCGCATGATGCATGAGAGCT
4</code></pre>
</section>
<section id="sample-output-1" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="sample-output-1"><span class="header-section-number">1.2</span> Sample Output</h2>
<pre><code>CATG GCAT</code></pre>
</section>
<section id="solution-1" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="solution-1"><span class="header-section-number">1.3</span> Solution</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count occurrences of each k-mer in the text."""</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(text, k):</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> most_frequent_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find the most frequent k-mers."""</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern size</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>text, k <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="bu">int</span>(k)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Find and print the most frequent k-mers</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>most_frequent <span class="op">=</span> most_frequent_kmers(count_kmers(text, k))</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-reverse-complement-of-a-string" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Find the Reverse Complement of a String</h1>
<p>Find the reverse complement of a DNA string.</p>
<p>Given:&nbsp;A DNA string&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;<span class="math inline">\(\overline{Pattern}\)</span>, the reverse complement of&nbsp;<em>Pattern</em>.</p>
<section id="sample-dataset-2" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sample-dataset-2"><span class="header-section-number">2.1</span> Sample Dataset</h2>
<pre><code>AAAACCCGGT</code></pre>
</section>
<section id="sample-output-2" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="sample-output-2"><span class="header-section-number">2.2</span> Sample Output</h2>
<pre><code>ACCGGGTTTT</code></pre>
</section>
<section id="solution-2" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="solution-2"><span class="header-section-number">2.3</span> Solution</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Return the reverse complement of a DNA sequence."""</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="st">AAAACCCGGT</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the reverse complement</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip().split()[<span class="dv">0</span>]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reverse_complement(sequence))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-occurrences-of-a-pattern-in-a-string" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Find All Occurrences of a Pattern in a String</h1>
<p>Pattern Matching Problem, Find all occurrences of a pattern in a string.</p>
<p>Given:&nbsp;Strings&nbsp;<em>Pattern</em>&nbsp;and&nbsp;<em>Genome</em>.</p>
<p>Return:&nbsp;All starting positions in&nbsp;<em>Genome</em>&nbsp;where&nbsp;<em>Pattern</em>&nbsp;appears as a substring. Use&nbsp;<a href="https://rosalind.info/glossary/0-based-numbering/">0-based indexing</a>.</p>
<section id="sample-dataset-3" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sample-dataset-3"><span class="header-section-number">3.1</span> Sample Dataset</h2>
<pre><code>ATAT
GATATATGCATATACTT</code></pre>
</section>
<section id="sample-output-3" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sample-output-3"><span class="header-section-number">3.2</span> Sample Output</h2>
<pre><code>1 3 9</code></pre>
</section>
<section id="solution-3" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="solution-3"><span class="header-section-number">3.3</span> Solution</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Generator</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_pattern_indices(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Yield starting indices where the pattern is found in the text."""</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, <span class="bu">len</span>(pattern))):</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> substring <span class="op">==</span> pattern:</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> i</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="st">ATAT</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="st">GATATATGCATATACTT</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into pattern and text</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>pattern, text <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print indices where the pattern is found</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_pattern_indices(text, pattern))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-patterns-forming-clumps-in-a-string" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Find Patterns Forming Clumps in a String</h1>
<p>Clump Finding Problem, Find patterns forming clumps in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Genome</em>, and integers&nbsp;<em>k</em>,&nbsp;<em>L</em>, and&nbsp;<em>t</em>.</p>
<p>Return:&nbsp;All distinct&nbsp;<em>k</em>-mers forming (<em>L</em>,&nbsp;<em>t</em>)-clumps in&nbsp;<em>Genome</em>.</p>
<section id="sample-dataset-4" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sample-dataset-4"><span class="header-section-number">4.1</span> Sample Dataset</h2>
<pre><code>CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC
5 75 4</code></pre>
</section>
<section id="sample-output-4" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sample-output-4"><span class="header-section-number">4.2</span> Sample Output</h2>
<pre><code>CGACA GAAGA AATGT</code></pre>
</section>
<section id="solution-4" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="solution-4"><span class="header-section-number">4.3</span> Solution</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions of k-length kmers within the text."""</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    kmer_positions <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, k)):</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        kmer_positions[substring].append(i)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_positions</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> has_clump(positions: List[<span class="bu">int</span>], L: <span class="bu">int</span>, t: <span class="bu">int</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Check if a given array of kmers at positions forms a clump of t within L."""</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(positions) <span class="op">-</span> t <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (positions[i <span class="op">+</span> t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> k <span class="op">-</span> positions[i]) <span class="op">&lt;=</span> L:</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="st">CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="st">5 75 4</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into sequence and parameters</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>seq, params <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>k, L, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Find kmers and print those forming clumps</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>kmers <span class="op">=</span> find_kmers(seq, k)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>clumps <span class="op">=</span> [kmer <span class="cf">for</span> kmer <span class="kw">in</span> kmers <span class="cf">if</span> has_clump(kmers[kmer], L, t, k)]</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>clumps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-position-in-a-genome-minimizing-the-skew" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Find a Position in a Genome Minimizing the Skew</h1>
<p>Minimum Skew Problem, Find a position in a genome minimizing the skew.</p>
<p>Given:&nbsp;A DNA string&nbsp;<em>Genome</em>.</p>
<p>Return:&nbsp;All integer(s)&nbsp;<em>i</em>&nbsp;minimizing&nbsp;<em>Skew</em>(*Prefix__i<em>&nbsp;(</em>Text<em>)) over all values of&nbsp;</em>i<em>&nbsp;(from 0 to |</em>Genome*|).</p>
<section id="sample-dataset-5" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sample-dataset-5"><span class="header-section-number">5.1</span> Sample Dataset</h2>
<pre><code>CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</code></pre>
</section>
<section id="sample-output-5" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sample-output-5"><span class="header-section-number">5.2</span> Sample Output</h2>
<pre><code>53 97</code></pre>
</section>
<section id="solution-5" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="solution-5"><span class="header-section-number">5.3</span> Solution</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minima(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions with the minimum skew in a DNA sequence."""</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    skew <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> {<span class="st">"G"</span>: <span class="dv">1</span>, <span class="st">"C"</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"T"</span>: <span class="dv">0</span>}</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(seq):</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        skew.append(skew[i] <span class="op">+</span> delta[nucleotide])</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    min_skew <span class="op">=</span> <span class="bu">min</span>(skew)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (i <span class="cf">for</span> i, value <span class="kw">in</span> <span class="bu">enumerate</span>(skew) <span class="cf">if</span> value <span class="op">==</span> min_skew)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="st">CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the positions with minimum skew</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip()</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_minima(sequence))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-hamming-distance-between-two-strings" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Compute the Hamming Distance Between Two Strings</h1>
<p>Hamming Distance Problem, Compute the Hamming distance between two DNA strings.</p>
<p>Given:&nbsp;Two DNA strings.</p>
<p>Return:&nbsp;An integer value representing the Hamming distance.</p>
<section id="sample-dataset-6" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sample-dataset-6"><span class="header-section-number">6.1</span> Sample Dataset</h2>
<pre><code>GGGCCGTTGGT
GGACCGTTGAC</code></pre>
</section>
<section id="sample-output-6" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="sample-output-6"><span class="header-section-number">6.2</span> Sample Output</h2>
<pre><code>3</code></pre>
</section>
<section id="solution-6" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="solution-6"><span class="header-section-number">6.3</span> Solution</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> zip_longest</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> zip_longest(sequence1, sequence2, fillvalue<span class="op">=</span><span class="va">None</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_dna_sequences(input_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>(input_string.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>Sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCCGTTGGT</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="st">GGACCGTTGAC</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>dna_sequence1, dna_sequence2 <span class="op">=</span> parse_dna_sequences(Sample_input)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>hamming_distance <span class="op">=</span> calculate_hamming_distance(dna_sequence1, dna_sequence2)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(hamming_distance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-approximate-occurrences-of-a-pattern-in-a-string" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Find All Approximate Occurrences of a Pattern in a String</h1>
<p>Approximate Pattern Matching Problem, Find all approximate occurrences of a pattern in a string.</p>
<p>Given:&nbsp;Strings&nbsp;<em>Pattern</em>&nbsp;and&nbsp;<em>Text</em>&nbsp;along with an integer&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All starting positions where&nbsp;<em>Pattern</em>&nbsp;appears as a substring of&nbsp;<em>Text</em>&nbsp;with at most&nbsp;<em>d</em>&nbsp;mismatches.</p>
<section id="sample-dataset-7" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="sample-dataset-7"><span class="header-section-number">7.1</span> Sample Dataset</h2>
<pre><code>ATTCTGGA
CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC
3</code></pre>
</section>
<section id="sample-output-7" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="sample-output-7"><span class="header-section-number">7.2</span> Sample Output</h2>
<pre><code>6 7 26 27 78</code></pre>
</section>
<section id="solution-7" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="solution-7"><span class="header-section-number">7.3</span> Solution</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_approximate_matches(pattern: <span class="bu">str</span>, genome: <span class="bu">str</span>, max_mismatch: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">int</span>]:</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    pattern_length <span class="op">=</span> <span class="bu">len</span>(pattern)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (position <span class="cf">for</span> position, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(genome, pattern_length))</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_mismatch)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    pattern, genome, max_mismatch_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pattern, genome, <span class="bu">int</span>(max_mismatch_str)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="st">ATTCTGGA</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>pattern, genome, max_mismatch <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>match_positions <span class="op">=</span> <span class="bu">list</span>(find_approximate_matches(pattern, genome, max_mismatch))</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>match_positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-most-frequent-words-with-mismatches-in-a-string" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Find the Most Frequent Words with Mismatches in a String</h1>
<p>Frequent Words with Mismatches Problem, Find the most frequent k-mers with mismatches in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>&nbsp;as well as integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All most frequent&nbsp;<em>k</em>-mers with up to&nbsp;<em>d</em>&nbsp;mismatches in&nbsp;<em>Text</em>.</p>
<section id="sample-dataset-8" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="sample-dataset-8"><span class="header-section-number">8.1</span> Sample Dataset</h2>
<pre><code>ACGTTGCATGTCGCATGATGCATGAGAGCT
4 1</code></pre>
</section>
<section id="sample-output-8" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="sample-output-8"><span class="header-section-number">8.2</span> Sample Output</h2>
<pre><code>ATGC ATGT GATG</code></pre>
</section>
<section id="solution-8" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="solution-8"><span class="header-section-number">8.3</span> Solution</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna_sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna_sequence, kmer_length):</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(observed_kmers: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(observed_kmers[observed_kmer] </span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> observed_kmer <span class="kw">in</span> observed_kmers </span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>observed_kmers <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(observed_kmers, max_mismatches, kmer_length))</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>most_frequent_kmers <span class="op">=</span> find_most_frequent(approximate_kmer_counts)</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent_kmers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-frequent-words-with-mismatches-and-reverse-complements" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Find Frequent Words with Mismatches and Reverse Complements</h1>
<p>Frequent Words with Mismatches and Reverse Complements Problem. Find the most frequent k-mers (with mismatches and reverse complements) in a DNA string.</p>
<p>Given:&nbsp;A DNA string&nbsp;<em>Text</em>&nbsp;as well as integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All&nbsp;<em>k</em>-mers&nbsp;<em>Pattern</em>&nbsp;maximizing the sum&nbsp;*Count__d<em>(</em>Text<em>,&nbsp;<span class="math inline">\(Pattern\)</span>) +&nbsp;</em>Count__d<em>(</em>Text<em>,&nbsp;<span class="math inline">\(\overline{Pattern}\)</span>}) over all possible&nbsp;</em>k*-mers.</p>
<section id="sample-dataset-9" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="sample-dataset-9"><span class="header-section-number">9.1</span> Sample Dataset</h2>
<pre><code>ACGTTGCATGTCGCATGATGCATGAGAGCT
4 1</code></pre>
</section>
<section id="sample-output-9" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="sample-output-9"><span class="header-section-number">9.2</span> Sample Output</h2>
<pre><code>ATGT ACAT</code></pre>
</section>
<section id="solution-9" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="solution-9"><span class="header-section-number">9.3</span> Solution</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(dna: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna: <span class="bu">str</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna[i:i <span class="op">+</span> length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna) <span class="op">-</span> length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna, kmer_length):</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">if</span> hamming_distance(reverse_complement(potential_kmer), observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>kmer_counts <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(kmer_counts, max_mismatches, kmer_length))</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_most_frequent(approximate_kmer_counts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-frequency-array-of-a-string" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Generate the Frequency Array of a String</h1>
<p>Computing a Frequency Array, Generate the frequency array of a DNA string.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Text</em>&nbsp;and an integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;The frequency array of&nbsp;<em>k</em>-mers in&nbsp;<em>Text</em>.</p>
<section id="sample-dataset-10" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="sample-dataset-10"><span class="header-section-number">10.1</span> Sample Dataset</h2>
<pre><code>ACGCGGCTCTGAAA
2</code></pre>
</section>
<section id="sample-output-10" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="sample-output-10"><span class="header-section-number">10.2</span> Sample Output</h2>
<pre><code>2 1 0 0 0 0 2 2 1 2 1 0 0 1 1 0</code></pre>
</section>
<section id="solution-10" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="solution-10"><span class="header-section-number">10.3</span> Solution</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict, Tuple</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (text[i : i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(s1: <span class="bu">str</span>, s2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(s1, s2))</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(k: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>k))</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_frequencies(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [count_pattern_occurrences(sequence, kmer) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length)]</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    sequence, kmer_length <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(kmer_length)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="st">ACGCGGCTCTGAAA</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>sequence, kmer_length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>kmer_frequencies <span class="op">=</span> calculate_kmer_frequencies(sequence, kmer_length)</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>kmer_frequencies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-patterntonumber" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Implement PatternToNumber</h1>
<p>Implement PatternToNumber, Convert a DNA string to a number.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;<em>PatternToNumber</em>(<em>Pattern</em>).</p>
<section id="sample-dataset-11" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="sample-dataset-11"><span class="header-section-number">11.1</span> Sample Dataset</h2>
<pre><code>AGT</code></pre>
</section>
<section id="sample-output-11" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="sample-output-11"><span class="header-section-number">11.2</span> Sample Output</h2>
<pre><code>11</code></pre>
</section>
<section id="solution-11" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="solution-11"><span class="header-section-number">11.3</span> Solution</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_nucleotide_to_number_map() <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_nucleotide_to_number(nucleotide: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotide_map[nucleotide]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_dna_pattern_to_number(dna_pattern: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> dna_pattern:</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">4</span> <span class="op">*</span> convert_dna_pattern_to_number(dna_pattern[:<span class="op">-</span><span class="dv">1</span>], nucleotide_map) <span class="op">+</span> convert_nucleotide_to_number(dna_pattern[<span class="op">-</span><span class="dv">1</span>], nucleotide_map)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_data.strip()</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="st">AGT</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>nucleotide_map <span class="op">=</span> create_nucleotide_to_number_map()</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> convert_dna_pattern_to_number(dna_pattern, nucleotide_map)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-numbertopattern" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Implement NumberToPattern</h1>
<p>Implement NumberToPattern, Convert an integer to its corresponding DNA string.</p>
<p>Given:&nbsp;Integers&nbsp;<em>index</em>&nbsp;and&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;<em>NumberToPattern</em>(<em>index</em>,&nbsp;<em>k</em>).</p>
<section id="sample-dataset-12" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="sample-dataset-12"><span class="header-section-number">12.1</span> Sample Dataset</h2>
<pre><code>45
4</code></pre>
</section>
<section id="sample-output-12" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="sample-output-12"><span class="header-section-number">12.2</span> Sample Output</h2>
<pre><code>AGTC</code></pre>
</section>
<section id="solution-12" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="solution-12"><span class="header-section-number">12.3</span> Solution</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_nucleotide(index: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotides[index]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_dna_pattern(index: <span class="bu">int</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> length <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> number_to_nucleotide(index)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    quotient, remainder <span class="op">=</span> <span class="bu">divmod</span>(index, <span class="dv">4</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> number_to_dna_pattern(quotient, length <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> number_to_nucleotide(remainder)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    index_str, length_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">int</span>(index_str), <span class="bu">int</span>(length_str)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="st">45</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>index, length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> number_to_dna_pattern(index, length)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dna_pattern)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-d-neighborhood-of-a-string" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Generate the d-Neighborhood of a String</h1>
<p>Generate the d-Neighborhood of a String Find all the neighbors of a pattern.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Pattern</em>&nbsp;and an integer&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;The collection of strings&nbsp;<em>Neighbors</em>(<em>Pattern</em>,&nbsp;<em>d</em>).</p>
<section id="sample-dataset-13" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="sample-dataset-13"><span class="header-section-number">13.1</span> Sample Dataset</h2>
<pre><code>ACG
1</code></pre>
</section>
<section id="sample-output-13" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="sample-output-13"><span class="header-section-number">13.2</span> Sample Output</h2>
<pre><code>CCG
TCG
GCG
AAG
ATG
AGG
ACA
ACC
ACT
ACG</code></pre>
</section>
<section id="solution-13" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="solution-13"><span class="header-section-number">13.3</span> Solution</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Set, List, Tuple, Iterator</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_immediate_neighbors(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, current_base <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> new_base <span class="kw">in</span> nucleotides:</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> new_base <span class="op">!=</span> current_base:</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> sequence[:i] <span class="op">+</span> new_base <span class="op">+</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:]</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    suffix_neighbors <span class="op">=</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> suffix <span class="kw">in</span> suffix_neighbors:</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], suffix) <span class="op">&lt;</span> max_distance:</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>            neighbors.update(base <span class="op">+</span> suffix <span class="cf">for</span> base <span class="kw">in</span> nucleotides)</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>            neighbors.add(sequence[<span class="dv">0</span>] <span class="op">+</span> suffix)</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbors</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    sequence, distance <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(distance)</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a><span class="st">ACG</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>sequence, max_distance <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>neighbor_sequences <span class="op">=</span> generate_neighbors(sequence, max_distance)</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(neighbor_sequences), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
</section>
<section id="compute-the-probability-of-a-hidden-path" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Compute the Probability of a Hidden Path</h1>
<p>Given:&nbsp;A hidden path <span class="math inline">\(π\)</span> followed by the states&nbsp;<em>States</em>&nbsp;and transition matrix&nbsp;<em>Transition</em>&nbsp;of an HMM (<span class="math inline">\(Σ\)</span>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The probability of this path, <span class="math inline">\(Pr(π)\)</span>. You may assume that initial probabilities are equal.</p>
<section id="sample-dataset-14" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="sample-dataset-14"><span class="header-section-number">14.1</span> Sample Dataset</h2>
<pre><code>AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB
--------
A   B
--------
    A   B
A   0.194   0.806
B   0.273   0.727</code></pre>
</section>
<section id="sample-output-14" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="sample-output-14"><span class="header-section-number">14.2</span> Sample Output</h2>
<pre><code>5.01732865318e-19</code></pre>
</section>
<section id="solution-14" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="solution-14"><span class="header-section-number">14.3</span> Solution</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hidden_path_data(input_lines):</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    transition_probabilities <span class="op">=</span> {}</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>            current_state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> next_state, probability <span class="kw">in</span> <span class="bu">zip</span>(states, row_data[<span class="dv">1</span>:]):</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>                transition_probabilities[(current_state, next_state)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hidden_path, transition_probabilities</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hidden_path_probability(hidden_path, transition_probabilities):</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    initial_probability <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    path_probability <span class="op">=</span> initial_probability <span class="op">*</span> prod(</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>        transition_probabilities[state_pair] </span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> state_pair <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, hidden_path[<span class="dv">1</span>:])</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path_probability</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="st">AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.194   0.806</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.273   0.727</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>hidden_path, transition_probabilities <span class="op">=</span> parse_hidden_path_data(input_lines)</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_hidden_path_probability(hidden_path, transition_probabilities)</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-probability-of-an-outcome-given-a-hidden-path" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Compute the Probability of an Outcome Given a Hidden Path</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by a hidden path&nbsp;<em>π</em>, followed by the states&nbsp;<em>States</em>&nbsp;and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The conditional probability <span class="math inline">\(Pr(x|π)\)</span> that string&nbsp;<em>x</em>&nbsp;will be emitted by the HMM given the hidden path&nbsp;<em>π</em>.</p>
<section id="sample-dataset-15" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="sample-dataset-15"><span class="header-section-number">15.1</span> Sample Dataset</h2>
<pre><code>xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx
--------
x   y   z
--------
BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB
--------
A   B
--------
    x   y   z
A   0.612   0.314   0.074 
B   0.346   0.317   0.336</code></pre>
</section>
<section id="sample-output-15" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="sample-output-15"><span class="header-section-number">15.2</span> Sample Output</h2>
<pre><code>1.93157070893e-28</code></pre>
</section>
<section id="solution-15" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="solution-15"><span class="header-section-number">15.3</span> Solution</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_emission_data(input_lines):</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    emission_sequence <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    symbols <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    emission_probabilities <span class="op">=</span> {}</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>            state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> symbol, probability <span class="kw">in</span> <span class="bu">zip</span>(symbols, row_data[<span class="dv">1</span>:]):</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>                emission_probabilities[(state, symbol)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emission_sequence, hidden_path, emission_probabilities</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities):</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prod(emission_probabilities[state_symbol] <span class="cf">for</span> state_symbol <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, emission_sequence))</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="st">xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="st">x y z</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="st">BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.612   0.314   0.074 </span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.346   0.317   0.336</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>emission_sequence, hidden_path, emission_probabilities <span class="op">=</span> parse_emission_data(input_lines)</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities)</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-the-viterbi-algorithm" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Implement the Viterbi Algorithm</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by the states&nbsp;<em>States</em>, transition matrix&nbsp;<em>Transition</em>, and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;A path that maximizes the (unconditional) probability Pr(<em>x</em>,&nbsp;<em>π</em>) over all possible paths&nbsp;<em>π</em>.</p>
<section id="sample-dataset-16" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="sample-dataset-16"><span class="header-section-number">16.1</span> Sample Dataset</h2>
<pre><code>xyxzzxyxyy
--------
x   y   z
--------
A   B
--------
    A   B
A   0.641   0.359
B   0.729   0.271
--------
    x   y   z
A   0.117   0.691   0.192   
B   0.097   0.42    0.483</code></pre>
</section>
<section id="sample-output-16" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="sample-output-16"><span class="header-section-number">16.2</span> Sample Output</h2>
<pre><code>AAABBAAAAA</code></pre>
</section>
<section id="solution-16" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="solution-16"><span class="header-section-number">16.3</span> Solution</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> <span class="bu">len</span>(states)</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>    sequence_length <span class="op">=</span> <span class="bu">len</span>(sequence)</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>    viterbi_matrix <span class="op">=</span> np.zeros((sequence_length, num_states))</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>    backpointer <span class="op">=</span> np.zeros((sequence_length, num_states), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the first column of the viterbi matrix</span></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>        viterbi_matrix[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> num_states)</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill in the rest of the viterbi matrix</span></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, sequence_length):</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>            probabilities <span class="op">=</span> [</span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[previous_state, current_state]) <span class="op">+</span> </span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>                log(emission_matrix[current_state, sequence[t]]) <span class="op">+</span> </span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>                viterbi_matrix[t<span class="op">-</span><span class="dv">1</span>, k]</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>            max_prob_index <span class="op">=</span> probabilities.index(<span class="bu">max</span>(probabilities))</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>            backpointer[t, j] <span class="op">=</span> max_prob_index</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>            viterbi_matrix[t, j] <span class="op">=</span> <span class="bu">max</span>(probabilities)</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>    best_path_index <span class="op">=</span> np.argmax(viterbi_matrix[<span class="op">-</span><span class="dv">1</span>, :])</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>    best_path <span class="op">=</span> states[best_path_index]</span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(sequence_length <span class="op">-</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a>        best_path_index <span class="op">=</span> backpointer[t, best_path_index]</span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a>        best_path <span class="op">=</span> states[best_path_index] <span class="op">+</span> best_path</span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_path</span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a><span class="st">xyxzzxyxyy</span></span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.641   0.359</span></span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.729   0.271</span></span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb51-74"><a href="#cb51-74" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb51-75"><a href="#cb51-75" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.117   0.691   0.192   </span></span>
<span id="cb51-76"><a href="#cb51-76" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.097   0.42    0.483</span></span>
<span id="cb51-77"><a href="#cb51-77" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb51-78"><a href="#cb51-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-79"><a href="#cb51-79" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb51-80"><a href="#cb51-80" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb51-81"><a href="#cb51-81" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb51-82"><a href="#cb51-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-probability-of-a-string-emitted-by-an-hmm" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Compute the Probability of a String Emitted by an HMM</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by the states&nbsp;<em>States</em>, transition matrix&nbsp;<em>Transition</em>, and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The probability Pr(<em>x</em>) that the HMM emits&nbsp;<em>x</em>.</p>
<section id="sample-dataset-17" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="sample-dataset-17"><span class="header-section-number">17.1</span> Sample Dataset</h2>
<pre><code>xzyyzzyzyy
--------
x   y   z
--------
A   B
--------
    A   B
A   0.303   0.697 
B   0.831   0.169 
--------
    x   y   z
A   0.533   0.065   0.402 
B   0.342   0.334   0.324</code></pre>
</section>
<section id="sample-output-17" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="sample-output-17"><span class="header-section-number">17.2</span> Sample Output</h2>
<pre><code>1.1005510319694847e-06</code></pre>
</section>
<section id="solution-17" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="solution-17"><span class="header-section-number">17.3</span> Solution</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator):</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix):</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>    probability_matrix <span class="op">=</span> np.ones((<span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(states)))</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>        probability_matrix[<span class="dv">0</span>, i] <span class="op">=</span> emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states)</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>            probability_matrix[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>                transition_matrix[previous_state, current_state] <span class="op">*</span> </span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>                emission_matrix[current_state, emission] <span class="op">*</span> </span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>                probability_matrix[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(probability_matrix[i, :])</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzzyzyy</span></span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.303   0.697 </span></span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.831   0.169 </span></span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.533   0.065   0.402 </span></span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.342   0.334   0.324</span></span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-profile-hmm" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Construct a Profile HMM</h1>
<p>Given:&nbsp;A threshold&nbsp;<em>θ</em>, followed by an alphabet&nbsp;<em>Σ</em>, followed by a multiple alignment&nbsp;<em>Alignment</em>&nbsp;whose strings are formed from&nbsp;<em>Σ</em>.</p>
<p>Return:&nbsp;The transition and emission probabilities of the profile HMM&nbsp;<em>HMM</em>(<em>Alignment</em>,&nbsp;<em>θ</em>).</p>
<section id="sample-dataset-18" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="sample-dataset-18"><span class="header-section-number">18.1</span> Sample Dataset</h2>
<pre><code>0.289
--------
A   B   C   D   E
--------
EBA
EBD
EB-
EED
EBD
EBE
E-D
EBD</code></pre>
</section>
<section id="sample-output-18" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="sample-output-18"><span class="header-section-number">18.2</span> Sample Output</h2>
<pre><code>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E
S   0   0   1.0 0   0   0   0   0   0   0   0   0
I0  0   0   0   0   0   0   0   0   0   0   0   0
M1  0   0   0   0   0   0.875   0.125   0   0   0   0   0
D1  0   0   0   0   0   0   0   0   0   0   0   0
I1  0   0   0   0   0   0   0   0   0   0   0   0
M2  0   0   0   0   0   0   0   0   0.857   0.143   0   0
D2  0   0   0   0   0   0   0   0   1.0 0   0   0
I2  0   0   0   0   0   0   0   0   0   0   0   0
M3  0   0   0   0   0   0   0   0   0   0   0   1.0
D3  0   0   0   0   0   0   0   0   0   0   0   1.0
I3  0   0   0   0   0   0   0   0   0   0   0   0
E   0   0   0   0   0   0   0   0   0   0   0   0
--------
    A   B   C   D   E
S   0   0   0   0   0
I0  0   0   0   0   0
M1  0   0   0   0   1.0
D1  0   0   0   0   0
I1  0   0   0   0   0
M2  0   0.857   0   0   0.143
D2  0   0   0   0   0
I2  0   0   0   0   0
M3  0.143   0   0   0.714   0.143
D3  0   0   0   0   0
I3  0   0   0   0   0
E   0   0   0   0   0</code></pre>
</section>
<section id="solution-18" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="solution-18"><span class="header-section-number">18.3</span> Solution</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    threshold <span class="op">=</span> <span class="bu">float</span>(<span class="bu">next</span>(input_iterator).rstrip())</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_iterator])</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, alphabet, alignment</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probabilities(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probabilities(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb57-60"><a href="#cb57-60" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb57-61"><a href="#cb57-61" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb57-62"><a href="#cb57-62" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb57-63"><a href="#cb57-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-64"><a href="#cb57-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb57-65"><a href="#cb57-65" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb57-66"><a href="#cb57-66" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb57-67"><a href="#cb57-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb57-68"><a href="#cb57-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb57-69"><a href="#cb57-69" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb57-70"><a href="#cb57-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb57-71"><a href="#cb57-71" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb57-72"><a href="#cb57-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb57-73"><a href="#cb57-73" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb57-74"><a href="#cb57-74" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb57-75"><a href="#cb57-75" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb57-76"><a href="#cb57-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb57-77"><a href="#cb57-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb57-78"><a href="#cb57-78" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb57-79"><a href="#cb57-79" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb57-80"><a href="#cb57-80" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb57-81"><a href="#cb57-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb57-82"><a href="#cb57-82" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb57-83"><a href="#cb57-83" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb57-84"><a href="#cb57-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-85"><a href="#cb57-85" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb57-86"><a href="#cb57-86" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb57-87"><a href="#cb57-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-88"><a href="#cb57-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb57-89"><a href="#cb57-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-90"><a href="#cb57-90" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb57-91"><a href="#cb57-91" aria-hidden="true" tabindex="-1"></a><span class="st">0.289</span></span>
<span id="cb57-92"><a href="#cb57-92" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb57-93"><a href="#cb57-93" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb57-94"><a href="#cb57-94" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb57-95"><a href="#cb57-95" aria-hidden="true" tabindex="-1"></a><span class="st">EBA</span></span>
<span id="cb57-96"><a href="#cb57-96" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb57-97"><a href="#cb57-97" aria-hidden="true" tabindex="-1"></a><span class="st">EB-</span></span>
<span id="cb57-98"><a href="#cb57-98" aria-hidden="true" tabindex="-1"></a><span class="st">EED</span></span>
<span id="cb57-99"><a href="#cb57-99" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb57-100"><a href="#cb57-100" aria-hidden="true" tabindex="-1"></a><span class="st">EBE</span></span>
<span id="cb57-101"><a href="#cb57-101" aria-hidden="true" tabindex="-1"></a><span class="st">E-D</span></span>
<span id="cb57-102"><a href="#cb57-102" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb57-103"><a href="#cb57-103" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb57-104"><a href="#cb57-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-105"><a href="#cb57-105" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb57-106"><a href="#cb57-106" aria-hidden="true" tabindex="-1"></a>threshold, alphabet, alignment <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb57-107"><a href="#cb57-107" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb57-108"><a href="#cb57-108" aria-hidden="true" tabindex="-1"></a>print_transition_probabilities(transition_probs)</span>
<span id="cb57-109"><a href="#cb57-109" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb57-110"><a href="#cb57-110" aria-hidden="true" tabindex="-1"></a>print_emission_probabilities(emission_probs, alphabet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-profile-hmm-with-pseudocounts" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Construct a Profile HMM with Pseudocounts</h1>
<p>Given:&nbsp;A threshold&nbsp;<em>θ</em>&nbsp;and a pseudocount&nbsp;<em>σ</em>, followed by an alphabet&nbsp;<em>Σ</em>, followed by a multiple alignment&nbsp;<em>Alignment</em>&nbsp;whose strings are formed from&nbsp;<em>Σ</em>.</p>
<p>Return:&nbsp;The transition and emission probabilities of the profile HMM&nbsp;<em>HMM</em>(<em>Alignment</em>,&nbsp;<em>θ</em>,&nbsp;<em>σ</em>).</p>
<section id="sample-dataset-19" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="sample-dataset-19"><span class="header-section-number">19.1</span> Sample Dataset</h2>
<pre><code>0.358   0.01
--------
A   B   C   D   E
--------
ADA
ADA
AAA
ADC
-DA
D-A</code></pre>
</section>
<section id="sample-output-19" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="sample-output-19"><span class="header-section-number">19.2</span> Sample Output</h2>
<pre><code>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E
S   0   0.01    0.819   0.172   0   0   0   0   0   0   0   0
I0  0   0.333   0.333   0.333   0   0   0   0   0   0   0   0
M1  0   0   0   0   0.01    0.786   0.204   0   0   0   0   0
D1  0   0   0   0   0.01    0.981   0.01    0   0   0   0   0
I1  0   0   0   0   0.333   0.333   0.333   0   0   0   0   0
M2  0   0   0   0   0   0   0   0.01    0.981   0.01    0   0
D2  0   0   0   0   0   0   0   0.01    0.981   0.01    0   0
I2  0   0   0   0   0   0   0   0.333   0.333   0.333   0   0
M3  0   0   0   0   0   0   0   0   0   0   0.01    0.99
D3  0   0   0   0   0   0   0   0   0   0   0.5 0.5
I3  0   0   0   0   0   0   0   0   0   0   0.5 0.5
E   0   0   0   0   0   0   0   0   0   0   0   0
--------
    A   B   C   D   E
S   0   0   0   0   0
I0  0.2 0.2 0.2 0.2 0.2
M1  0.771   0.01    0.01    0.2 0.01
D1  0   0   0   0   0
I1  0.2 0.2 0.2 0.2 0.2
M2  0.2 0.01    0.01    0.771   0.01
D2  0   0   0   0   0
I2  0.2 0.2 0.2 0.2 0.2
M3  0.803   0.01    0.168   0.01    0.01
D3  0   0   0   0   0
I3  0.2 0.2 0.2 0.2 0.2
E   0   0   0   0   0</code></pre>
</section>
<section id="solution-19" class="level2" data-number="19.3">
<h2 data-number="19.3" class="anchored" data-anchor-id="solution-19"><span class="header-section-number">19.3</span> Solution</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probs(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probs(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb60-71"><a href="#cb60-71" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb60-72"><a href="#cb60-72" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb60-73"><a href="#cb60-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb60-74"><a href="#cb60-74" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb60-75"><a href="#cb60-75" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb60-76"><a href="#cb60-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-77"><a href="#cb60-77" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb60-78"><a href="#cb60-78" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb60-79"><a href="#cb60-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-80"><a href="#cb60-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb60-81"><a href="#cb60-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-82"><a href="#cb60-82" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb60-83"><a href="#cb60-83" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_handle).rstrip().split())</span>
<span id="cb60-84"><a href="#cb60-84" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb60-85"><a href="#cb60-85" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_handle).split()</span>
<span id="cb60-86"><a href="#cb60-86" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb60-87"><a href="#cb60-87" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_handle])</span>
<span id="cb60-88"><a href="#cb60-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, pseudocount, alphabet, alignment</span>
<span id="cb60-89"><a href="#cb60-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-90"><a href="#cb60-90" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_transition_pseudocounts(transition_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb60-91"><a href="#cb60-91" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb60-92"><a href="#cb60-92" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb60-93"><a href="#cb60-93" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb60-94"><a href="#cb60-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb60-95"><a href="#cb60-95" aria-hidden="true" tabindex="-1"></a>        transition_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span> : i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">5</span>, (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span> : (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb60-96"><a href="#cb60-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(transition_matrix)</span>
<span id="cb60-97"><a href="#cb60-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-98"><a href="#cb60-98" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_emission_pseudocounts(emission_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb60-99"><a href="#cb60-99" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb60-100"><a href="#cb60-100" aria-hidden="true" tabindex="-1"></a>    emission_matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb60-101"><a href="#cb60-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb60-102"><a href="#cb60-102" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb60-103"><a href="#cb60-103" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb60-104"><a href="#cb60-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(emission_matrix)</span>
<span id="cb60-105"><a href="#cb60-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-106"><a href="#cb60-106" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_pseudocount_profile_hmm(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb60-107"><a href="#cb60-107" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb60-108"><a href="#cb60-108" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_transition_pseudocounts(transition_probs, pseudocount)</span>
<span id="cb60-109"><a href="#cb60-109" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_emission_pseudocounts(emission_probs, pseudocount)</span>
<span id="cb60-110"><a href="#cb60-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb60-111"><a href="#cb60-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-112"><a href="#cb60-112" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb60-113"><a href="#cb60-113" aria-hidden="true" tabindex="-1"></a><span class="st">0.358   0.01</span></span>
<span id="cb60-114"><a href="#cb60-114" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb60-115"><a href="#cb60-115" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb60-116"><a href="#cb60-116" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb60-117"><a href="#cb60-117" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb60-118"><a href="#cb60-118" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb60-119"><a href="#cb60-119" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb60-120"><a href="#cb60-120" aria-hidden="true" tabindex="-1"></a><span class="st">ADC</span></span>
<span id="cb60-121"><a href="#cb60-121" aria-hidden="true" tabindex="-1"></a><span class="st">-DA</span></span>
<span id="cb60-122"><a href="#cb60-122" aria-hidden="true" tabindex="-1"></a><span class="st">D-A</span></span>
<span id="cb60-123"><a href="#cb60-123" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb60-124"><a href="#cb60-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-125"><a href="#cb60-125" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb60-126"><a href="#cb60-126" aria-hidden="true" tabindex="-1"></a>threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb60-127"><a href="#cb60-127" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_pseudocount_profile_hmm(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb60-128"><a href="#cb60-128" aria-hidden="true" tabindex="-1"></a>print_transition_probs(transition_probs)</span>
<span id="cb60-129"><a href="#cb60-129" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb60-130"><a href="#cb60-130" aria-hidden="true" tabindex="-1"></a>print_emission_probs(emission_probs, alphabet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="perform-a-multiple-sequence-alignment-with-a-profile-hmm" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Perform a Multiple Sequence Alignment with a Profile HMM</h1>
<p>Given:&nbsp;A string Text, a multiple alignment Alignment, a threshold θ, and a pseudocount σ.</p>
<p>Return:&nbsp;An optimal hidden path emitting Text in HMM(Alignment,θ,σ).</p>
<section id="sample-dataset-20" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="sample-dataset-20"><span class="header-section-number">20.1</span> Sample Dataset</h2>
<pre><code>AEFDFDC
--------
0.4 0.01
--------
A   B   C   D   E   F
--------
ACDEFACADF
AFDA---CCF
A--EFD-FDC
ACAEF--A-C
ADDEFAAADF</code></pre>
</section>
<section id="sample-output-20" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="sample-output-20"><span class="header-section-number">20.2</span> Sample Output</h2>
<pre><code>M1 D2 D3 M4 M5 I5 M6 M7 M8</code></pre>
</section>
<section id="solution-20" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="solution-20"><span class="header-section-number">20.3</span> Solution</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf, log</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>        labels.extend([<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>])</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(num_states: <span class="bu">int</span>, num_symbols: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_symbols), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_index(state_num: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (state_num <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> state_num <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>    valid_length <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_length <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_length)</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_length, <span class="bu">len</span>(alphabet))</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>        valid_col_count <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[col]:</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>                valid_col_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"del"</span>)</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"match"</span>)</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"ins"</span>)</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_transitions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>:i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">5</span>, (i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">1</span>:(i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_emissions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-86"><a href="#cb63-86" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm_with_pseudocounts(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb63-87"><a href="#cb63-87" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb63-88"><a href="#cb63-88" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_pseudocounts_to_transitions(transition_probs, pseudocount)</span>
<span id="cb63-89"><a href="#cb63-89" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_pseudocounts_to_emissions(emission_probs, pseudocount)</span>
<span id="cb63-90"><a href="#cb63-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb63-91"><a href="#cb63-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-92"><a href="#cb63-92" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input_data(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb63-93"><a href="#cb63-93" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb63-94"><a href="#cb63-94" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb63-95"><a href="#cb63-95" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_iterator).rstrip().split())</span>
<span id="cb63-96"><a href="#cb63-96" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb63-97"><a href="#cb63-97" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb63-98"><a href="#cb63-98" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb63-99"><a href="#cb63-99" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(x.strip()) <span class="cf">for</span> x <span class="kw">in</span> input_iterator])</span>
<span id="cb63-100"><a href="#cb63-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, threshold, pseudocount, alphabet, alignment</span>
<span id="cb63-101"><a href="#cb63-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-102"><a href="#cb63-102" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_transition_probs_to_dict(matrix: np.ndarray) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb63-103"><a href="#cb63-103" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb63-104"><a href="#cb63-104" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb63-105"><a href="#cb63-105" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb63-106"><a href="#cb63-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb63-107"><a href="#cb63-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb63-108"><a href="#cb63-108" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb63-109"><a href="#cb63-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb63-110"><a href="#cb63-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-111"><a href="#cb63-111" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_emission_probs_to_dict(matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb63-112"><a href="#cb63-112" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb63-113"><a href="#cb63-113" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb63-114"><a href="#cb63-114" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb63-115"><a href="#cb63-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb63-116"><a href="#cb63-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, symbol <span class="kw">in</span> <span class="bu">enumerate</span>(alphabet):</span>
<span id="cb63-117"><a href="#cb63-117" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], symbol] <span class="op">=</span> matrix[i][j]</span>
<span id="cb63-118"><a href="#cb63-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb63-119"><a href="#cb63-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-120"><a href="#cb63-120" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_hmm_graph(transition_probs: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]:</span>
<span id="cb63-121"><a href="#cb63-121" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_edge(source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb63-122"><a href="#cb63-122" aria-hidden="true" tabindex="-1"></a>        graph[source].append({<span class="st">"node"</span>: target, <span class="st">"weight"</span>: transition_probs[source, target]})</span>
<span id="cb63-123"><a href="#cb63-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-124"><a href="#cb63-124" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb63-125"><a href="#cb63-125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target <span class="kw">in</span> [<span class="st">"I0"</span>, <span class="st">"M1"</span>, <span class="st">"D1"</span>]:</span>
<span id="cb63-126"><a href="#cb63-126" aria-hidden="true" tabindex="-1"></a>        add_edge(<span class="st">"S"</span>, target)</span>
<span id="cb63-127"><a href="#cb63-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb63-128"><a href="#cb63-128" aria-hidden="true" tabindex="-1"></a>        source <span class="op">=</span> <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb63-129"><a href="#cb63-129" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [source, <span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb63-130"><a href="#cb63-130" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb63-131"><a href="#cb63-131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states):</span>
<span id="cb63-132"><a href="#cb63-132" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb63-133"><a href="#cb63-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb63-134"><a href="#cb63-134" aria-hidden="true" tabindex="-1"></a>                add_edge(source, target)</span>
<span id="cb63-135"><a href="#cb63-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb63-136"><a href="#cb63-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="st">"E"</span>]:</span>
<span id="cb63-137"><a href="#cb63-137" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb63-138"><a href="#cb63-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-139"><a href="#cb63-139" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb63-140"><a href="#cb63-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-141"><a href="#cb63-141" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_topological_order(num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb63-142"><a href="#cb63-142" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"S"</span>, <span class="dv">0</span>)</span>
<span id="cb63-143"><a href="#cb63-143" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb63-144"><a href="#cb63-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="ss">f"D</span><span class="sc">{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)</span>
<span id="cb63-145"><a href="#cb63-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(seq_length):</span>
<span id="cb63-146"><a href="#cb63-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="st">"I0"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb63-147"><a href="#cb63-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb63-148"><a href="#cb63-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> state_type <span class="kw">in</span> [<span class="st">"M"</span>, <span class="st">"D"</span>, <span class="st">"I"</span>]:</span>
<span id="cb63-149"><a href="#cb63-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> (<span class="ss">f"</span><span class="sc">{</span>state_type<span class="sc">}{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb63-150"><a href="#cb63-150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"E"</span>, seq_length <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb63-151"><a href="#cb63-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-152"><a href="#cb63-152" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_previous_nodes(current_node: <span class="bu">str</span>, current_col: <span class="bu">int</span>, num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb63-153"><a href="#cb63-153" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"E"</span>:</span>
<span id="cb63-154"><a href="#cb63-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length)]</span>
<span id="cb63-155"><a href="#cb63-155" aria-hidden="true" tabindex="-1"></a>    state_num <span class="op">=</span> <span class="bu">int</span>(current_node[<span class="dv">1</span>:])</span>
<span id="cb63-156"><a href="#cb63-156" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb63-157"><a href="#cb63-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)]</span>
<span id="cb63-158"><a href="#cb63-158" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"I0"</span>:</span>
<span id="cb63-159"><a href="#cb63-159" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb63-160"><a href="#cb63-160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"M1"</span>:</span>
<span id="cb63-161"><a href="#cb63-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb63-162"><a href="#cb63-162" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"I"</span>:</span>
<span id="cb63-163"><a href="#cb63-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb63-164"><a href="#cb63-164" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"M"</span>:</span>
<span id="cb63-165"><a href="#cb63-165" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb63-166"><a href="#cb63-166" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"D"</span>:</span>
<span id="cb63-167"><a href="#cb63-167" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"I0"</span>, current_col)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col)]</span>
<span id="cb63-168"><a href="#cb63-168" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb63-169"><a href="#cb63-169" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Unhandled node: </span><span class="sc">{</span>current_node<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb63-170"><a href="#cb63-170" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb63-171"><a href="#cb63-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-172"><a href="#cb63-172" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simplify_graph(graph: Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict[<span class="bu">str</span>, <span class="bu">float</span>]]:</span>
<span id="cb63-173"><a href="#cb63-173" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {k: {x[<span class="st">"node"</span>]: x[<span class="st">"weight"</span>] <span class="cf">for</span> x <span class="kw">in</span> v} <span class="cf">for</span> k, v <span class="kw">in</span> graph.items()}</span>
<span id="cb63-174"><a href="#cb63-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-175"><a href="#cb63-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Main execution</span></span>
<span id="cb63-176"><a href="#cb63-176" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input):</span>
<span id="cb63-177"><a href="#cb63-177" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb63-178"><a href="#cb63-178" aria-hidden="true" tabindex="-1"></a>    sequence, threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input_data(input_lines)</span>
<span id="cb63-179"><a href="#cb63-179" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm_with_pseudocounts(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb63-180"><a href="#cb63-180" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (transition_probs.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb63-181"><a href="#cb63-181" aria-hidden="true" tabindex="-1"></a>    transition_probs_dict <span class="op">=</span> convert_transition_probs_to_dict(transition_probs)</span>
<span id="cb63-182"><a href="#cb63-182" aria-hidden="true" tabindex="-1"></a>    emission_probs_dict <span class="op">=</span> convert_emission_probs_to_dict(emission_probs, alphabet)</span>
<span id="cb63-183"><a href="#cb63-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-184"><a href="#cb63-184" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> build_hmm_graph(transition_probs_dict, num_states)</span>
<span id="cb63-185"><a href="#cb63-185" aria-hidden="true" tabindex="-1"></a>    topological_order <span class="op">=</span> generate_topological_order(num_states, <span class="bu">len</span>(sequence))</span>
<span id="cb63-186"><a href="#cb63-186" aria-hidden="true" tabindex="-1"></a>    simplified_graph <span class="op">=</span> simplify_graph(graph)</span>
<span id="cb63-187"><a href="#cb63-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-188"><a href="#cb63-188" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dynamic programming to find the most probable path</span></span>
<span id="cb63-189"><a href="#cb63-189" aria-hidden="true" tabindex="-1"></a>    previous_node <span class="op">=</span> <span class="bu">next</span>(topological_order)</span>
<span id="cb63-190"><a href="#cb63-190" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> {previous_node: <span class="dv">0</span>}</span>
<span id="cb63-191"><a href="#cb63-191" aria-hidden="true" tabindex="-1"></a>    backpointers <span class="op">=</span> {previous_node: (<span class="va">None</span>, <span class="va">None</span>)}</span>
<span id="cb63-192"><a href="#cb63-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-193"><a href="#cb63-193" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_node, current_col <span class="kw">in</span> topological_order:</span>
<span id="cb63-194"><a href="#cb63-194" aria-hidden="true" tabindex="-1"></a>        backpointers[(current_node, current_col)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb63-195"><a href="#cb63-195" aria-hidden="true" tabindex="-1"></a>        scores[(current_node, current_col)] <span class="op">=</span> <span class="op">-</span>inf</span>
<span id="cb63-196"><a href="#cb63-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> prev_node, prev_col <span class="kw">in</span> get_previous_nodes(current_node, current_col, num_states, <span class="bu">len</span>(sequence)):</span>
<span id="cb63-197"><a href="#cb63-197" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_col <span class="op">&lt;</span> current_col <span class="kw">and</span> current_node <span class="op">!=</span> <span class="st">"E"</span>:</span>
<span id="cb63-198"><a href="#cb63-198" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> emission_probs_dict[current_node, sequence[current_col <span class="op">-</span> <span class="dv">1</span>]]</span>
<span id="cb63-199"><a href="#cb63-199" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb63-200"><a href="#cb63-200" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb63-201"><a href="#cb63-201" aria-hidden="true" tabindex="-1"></a>            log_prob <span class="op">=</span> log(simplified_graph[prev_node][current_node]) <span class="op">+</span> log(emission_prob) <span class="op">+</span> scores[(prev_node, prev_col)]</span>
<span id="cb63-202"><a href="#cb63-202" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> log_prob <span class="op">&gt;</span> scores[(current_node, current_col)]:</span>
<span id="cb63-203"><a href="#cb63-203" aria-hidden="true" tabindex="-1"></a>                scores[(current_node, current_col)] <span class="op">=</span> log_prob</span>
<span id="cb63-204"><a href="#cb63-204" aria-hidden="true" tabindex="-1"></a>                backpointers[(current_node, current_col)] <span class="op">=</span> (prev_node, prev_col)</span>
<span id="cb63-205"><a href="#cb63-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-206"><a href="#cb63-206" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback to find the path</span></span>
<span id="cb63-207"><a href="#cb63-207" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> []</span>
<span id="cb63-208"><a href="#cb63-208" aria-hidden="true" tabindex="-1"></a>    position <span class="op">=</span> (<span class="st">"E"</span>, <span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb63-209"><a href="#cb63-209" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> position[<span class="dv">0</span>]:</span>
<span id="cb63-210"><a href="#cb63-210" aria-hidden="true" tabindex="-1"></a>        path.append(backpointers[position][<span class="dv">0</span>])</span>
<span id="cb63-211"><a href="#cb63-211" aria-hidden="true" tabindex="-1"></a>        position <span class="op">=</span> backpointers[position]</span>
<span id="cb63-212"><a href="#cb63-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-213"><a href="#cb63-213" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>path[::<span class="op">-</span><span class="dv">1</span>][<span class="dv">2</span>:])</span>
<span id="cb63-214"><a href="#cb63-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-215"><a href="#cb63-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-216"><a href="#cb63-216" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb63-217"><a href="#cb63-217" aria-hidden="true" tabindex="-1"></a><span class="st">AEFDFDC</span></span>
<span id="cb63-218"><a href="#cb63-218" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb63-219"><a href="#cb63-219" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.01</span></span>
<span id="cb63-220"><a href="#cb63-220" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb63-221"><a href="#cb63-221" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E   F</span></span>
<span id="cb63-222"><a href="#cb63-222" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb63-223"><a href="#cb63-223" aria-hidden="true" tabindex="-1"></a><span class="st">ACDEFACADF</span></span>
<span id="cb63-224"><a href="#cb63-224" aria-hidden="true" tabindex="-1"></a><span class="st">AFDA---CCF</span></span>
<span id="cb63-225"><a href="#cb63-225" aria-hidden="true" tabindex="-1"></a><span class="st">A--EFD-FDC</span></span>
<span id="cb63-226"><a href="#cb63-226" aria-hidden="true" tabindex="-1"></a><span class="st">ACAEF--A-C</span></span>
<span id="cb63-227"><a href="#cb63-227" aria-hidden="true" tabindex="-1"></a><span class="st">ADDEFAAADF</span></span>
<span id="cb63-228"><a href="#cb63-228" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb63-229"><a href="#cb63-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-230"><a href="#cb63-230" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="estimate-the-parameters-of-an-hmm" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> Estimate the Parameters of an HMM</h1>
<p>Given:&nbsp;A sequence of emitted symbols x = x1… xn in an alphabet ∑ and a path <span class="math inline">\(π = π_1... π_n\)</span> generated by a k-state HMM with unknown transition and emission probabilities.</p>
<p>Return:&nbsp;A matrix of transition probabilities Transition and a matrix of emission probabilities Emission that maximize <span class="math inline">\(Pr(x,π)\)</span> over all possible matrices of transition and emission probabilities.</p>
<section id="sample-dataset-21" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="sample-dataset-21"><span class="header-section-number">21.1</span> Sample Dataset</h2>
<pre><code>yzzzyxzxxx
--------
x   y   z
--------
BBABABABAB
--------
A   B   C</code></pre>
</section>
<section id="sample-output-21" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="sample-output-21"><span class="header-section-number">21.2</span> Sample Output</h2>
<pre><code>A   B   C
A   0.0 1.0 0.0
B   0.8 0.2 0.0
C   0.333   0.333   0.333
--------
    x   y   z
A   0.25    0.25    0.5
B   0.5 0.167   0.333
C   0.333   0.333   0.333</code></pre>
</section>
<section id="solution-21" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="solution-21"><span class="header-section-number">21.3</span> Solution</h2>
<div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator, Union</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], <span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, alphabet, path, states</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_dict(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">1</span>]):</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>            result[row_labels[i], column_labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_state, next_state <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>        transition_matrix[states.index(current_state)][states.index(next_state)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> normalize_matrix(transition_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(transition_matrix, states, states)</span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> transition_matrix</span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> state, symbol <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a>        emission_matrix[states.index(state)][alphabet.index(symbol)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> normalize_matrix(emission_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(emission_matrix, states, alphabet)</span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> emission_matrix</span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true" tabindex="-1"></a>    sequence, alphabet, path, states <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states)</span>
<span id="cb66-64"><a href="#cb66-64" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states)</span>
<span id="cb66-65"><a href="#cb66-65" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, states, states)</span>
<span id="cb66-66"><a href="#cb66-66" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb66-67"><a href="#cb66-67" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, states, alphabet)</span>
<span id="cb66-68"><a href="#cb66-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-69"><a href="#cb66-69" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb66-70"><a href="#cb66-70" aria-hidden="true" tabindex="-1"></a><span class="st">yzzzyxzxxx</span></span>
<span id="cb66-71"><a href="#cb66-71" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb66-72"><a href="#cb66-72" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb66-73"><a href="#cb66-73" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb66-74"><a href="#cb66-74" aria-hidden="true" tabindex="-1"></a><span class="st">BBABABABAB</span></span>
<span id="cb66-75"><a href="#cb66-75" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb66-76"><a href="#cb66-76" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C</span></span>
<span id="cb66-77"><a href="#cb66-77" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb66-78"><a href="#cb66-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-79"><a href="#cb66-79" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-viterbi-learning" class="level1" data-number="22">
<h1 data-number="22"><span class="header-section-number">22</span> Implement Viterbi Learning</h1>
<p>Given:&nbsp;A sequence of emitted symbols&nbsp;<span class="math inline">\(x=x_1... x_n\)</span>&nbsp;in an alphabet&nbsp;<em>A</em>, generated by a&nbsp;<em>k</em>-state HMM with unknown transition and emission probabilities, initial&nbsp;<em>Transition</em>&nbsp;and&nbsp;<em>Emission</em>&nbsp;matrices and a number of iterations&nbsp;<em>i</em>.</p>
<p>Return:&nbsp;A matrix of transition probabilities&nbsp;<em>Transition</em>&nbsp;and a matrix of emission probabilities&nbsp;<em>Emission</em>&nbsp;that maximizes <span class="math inline">\(Pr(x,π)\)</span> over all possible transition and emission matrices and over all hidden paths&nbsp;<em>π</em>.</p>
<section id="sample-dataset-22" class="level2" data-number="22.1">
<h2 data-number="22.1" class="anchored" data-anchor-id="sample-dataset-22"><span class="header-section-number">22.1</span> Sample Dataset</h2>
<pre><code>100
--------
xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz
--------
x   y   z
--------
A   B
--------
    A   B
A   0.582   0.418
B   0.272   0.728
--------
    x   y   z
A   0.129   0.35    0.52
B   0.422   0.151   0.426</code></pre>
</section>
<section id="sample-output-22" class="level2" data-number="22.2">
<h2 data-number="22.2" class="anchored" data-anchor-id="sample-output-22"><span class="header-section-number">22.2</span> Sample Output</h2>
<pre><code>A   B
A   0.875   0.125
B   0.011   0.989
--------
    x   y   z
A   0.0 0.75    0.25
B   0.402   0.174   0.424</code></pre>
</section>
<section id="solution-22" class="level2" data-number="22.3">
<h2 data-number="22.3" class="anchored" data-anchor-id="solution-22"><span class="header-section-number">22.3</span> Solution</h2>
<div class="sourceCode" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)))</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states))</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>            opt <span class="op">=</span> [</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[prev, state]) <span class="op">+</span> log(emission_matrix[state, emission]) <span class="op">+</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>            p <span class="op">=</span> opt.index(<span class="bu">max</span>(opt))</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>            ptr[i, j] <span class="op">=</span> p</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">max</span>(opt)</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>    ind <span class="op">=</span> np.argmax(mat[i, :])</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>    state_sequence <span class="op">=</span> states[ind]</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>        state_sequence <span class="op">=</span> states[ptr[i, ind]] <span class="op">+</span> state_sequence</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> ptr[i, ind]</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> state_sequence</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>, min_val: <span class="bu">float</span> <span class="op">=</span> <span class="fl">1e-16</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a>    normalized <span class="op">=</span> matrix <span class="op">/</span> matrix.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros:</span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a>        normalized[normalized <span class="op">==</span> <span class="dv">0</span>] <span class="op">=</span> min_val</span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalized</span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a>        tmat[states.index(a)][states.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> normalize_matrix(tmat)</span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], states[j]): tmat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states))}</span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tmat</span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true" tabindex="-1"></a>        emat[states.index(a)][alphabet.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb69-56"><a href="#cb69-56" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> normalize_matrix(emat)</span>
<span id="cb69-57"><a href="#cb69-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb69-58"><a href="#cb69-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], alphabet[j]): emat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(alphabet))}</span>
<span id="cb69-59"><a href="#cb69-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emat</span>
<span id="cb69-60"><a href="#cb69-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-61"><a href="#cb69-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb69-62"><a href="#cb69-62" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(column_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb69-63"><a href="#cb69-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb69-64"><a href="#cb69-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(column_labels):</span>
<span id="cb69-65"><a href="#cb69-65" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb69-66"><a href="#cb69-66" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, column_labels)</span>
<span id="cb69-67"><a href="#cb69-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-68"><a href="#cb69-68" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: StringIO) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb69-69"><a href="#cb69-69" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb69-70"><a href="#cb69-70" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb69-71"><a href="#cb69-71" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb69-72"><a href="#cb69-72" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb69-73"><a href="#cb69-73" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb69-74"><a href="#cb69-74" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb69-75"><a href="#cb69-75" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb69-76"><a href="#cb69-76" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb69-77"><a href="#cb69-77" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb69-78"><a href="#cb69-78" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb69-79"><a href="#cb69-79" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb69-80"><a href="#cb69-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb69-81"><a href="#cb69-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb69-82"><a href="#cb69-82" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb69-83"><a href="#cb69-83" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb69-84"><a href="#cb69-84" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb69-85"><a href="#cb69-85" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb69-86"><a href="#cb69-86" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb69-87"><a href="#cb69-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb69-88"><a href="#cb69-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb69-89"><a href="#cb69-89" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb69-90"><a href="#cb69-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, sequence, states, alphabet, transition_matrix, emission_matrix</span>
<span id="cb69-91"><a href="#cb69-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-92"><a href="#cb69-92" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb69-93"><a href="#cb69-93" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb69-94"><a href="#cb69-94" aria-hidden="true" tabindex="-1"></a>    niter, sequence, states, alphabet, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb69-95"><a href="#cb69-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb69-96"><a href="#cb69-96" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb69-97"><a href="#cb69-97" aria-hidden="true" tabindex="-1"></a>        transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-98"><a href="#cb69-98" aria-hidden="true" tabindex="-1"></a>        emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-99"><a href="#cb69-99" aria-hidden="true" tabindex="-1"></a>    print_dict(transition_matrix, states, states)</span>
<span id="cb69-100"><a href="#cb69-100" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb69-101"><a href="#cb69-101" aria-hidden="true" tabindex="-1"></a>    print_dict(emission_matrix, states, alphabet)</span>
<span id="cb69-102"><a href="#cb69-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-103"><a href="#cb69-103" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb69-104"><a href="#cb69-104" aria-hidden="true" tabindex="-1"></a><span class="st">100</span></span>
<span id="cb69-105"><a href="#cb69-105" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb69-106"><a href="#cb69-106" aria-hidden="true" tabindex="-1"></a><span class="st">xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz</span></span>
<span id="cb69-107"><a href="#cb69-107" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb69-108"><a href="#cb69-108" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb69-109"><a href="#cb69-109" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb69-110"><a href="#cb69-110" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb69-111"><a href="#cb69-111" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb69-112"><a href="#cb69-112" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb69-113"><a href="#cb69-113" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.582   0.418</span></span>
<span id="cb69-114"><a href="#cb69-114" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.272   0.728</span></span>
<span id="cb69-115"><a href="#cb69-115" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb69-116"><a href="#cb69-116" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb69-117"><a href="#cb69-117" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.129   0.35    0.52</span></span>
<span id="cb69-118"><a href="#cb69-118" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.422   0.151   0.426</span></span>
<span id="cb69-119"><a href="#cb69-119" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb69-120"><a href="#cb69-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-121"><a href="#cb69-121" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="solve-the-soft-decoding-problem" class="level1" data-number="23">
<h1 data-number="23"><span class="header-section-number">23</span> Solve the Soft Decoding Problem</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by the states&nbsp;<em>States</em>, transition matrix&nbsp;<em>Transition</em>, and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The probability <span class="math inline">\(Pr(π_i=k|x)\)</span> that the HMM was in state k at step i (for each state k and each step i).</p>
<section id="sample-dataset-23" class="level2" data-number="23.1">
<h2 data-number="23.1" class="anchored" data-anchor-id="sample-dataset-23"><span class="header-section-number">23.1</span> Sample Dataset</h2>
<pre><code>zyxxxxyxzz
--------
x   y   z
--------
A   B
--------
    A   B
A   0.911   0.089
B   0.228   0.772
--------
    x   y   z
A   0.356   0.191   0.453 
B   0.04    0.467   0.493</code></pre>
</section>
<section id="sample-output-23" class="level2" data-number="23.2">
<h2 data-number="23.2" class="anchored" data-anchor-id="sample-output-23"><span class="header-section-number">23.2</span> Sample Output</h2>
<pre><code>A   B 
0.5438  0.4562 
0.6492  0.3508 
0.9647  0.0353 
0.9936  0.0064 
0.9957  0.0043 
0.9891  0.0109 
0.9154  0.0846 
0.964   0.036 
0.8737  0.1263 
0.8167  0.1833</code></pre>
</section>
<section id="solution-23" class="level2" data-number="23.3">
<h2 data-number="23.3" class="anchored" data-anchor-id="solution-23"><span class="header-section-number">23.3</span> Solution</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    seq: <span class="bu">str</span> <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    alphabet: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>    states: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    lines: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>    emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq, states, tmat, emat</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a>    input_lines: Iterator[<span class="bu">str</span>] <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a>    seq, states, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb72-61"><a href="#cb72-61" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> soft_decode(seq, states, tmat, emat)</span>
<span id="cb72-62"><a href="#cb72-62" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>states, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb72-63"><a href="#cb72-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> r <span class="kw">in</span> np.<span class="bu">round</span>(tot, <span class="dv">4</span>):</span>
<span id="cb72-64"><a href="#cb72-64" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb72-65"><a href="#cb72-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-66"><a href="#cb72-66" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb72-67"><a href="#cb72-67" aria-hidden="true" tabindex="-1"></a><span class="st">zyxxxxyxzz</span></span>
<span id="cb72-68"><a href="#cb72-68" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb72-69"><a href="#cb72-69" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb72-70"><a href="#cb72-70" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb72-71"><a href="#cb72-71" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb72-72"><a href="#cb72-72" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb72-73"><a href="#cb72-73" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb72-74"><a href="#cb72-74" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.911   0.089</span></span>
<span id="cb72-75"><a href="#cb72-75" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.228   0.772</span></span>
<span id="cb72-76"><a href="#cb72-76" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb72-77"><a href="#cb72-77" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb72-78"><a href="#cb72-78" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.356   0.191   0.453 </span></span>
<span id="cb72-79"><a href="#cb72-79" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.04    0.467   0.493</span></span>
<span id="cb72-80"><a href="#cb72-80" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb72-81"><a href="#cb72-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-82"><a href="#cb72-82" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-baum-welch-learning" class="level1" data-number="24">
<h1 data-number="24"><span class="header-section-number">24</span> Implement Baum-Welch Learning</h1>
<p>Given:&nbsp;A sequence of emitted symbols <span class="math inline">\(x=x_1...x_n\)</span> in an alphabet A, generated by a k-state HMM with unknown transition and emission probabilities, initial Transition and Emission matrices and a number of iterations I.</p>
<p>Return:&nbsp;A matrix of transition probabilities Transition and a matrix of emission probabilities Emission that maximizes <span class="math inline">\(Pr(x,π)\)</span> over all possible transition and emission matrices and over all hidden paths π.</p>
<section id="sample-dataset-24" class="level2" data-number="24.1">
<h2 data-number="24.1" class="anchored" data-anchor-id="sample-dataset-24"><span class="header-section-number">24.1</span> Sample Dataset</h2>
<pre><code>10
--------
xzyyzyzyxy
--------
x   y   z
--------
A   B
--------
    A   B
A   0.019   0.981 
B   0.668   0.332 
--------
x   y   z
A   0.175   0.003   0.821 
B   0.196   0.512   0.293</code></pre>
</section>
<section id="sample-output-24" class="level2" data-number="24.2">
<h2 data-number="24.2" class="anchored" data-anchor-id="sample-output-24"><span class="header-section-number">24.2</span> Sample Output</h2>
<pre><code>A   B
A   0.000   1.000   
B   0.786   0.214   
--------
    x   y   z
A   0.242   0.000   0.758   
B   0.172   0.828   0.000</code></pre>
</section>
<section id="solution-24" class="level2" data-number="24.3">
<h2 data-number="24.3" class="anchored" data-anchor-id="solution-24"><span class="header-section-number">24.3</span> Solution</h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(col_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(col_labels):</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, col_labels)</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>    seq <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> {</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> {</span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, seq, states, alphabet, tmat, emat</span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb75-47"><a href="#cb75-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb75-48"><a href="#cb75-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb75-49"><a href="#cb75-49" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb75-50"><a href="#cb75-50" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb75-51"><a href="#cb75-51" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb75-52"><a href="#cb75-52" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb75-53"><a href="#cb75-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb75-54"><a href="#cb75-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-55"><a href="#cb75-55" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb75-56"><a href="#cb75-56" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb75-57"><a href="#cb75-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb75-58"><a href="#cb75-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb75-59"><a href="#cb75-59" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb75-60"><a href="#cb75-60" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb75-61"><a href="#cb75-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb75-62"><a href="#cb75-62" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb75-63"><a href="#cb75-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb75-64"><a href="#cb75-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-65"><a href="#cb75-65" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb75-66"><a href="#cb75-66" aria-hidden="true" tabindex="-1"></a>    tot <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb75-67"><a href="#cb75-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb75-68"><a href="#cb75-68" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-69"><a href="#cb75-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb75-70"><a href="#cb75-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-71"><a href="#cb75-71" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> as_dict(x: np.ndarray, r: List[<span class="bu">str</span>], c: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb75-72"><a href="#cb75-72" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb75-73"><a href="#cb75-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">0</span>]):</span>
<span id="cb75-74"><a href="#cb75-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">1</span>]):</span>
<span id="cb75-75"><a href="#cb75-75" aria-hidden="true" tabindex="-1"></a>            g[r[i], c[j]] <span class="op">=</span> x[i][j]</span>
<span id="cb75-76"><a href="#cb75-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g</span>
<span id="cb75-77"><a href="#cb75-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-78"><a href="#cb75-78" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_pi2(seq: <span class="bu">str</span>, fwd: np.ndarray, bak: np.ndarray, tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], states: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb75-79"><a href="#cb75-79" aria-hidden="true" tabindex="-1"></a>    rep_mat <span class="op">=</span> np.zeros((fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>, <span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb75-80"><a href="#cb75-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb75-81"><a href="#cb75-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, s1 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb75-82"><a href="#cb75-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k, s2 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb75-83"><a href="#cb75-83" aria-hidden="true" tabindex="-1"></a>                weight <span class="op">=</span> tmat[s1, s2] <span class="op">*</span> emat[s2, seq[i <span class="op">+</span> <span class="dv">1</span>]]</span>
<span id="cb75-84"><a href="#cb75-84" aria-hidden="true" tabindex="-1"></a>                rep_mat[i, j, k] <span class="op">=</span> (</span>
<span id="cb75-85"><a href="#cb75-85" aria-hidden="true" tabindex="-1"></a>                    fwd[i, j] <span class="op">*</span> bak[i <span class="op">+</span> <span class="dv">1</span>, k] <span class="op">*</span> weight <span class="op">/</span> <span class="bu">sum</span>(fwd[i, :] <span class="op">*</span> bak[i, :])</span>
<span id="cb75-86"><a href="#cb75-86" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb75-87"><a href="#cb75-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rep_mat</span>
<span id="cb75-88"><a href="#cb75-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-89"><a href="#cb75-89" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_tmat(seq: <span class="bu">str</span>, st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb75-90"><a href="#cb75-90" aria-hidden="true" tabindex="-1"></a>    fwd <span class="op">=</span> forward(seq, st, tmat, emat)</span>
<span id="cb75-91"><a href="#cb75-91" aria-hidden="true" tabindex="-1"></a>    bak <span class="op">=</span> backward(seq, st, tmat, emat)</span>
<span id="cb75-92"><a href="#cb75-92" aria-hidden="true" tabindex="-1"></a>    pi2 <span class="op">=</span> estimate_pi2(seq, fwd, bak, tmat, emat, st)</span>
<span id="cb75-93"><a href="#cb75-93" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> np.<span class="bu">sum</span>(pi2, <span class="dv">0</span>)</span>
<span id="cb75-94"><a href="#cb75-94" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> tmat_new <span class="op">/</span> np.<span class="bu">sum</span>(tmat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-95"><a href="#cb75-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(tmat_new, st, st)</span>
<span id="cb75-96"><a href="#cb75-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-97"><a href="#cb75-97" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emat(seq: <span class="bu">str</span>, al: List[<span class="bu">str</span>], st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb75-98"><a href="#cb75-98" aria-hidden="true" tabindex="-1"></a>    pi1 <span class="op">=</span> soft_decode(seq, st, tmat, emat)</span>
<span id="cb75-99"><a href="#cb75-99" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> np.zeros((<span class="bu">len</span>(st), <span class="bu">len</span>(al)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb75-100"><a href="#cb75-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(al):</span>
<span id="cb75-101"><a href="#cb75-101" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> np.array(<span class="bu">list</span>(seq)) <span class="op">==</span> emission</span>
<span id="cb75-102"><a href="#cb75-102" aria-hidden="true" tabindex="-1"></a>        emat_new[:, i] <span class="op">=</span> np.<span class="bu">sum</span>(pi1[ind, :], <span class="dv">0</span>)</span>
<span id="cb75-103"><a href="#cb75-103" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> emat_new <span class="op">/</span> np.<span class="bu">sum</span>(emat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-104"><a href="#cb75-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(emat_new, st, al)</span>
<span id="cb75-105"><a href="#cb75-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-106"><a href="#cb75-106" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb75-107"><a href="#cb75-107" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb75-108"><a href="#cb75-108" aria-hidden="true" tabindex="-1"></a>    niter, seq, st, al, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb75-109"><a href="#cb75-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb75-110"><a href="#cb75-110" aria-hidden="true" tabindex="-1"></a>        tmat2 <span class="op">=</span> estimate_tmat(seq, st, tmat, emat)</span>
<span id="cb75-111"><a href="#cb75-111" aria-hidden="true" tabindex="-1"></a>        emat2 <span class="op">=</span> estimate_emat(seq, al, st, tmat, emat)</span>
<span id="cb75-112"><a href="#cb75-112" aria-hidden="true" tabindex="-1"></a>        emat, tmat <span class="op">=</span> emat2, tmat2</span>
<span id="cb75-113"><a href="#cb75-113" aria-hidden="true" tabindex="-1"></a>    print_dict(tmat, st, st)</span>
<span id="cb75-114"><a href="#cb75-114" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb75-115"><a href="#cb75-115" aria-hidden="true" tabindex="-1"></a>    print_dict(emat, st, al)</span>
<span id="cb75-116"><a href="#cb75-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-117"><a href="#cb75-117" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb75-118"><a href="#cb75-118" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb75-119"><a href="#cb75-119" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb75-120"><a href="#cb75-120" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzyzyxy</span></span>
<span id="cb75-121"><a href="#cb75-121" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb75-122"><a href="#cb75-122" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb75-123"><a href="#cb75-123" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb75-124"><a href="#cb75-124" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb75-125"><a href="#cb75-125" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb75-126"><a href="#cb75-126" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb75-127"><a href="#cb75-127" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.019   0.981 </span></span>
<span id="cb75-128"><a href="#cb75-128" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.668   0.332 </span></span>
<span id="cb75-129"><a href="#cb75-129" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb75-130"><a href="#cb75-130" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb75-131"><a href="#cb75-131" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.175   0.003   0.821 </span></span>
<span id="cb75-132"><a href="#cb75-132" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.196   0.512   0.293</span></span>
<span id="cb75-133"><a href="#cb75-133" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb75-134"><a href="#cb75-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-135"><a href="#cb75-135" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-graph-of-a-spectrum" class="level1" data-number="25">
<h1 data-number="25"><span class="header-section-number">25</span> Construct the Graph of a Spectrum</h1>
<section id="spectrum-graph-construction" class="level2" data-number="25.1">
<h2 data-number="25.1" class="anchored" data-anchor-id="spectrum-graph-construction"><span class="header-section-number">25.1</span> Spectrum Graph Construction</h2>
<p>Construct the graph of a spectrum.</p>
<p>Given:&nbsp;A space-delimited list of integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;<em>Graph(Spectrum)</em>.</p>
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
</section>
<section id="sample-dataset-25" class="level2" data-number="25.2">
<h2 data-number="25.2" class="anchored" data-anchor-id="sample-dataset-25"><span class="header-section-number">25.2</span> Sample Dataset</h2>
<pre><code>57 71 154 185 301 332 415 429 486</code></pre>
</section>
<section id="sample-output-25" class="level2" data-number="25.3">
<h2 data-number="25.3" class="anchored" data-anchor-id="sample-output-25"><span class="header-section-number">25.3</span> Sample Output</h2>
<pre><code>0-&gt;57:G
0-&gt;71:A
57-&gt;154:P
57-&gt;185:K
71-&gt;185:N
154-&gt;301:F
185-&gt;332:F
301-&gt;415:N
301-&gt;429:K
332-&gt;429:P
415-&gt;486:A
429-&gt;486:G</code></pre>
</section>
<section id="solution-25" class="level2" data-number="25.4">
<h2 data-number="25.4" class="anchored" data-anchor-id="solution-25"><span class="header-section-number">25.4</span> Solution</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Amino acid weights dictionary</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>amino_acid_weights <span class="op">=</span> {</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'V'</span>: <span class="dv">99</span>,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'Y'</span>: <span class="dv">163</span>, <span class="st">'W'</span>: <span class="dv">186</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spectrum_graph(masses):</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reverse mapping of weights to amino acids</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>    weight_to_amino_acid <span class="op">=</span> {weight: aa <span class="cf">for</span> aa, weight <span class="kw">in</span> amino_acid_weights.items()}</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create graph based on mass differences</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(masses)):</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(masses)):</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>            difference <span class="op">=</span> masses[j] <span class="op">-</span> masses[i]</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> difference <span class="kw">in</span> weight_to_amino_acid:</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>                graph[masses[i]].append({<span class="st">"n"</span>: masses[j], <span class="st">"l"</span>: weight_to_amino_acid[difference]})</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"57 71 154 185 301 332 415 429 486"</span></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>masses <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, sample_input.split()))</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the spectrum graph</span></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> start_mass, edges <span class="kw">in</span> spectrum_graph(masses).items():</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>start_mass<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>edge[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>edge[<span class="st">'l'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-motifenumeration" class="level1" data-number="26">
<h1 data-number="26"><span class="header-section-number">26</span> Implement MotifEnumeration</h1>
<p>Implanted Motif Problem. Implement MotifEnumeration (shown above) to find all (k, d)-motifs in a collection of strings.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;All (<em>k</em>,&nbsp;<em>d</em>)-motifs in&nbsp;<em>Dna</em>.</p>
<section id="sample-dataset-26" class="level2" data-number="26.1">
<h2 data-number="26.1" class="anchored" data-anchor-id="sample-dataset-26"><span class="header-section-number">26.1</span> Sample Dataset</h2>
<pre><code>3 1
ATTTGGC
TGCCTTA
CGGTATC
GAAAATT</code></pre>
</section>
<section id="sample-output-26" class="level2" data-number="26.2">
<h2 data-number="26.2" class="anchored" data-anchor-id="sample-output-26"><span class="header-section-number">26.2</span> Sample Output</h2>
<pre><code>ATA ATT GTT TTT</code></pre>
</section>
<section id="solution-26" class="level2" data-number="26.3">
<h2 data-number="26.3" class="anchored" data-anchor-id="solution-26"><span class="header-section-number">26.3</span> Solution</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Iterator</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>    neighbor_set <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance):</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], neighbor) <span class="op">&lt;</span> max_distance:</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>                neighbor_set.add(nucleotide <span class="op">+</span> neighbor)</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>            neighbor_set.add(sequence[<span class="dv">0</span>] <span class="op">+</span> neighbor)</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbor_set</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_kmers(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(kmer <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length))</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> contains_approximate_match(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">any</span>(calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_distance </span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>               <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enumerate_motifs(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>    motif_patterns <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> get_all_kmers(dna_sequences, kmer_length):</span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor_kmer <span class="kw">in</span> generate_neighbors(kmer, max_distance):</span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(contains_approximate_match(neighbor_kmer, sequence, max_distance) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences):</span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a>                motif_patterns.add(neighbor_kmer)</span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> motif_patterns</span>
<span id="cb81-40"><a href="#cb81-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-41"><a href="#cb81-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb81-42"><a href="#cb81-42" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb81-43"><a href="#cb81-43" aria-hidden="true" tabindex="-1"></a><span class="st">3 1</span></span>
<span id="cb81-44"><a href="#cb81-44" aria-hidden="true" tabindex="-1"></a><span class="st">ATTTGGC</span></span>
<span id="cb81-45"><a href="#cb81-45" aria-hidden="true" tabindex="-1"></a><span class="st">TGCCTTA</span></span>
<span id="cb81-46"><a href="#cb81-46" aria-hidden="true" tabindex="-1"></a><span class="st">CGGTATC</span></span>
<span id="cb81-47"><a href="#cb81-47" aria-hidden="true" tabindex="-1"></a><span class="st">GAAAATT</span></span>
<span id="cb81-48"><a href="#cb81-48" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb81-49"><a href="#cb81-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-50"><a href="#cb81-50" aria-hidden="true" tabindex="-1"></a>input_params, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb81-51"><a href="#cb81-51" aria-hidden="true" tabindex="-1"></a>kmer_length, max_distance <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_params.split())</span>
<span id="cb81-52"><a href="#cb81-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(enumerate_motifs(dna_sequences, kmer_length, max_distance)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-median-string" class="level1" data-number="27">
<h1 data-number="27"><span class="header-section-number">27</span> Find a Median String</h1>
<p>Median String Problem, Find a median string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A&nbsp;<em>k</em>-mer&nbsp;<em>Pattern</em>&nbsp;that minimizes&nbsp;<em>d</em>(<em>Pattern</em>,&nbsp;<em>Dna</em>) over all&nbsp;<em>k</em>-mers&nbsp;<em>Pattern</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-27" class="level2" data-number="27.1">
<h2 data-number="27.1" class="anchored" data-anchor-id="sample-dataset-27"><span class="header-section-number">27.1</span> Sample Dataset</h2>
<pre><code>3
AAATTGACGCAT
GACGACCACGTT
CGTCAGCGCCTG
GCTGAGCACCGG
AGTACGGGACAG</code></pre>
</section>
<section id="sample-output-27" class="level2" data-number="27.2">
<h2 data-number="27.2" class="anchored" data-anchor-id="sample-output-27"><span class="header-section-number">27.2</span> Sample Output</h2>
<pre><code>ACG</code></pre>
</section>
<section id="solution-27" class="level2" data-number="27.3">
<h2 data-number="27.3" class="anchored" data-anchor-id="solution-27"><span class="header-section-number">27.3</span> Solution</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(nucleotides) <span class="cf">for</span> nucleotides <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(nucleotide1 <span class="op">!=</span> nucleotide2 <span class="cf">for</span> nucleotide1, nucleotide2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(substring, pattern) <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_total_distance(pattern: <span class="bu">str</span>, dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, sequence) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences)</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_median_string(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>    min_distance <span class="op">=</span> math.inf</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>    median_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>        current_distance <span class="op">=</span> calculate_total_distance(kmer, dna_sequences)</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_distance <span class="op">&lt;</span> min_distance:</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>            min_distance <span class="op">=</span> current_distance</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>            median_kmer <span class="op">=</span> kmer</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> median_kmer</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a><span class="st">AAATTGACGCAT</span></span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a><span class="st">GACGACCACGTT</span></span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a><span class="st">CGTCAGCGCCTG</span></span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a><span class="st">GCTGAGCACCGG</span></span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a><span class="st">AGTACGGGACAG</span></span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>kmer_length, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_median_string(dna_sequences, <span class="bu">int</span>(kmer_length))</span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-profile-most-probable-k-mer-in-a-string" class="level1" data-number="28">
<h1 data-number="28"><span class="header-section-number">28</span> Find a Profile-most Probable k-mer in a String</h1>
<p>Profile-most Probable&nbsp;<em>k</em>-mer Problem, Find a Profile-most probable k-mer in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>, an integer&nbsp;<em>k</em>, and a 4 ×&nbsp;<em>k</em>&nbsp;matrix&nbsp;<em>Profile</em>.</p>
<p>Return:&nbsp;A&nbsp;<em>Profile</em>-most probable&nbsp;<em>k</em>-mer in&nbsp;<em>Text</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-28" class="level2" data-number="28.1">
<h2 data-number="28.1" class="anchored" data-anchor-id="sample-dataset-28"><span class="header-section-number">28.1</span> Sample Dataset</h2>
<pre><code>ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT
5
0.2 0.2 0.3 0.2 0.3
0.4 0.3 0.1 0.5 0.1
0.3 0.3 0.5 0.2 0.4
0.1 0.2 0.1 0.1 0.2</code></pre>
</section>
<section id="sample-output-28" class="level2" data-number="28.2">
<h2 data-number="28.2" class="anchored" data-anchor-id="sample-output-28"><span class="header-section-number">28.2</span> Sample Output</h2>
<pre><code>CCGAG</code></pre>
</section>
<section id="solution-28" class="level2" data-number="28.3">
<h2 data-number="28.3" class="anchored" data-anchor-id="solution-28"><span class="header-section-number">28.3</span> Solution</h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_profile_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile_matrix: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    nucleotide_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    max_probability <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length):</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>        kmer_probability <span class="op">=</span> math.prod(profile_matrix[nucleotide_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a><span class="st">ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a><span class="st">0.2 0.2 0.3 0.2 0.3</span></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.3 0.1 0.5 0.1</span></span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a><span class="st">0.3 0.3 0.5 0.2 0.4</span></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a><span class="st">0.1 0.2 0.1 0.1 0.2</span></span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, <span class="op">*</span>profile_rows <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>profile_matrix <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">float</span>, row.split())) <span class="cf">for</span> row <span class="kw">in</span> profile_rows]</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_profile_most_probable_kmer(dna_sequence, <span class="bu">int</span>(kmer_length), profile_matrix)</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-greedymotifsearch" class="level1" data-number="29">
<h1 data-number="29"><span class="header-section-number">29</span> Implement GreedyMotifSearch</h1>
<p>Implement, GreedyMotifSearch.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>t</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A collection of strings&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>GreedyMotifSearch</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>). If at any step you find more than one&nbsp;<em>Profile</em>-most probable&nbsp;<em>k</em>-mer in a given string, use the one occurring first.</p>
<section id="sample-dataset-29" class="level2" data-number="29.1">
<h2 data-number="29.1" class="anchored" data-anchor-id="sample-dataset-29"><span class="header-section-number">29.1</span> Sample Dataset</h2>
<pre><code>3 5
GGCGTTCAGGCA
AAGAATCAGTCA
CAAGGAGTTCGC
CACGTCAATCAC
CAATAATATTCG</code></pre>
</section>
<section id="sample-output-29" class="level2" data-number="29.2">
<h2 data-number="29.2" class="anchored" data-anchor-id="sample-output-29"><span class="header-section-number">29.2</span> Sample Output</h2>
<pre><code>CAG
CAG
CAA
CAA
CAA</code></pre>
</section>
<section id="solution-29" class="level2" data-number="29.3">
<h2 data-number="29.3" class="anchored" data-anchor-id="solution-29"><span class="header-section-number">29.3</span> Solution</h2>
<div class="sourceCode" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    max_probability: <span class="bu">float</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length):</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>        kmer_probability: <span class="bu">float</span> <span class="op">=</span> math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(sequences: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>    profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> [[] <span class="cf">for</span> _ <span class="kw">in</span> nucleotides]</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(nucleotides):</span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a>        profile[i] <span class="op">=</span> [</span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> sequences) <span class="op">+</span> pseudocount) <span class="op">/</span> <span class="bu">len</span>(sequences)</span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequences[<span class="dv">0</span>]))</span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>])):</span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a>        column: List[<span class="bu">str</span>] <span class="op">=</span> [motif[i] <span class="cf">for</span> motif <span class="kw">in</span> motifs]</span>
<span id="cb90-36"><a href="#cb90-36" aria-hidden="true" tabindex="-1"></a>        most_common: <span class="bu">str</span> <span class="op">=</span> Counter(column).most_common()[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb90-37"><a href="#cb90-37" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">sum</span>(nucleotide <span class="op">!=</span> most_common <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb90-38"><a href="#cb90-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb90-39"><a href="#cb90-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-40"><a href="#cb90-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb90-41"><a href="#cb90-41" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [seq[:kmer_length] <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb90-42"><a href="#cb90-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb90-43"><a href="#cb90-43" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb90-44"><a href="#cb90-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(dna_sequences)):</span>
<span id="cb90-45"><a href="#cb90-45" aria-hidden="true" tabindex="-1"></a>            current_profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount<span class="op">=</span>pseudocount)</span>
<span id="cb90-46"><a href="#cb90-46" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(dna_sequences[i], kmer_length, current_profile))</span>
<span id="cb90-47"><a href="#cb90-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb90-48"><a href="#cb90-48" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb90-49"><a href="#cb90-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb90-50"><a href="#cb90-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-51"><a href="#cb90-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb90-52"><a href="#cb90-52" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb90-53"><a href="#cb90-53" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb90-54"><a href="#cb90-54" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb90-55"><a href="#cb90-55" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb90-56"><a href="#cb90-56" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb90-57"><a href="#cb90-57" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb90-58"><a href="#cb90-58" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb90-59"><a href="#cb90-59" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb90-60"><a href="#cb90-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-61"><a href="#cb90-61" aria-hidden="true" tabindex="-1"></a>ints, <span class="op">*</span>dna <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb90-62"><a href="#cb90-62" aria-hidden="true" tabindex="-1"></a>k, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, ints.split())</span>
<span id="cb90-63"><a href="#cb90-63" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna, k)</span>
<span id="cb90-64"><a href="#cb90-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-greedymotifsearch-with-pseudocounts" class="level1" data-number="30">
<h1 data-number="30"><span class="header-section-number">30</span> Implement GreedyMotifSearch with Pseudocounts</h1>
<p>Implement.&nbsp;<em>GreedyMotifSearch</em>&nbsp;with Pseudocounts.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>t</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A collection of strings&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>GreedyMotifSearch</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>) with pseudocounts. If at any step you find more than one&nbsp;<em>Profile</em>-most probable&nbsp;<em>k</em>-mer in a given string, use the one occurring first.</p>
<section id="sample-dataset-30" class="level2" data-number="30.1">
<h2 data-number="30.1" class="anchored" data-anchor-id="sample-dataset-30"><span class="header-section-number">30.1</span> Sample Dataset</h2>
<pre><code>3 5
GGCGTTCAGGCA
AAGAATCAGTCA
CAAGGAGTTCGC
CACGTCAATCAC
CAATAATATTCG</code></pre>
</section>
<section id="sample-output-30" class="level2" data-number="30.2">
<h2 data-number="30.2" class="anchored" data-anchor-id="sample-output-30"><span class="header-section-number">30.2</span> Sample Output</h2>
<pre><code>TTC
ATC
TTC
ATC
TTC</code></pre>
</section>
<section id="solution-30" class="level2" data-number="30.3">
<h2 data-number="30.3" class="anchored" data-anchor-id="solution-30"><span class="header-section-number">30.3</span> Solution</h2>
<div class="sourceCode" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][position] </span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">for</span> position, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> motif_count </span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [sequence[:kmer_length] <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences]</span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences[<span class="dv">1</span>:]:</span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a>            profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount)</span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(sequence, kmer_length, profile))</span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb93-44"><a href="#cb93-44" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb93-45"><a href="#cb93-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-46"><a href="#cb93-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb93-47"><a href="#cb93-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-48"><a href="#cb93-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb93-49"><a href="#cb93-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb93-50"><a href="#cb93-50" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb93-51"><a href="#cb93-51" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb93-52"><a href="#cb93-52" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb93-53"><a href="#cb93-53" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb93-54"><a href="#cb93-54" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb93-55"><a href="#cb93-55" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb93-56"><a href="#cb93-56" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb93-57"><a href="#cb93-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-58"><a href="#cb93-58" aria-hidden="true" tabindex="-1"></a>k_value, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb93-59"><a href="#cb93-59" aria-hidden="true" tabindex="-1"></a>k_value <span class="op">=</span> <span class="bu">int</span>(k_value)</span>
<span id="cb93-60"><a href="#cb93-60" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna_sequences, k_value, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb93-61"><a href="#cb93-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-randomizedmotifsearch" class="level1" data-number="31">
<h1 data-number="31"><span class="header-section-number">31</span> Implement RandomizedMotifSearch</h1>
<p>Implement&nbsp;<em>RandomizedMotifSearch</em>.</p>
<p>Given:&nbsp;Positive integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>t</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A collection&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>RandomizedMotifSearch</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>) 1000 times. Remember to use pseudocounts!</p>
<section id="sample-dataset-31" class="level2" data-number="31.1">
<h2 data-number="31.1" class="anchored" data-anchor-id="sample-dataset-31"><span class="header-section-number">31.1</span> Sample Dataset</h2>
<pre><code>8 5
CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA
GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG
TAGTACCGAGACCGAAAGAAGTATACAGGCGT
TAGATCAAGTTTCAGGTGCACGTCGGTGAACC
AATCCACCAGCTCCACGTGCAATGTTGGCCTA</code></pre>
</section>
<section id="sample-output-31" class="level2" data-number="31.2">
<h2 data-number="31.2" class="anchored" data-anchor-id="sample-output-31"><span class="header-section-number">31.2</span> Sample Output</h2>
<pre><code>AACGGCCA
AAGTGCCA
TAGTACCG
AAGTTTCA
ACGTGCAA</code></pre>
</section>
<section id="solution-31" class="level2" data-number="31.3">
<h2 data-number="31.3" class="anchored" data-anchor-id="solution-31"><span class="header-section-number">31.3</span> Solution</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Callable</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> randint</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [sequence[i:i<span class="op">+</span>kmer_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][j] <span class="cf">for</span> j, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>    profile <span class="op">=</span> []</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>        profile.append([</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (<span class="bu">len</span>(motifs) <span class="op">+</span> <span class="dv">4</span> <span class="op">*</span> pseudocount)</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>]))</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start : start <span class="op">+</span> kmer_length]</span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_motifs(profile: List[List[<span class="bu">float</span>]], dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a>    kmer_length <span class="op">=</span> <span class="bu">len</span>(profile[<span class="dv">0</span>])</span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [find_most_probable_kmer(seq, kmer_length, profile) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> randomized_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb96-41"><a href="#cb96-41" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb96-42"><a href="#cb96-42" aria-hidden="true" tabindex="-1"></a>    best_score <span class="op">=</span> math.inf</span>
<span id="cb96-43"><a href="#cb96-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-44"><a href="#cb96-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb96-45"><a href="#cb96-45" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb96-46"><a href="#cb96-46" aria-hidden="true" tabindex="-1"></a>        motifs <span class="op">=</span> find_motifs(profile, dna_sequences)</span>
<span id="cb96-47"><a href="#cb96-47" aria-hidden="true" tabindex="-1"></a>        current_score <span class="op">=</span> calculate_score(motifs)</span>
<span id="cb96-48"><a href="#cb96-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb96-49"><a href="#cb96-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_score <span class="op">&gt;=</span> best_score:</span>
<span id="cb96-50"><a href="#cb96-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> best_score, motifs</span>
<span id="cb96-51"><a href="#cb96-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb96-52"><a href="#cb96-52" aria-hidden="true" tabindex="-1"></a>        best_score <span class="op">=</span> current_score</span>
<span id="cb96-53"><a href="#cb96-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-54"><a href="#cb96-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb96-55"><a href="#cb96-55" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb96-56"><a href="#cb96-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-57"><a href="#cb96-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb96-58"><a href="#cb96-58" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb96-59"><a href="#cb96-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb96-60"><a href="#cb96-60" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb96-61"><a href="#cb96-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-62"><a href="#cb96-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb96-63"><a href="#cb96-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-64"><a href="#cb96-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb96-65"><a href="#cb96-65" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb96-66"><a href="#cb96-66" aria-hidden="true" tabindex="-1"></a><span class="st">8 5</span></span>
<span id="cb96-67"><a href="#cb96-67" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA</span></span>
<span id="cb96-68"><a href="#cb96-68" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG</span></span>
<span id="cb96-69"><a href="#cb96-69" aria-hidden="true" tabindex="-1"></a><span class="st">TAGTACCGAGACCGAAAGAAGTATACAGGCGT</span></span>
<span id="cb96-70"><a href="#cb96-70" aria-hidden="true" tabindex="-1"></a><span class="st">TAGATCAAGTTTCAGGTGCACGTCGGTGAACC</span></span>
<span id="cb96-71"><a href="#cb96-71" aria-hidden="true" tabindex="-1"></a><span class="st">AATCCACCAGCTCCACGTGCAATGTTGGCCTA</span></span>
<span id="cb96-72"><a href="#cb96-72" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb96-73"><a href="#cb96-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-74"><a href="#cb96-74" aria-hidden="true" tabindex="-1"></a>kmer_length, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb96-75"><a href="#cb96-75" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb96-76"><a href="#cb96-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-77"><a href="#cb96-77" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(randomized_motif_search, <span class="dv">1000</span>, dna_sequences, kmer_length)</span>
<span id="cb96-78"><a href="#cb96-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-gibbssampler" class="level1" data-number="32">
<h1 data-number="32"><span class="header-section-number">32</span> Implement GibbsSampler</h1>
<p>Implement,&nbsp;<em>GibbsSampler</em>.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>,&nbsp;<em>t</em>, and&nbsp;<em>N</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;The strings&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>GibbsSampler</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>,&nbsp;<em>N</em>) with 20 random starts. Remember to use pseudocounts!</p>
<section id="sample-dataset-32" class="level2" data-number="32.1">
<h2 data-number="32.1" class="anchored" data-anchor-id="sample-dataset-32"><span class="header-section-number">32.1</span> Sample Dataset</h2>
<pre><code>8 5 100
CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA
GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG
TAGTACCGAGACCGAAAGAAGTATACAGGCGT
TAGATCAAGTTTCAGGTGCACGTCGGTGAACC
AATCCACCAGCTCCACGTGCAATGTTGGCCTA</code></pre>
</section>
<section id="sample-output-32" class="level2" data-number="32.2">
<h2 data-number="32.2" class="anchored" data-anchor-id="sample-output-32"><span class="header-section-number">32.2</span> Sample Output</h2>
<pre><code>TCTCGGGG
CCAAGGTG
TACAGGCG
TTCAGGTG
TCCACGTG</code></pre>
</section>
<section id="solution-32" class="level2" data-number="32.3">
<h2 data-number="32.3" class="anchored" data-anchor-id="solution-32"><span class="header-section-number">32.3</span> Solution</h2>
<div class="sourceCode" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, Tuple, Callable</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (motif_count <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>pseudocount)</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_probabilities(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>        math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length)</span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> calculate_kmer_probabilities(sequence, kmer_length, profile)</span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.choices(<span class="bu">range</span>(<span class="bu">len</span>(probabilities)), probabilities)[<span class="dv">0</span>]</span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gibbs_sampler(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, num_iterations: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb99-52"><a href="#cb99-52" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb99-53"><a href="#cb99-53" aria-hidden="true" tabindex="-1"></a>    best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb99-54"><a href="#cb99-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_iterations):</span>
<span id="cb99-55"><a href="#cb99-55" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(dna_sequences) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb99-56"><a href="#cb99-56" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs[:i] <span class="op">+</span> motifs[i <span class="op">+</span> <span class="dv">1</span> :], pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb99-57"><a href="#cb99-57" aria-hidden="true" tabindex="-1"></a>        motifs[i] <span class="op">=</span> select_random_kmer(dna_sequences[i], kmer_length, profile)</span>
<span id="cb99-58"><a href="#cb99-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb99-59"><a href="#cb99-59" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb99-60"><a href="#cb99-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> calculate_score(best_motifs), best_motifs</span>
<span id="cb99-61"><a href="#cb99-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-62"><a href="#cb99-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb99-63"><a href="#cb99-63" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb99-64"><a href="#cb99-64" aria-hidden="true" tabindex="-1"></a><span class="st">8 5 100</span></span>
<span id="cb99-65"><a href="#cb99-65" aria-hidden="true" tabindex="-1"></a><span class="st">TCTCGGGG</span></span>
<span id="cb99-66"><a href="#cb99-66" aria-hidden="true" tabindex="-1"></a><span class="st">CCAAGGTG</span></span>
<span id="cb99-67"><a href="#cb99-67" aria-hidden="true" tabindex="-1"></a><span class="st">TACAGGCG</span></span>
<span id="cb99-68"><a href="#cb99-68" aria-hidden="true" tabindex="-1"></a><span class="st">TTCAGGTG</span></span>
<span id="cb99-69"><a href="#cb99-69" aria-hidden="true" tabindex="-1"></a><span class="st">TCCACGTG</span></span>
<span id="cb99-70"><a href="#cb99-70" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb99-71"><a href="#cb99-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-72"><a href="#cb99-72" aria-hidden="true" tabindex="-1"></a>kmer_length, num_sequences, num_iterations, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb99-73"><a href="#cb99-73" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb99-74"><a href="#cb99-74" aria-hidden="true" tabindex="-1"></a>num_iterations <span class="op">=</span> <span class="bu">int</span>(num_iterations)</span>
<span id="cb99-75"><a href="#cb99-75" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(gibbs_sampler, <span class="dv">20</span>, dna_sequences, kmer_length, num_iterations)</span>
<span id="cb99-76"><a href="#cb99-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-distancebetweenpatternandstrings" class="level1" data-number="33">
<h1 data-number="33"><span class="header-section-number">33</span> Implement DistanceBetweenPatternAndStrings</h1>
<p>Compute DistanceBetweenPatternAndStrings. <em>Find the distance between a pattern and a set of strings.</em>.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Pattern</em>&nbsp;and a collection of DNA strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;<em>DistanceBetweenPatternAndStrings</em>(<em>Pattern</em>,&nbsp;<em>Dna</em>).</p>
<section id="sample-dataset-33" class="level2" data-number="33.1">
<h2 data-number="33.1" class="anchored" data-anchor-id="sample-dataset-33"><span class="header-section-number">33.1</span> Sample Dataset</h2>
<pre><code>AAA
TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</code></pre>
</section>
<section id="sample-output-33" class="level2" data-number="33.2">
<h2 data-number="33.2" class="anchored" data-anchor-id="sample-output-33"><span class="header-section-number">33.2</span> Sample Output</h2>
<pre><code>5</code></pre>
</section>
<section id="solution-33" class="level2" data-number="33.3">
<h2 data-number="33.3" class="anchored" data-anchor-id="solution-33"><span class="header-section-number">33.3</span> Solution</h2>
<div class="sourceCode" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(kmer, pattern) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_pattern_distance_to_strings(pattern: <span class="bu">str</span>, dna_strings: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, dna_string) <span class="cf">for</span> dna_string <span class="kw">in</span> dna_strings)</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a><span class="st">TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>pattern, dna_strings_raw <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>dna_strings <span class="op">=</span> dna_strings_raw.split()</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_pattern_distance_to_strings(pattern, dna_strings)</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-k-mer-composition-of-a-string" class="level1" data-number="34">
<h1 data-number="34"><span class="header-section-number">34</span> Generate the k-mer Composition of a String</h1>
<p>String Composition Problem, Generate the k-mer composition of a string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and a string&nbsp;<em>Text</em>.</p>
<p>Return:&nbsp;*Composition__k<em>(</em>Text<em>) (the&nbsp;</em>k*-mers can be provided in any order).</p>
<section id="sample-dataset-34" class="level2" data-number="34.1">
<h2 data-number="34.1" class="anchored" data-anchor-id="sample-dataset-34"><span class="header-section-number">34.1</span> Sample Dataset</h2>
<pre><code>5
CAATCCAAC</code></pre>
</section>
<section id="sample-output-34" class="level2" data-number="34.2">
<h2 data-number="34.2" class="anchored" data-anchor-id="sample-output-34"><span class="header-section-number">34.2</span> Sample Output</h2>
<pre><code>CAATC
AATCC
ATCCA
TCCAA
CCAAC</code></pre>
</section>
<section id="solution-34" class="level2" data-number="34.3">
<h2 data-number="34.3" class="anchored" data-anchor-id="solution-34"><span class="header-section-number">34.3</span> Solution</h2>
<div class="sourceCode" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i:i <span class="op">+</span> kmer_length]</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="st">CAATCCAAC</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>input_lines: <span class="bu">list</span>[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequence, kmer_length):</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(kmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-genome-path" class="level1" data-number="35">
<h1 data-number="35"><span class="header-section-number">35</span> Reconstruct a String from its Genome Path</h1>
<p>String Spelled by a Genome Path Problem, Find the string spelled by a genome path.</p>
<p>Given:&nbsp;A sequence of&nbsp;<em>k</em>-mers&nbsp;<em>Pattern1,…, Patternn</em>&nbsp;such that the last&nbsp;<em>k - 1</em>&nbsp;symbols of&nbsp;<em>Patterni</em>&nbsp;are equal to the first&nbsp;<em>k - 1</em>&nbsp;symbols of&nbsp;<em>Patterni+1</em>&nbsp;for&nbsp;<em>i</em>&nbsp;from 1 to n-1.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;of length&nbsp;<em>k+n-1</em>&nbsp;where the&nbsp;<em>i</em>-th&nbsp;<em>k</em>-mer in&nbsp;<em>Text</em>&nbsp;is equal to&nbsp;<em>Patterni</em>&nbsp;for all&nbsp;<em>i</em>.</p>
<section id="sample-dataset-35" class="level2" data-number="35.1">
<h2 data-number="35.1" class="anchored" data-anchor-id="sample-dataset-35"><span class="header-section-number">35.1</span> Sample Dataset</h2>
<pre><code>ACCGA
CCGAA
CGAAG
GAAGC
AAGCT</code></pre>
</section>
<section id="sample-output-35" class="level2" data-number="35.2">
<h2 data-number="35.2" class="anchored" data-anchor-id="sample-output-35"><span class="header-section-number">35.2</span> Sample Output</h2>
<pre><code>ACCGAAGCT</code></pre>
</section>
<section id="solution-35" class="level2" data-number="35.3">
<h2 data-number="35.3" class="anchored" data-anchor-id="solution-35"><span class="header-section-number">35.3</span> Solution</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_dna_sequence(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    reconstructed_sequence: <span class="bu">str</span> <span class="op">=</span> kmers[<span class="dv">0</span>]</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(kmers)):</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>        reconstructed_sequence <span class="op">+=</span> kmers[i][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_sequence</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="st">ACCGA</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="st">CCGAA</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="st">CGAAG</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="st">GAAGC</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="st">AAGCT</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_dna_sequence(kmer_list))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-overlap-graph-of-a-collection-of-k-mers" class="level1" data-number="36">
<h1 data-number="36"><span class="header-section-number">36</span> Construct the Overlap Graph of a Collection of k-mers</h1>
<p>Overlap Graph Problem, Construct the overlap graph of a collection of k-mers.</p>
<p>Given:&nbsp;A collection&nbsp;<em>Patterns</em>&nbsp;of&nbsp;<em>k</em>-mers.</p>
<p>Return:&nbsp;The overlap graph&nbsp;<em>Overlap</em>(<em>Patterns</em>), in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<section id="sample-dataset-36" class="level2" data-number="36.1">
<h2 data-number="36.1" class="anchored" data-anchor-id="sample-dataset-36"><span class="header-section-number">36.1</span> Sample Dataset</h2>
<pre><code>ATGCG
GCATG
CATGC
AGGCA
GGCAT</code></pre>
</section>
<section id="sample-output-36" class="level2" data-number="36.2">
<h2 data-number="36.2" class="anchored" data-anchor-id="sample-output-36"><span class="header-section-number">36.2</span> Sample Output</h2>
<pre><code>GCATG -&gt; CATGC
CATGC -&gt; ATGCG
AGGCA -&gt; GGCAT
GGCAT -&gt; GCATG</code></pre>
</section>
<section id="solution-36" class="level2" data-number="36.3">
<h2 data-number="36.3" class="anchored" data-anchor-id="solution-36"><span class="header-section-number">36.3</span> Solution</h2>
<div class="sourceCode" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> overlap_graph(patterns: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>]]:</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>    adj_list <span class="op">=</span> []</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">!=</span> j <span class="kw">and</span> patterns[i][<span class="dv">1</span>:] <span class="op">==</span> patterns[j][:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>                adj_list.append((patterns[i], patterns[j]))</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adj_list</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a><span class="st">ATGCG</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="st">GCATG</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a><span class="st">CATGC</span></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="st">AGGCA</span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a><span class="st">GGCAT</span></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>Patterns: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>adj_list <span class="op">=</span> overlap_graph(Patterns)</span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> adj_list:</span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>edge[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span>edge[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-de-bruijn-graph-of-a-string" class="level1" data-number="37">
<h1 data-number="37"><span class="header-section-number">37</span> Construct the De Bruijn Graph of a String</h1>
<p>De Bruijn Graph from a String Problem. Construct the de Bruijn graph of a string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and a string&nbsp;<em>Text</em>.</p>
<p>Return:*DeBruijn__k<em>(</em>Text*), in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<section id="sample-dataset-37" class="level2" data-number="37.1">
<h2 data-number="37.1" class="anchored" data-anchor-id="sample-dataset-37"><span class="header-section-number">37.1</span> Sample Dataset</h2>
<pre><code>4
AAGATTCTCTAC</code></pre>
</section>
<section id="sample-output-37" class="level2" data-number="37.2">
<h2 data-number="37.2" class="anchored" data-anchor-id="sample-output-37"><span class="header-section-number">37.2</span> Sample Output</h2>
<pre><code>AAG -&gt; AGA
AGA -&gt; GAT
ATT -&gt; TTC
CTA -&gt; TAC
CTC -&gt; TCT
GAT -&gt; ATT
TCT -&gt; CTA,CTC
TTC -&gt; TCT</code></pre>
</section>
<section id="solution-37" class="level2" data-number="37.3">
<h2 data-number="37.3" class="anchored" data-anchor-id="solution-37"><span class="header-section-number">37.3</span> Solution</h2>
<div class="sourceCode" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> OrderedDict</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, OrderedDict <span class="im">as</span> OrderedDictType</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]]:</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>    adjacency_list: OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]] <span class="op">=</span> OrderedDict()</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">2</span>):</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>        adjacency_list[sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:i <span class="op">+</span> kmer_length]</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>        adjacency_list[prefix].add(suffix)</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a><span class="st">AAGATTCTCTAC</span></span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(dna_sequence, kmer_length)</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> neighbors:</span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-de-bruijn-graph-of-a-collection-of-k-mers" class="level1" data-number="38">
<h1 data-number="38"><span class="header-section-number">38</span> Construct the De Bruijn Graph of a Collection of k-mers</h1>
<p>De Bruijn Graph from&nbsp;<em>k</em>-mers Problem. Construct the de Bruijn graph from a collection of k-mers.</p>
<p>Given:&nbsp;A collection of&nbsp;<em>k</em>-mers&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;The de Bruijn graph&nbsp;<em>DeBruijn</em>(<em>Patterns</em>), in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<section id="sample-dataset-38" class="level2" data-number="38.1">
<h2 data-number="38.1" class="anchored" data-anchor-id="sample-dataset-38"><span class="header-section-number">38.1</span> Sample Dataset</h2>
<pre><code>GAGG
CAGG
GGGG
GGGA
CAGG
AGGG
GGAG</code></pre>
</section>
<section id="sample-output-38" class="level2" data-number="38.2">
<h2 data-number="38.2" class="anchored" data-anchor-id="sample-output-38"><span class="header-section-number">38.2</span> Sample Output</h2>
<pre><code>GAG -&gt; AGG
CAG -&gt; AGG,AGG
GGG -&gt; GGG,GGA
AGG -&gt; GGG
GGA -&gt; GAG</code></pre>
</section>
<section id="solution-38" class="level2" data-number="38.3">
<h2 data-number="38.3" class="anchored" data-anchor-id="solution-38"><span class="header-section-number">38.3</span> Solution</h2>
<div class="sourceCode" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    adjacency_list: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_list:</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix].append(suffix)</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="st">GAGG</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="st">GGGG</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="st">GGGA</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="st">AGGG</span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a><span class="st">GGAG</span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmer_list)</span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-an-eulerian-cycle-in-a-graph" class="level1" data-number="39">
<h1 data-number="39"><span class="header-section-number">39</span> Find an Eulerian Cycle in a Graph</h1>
<p>Eulerian Cycle Problem, Find an Eulerian cycle in a graph.</p>
<p>Given:&nbsp;An Eulerian directed graph, in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<p>Return:&nbsp;An&nbsp;<a href="https://rosalind.info/glossary/eulerian-cycle/">Eulerian cycle</a>&nbsp;in this graph.</p>
<section id="sample-dataset-39" class="level2" data-number="39.1">
<h2 data-number="39.1" class="anchored" data-anchor-id="sample-dataset-39"><span class="header-section-number">39.1</span> Sample Dataset</h2>
<pre><code>0 -&gt; 3
1 -&gt; 0
2 -&gt; 1,6
3 -&gt; 2
4 -&gt; 2
5 -&gt; 4
6 -&gt; 5,8
7 -&gt; 9
8 -&gt; 7
9 -&gt; 6</code></pre>
</section>
<section id="sample-output-39" class="level2" data-number="39.2">
<h2 data-number="39.2" class="anchored" data-anchor-id="sample-output-39"><span class="header-section-number">39.2</span> Sample Output</h2>
<pre><code>6-&gt;8-&gt;7-&gt;9-&gt;6-&gt;5-&gt;4-&gt;2-&gt;1-&gt;0-&gt;3-&gt;2-&gt;6</code></pre>
</section>
<section id="solution-39" class="level2" data-number="39.3">
<h2 data-number="39.3" class="anchored" data-anchor-id="solution-39"><span class="header-section-number">39.3</span> Solution</h2>
<div class="sourceCode" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_list_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> element <span class="kw">in</span> adjacency_list_text:</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, element)</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Form a cycle by randomly walking in the graph</span></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Form new_cycle by traversing cycle (starting at new_start) and then randomly walking</span></span>
<span id="cb120-38"><a href="#cb120-38" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb120-39"><a href="#cb120-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-40"><a href="#cb120-40" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb120-41"><a href="#cb120-41" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb120-42"><a href="#cb120-42" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb120-43"><a href="#cb120-43" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb120-44"><a href="#cb120-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb120-45"><a href="#cb120-45" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb120-46"><a href="#cb120-46" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb120-47"><a href="#cb120-47" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb120-48"><a href="#cb120-48" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb120-49"><a href="#cb120-49" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb120-50"><a href="#cb120-50" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb120-51"><a href="#cb120-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb120-52"><a href="#cb120-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-53"><a href="#cb120-53" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb120-54"><a href="#cb120-54" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 3</span></span>
<span id="cb120-55"><a href="#cb120-55" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 0</span></span>
<span id="cb120-56"><a href="#cb120-56" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1,6</span></span>
<span id="cb120-57"><a href="#cb120-57" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 2</span></span>
<span id="cb120-58"><a href="#cb120-58" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; 2</span></span>
<span id="cb120-59"><a href="#cb120-59" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 4</span></span>
<span id="cb120-60"><a href="#cb120-60" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 5,8</span></span>
<span id="cb120-61"><a href="#cb120-61" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 9</span></span>
<span id="cb120-62"><a href="#cb120-62" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 7</span></span>
<span id="cb120-63"><a href="#cb120-63" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb120-64"><a href="#cb120-64" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb120-65"><a href="#cb120-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-66"><a href="#cb120-66" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb120-67"><a href="#cb120-67" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb120-68"><a href="#cb120-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-69"><a href="#cb120-69" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_cycle(adjacency_list)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-an-eulerian-path-in-a-graph" class="level1" data-number="40">
<h1 data-number="40"><span class="header-section-number">40</span> Find an Eulerian Path in a Graph</h1>
<p>Eulerian Path Problem, Find an Eulerian path in a graph.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/directed-graph/">directed graph</a>&nbsp;that contains an Eulerian path, where the graph is given in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<p>Return:&nbsp;An Eulerian path in this graph.</p>
<section id="sample-dataset-40" class="level2" data-number="40.1">
<h2 data-number="40.1" class="anchored" data-anchor-id="sample-dataset-40"><span class="header-section-number">40.1</span> Sample Dataset</h2>
<pre><code>0 -&gt; 2
1 -&gt; 3
2 -&gt; 1
3 -&gt; 0,4
6 -&gt; 3,7
7 -&gt; 8
8 -&gt; 9
9 -&gt; 6</code></pre>
</section>
<section id="sample-output-40" class="level2" data-number="40.2">
<h2 data-number="40.2" class="anchored" data-anchor-id="sample-output-40"><span class="header-section-number">40.2</span> Sample Output</h2>
<pre><code>6-&gt;7-&gt;8-&gt;9-&gt;6-&gt;3-&gt;0-&gt;2-&gt;1-&gt;3-&gt;4</code></pre>
</section>
<section id="solution-40" class="level2" data-number="40.3">
<h2 data-number="40.3" class="anchored" data-anchor-id="solution-40"><span class="header-section-number">40.3</span> Solution</h2>
<div class="sourceCode" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-32"><a href="#cb123-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb123-33"><a href="#cb123-33" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb123-34"><a href="#cb123-34" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb123-35"><a href="#cb123-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-36"><a href="#cb123-36" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb123-37"><a href="#cb123-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-38"><a href="#cb123-38" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb123-39"><a href="#cb123-39" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb123-40"><a href="#cb123-40" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb123-41"><a href="#cb123-41" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb123-42"><a href="#cb123-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb123-43"><a href="#cb123-43" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb123-44"><a href="#cb123-44" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb123-45"><a href="#cb123-45" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb123-46"><a href="#cb123-46" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb123-47"><a href="#cb123-47" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb123-48"><a href="#cb123-48" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb123-49"><a href="#cb123-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb123-50"><a href="#cb123-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-51"><a href="#cb123-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb123-52"><a href="#cb123-52" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb123-53"><a href="#cb123-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb123-54"><a href="#cb123-54" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb123-55"><a href="#cb123-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb123-56"><a href="#cb123-56" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb123-57"><a href="#cb123-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-58"><a href="#cb123-58" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb123-59"><a href="#cb123-59" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb123-60"><a href="#cb123-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-61"><a href="#cb123-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb123-62"><a href="#cb123-62" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb123-63"><a href="#cb123-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb123-64"><a href="#cb123-64" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb123-65"><a href="#cb123-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-66"><a href="#cb123-66" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb123-67"><a href="#cb123-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb123-68"><a href="#cb123-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb123-69"><a href="#cb123-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb123-70"><a href="#cb123-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-71"><a href="#cb123-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb123-72"><a href="#cb123-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-73"><a href="#cb123-73" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb123-74"><a href="#cb123-74" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 2</span></span>
<span id="cb123-75"><a href="#cb123-75" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 3</span></span>
<span id="cb123-76"><a href="#cb123-76" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1</span></span>
<span id="cb123-77"><a href="#cb123-77" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 0,4</span></span>
<span id="cb123-78"><a href="#cb123-78" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 3,7</span></span>
<span id="cb123-79"><a href="#cb123-79" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 8</span></span>
<span id="cb123-80"><a href="#cb123-80" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 9</span></span>
<span id="cb123-81"><a href="#cb123-81" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb123-82"><a href="#cb123-82" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb123-83"><a href="#cb123-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-84"><a href="#cb123-84" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb123-85"><a href="#cb123-85" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb123-86"><a href="#cb123-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-87"><a href="#cb123-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_path(adjacency_list)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-k-mer-composition" class="level1" data-number="41">
<h1 data-number="41"><span class="header-section-number">41</span> Reconstruct a String from its k-mer Composition</h1>
<p>String Reconstruction Problem. Reconstruct a string from its k-mer composition.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;followed by a list of&nbsp;<em>k</em>-mers&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;with&nbsp;<em>k</em>-mer composition equal to&nbsp;<em>Patterns</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-41" class="level2" data-number="41.1">
<h2 data-number="41.1" class="anchored" data-anchor-id="sample-dataset-41"><span class="header-section-number">41.1</span> Sample Dataset</h2>
<pre><code>4
CTTA
ACCA
TACC
GGCT
GCTT
TTAC</code></pre>
</section>
<section id="sample-output-41" class="level2" data-number="41.2">
<h2 data-number="41.2" class="anchored" data-anchor-id="sample-output-41"><span class="header-section-number">41.2</span> Sample Output</h2>
<pre><code>GGCTTACCA</code></pre>
</section>
<section id="solution-41" class="level2" data-number="41.3">
<h2 data-number="41.3" class="anchored" data-anchor-id="solution-41"><span class="header-section-number">41.3</span> Solution</h2>
<div class="sourceCode" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb126-43"><a href="#cb126-43" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb126-44"><a href="#cb126-44" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb126-45"><a href="#cb126-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb126-46"><a href="#cb126-46" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb126-47"><a href="#cb126-47" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb126-48"><a href="#cb126-48" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb126-49"><a href="#cb126-49" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb126-50"><a href="#cb126-50" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb126-51"><a href="#cb126-51" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb126-52"><a href="#cb126-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb126-53"><a href="#cb126-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-54"><a href="#cb126-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb126-55"><a href="#cb126-55" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb126-56"><a href="#cb126-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb126-57"><a href="#cb126-57" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb126-58"><a href="#cb126-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb126-59"><a href="#cb126-59" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb126-60"><a href="#cb126-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-61"><a href="#cb126-61" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb126-62"><a href="#cb126-62" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb126-63"><a href="#cb126-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-64"><a href="#cb126-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb126-65"><a href="#cb126-65" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb126-66"><a href="#cb126-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb126-67"><a href="#cb126-67" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb126-68"><a href="#cb126-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-69"><a href="#cb126-69" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb126-70"><a href="#cb126-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb126-71"><a href="#cb126-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb126-72"><a href="#cb126-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb126-73"><a href="#cb126-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-74"><a href="#cb126-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb126-75"><a href="#cb126-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-76"><a href="#cb126-76" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb126-77"><a href="#cb126-77" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb126-78"><a href="#cb126-78" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(adjacency_list)</span>
<span id="cb126-79"><a href="#cb126-79" aria-hidden="true" tabindex="-1"></a>    reconstructed_string <span class="op">=</span> path[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb126-80"><a href="#cb126-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> path:</span>
<span id="cb126-81"><a href="#cb126-81" aria-hidden="true" tabindex="-1"></a>        reconstructed_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb126-82"><a href="#cb126-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_string</span>
<span id="cb126-83"><a href="#cb126-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-84"><a href="#cb126-84" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb126-85"><a href="#cb126-85" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb126-86"><a href="#cb126-86" aria-hidden="true" tabindex="-1"></a><span class="st">CTTA</span></span>
<span id="cb126-87"><a href="#cb126-87" aria-hidden="true" tabindex="-1"></a><span class="st">ACCA</span></span>
<span id="cb126-88"><a href="#cb126-88" aria-hidden="true" tabindex="-1"></a><span class="st">TACC</span></span>
<span id="cb126-89"><a href="#cb126-89" aria-hidden="true" tabindex="-1"></a><span class="st">GGCT</span></span>
<span id="cb126-90"><a href="#cb126-90" aria-hidden="true" tabindex="-1"></a><span class="st">GCTT</span></span>
<span id="cb126-91"><a href="#cb126-91" aria-hidden="true" tabindex="-1"></a><span class="st">TTAC</span></span>
<span id="cb126-92"><a href="#cb126-92" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb126-93"><a href="#cb126-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-94"><a href="#cb126-94" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb126-95"><a href="#cb126-95" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb126-96"><a href="#cb126-96" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">1</span>:]</span>
<span id="cb126-97"><a href="#cb126-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-98"><a href="#cb126-98" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string(kmers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-k-universal-circular-string" class="level1" data-number="42">
<h1 data-number="42"><span class="header-section-number">42</span> Find a k-Universal Circular String</h1>
<p><em>k</em>-Universal Circular String Problem. Find a k-universal circular binary string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;A&nbsp;<em>k</em>-universal circular string. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-42" class="level2" data-number="42.1">
<h2 data-number="42.1" class="anchored" data-anchor-id="sample-dataset-42"><span class="header-section-number">42.1</span> Sample Dataset</h2>
<p><code>4</code></p>
</section>
<section id="sample-output-42" class="level2" data-number="42.2">
<h2 data-number="42.2" class="anchored" data-anchor-id="sample-output-42"><span class="header-section-number">42.2</span> Sample Output</h2>
<pre><code>1111010010110000</code></pre>
</section>
<section id="solution-42" class="level2" data-number="42.3">
<h2 data-number="42.3" class="anchored" data-anchor-id="solution-42"><span class="header-section-number">42.3</span> Solution</h2>
<div class="sourceCode" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb128-33"><a href="#cb128-33" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb128-34"><a href="#cb128-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-35"><a href="#cb128-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb128-36"><a href="#cb128-36" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb128-37"><a href="#cb128-37" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb128-38"><a href="#cb128-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-39"><a href="#cb128-39" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb128-40"><a href="#cb128-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-41"><a href="#cb128-41" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb128-42"><a href="#cb128-42" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb128-43"><a href="#cb128-43" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb128-44"><a href="#cb128-44" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb128-45"><a href="#cb128-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb128-46"><a href="#cb128-46" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb128-47"><a href="#cb128-47" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb128-48"><a href="#cb128-48" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb128-49"><a href="#cb128-49" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb128-50"><a href="#cb128-50" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb128-51"><a href="#cb128-51" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb128-52"><a href="#cb128-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb128-53"><a href="#cb128-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-54"><a href="#cb128-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_k_universal_circular_string(k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb128-55"><a href="#cb128-55" aria-hidden="true" tabindex="-1"></a>    kmers: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb128-56"><a href="#cb128-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span> <span class="op">**</span> k):</span>
<span id="cb128-57"><a href="#cb128-57" aria-hidden="true" tabindex="-1"></a>        kmer <span class="op">=</span> <span class="bu">format</span>(i, <span class="ss">f'0</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">b'</span>)</span>
<span id="cb128-58"><a href="#cb128-58" aria-hidden="true" tabindex="-1"></a>        kmers.append(kmer)</span>
<span id="cb128-59"><a href="#cb128-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-60"><a href="#cb128-60" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb128-61"><a href="#cb128-61" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(adjacency_list)</span>
<span id="cb128-62"><a href="#cb128-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-63"><a href="#cb128-63" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> cycle[:<span class="bu">len</span>(cycle) <span class="op">-</span> k <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb128-64"><a href="#cb128-64" aria-hidden="true" tabindex="-1"></a>    circular_string <span class="op">=</span> cycle[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb128-65"><a href="#cb128-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> cycle:</span>
<span id="cb128-66"><a href="#cb128-66" aria-hidden="true" tabindex="-1"></a>        circular_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb128-67"><a href="#cb128-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> circular_string</span>
<span id="cb128-68"><a href="#cb128-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-69"><a href="#cb128-69" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb128-70"><a href="#cb128-70" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb128-71"><a href="#cb128-71" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb128-72"><a href="#cb128-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-73"><a href="#cb128-73" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb128-74"><a href="#cb128-74" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb128-75"><a href="#cb128-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-76"><a href="#cb128-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generate_k_universal_circular_string(k))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-paired-composition" class="level1" data-number="43">
<h1 data-number="43"><span class="header-section-number">43</span> Reconstruct a String from its Paired Composition</h1>
<p>String Reconstruction from Read-Pairs Problem. Reconstruct a string from its paired composition.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>&nbsp;followed by a collection of paired&nbsp;<em>k</em>-mers&nbsp;<em>PairedReads</em>.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;with (<em>k</em>,&nbsp;<em>d</em>)-mer composition equal to&nbsp;<em>PairedReads</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-43" class="level2" data-number="43.1">
<h2 data-number="43.1" class="anchored" data-anchor-id="sample-dataset-43"><span class="header-section-number">43.1</span> Sample Dataset</h2>
<pre><code>4 2
GAGA|TTGA
TCGT|GATG
CGTG|ATGT
TGGT|TGAG
GTGA|TGTT
GTGG|GTGA
TGAG|GTTG
GGTC|GAGA
GTCG|AGAT</code></pre>
</section>
<section id="sample-output-43" class="level2" data-number="43.2">
<h2 data-number="43.2" class="anchored" data-anchor-id="sample-output-43"><span class="header-section-number">43.2</span> Sample Output</h2>
<pre><code>GTGGTCGTGAGATGTTGA</code></pre>
</section>
<section id="solution-43" class="level2" data-number="43.3">
<h2 data-number="43.3" class="anchored" data-anchor-id="solution-43"><span class="header-section-number">43.3</span> Solution</h2>
<div class="sourceCode" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb131-50"><a href="#cb131-50" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb131-51"><a href="#cb131-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-52"><a href="#cb131-52" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb131-53"><a href="#cb131-53" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb131-54"><a href="#cb131-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-55"><a href="#cb131-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb131-56"><a href="#cb131-56" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb131-57"><a href="#cb131-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb131-58"><a href="#cb131-58" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb131-59"><a href="#cb131-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-60"><a href="#cb131-60" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb131-61"><a href="#cb131-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb131-62"><a href="#cb131-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb131-63"><a href="#cb131-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb131-64"><a href="#cb131-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-65"><a href="#cb131-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb131-66"><a href="#cb131-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-67"><a href="#cb131-67" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph_paired_reads(paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]]:</span>
<span id="cb131-68"><a href="#cb131-68" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb131-69"><a href="#cb131-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pair <span class="kw">in</span> paired_reads:</span>
<span id="cb131-70"><a href="#cb131-70" aria-hidden="true" tabindex="-1"></a>        graph[(pair[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>], pair[<span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>])].append((pair[<span class="dv">0</span>][<span class="dv">1</span>:], pair[<span class="dv">1</span>][<span class="dv">1</span>:]))</span>
<span id="cb131-71"><a href="#cb131-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb131-72"><a href="#cb131-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-73"><a href="#cb131-73" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> string_spelled_by_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb131-74"><a href="#cb131-74" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb131-75"><a href="#cb131-75" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">1</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>]</span>
<span id="cb131-76"><a href="#cb131-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-77"><a href="#cb131-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb131-78"><a href="#cb131-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb131-79"><a href="#cb131-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb131-80"><a href="#cb131-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb131-81"><a href="#cb131-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-82"><a href="#cb131-82" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_read_pairs(k: <span class="bu">int</span>, d: <span class="bu">int</span>, paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb131-83"><a href="#cb131-83" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph_paired_reads(paired_reads)</span>
<span id="cb131-84"><a href="#cb131-84" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(graph)</span>
<span id="cb131-85"><a href="#cb131-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> string_spelled_by_gapped_patterns(path, k <span class="op">-</span> <span class="dv">1</span>, d)</span>
<span id="cb131-86"><a href="#cb131-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-87"><a href="#cb131-87" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb131-88"><a href="#cb131-88" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb131-89"><a href="#cb131-89" aria-hidden="true" tabindex="-1"></a><span class="st">GAGA|TTGA</span></span>
<span id="cb131-90"><a href="#cb131-90" aria-hidden="true" tabindex="-1"></a><span class="st">TCGT|GATG</span></span>
<span id="cb131-91"><a href="#cb131-91" aria-hidden="true" tabindex="-1"></a><span class="st">CGTG|ATGT</span></span>
<span id="cb131-92"><a href="#cb131-92" aria-hidden="true" tabindex="-1"></a><span class="st">TGGT|TGAG</span></span>
<span id="cb131-93"><a href="#cb131-93" aria-hidden="true" tabindex="-1"></a><span class="st">GTGA|TGTT</span></span>
<span id="cb131-94"><a href="#cb131-94" aria-hidden="true" tabindex="-1"></a><span class="st">GTGG|GTGA</span></span>
<span id="cb131-95"><a href="#cb131-95" aria-hidden="true" tabindex="-1"></a><span class="st">TGAG|GTTG</span></span>
<span id="cb131-96"><a href="#cb131-96" aria-hidden="true" tabindex="-1"></a><span class="st">GGTC|GAGA</span></span>
<span id="cb131-97"><a href="#cb131-97" aria-hidden="true" tabindex="-1"></a><span class="st">GTCG|AGAT</span></span>
<span id="cb131-98"><a href="#cb131-98" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb131-99"><a href="#cb131-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-100"><a href="#cb131-100" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb131-101"><a href="#cb131-101" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb131-102"><a href="#cb131-102" aria-hidden="true" tabindex="-1"></a>paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb131-103"><a href="#cb131-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-104"><a href="#cb131-104" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_read_pairs(k, d, paired_reads))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-contigs-from-a-collection-of-reads" class="level1" data-number="44">
<h1 data-number="44"><span class="header-section-number">44</span> Generate Contigs from a Collection of Reads</h1>
<p>Contig Generation Problem. Generate the contigs from a collection of reads (with imperfect coverage).</p>
<p>Given:&nbsp;A collection of k-mers&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;All contigs in&nbsp;<em>DeBruijn(Patterns)</em>. (You may return the strings in any order.)</p>
<section id="sample-dataset-44" class="level2" data-number="44.1">
<h2 data-number="44.1" class="anchored" data-anchor-id="sample-dataset-44"><span class="header-section-number">44.1</span> Sample Dataset</h2>
<pre><code>ATG
ATG
TGT
TGG
CAT
GGA
GAT
AGA</code></pre>
</section>
<section id="sample-output-44" class="level2" data-number="44.2">
<h2 data-number="44.2" class="anchored" data-anchor-id="sample-output-44"><span class="header-section-number">44.2</span> Sample Output</h2>
<pre><code>AGA ATG ATG CAT GAT TGGA TGT</code></pre>
</section>
<section id="solution-44" class="level2" data-number="44.3">
<h2 data-number="44.3" class="anchored" data-anchor-id="solution-44"><span class="header-section-number">44.3</span> Solution</h2>
<div class="sourceCode" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>        prefix, suffix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>], kmer[<span class="dv">1</span>:]</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[prefix].append(suffix)</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb134-23"><a href="#cb134-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb134-24"><a href="#cb134-24" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(targets)]</span>
<span id="cb134-25"><a href="#cb134-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb134-26"><a href="#cb134-26" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(targets)</span>
<span id="cb134-27"><a href="#cb134-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-28"><a href="#cb134-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb134-29"><a href="#cb134-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> target <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb134-30"><a href="#cb134-30" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb134-31"><a href="#cb134-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb134-32"><a href="#cb134-32" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb134-33"><a href="#cb134-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-34"><a href="#cb134-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb134-35"><a href="#cb134-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb134-36"><a href="#cb134-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb134-37"><a href="#cb134-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb134-38"><a href="#cb134-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb134-39"><a href="#cb134-39" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb134-40"><a href="#cb134-40" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb134-41"><a href="#cb134-41" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb134-42"><a href="#cb134-42" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb134-43"><a href="#cb134-43" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb134-44"><a href="#cb134-44" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb134-45"><a href="#cb134-45" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb134-46"><a href="#cb134-46" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb134-47"><a href="#cb134-47" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb134-48"><a href="#cb134-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-49"><a href="#cb134-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb134-50"><a href="#cb134-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb134-51"><a href="#cb134-51" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb134-52"><a href="#cb134-52" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb134-53"><a href="#cb134-53" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb134-54"><a href="#cb134-54" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb134-55"><a href="#cb134-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb134-56"><a href="#cb134-56" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb134-57"><a href="#cb134-57" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb134-58"><a href="#cb134-58" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb134-59"><a href="#cb134-59" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb134-60"><a href="#cb134-60" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb134-61"><a href="#cb134-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-62"><a href="#cb134-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb134-63"><a href="#cb134-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-64"><a href="#cb134-64" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_contigs(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb134-65"><a href="#cb134-65" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb134-66"><a href="#cb134-66" aria-hidden="true" tabindex="-1"></a>    paths <span class="op">=</span> find_maximal_non_branching_paths(graph)</span>
<span id="cb134-67"><a href="#cb134-67" aria-hidden="true" tabindex="-1"></a>    contigs: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb134-68"><a href="#cb134-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> path <span class="kw">in</span> paths:</span>
<span id="cb134-69"><a href="#cb134-69" aria-hidden="true" tabindex="-1"></a>        contig <span class="op">=</span> path[<span class="dv">0</span>]</span>
<span id="cb134-70"><a href="#cb134-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> path[<span class="dv">1</span>:]:</span>
<span id="cb134-71"><a href="#cb134-71" aria-hidden="true" tabindex="-1"></a>            contig <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb134-72"><a href="#cb134-72" aria-hidden="true" tabindex="-1"></a>        contigs.append(contig)</span>
<span id="cb134-73"><a href="#cb134-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> contigs</span>
<span id="cb134-74"><a href="#cb134-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-75"><a href="#cb134-75" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb134-76"><a href="#cb134-76" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb134-77"><a href="#cb134-77" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb134-78"><a href="#cb134-78" aria-hidden="true" tabindex="-1"></a><span class="st">TGT</span></span>
<span id="cb134-79"><a href="#cb134-79" aria-hidden="true" tabindex="-1"></a><span class="st">TGG</span></span>
<span id="cb134-80"><a href="#cb134-80" aria-hidden="true" tabindex="-1"></a><span class="st">CAT</span></span>
<span id="cb134-81"><a href="#cb134-81" aria-hidden="true" tabindex="-1"></a><span class="st">GGA</span></span>
<span id="cb134-82"><a href="#cb134-82" aria-hidden="true" tabindex="-1"></a><span class="st">GAT</span></span>
<span id="cb134-83"><a href="#cb134-83" aria-hidden="true" tabindex="-1"></a><span class="st">AGA</span></span>
<span id="cb134-84"><a href="#cb134-84" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb134-85"><a href="#cb134-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-86"><a href="#cb134-86" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb134-87"><a href="#cb134-87" aria-hidden="true" tabindex="-1"></a>contigs <span class="op">=</span> generate_contigs(kmers)</span>
<span id="cb134-88"><a href="#cb134-88" aria-hidden="true" tabindex="-1"></a>contigs.sort()</span>
<span id="cb134-89"><a href="#cb134-89" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(contigs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-string-spelled-by-a-gapped-genome-path" class="level1" data-number="45">
<h1 data-number="45"><span class="header-section-number">45</span> Construct a String Spelled by a Gapped Genome Path</h1>
<p>Gapped Genome Path String Problem. Reconstruct a string from a sequence of (k,d)-mers corresponding to a path in a paired de Bruijn graph.</p>
<p>Given:&nbsp;A sequence of&nbsp;<em>(k, d)</em>-mers (<em>a1|b1</em>),…, (<em>an|bn</em>) such that&nbsp;<em>Suffix(ai|bi) = Prefix(ai+1|bi+1)</em>&nbsp;for all&nbsp;<em>i</em>&nbsp;from 1 to n-1.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;where the&nbsp;<em>i</em>-th&nbsp;<em>k</em>-mer in&nbsp;<em>Text</em>&nbsp;is equal to&nbsp;<em>Suffix(ai|bi)</em>&nbsp;for all&nbsp;<em>i</em>&nbsp;from 1 to n, if such a string exists.</p>
<section id="sample-dataset-45" class="level2" data-number="45.1">
<h2 data-number="45.1" class="anchored" data-anchor-id="sample-dataset-45"><span class="header-section-number">45.1</span> Sample Dataset</h2>
<pre><code>4 2
GACC|GCGC
ACCG|CGCC
CCGA|GCCG
CGAG|CCGG
GAGC|CGGA</code></pre>
</section>
<section id="sample-output-45" class="level2" data-number="45.2">
<h2 data-number="45.2" class="anchored" data-anchor-id="sample-output-45"><span class="header-section-number">45.2</span> Sample Output</h2>
<pre><code>GACCGAGCGCCGGA</code></pre>
</section>
<section id="solution-45" class="level2" data-number="45.3">
<h2 data-number="45.3" class="anchored" data-anchor-id="solution-45"><span class="header-section-number">45.3</span> Solution</h2>
<div class="sourceCode" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (prefix, suffix) <span class="kw">in</span> <span class="bu">enumerate</span>(gapped_patterns):</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">!=</span> <span class="bu">len</span>(gapped_patterns) <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix[<span class="dv">0</span>]</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix[<span class="dv">0</span>]</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a><span class="st">GACC|GCGC</span></span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a><span class="st">ACCG|CGCC</span></span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a><span class="st">CCGA|GCCG</span></span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a><span class="st">CGAG|CCGG</span></span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a><span class="st">GAGC|CGGA</span></span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a>gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb137-32"><a href="#cb137-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-33"><a href="#cb137-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_gapped_patterns(gapped_patterns, k <span class="op">-</span> <span class="dv">1</span>, d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-all-maximal-non-branching-paths-in-a-graph" class="level1" data-number="46">
<h1 data-number="46"><span class="header-section-number">46</span> Generate All Maximal Non-Branching Paths in a Graph</h1>
<p>Maximal Non-Branching Path Problem. Find all maximal non-branching paths in a graph.</p>
<p>Given:&nbsp;The adjacency list of a graph whose nodes are integers.</p>
<p>Return:&nbsp;The collection of all maximal non-branching paths in the graph.</p>
<section id="sample-dataset-46" class="level2" data-number="46.1">
<h2 data-number="46.1" class="anchored" data-anchor-id="sample-dataset-46"><span class="header-section-number">46.1</span> Sample Dataset</h2>
<pre><code>1 -&gt; 2
2 -&gt; 3
3 -&gt; 4,5
6 -&gt; 7
7 -&gt; 6</code></pre>
</section>
<section id="sample-output-46" class="level2" data-number="46.2">
<h2 data-number="46.2" class="anchored" data-anchor-id="sample-output-46"><span class="header-section-number">46.2</span> Sample Output</h2>
<pre><code>1 -&gt; 2 -&gt; 3
3 -&gt; 4
3 -&gt; 5
6 -&gt; 7 -&gt; 6</code></pre>
</section>
<section id="solution-46" class="level2" data-number="46.3">
<h2 data-number="46.3" class="anchored" data-anchor-id="solution-46"><span class="header-section-number">46.3</span> Solution</h2>
<div class="sourceCode" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>        source, targets <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[source] <span class="op">=</span> targets.split(<span class="st">','</span>)</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(neighbors)]</span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(neighbors)</span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-28"><a href="#cb140-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb140-29"><a href="#cb140-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb140-30"><a href="#cb140-30" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb140-31"><a href="#cb140-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb140-32"><a href="#cb140-32" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb140-33"><a href="#cb140-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-34"><a href="#cb140-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb140-35"><a href="#cb140-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb140-36"><a href="#cb140-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb140-37"><a href="#cb140-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb140-38"><a href="#cb140-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb140-39"><a href="#cb140-39" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb140-40"><a href="#cb140-40" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb140-41"><a href="#cb140-41" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb140-42"><a href="#cb140-42" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb140-43"><a href="#cb140-43" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb140-44"><a href="#cb140-44" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb140-45"><a href="#cb140-45" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb140-46"><a href="#cb140-46" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb140-47"><a href="#cb140-47" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb140-48"><a href="#cb140-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-49"><a href="#cb140-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb140-50"><a href="#cb140-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb140-51"><a href="#cb140-51" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb140-52"><a href="#cb140-52" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb140-53"><a href="#cb140-53" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb140-54"><a href="#cb140-54" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb140-55"><a href="#cb140-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb140-56"><a href="#cb140-56" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb140-57"><a href="#cb140-57" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb140-58"><a href="#cb140-58" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb140-59"><a href="#cb140-59" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb140-60"><a href="#cb140-60" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb140-61"><a href="#cb140-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-62"><a href="#cb140-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb140-63"><a href="#cb140-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-64"><a href="#cb140-64" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb140-65"><a href="#cb140-65" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 2</span></span>
<span id="cb140-66"><a href="#cb140-66" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 3</span></span>
<span id="cb140-67"><a href="#cb140-67" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 4,5</span></span>
<span id="cb140-68"><a href="#cb140-68" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 7</span></span>
<span id="cb140-69"><a href="#cb140-69" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 6</span></span>
<span id="cb140-70"><a href="#cb140-70" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb140-71"><a href="#cb140-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-72"><a href="#cb140-72" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb140-73"><a href="#cb140-73" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb140-74"><a href="#cb140-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-75"><a href="#cb140-75" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_maximal_non_branching_paths(adjacency_list)</span>
<span id="cb140-76"><a href="#cb140-76" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> path <span class="kw">in</span> result:</span>
<span id="cb140-77"><a href="#cb140-77" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">" -&gt; "</span>.join(path))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="translate-an-rna-string-into-an-amino-acid-string" class="level1" data-number="47">
<h1 data-number="47"><span class="header-section-number">47</span> Translate an RNA String into an Amino Acid String</h1>
<p>Protein Translation Problem. Translate an&nbsp;<a href="https://rosalind.info/glossary/rna-string/">RNA string</a>&nbsp;into an&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid string</a>.</p>
<p>Given:&nbsp;An RNA string&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;The translation of&nbsp;<em>Pattern</em>&nbsp;into an amino acid string&nbsp;<em>Peptide</em>.</p>
<section id="sample-dataset-47" class="level2" data-number="47.1">
<h2 data-number="47.1" class="anchored" data-anchor-id="sample-dataset-47"><span class="header-section-number">47.1</span> Sample Dataset</h2>
<pre><code>AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA</code></pre>
</section>
<section id="sample-output-47" class="level2" data-number="47.2">
<h2 data-number="47.2" class="anchored" data-anchor-id="sample-output-47"><span class="header-section-number">47.2</span> Sample Output</h2>
<pre><code>MAMAPRTEINSTRING</code></pre>
</section>
<section id="solution-47" class="level2" data-number="47.3">
<h2 data-number="47.3" class="anchored" data-anchor-id="solution-47"><span class="header-section-number">47.3</span> Solution</h2>
<div class="sourceCode" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> translate_rna_to_protein(rna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># RNA 코돈을 아미노산으로 변환하는 딕셔너리</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    codon_table: Dict[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> {</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UUU'</span>: <span class="st">'F'</span>, <span class="st">'UUC'</span>: <span class="st">'F'</span>, <span class="st">'UUA'</span>: <span class="st">'L'</span>, <span class="st">'UUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UCU'</span>: <span class="st">'S'</span>, <span class="st">'UCC'</span>: <span class="st">'S'</span>, <span class="st">'UCA'</span>: <span class="st">'S'</span>, <span class="st">'UCG'</span>: <span class="st">'S'</span>,</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UAU'</span>: <span class="st">'Y'</span>, <span class="st">'UAC'</span>: <span class="st">'Y'</span>, <span class="st">'UAA'</span>: <span class="st">'*'</span>, <span class="st">'UAG'</span>: <span class="st">'*'</span>,</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UGU'</span>: <span class="st">'C'</span>, <span class="st">'UGC'</span>: <span class="st">'C'</span>, <span class="st">'UGA'</span>: <span class="st">'*'</span>, <span class="st">'UGG'</span>: <span class="st">'W'</span>,</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CUU'</span>: <span class="st">'L'</span>, <span class="st">'CUC'</span>: <span class="st">'L'</span>, <span class="st">'CUA'</span>: <span class="st">'L'</span>, <span class="st">'CUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CCU'</span>: <span class="st">'P'</span>, <span class="st">'CCC'</span>: <span class="st">'P'</span>, <span class="st">'CCA'</span>: <span class="st">'P'</span>, <span class="st">'CCG'</span>: <span class="st">'P'</span>,</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CAU'</span>: <span class="st">'H'</span>, <span class="st">'CAC'</span>: <span class="st">'H'</span>, <span class="st">'CAA'</span>: <span class="st">'Q'</span>, <span class="st">'CAG'</span>: <span class="st">'Q'</span>,</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CGU'</span>: <span class="st">'R'</span>, <span class="st">'CGC'</span>: <span class="st">'R'</span>, <span class="st">'CGA'</span>: <span class="st">'R'</span>, <span class="st">'CGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AUU'</span>: <span class="st">'I'</span>, <span class="st">'AUC'</span>: <span class="st">'I'</span>, <span class="st">'AUA'</span>: <span class="st">'I'</span>, <span class="st">'AUG'</span>: <span class="st">'M'</span>,</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ACU'</span>: <span class="st">'T'</span>, <span class="st">'ACC'</span>: <span class="st">'T'</span>, <span class="st">'ACA'</span>: <span class="st">'T'</span>, <span class="st">'ACG'</span>: <span class="st">'T'</span>,</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AAU'</span>: <span class="st">'N'</span>, <span class="st">'AAC'</span>: <span class="st">'N'</span>, <span class="st">'AAA'</span>: <span class="st">'K'</span>, <span class="st">'AAG'</span>: <span class="st">'K'</span>,</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AGU'</span>: <span class="st">'S'</span>, <span class="st">'AGC'</span>: <span class="st">'S'</span>, <span class="st">'AGA'</span>: <span class="st">'R'</span>, <span class="st">'AGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GUU'</span>: <span class="st">'V'</span>, <span class="st">'GUC'</span>: <span class="st">'V'</span>, <span class="st">'GUA'</span>: <span class="st">'V'</span>, <span class="st">'GUG'</span>: <span class="st">'V'</span>,</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GCU'</span>: <span class="st">'A'</span>, <span class="st">'GCC'</span>: <span class="st">'A'</span>, <span class="st">'GCA'</span>: <span class="st">'A'</span>, <span class="st">'GCG'</span>: <span class="st">'A'</span>,</span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GAU'</span>: <span class="st">'D'</span>, <span class="st">'GAC'</span>: <span class="st">'D'</span>, <span class="st">'GAA'</span>: <span class="st">'E'</span>, <span class="st">'GAG'</span>: <span class="st">'E'</span>,</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GGU'</span>: <span class="st">'G'</span>, <span class="st">'GGC'</span>: <span class="st">'G'</span>, <span class="st">'GGA'</span>: <span class="st">'G'</span>, <span class="st">'GGG'</span>: <span class="st">'G'</span></span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>    protein_sequence: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># RNA 서열을 3개의 뉴클레오티드(코돈)씩 나누어 처리</span></span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(rna_sequence), <span class="dv">3</span>):</span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a>        codon: <span class="bu">str</span> <span class="op">=</span> rna_sequence[i:i<span class="op">+</span><span class="dv">3</span>]</span>
<span id="cb143-29"><a href="#cb143-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb143-30"><a href="#cb143-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 코돈이 3개의 뉴클레오티드로 완전하지 않으면 중단</span></span>
<span id="cb143-31"><a href="#cb143-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(codon) <span class="op">!=</span> <span class="dv">3</span>:</span>
<span id="cb143-32"><a href="#cb143-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb143-33"><a href="#cb143-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb143-34"><a href="#cb143-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 코돈을 아미노산으로 변환</span></span>
<span id="cb143-35"><a href="#cb143-35" aria-hidden="true" tabindex="-1"></a>        amino_acid: <span class="bu">str</span> <span class="op">=</span> codon_table.get(codon, <span class="st">''</span>)</span>
<span id="cb143-36"><a href="#cb143-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb143-37"><a href="#cb143-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 종결 코돈('*')을 만나면 번역 중단</span></span>
<span id="cb143-38"><a href="#cb143-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> amino_acid <span class="op">==</span> <span class="st">'*'</span>:</span>
<span id="cb143-39"><a href="#cb143-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb143-40"><a href="#cb143-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb143-41"><a href="#cb143-41" aria-hidden="true" tabindex="-1"></a>        protein_sequence <span class="op">+=</span> amino_acid</span>
<span id="cb143-42"><a href="#cb143-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-43"><a href="#cb143-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> protein_sequence</span>
<span id="cb143-44"><a href="#cb143-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-45"><a href="#cb143-45" aria-hidden="true" tabindex="-1"></a><span class="co"># 입력 RNA 서열</span></span>
<span id="cb143-46"><a href="#cb143-46" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb143-47"><a href="#cb143-47" aria-hidden="true" tabindex="-1"></a><span class="st">AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA</span></span>
<span id="cb143-48"><a href="#cb143-48" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb143-49"><a href="#cb143-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-50"><a href="#cb143-50" aria-hidden="true" tabindex="-1"></a>rna_sequence: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span>.join(sample_input.strip().split())</span>
<span id="cb143-51"><a href="#cb143-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-52"><a href="#cb143-52" aria-hidden="true" tabindex="-1"></a><span class="co"># RNA를 단백질로 번역</span></span>
<span id="cb143-53"><a href="#cb143-53" aria-hidden="true" tabindex="-1"></a>protein: <span class="bu">str</span> <span class="op">=</span> translate_rna_to_protein(rna_sequence)</span>
<span id="cb143-54"><a href="#cb143-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-55"><a href="#cb143-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(protein)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-substrings-of-a-genome-encoding-a-given-amino-acid-string" class="level1" data-number="48">
<h1 data-number="48"><span class="header-section-number">48</span> Find Substrings of a Genome Encoding a Given Amino Acid String</h1>
<p>Peptide Encoding Problem, Find substrings of a genome encoding a given amino acid sequence.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Text</em>&nbsp;and an&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid string</a>&nbsp;<em>Peptide</em>.</p>
<p>Return:&nbsp;All substrings of&nbsp;<em>Text</em>&nbsp;encoding&nbsp;<em>Peptide</em>&nbsp;(if any such substrings exist).</p>
<section id="sample-dataset-48" class="level2" data-number="48.1">
<h2 data-number="48.1" class="anchored" data-anchor-id="sample-dataset-48"><span class="header-section-number">48.1</span> Sample Dataset</h2>
<pre><code>ATGGCCATGGCCCCCAGAACTGAGATCAATAGTACCCGTATTAACGGGTGA
MA</code></pre>
</section>
<section id="sample-output-48" class="level2" data-number="48.2">
<h2 data-number="48.2" class="anchored" data-anchor-id="sample-output-48"><span class="header-section-number">48.2</span> Sample Output</h2>
<pre><code>ATGGCC
GGCCAT
ATGGCC</code></pre>
</section>
<section id="solution-48" class="level2" data-number="48.3">
<h2 data-number="48.3" class="anchored" data-anchor-id="solution-48"><span class="header-section-number">48.3</span> Solution</h2>
<div class="sourceCode" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> translate_rna_to_protein(rna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>    codon_to_amino_acid: Dict[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> {</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UUU'</span>: <span class="st">'F'</span>, <span class="st">'UUC'</span>: <span class="st">'F'</span>, <span class="st">'UUA'</span>: <span class="st">'L'</span>, <span class="st">'UUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UCU'</span>: <span class="st">'S'</span>, <span class="st">'UCC'</span>: <span class="st">'S'</span>, <span class="st">'UCA'</span>: <span class="st">'S'</span>, <span class="st">'UCG'</span>: <span class="st">'S'</span>,</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UAU'</span>: <span class="st">'Y'</span>, <span class="st">'UAC'</span>: <span class="st">'Y'</span>, <span class="st">'UAA'</span>: <span class="st">'*'</span>, <span class="st">'UAG'</span>: <span class="st">'*'</span>,</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UGU'</span>: <span class="st">'C'</span>, <span class="st">'UGC'</span>: <span class="st">'C'</span>, <span class="st">'UGA'</span>: <span class="st">'*'</span>, <span class="st">'UGG'</span>: <span class="st">'W'</span>,</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CUU'</span>: <span class="st">'L'</span>, <span class="st">'CUC'</span>: <span class="st">'L'</span>, <span class="st">'CUA'</span>: <span class="st">'L'</span>, <span class="st">'CUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CCU'</span>: <span class="st">'P'</span>, <span class="st">'CCC'</span>: <span class="st">'P'</span>, <span class="st">'CCA'</span>: <span class="st">'P'</span>, <span class="st">'CCG'</span>: <span class="st">'P'</span>,</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CAU'</span>: <span class="st">'H'</span>, <span class="st">'CAC'</span>: <span class="st">'H'</span>, <span class="st">'CAA'</span>: <span class="st">'Q'</span>, <span class="st">'CAG'</span>: <span class="st">'Q'</span>,</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CGU'</span>: <span class="st">'R'</span>, <span class="st">'CGC'</span>: <span class="st">'R'</span>, <span class="st">'CGA'</span>: <span class="st">'R'</span>, <span class="st">'CGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AUU'</span>: <span class="st">'I'</span>, <span class="st">'AUC'</span>: <span class="st">'I'</span>, <span class="st">'AUA'</span>: <span class="st">'I'</span>, <span class="st">'AUG'</span>: <span class="st">'M'</span>,</span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ACU'</span>: <span class="st">'T'</span>, <span class="st">'ACC'</span>: <span class="st">'T'</span>, <span class="st">'ACA'</span>: <span class="st">'T'</span>, <span class="st">'ACG'</span>: <span class="st">'T'</span>,</span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AAU'</span>: <span class="st">'N'</span>, <span class="st">'AAC'</span>: <span class="st">'N'</span>, <span class="st">'AAA'</span>: <span class="st">'K'</span>, <span class="st">'AAG'</span>: <span class="st">'K'</span>,</span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AGU'</span>: <span class="st">'S'</span>, <span class="st">'AGC'</span>: <span class="st">'S'</span>, <span class="st">'AGA'</span>: <span class="st">'R'</span>, <span class="st">'AGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GUU'</span>: <span class="st">'V'</span>, <span class="st">'GUC'</span>: <span class="st">'V'</span>, <span class="st">'GUA'</span>: <span class="st">'V'</span>, <span class="st">'GUG'</span>: <span class="st">'V'</span>,</span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GCU'</span>: <span class="st">'A'</span>, <span class="st">'GCC'</span>: <span class="st">'A'</span>, <span class="st">'GCA'</span>: <span class="st">'A'</span>, <span class="st">'GCG'</span>: <span class="st">'A'</span>,</span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GAU'</span>: <span class="st">'D'</span>, <span class="st">'GAC'</span>: <span class="st">'D'</span>, <span class="st">'GAA'</span>: <span class="st">'E'</span>, <span class="st">'GAG'</span>: <span class="st">'E'</span>,</span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GGU'</span>: <span class="st">'G'</span>, <span class="st">'GGC'</span>: <span class="st">'G'</span>, <span class="st">'GGA'</span>: <span class="st">'G'</span>, <span class="st">'GGG'</span>: <span class="st">'G'</span></span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb146-23"><a href="#cb146-23" aria-hidden="true" tabindex="-1"></a>    protein_sequence: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb146-24"><a href="#cb146-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb146-25"><a href="#cb146-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(rna_sequence), <span class="dv">3</span>):</span>
<span id="cb146-26"><a href="#cb146-26" aria-hidden="true" tabindex="-1"></a>        codon: <span class="bu">str</span> <span class="op">=</span> rna_sequence[i:i<span class="op">+</span><span class="dv">3</span>]</span>
<span id="cb146-27"><a href="#cb146-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb146-28"><a href="#cb146-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(codon) <span class="op">!=</span> <span class="dv">3</span>:</span>
<span id="cb146-29"><a href="#cb146-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb146-30"><a href="#cb146-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb146-31"><a href="#cb146-31" aria-hidden="true" tabindex="-1"></a>        amino_acid: <span class="bu">str</span> <span class="op">=</span> codon_to_amino_acid.get(codon, <span class="st">''</span>)</span>
<span id="cb146-32"><a href="#cb146-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb146-33"><a href="#cb146-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> amino_acid <span class="op">==</span> <span class="st">'*'</span>:</span>
<span id="cb146-34"><a href="#cb146-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb146-35"><a href="#cb146-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb146-36"><a href="#cb146-36" aria-hidden="true" tabindex="-1"></a>        protein_sequence.append(amino_acid)</span>
<span id="cb146-37"><a href="#cb146-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb146-38"><a href="#cb146-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span>.join(protein_sequence)</span>
<span id="cb146-39"><a href="#cb146-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-40"><a href="#cb146-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(dna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb146-41"><a href="#cb146-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb146-42"><a href="#cb146-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-43"><a href="#cb146-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dna_to_rna(dna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb146-44"><a href="#cb146-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence.replace(<span class="st">"T"</span>, <span class="st">"U"</span>)</span>
<span id="cb146-45"><a href="#cb146-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-46"><a href="#cb146-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_peptide_encoding_substrings(dna_sequence: <span class="bu">str</span>, peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb146-47"><a href="#cb146-47" aria-hidden="true" tabindex="-1"></a>    substring_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(peptide) <span class="op">*</span> <span class="dv">3</span></span>
<span id="cb146-48"><a href="#cb146-48" aria-hidden="true" tabindex="-1"></a>    encoding_substrings: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb146-49"><a href="#cb146-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-50"><a href="#cb146-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb146-51"><a href="#cb146-51" aria-hidden="true" tabindex="-1"></a>        dna_substring: <span class="bu">str</span> <span class="op">=</span> dna_sequence[i:i <span class="op">+</span> substring_length]</span>
<span id="cb146-52"><a href="#cb146-52" aria-hidden="true" tabindex="-1"></a>        reverse_complement_substring: <span class="bu">str</span> <span class="op">=</span> reverse_complement(dna_substring)</span>
<span id="cb146-53"><a href="#cb146-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-54"><a href="#cb146-54" aria-hidden="true" tabindex="-1"></a>        rna_substring: <span class="bu">str</span> <span class="op">=</span> dna_to_rna(dna_substring)</span>
<span id="cb146-55"><a href="#cb146-55" aria-hidden="true" tabindex="-1"></a>        reverse_complement_rna: <span class="bu">str</span> <span class="op">=</span> dna_to_rna(reverse_complement_substring)</span>
<span id="cb146-56"><a href="#cb146-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-57"><a href="#cb146-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (translate_rna_to_protein(rna_substring) <span class="op">==</span> peptide <span class="kw">or</span> </span>
<span id="cb146-58"><a href="#cb146-58" aria-hidden="true" tabindex="-1"></a>            translate_rna_to_protein(reverse_complement_rna) <span class="op">==</span> peptide):</span>
<span id="cb146-59"><a href="#cb146-59" aria-hidden="true" tabindex="-1"></a>            encoding_substrings.append(dna_substring)</span>
<span id="cb146-60"><a href="#cb146-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-61"><a href="#cb146-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> encoding_substrings</span>
<span id="cb146-62"><a href="#cb146-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-63"><a href="#cb146-63" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb146-64"><a href="#cb146-64" aria-hidden="true" tabindex="-1"></a><span class="st">ATGGCCATGGCCCCCAGAACTGAGATCAATAGTACCCGTATTAACGGGTGA</span></span>
<span id="cb146-65"><a href="#cb146-65" aria-hidden="true" tabindex="-1"></a><span class="st">MA</span></span>
<span id="cb146-66"><a href="#cb146-66" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb146-67"><a href="#cb146-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-68"><a href="#cb146-68" aria-hidden="true" tabindex="-1"></a>dna_sequence, peptide <span class="op">=</span> sample_input.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb146-69"><a href="#cb146-69" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> find_peptide_encoding_substrings(dna_sequence, peptide)</span>
<span id="cb146-70"><a href="#cb146-70" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-theoretical-spectrum-of-a-cyclic-peptide" class="level1" data-number="49">
<h1 data-number="49"><span class="header-section-number">49</span> Generate the Theoretical Spectrum of a Cyclic Peptide</h1>
<p>Generating Theoretical Spectrum Problem, Generate the theoretical spectrum of a cyclic peptide.</p>
<p>Given:&nbsp;An amino acid string&nbsp;<em>Peptide</em>.</p>
<p>Return:&nbsp;<em>Cyclospectrum</em>(<em>Peptide</em>).</p>
<section id="sample-dataset-49" class="level2" data-number="49.1">
<h2 data-number="49.1" class="anchored" data-anchor-id="sample-dataset-49"><span class="header-section-number">49.1</span> Sample Dataset</h2>
<pre><code>LEQN</code></pre>
</section>
<section id="sample-output-49" class="level2" data-number="49.2">
<h2 data-number="49.2" class="anchored" data-anchor-id="sample-output-49"><span class="header-section-number">49.2</span> Sample Output</h2>
<pre><code>0 113 114 128 129 227 242 242 257 355 356 370 371 484</code></pre>
</section>
<section id="solution-49" class="level2" data-number="49.3">
<h2 data-number="49.3" class="anchored" data-anchor-id="solution-49"><span class="header-section-number">49.3</span> Solution</h2>
<div class="sourceCode" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[amino_acid] <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide)</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>    circular_peptide: <span class="bu">str</span> <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> subpeptide_length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>            subpeptide: <span class="bu">str</span> <span class="op">=</span> circular_peptide[start_index:start_index <span class="op">+</span> subpeptide_length]</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[amino_acid] <span class="cf">for</span> amino_acid <span class="kw">in</span> subpeptide)</span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(spectrum)</span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a><span class="st">LEQN</span></span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(input_peptide)</span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-number-of-peptides-of-given-total-mass" class="level1" data-number="50">
<h1 data-number="50"><span class="header-section-number">50</span> Compute the Number of Peptides of Given Total Mass</h1>
<p>Counting Peptides with Given Mass Problem, Compute the number of peptides of given total mass.</p>
<p>Given:&nbsp;An integer&nbsp;<em>m</em>.</p>
<p>Return:&nbsp;The number of linear peptides having integer mass&nbsp;<em>m</em>.</p>
<section id="sample-dataset-50" class="level2" data-number="50.1">
<h2 data-number="50.1" class="anchored" data-anchor-id="sample-dataset-50"><span class="header-section-number">50.1</span> Sample Dataset</h2>
<pre><code>1024</code></pre>
</section>
<section id="sample-output-50" class="level2" data-number="50.2">
<h2 data-number="50.2" class="anchored" data-anchor-id="sample-output-50"><span class="header-section-number">50.2</span> Sample Output</h2>
<pre><code>14712706211</code></pre>
</section>
<section id="solution-50" class="level2" data-number="50.3">
<h2 data-number="50.3" class="anchored" data-anchor-id="solution-50"><span class="header-section-number">50.3</span> Solution</h2>
<div class="sourceCode" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>LIGHTEST_AMINO_ACID: <span class="bu">int</span> <span class="op">=</span> <span class="bu">min</span>(AMINO_ACID_MASSES)</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_possible_peptides(target_mass: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>    peptide_count: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_mass <span class="kw">in</span> <span class="bu">range</span>(LIGHTEST_AMINO_ACID, target_mass <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>        peptide_count[current_mass] <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> amino_acid_mass <span class="kw">in</span> AMINO_ACID_MASSES <span class="cf">if</span> amino_acid_mass <span class="op">==</span> current_mass)</span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> amino_acid_mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_mass <span class="op">&gt;=</span> amino_acid_mass:</span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a>                peptide_count[current_mass] <span class="op">+=</span> peptide_count[current_mass <span class="op">-</span> amino_acid_mass]</span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide_count[target_mass]</span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb152-20"><a href="#cb152-20" aria-hidden="true" tabindex="-1"></a><span class="st">1024</span></span>
<span id="cb152-21"><a href="#cb152-21" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb152-22"><a href="#cb152-22" aria-hidden="true" tabindex="-1"></a>target_peptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(sample_input.strip())</span>
<span id="cb152-23"><a href="#cb152-23" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> count_possible_peptides(target_peptide_mass)</span>
<span id="cb152-24"><a href="#cb152-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-cyclic-peptide-with-theoretical-spectrum-matching-an-ideal-spectrum" class="level1" data-number="51">
<h1 data-number="51"><span class="header-section-number">51</span> Find a Cyclic Peptide with Theoretical Spectrum Matching an Ideal Spectrum</h1>
<p>Cyclopeptide Sequencing Problem, Given an ideal experimental spectrum, find a cyclic peptide whose theoretical spectrum matches the experimental spectrum.</p>
<p>Given:&nbsp;A collection of (possibly repeated) integers&nbsp;<em>Spectrum</em>&nbsp;corresponding to an ideal experimental spectrum.</p>
<p>Return:&nbsp;Every amino acid string&nbsp;<em>Peptide</em>&nbsp;such that&nbsp;<em>Cyclospectrum</em>(<em>Peptide</em>) =&nbsp;<em>Spectrum</em>&nbsp;(if such a string exists).</p>
<section id="sample-dataset-51" class="level2" data-number="51.1">
<h2 data-number="51.1" class="anchored" data-anchor-id="sample-dataset-51"><span class="header-section-number">51.1</span> Sample Dataset</h2>
<pre><code>0 113 128 186 241 299 314 427</code></pre>
</section>
<section id="sample-output-51" class="level2" data-number="51.2">
<h2 data-number="51.2" class="anchored" data-anchor-id="sample-output-51"><span class="header-section-number">51.2</span> Sample Output</h2>
<pre><code>113-128-186 113-186-128 186-128-113 128-186-113 186-113-128 128-113-186</code></pre>
</section>
<section id="solution-51" class="level2" data-number="51.3">
<h2 data-number="51.3" class="anchored" data-anchor-id="solution-51"><span class="header-section-number">51.3</span> Solution</h2>
<div class="sourceCode" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">sum</span>(peptide)]</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[i:i <span class="op">+</span> k]</span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>            spectrum.append(<span class="bu">sum</span>(subpeptide))</span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>    prefix_mass: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> peptide:</span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a>        prefix_mass.append(prefix_mass[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> mass)</span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(prefix_mass[j] <span class="op">-</span> prefix_mass[i])</span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a>    linear_spectrum.sort()</span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linear_spectrum</span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-26"><a href="#cb155-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb155-27"><a href="#cb155-27" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb155-28"><a href="#cb155-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb155-29"><a href="#cb155-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb155-30"><a href="#cb155-30" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb155-31"><a href="#cb155-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb155-32"><a href="#cb155-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-33"><a href="#cb155-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_consistent(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb155-34"><a href="#cb155-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> AMINO_ACID_MASSES[<span class="dv">0</span>]:</span>
<span id="cb155-35"><a href="#cb155-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb155-36"><a href="#cb155-36" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb155-37"><a href="#cb155-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(mass <span class="kw">in</span> spectrum <span class="cf">for</span> mass <span class="kw">in</span> peptide_spectrum)</span>
<span id="cb155-38"><a href="#cb155-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-39"><a href="#cb155-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb155-40"><a href="#cb155-40" aria-hidden="true" tabindex="-1"></a>    candidate_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb155-41"><a href="#cb155-41" aria-hidden="true" tabindex="-1"></a>    result: Set[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb155-42"><a href="#cb155-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb155-43"><a href="#cb155-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> candidate_peptides:</span>
<span id="cb155-44"><a href="#cb155-44" aria-hidden="true" tabindex="-1"></a>        candidate_peptides <span class="op">=</span> expand_peptides(candidate_peptides)</span>
<span id="cb155-45"><a href="#cb155-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> candidate_peptides[:]:</span>
<span id="cb155-46"><a href="#cb155-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb155-47"><a href="#cb155-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_cyclospectrum(peptide) <span class="op">==</span> spectrum:</span>
<span id="cb155-48"><a href="#cb155-48" aria-hidden="true" tabindex="-1"></a>                    result.add(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, peptide)))</span>
<span id="cb155-49"><a href="#cb155-49" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb155-50"><a href="#cb155-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="kw">not</span> is_consistent(peptide, spectrum):</span>
<span id="cb155-51"><a href="#cb155-51" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb155-52"><a href="#cb155-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb155-53"><a href="#cb155-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb155-54"><a href="#cb155-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-55"><a href="#cb155-55" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb155-56"><a href="#cb155-56" aria-hidden="true" tabindex="-1"></a><span class="st">0 113 128 186 241 299 314 427</span></span>
<span id="cb155-57"><a href="#cb155-57" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb155-58"><a href="#cb155-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-59"><a href="#cb155-59" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb155-60"><a href="#cb155-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-61"><a href="#cb155-61" aria-hidden="true" tabindex="-1"></a>result: Set[<span class="bu">str</span>] <span class="op">=</span> cyclopeptide_sequencing(input_spectrum)</span>
<span id="cb155-62"><a href="#cb155-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-score-of-a-cyclic-peptide-against-a-spectrum" class="level1" data-number="52">
<h1 data-number="52"><span class="header-section-number">52</span> Compute the Score of a Cyclic Peptide Against a Spectrum</h1>
<p>Cyclic Peptide Scoring Problem, Compute the score of a cyclic peptide against a spectrum.</p>
<p>Given:&nbsp;An amino acid string&nbsp;<em>Peptide</em>&nbsp;and a collection of integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;The score of&nbsp;<em>Peptide</em>&nbsp;against&nbsp;<em>Spectrum</em>,&nbsp;<em>Score</em>(<em>Peptide</em>,&nbsp;<em>Spectrum</em>).</p>
<section id="sample-dataset-52" class="level2" data-number="52.1">
<h2 data-number="52.1" class="anchored" data-anchor-id="sample-dataset-52"><span class="header-section-number">52.1</span> Sample Dataset</h2>
<pre><code>NQEL
0 99 113 114 128 227 257 299 355 356 370 371 484</code></pre>
</section>
<section id="sample-output-52" class="level2" data-number="52.2">
<h2 data-number="52.2" class="anchored" data-anchor-id="sample-output-52"><span class="header-section-number">52.2</span> Sample Output</h2>
<pre><code>11</code></pre>
</section>
<section id="solution-52" class="level2" data-number="52.3">
<h2 data-number="52.3" class="anchored" data-anchor-id="solution-52"><span class="header-section-number">52.3</span> Solution</h2>
<div class="sourceCode" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[aa] <span class="cf">for</span> aa <span class="kw">in</span> peptide)</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>    extended_peptide: <span class="bu">str</span> <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>            subpeptide: <span class="bu">str</span> <span class="op">=</span> extended_peptide[start:start <span class="op">+</span> length]</span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[aa] <span class="cf">for</span> aa <span class="kw">in</span> subpeptide)</span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb158-28"><a href="#cb158-28" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb158-29"><a href="#cb158-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-30"><a href="#cb158-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb158-31"><a href="#cb158-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-32"><a href="#cb158-32" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb158-33"><a href="#cb158-33" aria-hidden="true" tabindex="-1"></a><span class="st">NQEL</span></span>
<span id="cb158-34"><a href="#cb158-34" aria-hidden="true" tabindex="-1"></a><span class="st">0 99 113 114 128 227 257 299 355 356 370 371 484</span></span>
<span id="cb158-35"><a href="#cb158-35" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb158-36"><a href="#cb158-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-37"><a href="#cb158-37" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb158-38"><a href="#cb158-38" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb158-39"><a href="#cb158-39" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb158-40"><a href="#cb158-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-41"><a href="#cb158-41" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> calculate_score(input_peptide, input_spectrum)</span>
<span id="cb158-42"><a href="#cb158-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-leaderboardcyclopeptidesequencing" class="level1" data-number="53">
<h1 data-number="53"><span class="header-section-number">53</span> Implement LeaderboardCyclopeptideSequencing</h1>
<p>Implement&nbsp;<em>LeaderboardCyclopeptideSequencing</em></p>
<p>Given:&nbsp;An integer&nbsp;<em>N</em>&nbsp;and a collection of integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;<em>LeaderPeptide</em>&nbsp;after running&nbsp;<em>LeaderboardCyclopeptideSequencing</em>(<em>Spectrum</em>,&nbsp;<em>N</em>).</p>
<section id="sample-dataset-53" class="level2" data-number="53.1">
<h2 data-number="53.1" class="anchored" data-anchor-id="sample-dataset-53"><span class="header-section-number">53.1</span> Sample Dataset</h2>
<pre><code>10
0 71 113 129 147 200 218 260 313 331 347 389 460</code></pre>
</section>
<section id="sample-output-53" class="level2" data-number="53.2">
<h2 data-number="53.2" class="anchored" data-anchor-id="sample-output-53"><span class="header-section-number">53.2</span> Sample Output</h2>
<pre><code>113-147-71-129</code></pre>
</section>
<section id="solution-53" class="level2" data-number="53.3">
<h2 data-number="53.3" class="anchored" data-anchor-id="solution-53"><span class="header-section-number">53.3</span> Solution</h2>
<div class="sourceCode" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Dict</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(peptide)</span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[start:start <span class="op">+</span> length]</span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(subpeptide)</span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_consistent(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb161-28"><a href="#cb161-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(peptide_spectrum.count(mass) <span class="op">&lt;=</span> spectrum.count(mass) <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(peptide_spectrum))</span>
<span id="cb161-29"><a href="#cb161-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-30"><a href="#cb161-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb161-31"><a href="#cb161-31" aria-hidden="true" tabindex="-1"></a>    result: Set[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb161-32"><a href="#cb161-32" aria-hidden="true" tabindex="-1"></a>    candidate_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb161-33"><a href="#cb161-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> candidate_peptides:</span>
<span id="cb161-34"><a href="#cb161-34" aria-hidden="true" tabindex="-1"></a>        candidate_peptides <span class="op">=</span> expand_peptides(candidate_peptides)</span>
<span id="cb161-35"><a href="#cb161-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> candidate_peptides[:]:</span>
<span id="cb161-36"><a href="#cb161-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb161-37"><a href="#cb161-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_cyclospectrum(peptide) <span class="op">==</span> spectrum:</span>
<span id="cb161-38"><a href="#cb161-38" aria-hidden="true" tabindex="-1"></a>                    result.add(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, peptide)))</span>
<span id="cb161-39"><a href="#cb161-39" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb161-40"><a href="#cb161-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="kw">not</span> is_consistent(peptide, spectrum):</span>
<span id="cb161-41"><a href="#cb161-41" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb161-42"><a href="#cb161-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb161-43"><a href="#cb161-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-44"><a href="#cb161-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb161-45"><a href="#cb161-45" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb161-46"><a href="#cb161-46" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb161-47"><a href="#cb161-47" aria-hidden="true" tabindex="-1"></a>    unique_masses: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(peptide_spectrum <span class="op">+</span> spectrum)</span>
<span id="cb161-48"><a href="#cb161-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb161-49"><a href="#cb161-49" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(peptide_spectrum.count(mass), spectrum.count(mass))</span>
<span id="cb161-50"><a href="#cb161-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb161-51"><a href="#cb161-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-52"><a href="#cb161-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[List[<span class="bu">int</span>]], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb161-53"><a href="#cb161-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb161-54"><a href="#cb161-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb161-55"><a href="#cb161-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-56"><a href="#cb161-56" aria-hidden="true" tabindex="-1"></a>    scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb161-57"><a href="#cb161-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb161-58"><a href="#cb161-58" aria-hidden="true" tabindex="-1"></a>        scores[i] <span class="op">=</span> calculate_score(peptide, spectrum)</span>
<span id="cb161-59"><a href="#cb161-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-60"><a href="#cb161-60" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb161-61"><a href="#cb161-61" aria-hidden="true" tabindex="-1"></a>    threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>] <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="bu">len</span>(sorted_scores) <span class="cf">else</span> sorted_scores[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb161-62"><a href="#cb161-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-63"><a href="#cb161-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> threshold]</span>
<span id="cb161-64"><a href="#cb161-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-65"><a href="#cb161-65" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> leaderboard_cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb161-66"><a href="#cb161-66" aria-hidden="true" tabindex="-1"></a>    leaderboard: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb161-67"><a href="#cb161-67" aria-hidden="true" tabindex="-1"></a>    leader_peptide: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb161-68"><a href="#cb161-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-69"><a href="#cb161-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> leaderboard:</span>
<span id="cb161-70"><a href="#cb161-70" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> expand_peptides(leaderboard)</span>
<span id="cb161-71"><a href="#cb161-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> leaderboard[:]:</span>
<span id="cb161-72"><a href="#cb161-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb161-73"><a href="#cb161-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_score(peptide, spectrum) <span class="op">&gt;</span> calculate_score(leader_peptide, spectrum):</span>
<span id="cb161-74"><a href="#cb161-74" aria-hidden="true" tabindex="-1"></a>                    leader_peptide <span class="op">=</span> peptide</span>
<span id="cb161-75"><a href="#cb161-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb161-76"><a href="#cb161-76" aria-hidden="true" tabindex="-1"></a>                leaderboard.remove(peptide)</span>
<span id="cb161-77"><a href="#cb161-77" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> trim_leaderboard(leaderboard, spectrum, n)</span>
<span id="cb161-78"><a href="#cb161-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> leader_peptide</span>
<span id="cb161-79"><a href="#cb161-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-80"><a href="#cb161-80" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb161-81"><a href="#cb161-81" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb161-82"><a href="#cb161-82" aria-hidden="true" tabindex="-1"></a><span class="st">0 71 113 129 147 200 218 260 313 331 347 389 460</span></span>
<span id="cb161-83"><a href="#cb161-83" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb161-84"><a href="#cb161-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-85"><a href="#cb161-85" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb161-86"><a href="#cb161-86" aria-hidden="true" tabindex="-1"></a>n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb161-87"><a href="#cb161-87" aria-hidden="true" tabindex="-1"></a>spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb161-88"><a href="#cb161-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-89"><a href="#cb161-89" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> leaderboard_cyclopeptide_sequencing(spectrum, n)</span>
<span id="cb161-90"><a href="#cb161-90" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-convolution-of-a-spectrum" class="level1" data-number="54">
<h1 data-number="54"><span class="header-section-number">54</span> Generate the Convolution of a Spectrum</h1>
<p>Spectral Convolution Problem, Compute the convolution of a spectrum.</p>
<p>Given:&nbsp;A collection of integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;The list of elements in the convolution of&nbsp;<em>Spectrum</em>&nbsp;in decreasing order of their multiplicities. If an element has multiplicity&nbsp;<em>k</em>, it should appear exactly&nbsp;<em>k</em>&nbsp;times.</p>
<section id="sample-dataset-54" class="level2" data-number="54.1">
<h2 data-number="54.1" class="anchored" data-anchor-id="sample-dataset-54"><span class="header-section-number">54.1</span> Sample Dataset</h2>
<pre><code>0 137 186 323</code></pre>
</section>
<section id="sample-output-54" class="level2" data-number="54.2">
<h2 data-number="54.2" class="anchored" data-anchor-id="sample-output-54"><span class="header-section-number">54.2</span> Sample Output</h2>
<pre><code>137 137 186 186 323 49</code></pre>
</section>
<section id="solution-54" class="level2" data-number="54.3">
<h2 data-number="54.3" class="anchored" data-anchor-id="solution-54"><span class="header-section-number">54.3</span> Solution</h2>
<div class="sourceCode" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectrum_convolution(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>    convolution_list: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectrum) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(spectrum)):</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>            mass_difference: <span class="bu">int</span> <span class="op">=</span> spectrum[j] <span class="op">-</span> spectrum[i]</span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> mass_difference <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>                convolution_list.append(mass_difference)</span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(convolution_list):</span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> convolution_list.count(mass)</span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>    sorted_masses: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(frequency_dict, key<span class="op">=</span>frequency_dict.get, reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a>    result: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> sorted_masses:</span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a>        result.extend([mass] <span class="op">*</span> frequency_dict[mass])</span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a><span class="st">0 137 186 323</span></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a>convolution_result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_spectrum_convolution(input_spectrum)</span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, convolution_result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-convolutioncyclopeptidesequencing" class="level1" data-number="55">
<h1 data-number="55"><span class="header-section-number">55</span> Implement ConvolutionCyclopeptideSequencing</h1>
<p>Implement&nbsp;<em>ConvolutionCyclopeptideSequencing</em>.</p>
<p>Given:&nbsp;An integer&nbsp;<em>M</em>, an integer&nbsp;<em>N</em>, and a collection of (possibly repeated) integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;A cyclic peptide LeaderPeptide with amino acids taken only from the top&nbsp;<em>M</em>&nbsp;elements (and ties) of the convolution of&nbsp;<em>Spectrum</em>&nbsp;that fall between 57 and 200, and where the size of&nbsp;<em>Leaderboard</em>&nbsp;is restricted to the top&nbsp;<em>N</em>&nbsp;(and ties).</p>
<section id="sample-dataset-55" class="level2" data-number="55.1">
<h2 data-number="55.1" class="anchored" data-anchor-id="sample-dataset-55"><span class="header-section-number">55.1</span> Sample Dataset</h2>
<pre><code>20
60
57 57 71 99 129 137 170 186 194 208 228 265 285 299 307 323 356 364 394 422 493</code></pre>
</section>
<section id="sample-output-55" class="level2" data-number="55.2">
<h2 data-number="55.2" class="anchored" data-anchor-id="sample-output-55"><span class="header-section-number">55.2</span> Sample Output</h2>
<pre><code>99-71-137-57-72-57</code></pre>
</section>
<section id="solution-55" class="level2" data-number="55.3">
<h2 data-number="55.3" class="anchored" data-anchor-id="solution-55"><span class="header-section-number">55.3</span> Solution</h2>
<div class="sourceCode" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectrum_convolution(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>    convolution_list: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectrum) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectrum)):</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> spectrum[j] <span class="op">-</span> spectrum[i] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>                convolution_list.append(spectrum[j] <span class="op">-</span> spectrum[i])</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(convolution_list):</span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> convolution_list.count(mass)</span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>    sorted_masses: List[<span class="bu">int</span>] <span class="op">=</span> [k <span class="cf">for</span> k, _ <span class="kw">in</span> <span class="bu">sorted</span>(frequency_dict.items(), key<span class="op">=</span><span class="kw">lambda</span> item: item[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)]</span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>    result: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> sorted_masses:</span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> [mass] <span class="op">*</span> frequency_dict[mass]</span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[List[<span class="bu">int</span>]], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a>    scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb167-27"><a href="#cb167-27" aria-hidden="true" tabindex="-1"></a>        scores[i] <span class="op">=</span> calculate_score(peptide, spectrum)</span>
<span id="cb167-28"><a href="#cb167-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-29"><a href="#cb167-29" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb167-30"><a href="#cb167-30" aria-hidden="true" tabindex="-1"></a>    threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb167-31"><a href="#cb167-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-32"><a href="#cb167-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> threshold]</span>
<span id="cb167-33"><a href="#cb167-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-34"><a href="#cb167-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb167-35"><a href="#cb167-35" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">sum</span>(peptide)]</span>
<span id="cb167-36"><a href="#cb167-36" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb167-37"><a href="#cb167-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb167-38"><a href="#cb167-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb167-39"><a href="#cb167-39" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[i:i <span class="op">+</span> k]</span>
<span id="cb167-40"><a href="#cb167-40" aria-hidden="true" tabindex="-1"></a>            spectrum.append(<span class="bu">sum</span>(subpeptide))</span>
<span id="cb167-41"><a href="#cb167-41" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb167-42"><a href="#cb167-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb167-43"><a href="#cb167-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-44"><a href="#cb167-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb167-45"><a href="#cb167-45" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb167-46"><a href="#cb167-46" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb167-47"><a href="#cb167-47" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(peptide_spectrum <span class="op">+</span> spectrum)</span>
<span id="cb167-48"><a href="#cb167-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb167-49"><a href="#cb167-49" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(peptide_spectrum.count(mass), spectrum.count(mass))</span>
<span id="cb167-50"><a href="#cb167-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb167-51"><a href="#cb167-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-52"><a href="#cb167-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_top_masses(spectrum: List[<span class="bu">int</span>], m: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb167-53"><a href="#cb167-53" aria-hidden="true" tabindex="-1"></a>    convolution: List[<span class="bu">int</span>] <span class="op">=</span> calculate_spectrum_convolution(spectrum)</span>
<span id="cb167-54"><a href="#cb167-54" aria-hidden="true" tabindex="-1"></a>    filtered_convolution: List[<span class="bu">int</span>] <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> convolution <span class="cf">if</span> <span class="dv">57</span> <span class="op">&lt;=</span> x <span class="op">&lt;=</span> <span class="dv">200</span>]</span>
<span id="cb167-55"><a href="#cb167-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-56"><a href="#cb167-56" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb167-57"><a href="#cb167-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(filtered_convolution):</span>
<span id="cb167-58"><a href="#cb167-58" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> filtered_convolution.count(mass)</span>
<span id="cb167-59"><a href="#cb167-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-60"><a href="#cb167-60" aria-hidden="true" tabindex="-1"></a>    sorted_elements: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> <span class="bu">sorted</span>(frequency_dict.items(), key<span class="op">=</span><span class="kw">lambda</span> kv: kv[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb167-61"><a href="#cb167-61" aria-hidden="true" tabindex="-1"></a>    top_masses: List[<span class="bu">int</span>] <span class="op">=</span> [mass <span class="cf">for</span> mass, freq <span class="kw">in</span> sorted_elements <span class="cf">if</span> freq <span class="op">&gt;=</span> sorted_elements[m <span class="op">-</span> <span class="dv">1</span>][<span class="dv">1</span>]]</span>
<span id="cb167-62"><a href="#cb167-62" aria-hidden="true" tabindex="-1"></a>    top_masses.sort()</span>
<span id="cb167-63"><a href="#cb167-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> top_masses</span>
<span id="cb167-64"><a href="#cb167-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-65"><a href="#cb167-65" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]], masses: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb167-66"><a href="#cb167-66" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb167-67"><a href="#cb167-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb167-68"><a href="#cb167-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> masses:</span>
<span id="cb167-69"><a href="#cb167-69" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb167-70"><a href="#cb167-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb167-71"><a href="#cb167-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-72"><a href="#cb167-72" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convolution_cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>], m: <span class="bu">int</span>, n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb167-73"><a href="#cb167-73" aria-hidden="true" tabindex="-1"></a>    masses: List[<span class="bu">int</span>] <span class="op">=</span> find_top_masses(spectrum, m)</span>
<span id="cb167-74"><a href="#cb167-74" aria-hidden="true" tabindex="-1"></a>    leaderboard: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb167-75"><a href="#cb167-75" aria-hidden="true" tabindex="-1"></a>    leader_peptide: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb167-76"><a href="#cb167-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-77"><a href="#cb167-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> leaderboard:</span>
<span id="cb167-78"><a href="#cb167-78" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> expand_peptides(leaderboard, masses)</span>
<span id="cb167-79"><a href="#cb167-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> leaderboard[:]:</span>
<span id="cb167-80"><a href="#cb167-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb167-81"><a href="#cb167-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_score(peptide, spectrum) <span class="op">&gt;</span> calculate_score(leader_peptide, spectrum):</span>
<span id="cb167-82"><a href="#cb167-82" aria-hidden="true" tabindex="-1"></a>                    leader_peptide <span class="op">=</span> peptide</span>
<span id="cb167-83"><a href="#cb167-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb167-84"><a href="#cb167-84" aria-hidden="true" tabindex="-1"></a>                leaderboard.remove(peptide)</span>
<span id="cb167-85"><a href="#cb167-85" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> trim_leaderboard(leaderboard, spectrum, n)</span>
<span id="cb167-86"><a href="#cb167-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> leader_peptide</span>
<span id="cb167-87"><a href="#cb167-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-88"><a href="#cb167-88" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb167-89"><a href="#cb167-89" aria-hidden="true" tabindex="-1"></a><span class="st">20</span></span>
<span id="cb167-90"><a href="#cb167-90" aria-hidden="true" tabindex="-1"></a><span class="st">60</span></span>
<span id="cb167-91"><a href="#cb167-91" aria-hidden="true" tabindex="-1"></a><span class="st">57 57 71 99 129 137 170 186 194 208 228 265 285 299 307 323 356 364 394 422 493</span></span>
<span id="cb167-92"><a href="#cb167-92" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb167-93"><a href="#cb167-93" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb167-94"><a href="#cb167-94" aria-hidden="true" tabindex="-1"></a>m: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb167-95"><a href="#cb167-95" aria-hidden="true" tabindex="-1"></a>n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">1</span>])</span>
<span id="cb167-96"><a href="#cb167-96" aria-hidden="true" tabindex="-1"></a>spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">2</span>].split()]</span>
<span id="cb167-97"><a href="#cb167-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-98"><a href="#cb167-98" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> convolution_cyclopeptide_sequencing(spectrum, m, n)</span>
<span id="cb167-99"><a href="#cb167-99" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-theoretical-spectrum-of-a-linear-peptide" class="level1" data-number="56">
<h1 data-number="56"><span class="header-section-number">56</span> Generate the Theoretical Spectrum of a Linear Peptide</h1>
<p>Linear Spectrum Problem, Generate the ideal linear spectrum of a peptide.</p>
<p>Given:&nbsp;An&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid string</a>&nbsp;<em>Peptide</em>.</p>
<p>Return:&nbsp;The linear spectrum of&nbsp;<em>Peptide</em>.</p>
<section id="sample-dataset-56" class="level2" data-number="56.1">
<h2 data-number="56.1" class="anchored" data-anchor-id="sample-dataset-56"><span class="header-section-number">56.1</span> Sample Dataset</h2>
<pre><code>NQEL</code></pre>
</section>
<section id="sample-output-56" class="level2" data-number="56.2">
<h2 data-number="56.2" class="anchored" data-anchor-id="sample-output-56"><span class="header-section-number">56.2</span> Sample Output</h2>
<pre><code>0 113 114 128 129 242 242 257 370 371 484</code></pre>
</section>
<section id="solution-56" class="level2" data-number="56.3">
<h2 data-number="56.3" class="anchored" data-anchor-id="solution-56"><span class="header-section-number">56.3</span> Solution</h2>
<div class="sourceCode" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a>sample_peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">"NQEL"</span></span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-28"><a href="#cb170-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the linear spectrum</span></span>
<span id="cb170-29"><a href="#cb170-29" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(sample_peptide)</span>
<span id="cb170-30"><a href="#cb170-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-score-of-a-linear-peptide" class="level1" data-number="57">
<h1 data-number="57"><span class="header-section-number">57</span> Compute the Score of a Linear Peptide</h1>
<p>Linear Peptide Scoring Problem, Compute the score of a linear peptide with respect to a spectrum.</p>
<p>Given:&nbsp;An amino acid string&nbsp;<em>Peptide</em>&nbsp;and a collection of integers&nbsp;<em>LinearSpectrum</em>.</p>
<p>Return:&nbsp;The linear score of&nbsp;<em>Peptide</em>&nbsp;against&nbsp;<em>Spectrum</em>,&nbsp;<em>LinearScore</em>(<em>Peptide</em>,&nbsp;<em>Spectrum</em>).</p>
<section id="sample-dataset-57" class="level2" data-number="57.1">
<h2 data-number="57.1" class="anchored" data-anchor-id="sample-dataset-57"><span class="header-section-number">57.1</span> Sample Dataset</h2>
<pre><code>NQEL
0 99 113 114 128 227 257 299 355 356 370 371 484</code></pre>
</section>
<section id="sample-output-57" class="level2" data-number="57.2">
<h2 data-number="57.2" class="anchored" data-anchor-id="sample-output-57"><span class="header-section-number">57.2</span> Sample Output</h2>
<pre><code>8</code></pre>
</section>
<section id="solution-57" class="level2" data-number="57.3">
<h2 data-number="57.3" class="anchored" data-anchor-id="solution-57"><span class="header-section-number">57.3</span> Solution</h2>
<div class="sourceCode" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb173-18"><a href="#cb173-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb173-19"><a href="#cb173-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb173-20"><a href="#cb173-20" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb173-21"><a href="#cb173-21" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb173-22"><a href="#cb173-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb173-23"><a href="#cb173-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb173-24"><a href="#cb173-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-25"><a href="#cb173-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb173-26"><a href="#cb173-26" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb173-27"><a href="#cb173-27" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb173-28"><a href="#cb173-28" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb173-29"><a href="#cb173-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb173-30"><a href="#cb173-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb173-31"><a href="#cb173-31" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb173-32"><a href="#cb173-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb173-33"><a href="#cb173-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb173-34"><a href="#cb173-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-35"><a href="#cb173-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb173-36"><a href="#cb173-36" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb173-37"><a href="#cb173-37" aria-hidden="true" tabindex="-1"></a><span class="st">NQEL</span></span>
<span id="cb173-38"><a href="#cb173-38" aria-hidden="true" tabindex="-1"></a><span class="st">0 99 113 114 128 227 257 299 355 356 370 371 484</span></span>
<span id="cb173-39"><a href="#cb173-39" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb173-40"><a href="#cb173-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-41"><a href="#cb173-41" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb173-42"><a href="#cb173-42" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb173-43"><a href="#cb173-43" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb173-44"><a href="#cb173-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-45"><a href="#cb173-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the linear score</span></span>
<span id="cb173-46"><a href="#cb173-46" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> calculate_linear_score(input_peptide, input_spectrum)</span>
<span id="cb173-47"><a href="#cb173-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="trim-a-peptide-leaderboard" class="level1" data-number="58">
<h1 data-number="58"><span class="header-section-number">58</span> Trim a Peptide Leaderboard</h1>
<p>Trim Problem, Trim a leaderboard of peptides.</p>
<p>Given:&nbsp;A leaderboard of linear peptides&nbsp;<em>Leaderboard</em>, a linear spectrum&nbsp;<em>Spectrum</em>, and an integer&nbsp;<em>N</em>.</p>
<p>Return:&nbsp;The top&nbsp;<em>N</em>&nbsp;peptides from&nbsp;<em>Leaderboard</em>&nbsp;scored against&nbsp;<em>Spectrum</em>. Remember to use&nbsp;<em>LinearScore</em>.</p>
<section id="sample-dataset-58" class="level2" data-number="58.1">
<h2 data-number="58.1" class="anchored" data-anchor-id="sample-dataset-58"><span class="header-section-number">58.1</span> Sample Dataset</h2>
<pre><code>LAST ALST TLLT TQAS
0 71 87 101 113 158 184 188 259 271 372
2</code></pre>
</section>
<section id="sample-output-58" class="level2" data-number="58.2">
<h2 data-number="58.2" class="anchored" data-anchor-id="sample-output-58"><span class="header-section-number">58.2</span> Sample Output</h2>
<pre><code>LAST ALST</code></pre>
</section>
<section id="solution-58" class="level2" data-number="58.3">
<h2 data-number="58.3" class="anchored" data-anchor-id="solution-58"><span class="header-section-number">58.3</span> Solution</h2>
<div class="sourceCode" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb176-17"><a href="#cb176-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb176-18"><a href="#cb176-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb176-19"><a href="#cb176-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb176-20"><a href="#cb176-20" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb176-21"><a href="#cb176-21" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb176-22"><a href="#cb176-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb176-23"><a href="#cb176-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb176-24"><a href="#cb176-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-25"><a href="#cb176-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb176-26"><a href="#cb176-26" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb176-27"><a href="#cb176-27" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb176-28"><a href="#cb176-28" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb176-29"><a href="#cb176-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb176-30"><a href="#cb176-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb176-31"><a href="#cb176-31" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb176-32"><a href="#cb176-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb176-33"><a href="#cb176-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb176-34"><a href="#cb176-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-35"><a href="#cb176-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[<span class="bu">str</span>], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb176-36"><a href="#cb176-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb176-37"><a href="#cb176-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb176-38"><a href="#cb176-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-39"><a href="#cb176-39" aria-hidden="true" tabindex="-1"></a>    peptide_scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb176-40"><a href="#cb176-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb176-41"><a href="#cb176-41" aria-hidden="true" tabindex="-1"></a>        peptide_scores[i] <span class="op">=</span> calculate_linear_score(peptide, spectrum)</span>
<span id="cb176-42"><a href="#cb176-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-43"><a href="#cb176-43" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(peptide_scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb176-44"><a href="#cb176-44" aria-hidden="true" tabindex="-1"></a>    score_threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb176-45"><a href="#cb176-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-46"><a href="#cb176-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> peptide_scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> score_threshold]</span>
<span id="cb176-47"><a href="#cb176-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-48"><a href="#cb176-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb176-49"><a href="#cb176-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb176-50"><a href="#cb176-50" aria-hidden="true" tabindex="-1"></a><span class="st">LAST ALST TLLT TQAS</span></span>
<span id="cb176-51"><a href="#cb176-51" aria-hidden="true" tabindex="-1"></a><span class="st">0 71 87 101 113 158 184 188 259 271 372</span></span>
<span id="cb176-52"><a href="#cb176-52" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb176-53"><a href="#cb176-53" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb176-54"><a href="#cb176-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-55"><a href="#cb176-55" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb176-56"><a href="#cb176-56" aria-hidden="true" tabindex="-1"></a>input_leaderboard: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">0</span>].split()</span>
<span id="cb176-57"><a href="#cb176-57" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb176-58"><a href="#cb176-58" aria-hidden="true" tabindex="-1"></a>input_n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb176-59"><a href="#cb176-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-60"><a href="#cb176-60" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> trim_leaderboard(input_leaderboard, input_spectrum, input_n)</span>
<span id="cb176-61"><a href="#cb176-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="solve-the-turnpike-problem" class="level1" data-number="59">
<h1 data-number="59"><span class="header-section-number">59</span> Solve the Turnpike Problem</h1>
<p>Turnpike Problem. Given all pairwise distances between points on a line segment, reconstruct the positions of those points.</p>
<p>Given:&nbsp;A collection of integers&nbsp;<em>L</em>.</p>
<p>Return:&nbsp;A set&nbsp;<em>A</em>&nbsp;such that <span class="math inline">\(∆A\)</span>&nbsp;=&nbsp;<em>L</em>.</p>
<section id="sample-dataset-59" class="level2" data-number="59.1">
<h2 data-number="59.1" class="anchored" data-anchor-id="sample-dataset-59"><span class="header-section-number">59.1</span> Sample Dataset</h2>
<pre><code>-10 -8 -7 -6 -5 -4 -3 -3 -2 -2 0 0 0 0 0 2 2 3 3 4 5 6 7 8 10</code></pre>
</section>
<section id="sample-output-59" class="level2" data-number="59.2">
<h2 data-number="59.2" class="anchored" data-anchor-id="sample-output-59"><span class="header-section-number">59.2</span> Sample Output</h2>
<pre><code>0 2 4 7 10</code></pre>
</section>
<section id="solution-59" class="level2" data-number="59.3">
<h2 data-number="59.3" class="anchored" data-anchor-id="solution-59"><span class="header-section-number">59.3</span> Solution</h2>
<div class="sourceCode" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Optional</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_absolute_differences(set_a: Set[<span class="bu">int</span>], set_b: Set[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">abs</span>(a <span class="op">-</span> b) <span class="cf">for</span> a <span class="kw">in</span> set_a <span class="cf">for</span> b <span class="kw">in</span> set_b]</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_multiset_subset(subset: List[<span class="bu">int</span>], superset: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(subset.count(elem) <span class="op">&lt;=</span> superset.count(elem) <span class="cf">for</span> elem <span class="kw">in</span> <span class="bu">set</span>(subset))</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiset_difference(set_a: List[<span class="bu">int</span>], set_b: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>    difference: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>    unique_elements: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(set_a)</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> elem <span class="kw">in</span> unique_elements:</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>        count_difference <span class="op">=</span> set_a.count(elem) <span class="op">-</span> set_b.count(elem)</span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count_difference <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a>            difference.extend([elem] <span class="op">*</span> count_difference)</span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(difference)</span>
<span id="cb179-17"><a href="#cb179-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-18"><a href="#cb179-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> place_elements(distances: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Optional[Set[<span class="bu">int</span>]]:</span>
<span id="cb179-19"><a href="#cb179-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> distances:</span>
<span id="cb179-20"><a href="#cb179-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> placed_elements</span>
<span id="cb179-21"><a href="#cb179-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-22"><a href="#cb179-22" aria-hidden="true" tabindex="-1"></a>    current_distance: <span class="bu">int</span> <span class="op">=</span> distances[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb179-23"><a href="#cb179-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb179-24"><a href="#cb179-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Try placing on the left</span></span>
<span id="cb179-25"><a href="#cb179-25" aria-hidden="true" tabindex="-1"></a>    left_differences: List[<span class="bu">int</span>] <span class="op">=</span> calculate_absolute_differences({current_distance}, placed_elements)</span>
<span id="cb179-26"><a href="#cb179-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_multiset_subset(left_differences, distances):</span>
<span id="cb179-27"><a href="#cb179-27" aria-hidden="true" tabindex="-1"></a>        placed_elements.add(current_distance)</span>
<span id="cb179-28"><a href="#cb179-28" aria-hidden="true" tabindex="-1"></a>        remaining_distances_left: List[<span class="bu">int</span>] <span class="op">=</span> multiset_difference(distances, left_differences)</span>
<span id="cb179-29"><a href="#cb179-29" aria-hidden="true" tabindex="-1"></a>        left_result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(remaining_distances_left)</span>
<span id="cb179-30"><a href="#cb179-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> left_result:</span>
<span id="cb179-31"><a href="#cb179-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> left_result</span>
<span id="cb179-32"><a href="#cb179-32" aria-hidden="true" tabindex="-1"></a>        placed_elements.remove(current_distance)</span>
<span id="cb179-33"><a href="#cb179-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-34"><a href="#cb179-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Try placing on the right</span></span>
<span id="cb179-35"><a href="#cb179-35" aria-hidden="true" tabindex="-1"></a>    right_differences: List[<span class="bu">int</span>] <span class="op">=</span> calculate_absolute_differences({total_width <span class="op">-</span> current_distance}, placed_elements)</span>
<span id="cb179-36"><a href="#cb179-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_multiset_subset(right_differences, distances):</span>
<span id="cb179-37"><a href="#cb179-37" aria-hidden="true" tabindex="-1"></a>        placed_elements.add(total_width <span class="op">-</span> current_distance)</span>
<span id="cb179-38"><a href="#cb179-38" aria-hidden="true" tabindex="-1"></a>        remaining_distances_right: List[<span class="bu">int</span>] <span class="op">=</span> multiset_difference(distances, right_differences)</span>
<span id="cb179-39"><a href="#cb179-39" aria-hidden="true" tabindex="-1"></a>        right_result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(remaining_distances_right)</span>
<span id="cb179-40"><a href="#cb179-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> right_result:</span>
<span id="cb179-41"><a href="#cb179-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> right_result</span>
<span id="cb179-42"><a href="#cb179-42" aria-hidden="true" tabindex="-1"></a>        placed_elements.remove(total_width <span class="op">-</span> current_distance)</span>
<span id="cb179-43"><a href="#cb179-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-44"><a href="#cb179-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb179-45"><a href="#cb179-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-46"><a href="#cb179-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb179-47"><a href="#cb179-47" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb179-48"><a href="#cb179-48" aria-hidden="true" tabindex="-1"></a><span class="st">-10 -8 -7 -6 -5 -4 -3 -3 -2 -2 0 0 0 0 0 2 2 3 3 4 5 6 7 8 10</span></span>
<span id="cb179-49"><a href="#cb179-49" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb179-50"><a href="#cb179-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-51"><a href="#cb179-51" aria-hidden="true" tabindex="-1"></a>input_distances: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb179-52"><a href="#cb179-52" aria-hidden="true" tabindex="-1"></a>positive_distances: List[<span class="bu">int</span>] <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> input_distances <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb179-53"><a href="#cb179-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-54"><a href="#cb179-54" aria-hidden="true" tabindex="-1"></a>total_width: <span class="bu">int</span> <span class="op">=</span> positive_distances.pop(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb179-55"><a href="#cb179-55" aria-hidden="true" tabindex="-1"></a>placed_elements: Set[<span class="bu">int</span>] <span class="op">=</span> {<span class="dv">0</span>, total_width}</span>
<span id="cb179-56"><a href="#cb179-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-57"><a href="#cb179-57" aria-hidden="true" tabindex="-1"></a>result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(positive_distances)</span>
<span id="cb179-58"><a href="#cb179-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, <span class="bu">sorted</span>(result))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-minimum-number-of-coins-needed-to-make-change" class="level1" data-number="60">
<h1 data-number="60"><span class="header-section-number">60</span> Find the Minimum Number of Coins Needed to Make Change</h1>
<p>The Change Problem, Find the minimum number of coins needed to make change</p>
<p>Given:&nbsp;An integer&nbsp;<em>money</em>&nbsp;and an array&nbsp;<em>Coins</em>&nbsp;of positive integers.</p>
<p>Return:&nbsp;The minimum number of coins with denominations&nbsp;<em>Coins</em>&nbsp;that changes&nbsp;<em>money</em>.</p>
<section id="sample-dataset-60" class="level2" data-number="60.1">
<h2 data-number="60.1" class="anchored" data-anchor-id="sample-dataset-60"><span class="header-section-number">60.1</span> Sample Dataset</h2>
<pre><code>40
1,5,10,20,25,50</code></pre>
</section>
<section id="sample-output-60" class="level2" data-number="60.2">
<h2 data-number="60.2" class="anchored" data-anchor-id="sample-output-60"><span class="header-section-number">60.2</span> Sample Output</h2>
<pre><code>2</code></pre>
</section>
<section id="solution-60" class="level2" data-number="60.3">
<h2 data-number="60.3" class="anchored" data-anchor-id="solution-60"><span class="header-section-number">60.3</span> Solution</h2>
<div class="sourceCode" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> min_coins_for_change(target_amount: <span class="bu">int</span>, available_coins: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>    min_coins_needed <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_amount <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, target_amount <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>        min_coins_needed.append(target_amount <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> coin <span class="kw">in</span> available_coins:</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_amount <span class="op">&gt;=</span> coin:</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>                coins_for_current <span class="op">=</span> min_coins_needed[current_amount <span class="op">-</span> coin] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> coins_for_current <span class="op">&lt;</span> min_coins_needed[current_amount]:</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>                    min_coins_needed[current_amount] <span class="op">=</span> coins_for_current</span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> min_coins_needed[target_amount]</span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a><span class="st">40</span></span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a><span class="st">1,5,10,20,25,50</span></span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a>target_amount <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a>available_coins <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split(<span class="st">","</span>)]</span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(min_coins_for_change(target_amount, available_coins))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-length-of-a-longest-path-in-a-manhattan-like-grid" class="level1" data-number="61">
<h1 data-number="61"><span class="header-section-number">61</span> Find the Length of a Longest Path in a Manhattan-like Grid</h1>
<p>Length of a Longest Path in the Manhattan Tourist Problem. Find the length of a longest path in a rectangular city.</p>
<p>Given:&nbsp;Integers&nbsp;<em>n</em>&nbsp;and&nbsp;<em>m</em>, followed by an&nbsp;<em>n</em>&nbsp;× (<em>m</em>+1) matrix&nbsp;<em>Down</em>&nbsp;and an (<em>n</em>+1) ×&nbsp;<em>m</em>&nbsp;matrix&nbsp;<em>Right</em>. The two matrices are separated by the”-“symbol.</p>
<p>Return:&nbsp;The length of a longest path from source (0, 0) to sink (<em>n</em>,&nbsp;<em>m</em>) in the&nbsp;<em>n</em>&nbsp;×&nbsp;<em>m</em>&nbsp;rectangular grid whose edges are defined by the matrices&nbsp;<em>Down</em>&nbsp;and&nbsp;<em>Right</em>.</p>
<section id="sample-dataset-61" class="level2" data-number="61.1">
<h2 data-number="61.1" class="anchored" data-anchor-id="sample-dataset-61"><span class="header-section-number">61.1</span> Sample Dataset</h2>
<pre><code>4 4
1 0 2 4 3
4 6 5 2 1
4 4 5 2 1
5 6 8 5 3
-
3 2 4 0
3 2 4 2
0 7 3 3
3 3 0 2
1 3 2 2</code></pre>
</section>
<section id="sample-output-61" class="level2" data-number="61.2">
<h2 data-number="61.2" class="anchored" data-anchor-id="sample-output-61"><span class="header-section-number">61.2</span> Sample Output</h2>
<pre><code>34</code></pre>
</section>
<section id="solution-61" class="level2" data-number="61.3">
<h2 data-number="61.3" class="anchored" data-anchor-id="solution-61"><span class="header-section-number">61.3</span> Solution</h2>
<div class="sourceCode" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_manhattan_tourist_input(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>, List[List[<span class="bu">int</span>]], List[List[<span class="bu">int</span>]]]:</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_text.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>    rows, cols <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, lines[<span class="dv">0</span>].split())</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>    down_weights <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> (cols <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows)]</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(rows):</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[i <span class="op">+</span> <span class="dv">1</span>].split()))</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>            down_weights[i][j] <span class="op">=</span> line[j]</span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>    separator_index <span class="op">=</span> rows <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>    right_weights <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> cols <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[i <span class="op">+</span> separator_index <span class="op">+</span> <span class="dv">1</span>].split()))</span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(cols):</span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a>            right_weights[i][j] <span class="op">=</span> line[j]</span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rows, cols, down_weights, right_weights</span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_longest_manhattan_path(rows: <span class="bu">int</span>, cols: <span class="bu">int</span>, down_weights: List[List[<span class="bu">int</span>]], right_weights: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a>    path_scores <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> (cols <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb185-25"><a href="#cb185-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb185-26"><a href="#cb185-26" aria-hidden="true" tabindex="-1"></a>        path_scores[i][<span class="dv">0</span>] <span class="op">=</span> path_scores[i <span class="op">-</span> <span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> down_weights[i <span class="op">-</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb185-27"><a href="#cb185-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-28"><a href="#cb185-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb185-29"><a href="#cb185-29" aria-hidden="true" tabindex="-1"></a>        path_scores[<span class="dv">0</span>][j] <span class="op">=</span> path_scores[<span class="dv">0</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> right_weights[<span class="dv">0</span>][j <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb185-30"><a href="#cb185-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-31"><a href="#cb185-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb185-32"><a href="#cb185-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb185-33"><a href="#cb185-33" aria-hidden="true" tabindex="-1"></a>            path_scores[i][j] <span class="op">=</span> <span class="bu">max</span>(path_scores[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">+</span> down_weights[i <span class="op">-</span> <span class="dv">1</span>][j],</span>
<span id="cb185-34"><a href="#cb185-34" aria-hidden="true" tabindex="-1"></a>                                    path_scores[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> right_weights[i][j <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb185-35"><a href="#cb185-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb185-36"><a href="#cb185-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path_scores[rows][cols]</span>
<span id="cb185-37"><a href="#cb185-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-38"><a href="#cb185-38" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb185-39"><a href="#cb185-39" aria-hidden="true" tabindex="-1"></a><span class="st">4 4</span></span>
<span id="cb185-40"><a href="#cb185-40" aria-hidden="true" tabindex="-1"></a><span class="st">1 0 2 4 3</span></span>
<span id="cb185-41"><a href="#cb185-41" aria-hidden="true" tabindex="-1"></a><span class="st">4 6 5 2 1</span></span>
<span id="cb185-42"><a href="#cb185-42" aria-hidden="true" tabindex="-1"></a><span class="st">4 4 5 2 1</span></span>
<span id="cb185-43"><a href="#cb185-43" aria-hidden="true" tabindex="-1"></a><span class="st">5 6 8 5 3</span></span>
<span id="cb185-44"><a href="#cb185-44" aria-hidden="true" tabindex="-1"></a><span class="st">-</span></span>
<span id="cb185-45"><a href="#cb185-45" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 4 0</span></span>
<span id="cb185-46"><a href="#cb185-46" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 4 2</span></span>
<span id="cb185-47"><a href="#cb185-47" aria-hidden="true" tabindex="-1"></a><span class="st">0 7 3 3</span></span>
<span id="cb185-48"><a href="#cb185-48" aria-hidden="true" tabindex="-1"></a><span class="st">3 3 0 2</span></span>
<span id="cb185-49"><a href="#cb185-49" aria-hidden="true" tabindex="-1"></a><span class="st">1 3 2 2</span></span>
<span id="cb185-50"><a href="#cb185-50" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb185-51"><a href="#cb185-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-52"><a href="#cb185-52" aria-hidden="true" tabindex="-1"></a>rows, cols, down_weights, right_weights <span class="op">=</span> parse_manhattan_tourist_input(sample_input)</span>
<span id="cb185-53"><a href="#cb185-53" aria-hidden="true" tabindex="-1"></a>longest_path_score <span class="op">=</span> calculate_longest_manhattan_path(rows, cols, down_weights, right_weights)</span>
<span id="cb185-54"><a href="#cb185-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>longest_path_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-longest-common-subsequence-of-two-strings" class="level1" data-number="62">
<h1 data-number="62"><span class="header-section-number">62</span> Find a Longest Common Subsequence of Two Strings</h1>
<p>Longest Common Subsequence Problem.</p>
<p>Given:&nbsp;Two strings.</p>
<p>Return:&nbsp;A longest common subsequence of these strings.</p>
<section id="sample-dataset-62" class="level2" data-number="62.1">
<h2 data-number="62.1" class="anchored" data-anchor-id="sample-dataset-62"><span class="header-section-number">62.1</span> Sample Dataset</h2>
<pre><code>AACCTTGG
ACACTGTGA</code></pre>
</section>
<section id="sample-output-62" class="level2" data-number="62.2">
<h2 data-number="62.2" class="anchored" data-anchor-id="sample-output-62"><span class="header-section-number">62.2</span> Sample Output</h2>
<pre><code>AACTGG</code></pre>
</section>
<section id="solution-62" class="level2" data-number="62.3">
<h2 data-number="62.3" class="anchored" data-anchor-id="solution-62"><span class="header-section-number">62.3</span> Solution</h2>
<div class="sourceCode" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> longest_common_subsequence(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>    padded_seq1 <span class="op">=</span> <span class="st">'-'</span> <span class="op">+</span> sequence1</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>    padded_seq2 <span class="op">=</span> <span class="st">'-'</span> <span class="op">+</span> sequence2</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[<span class="bu">str</span>]] <span class="op">=</span> [[<span class="st">''</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="cf">if</span> padded_seq1[i] <span class="op">==</span> padded_seq2[j] <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j], score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>], match_score)</span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j]:</span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb188-19"><a href="#cb188-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb188-20"><a href="#cb188-20" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diag"</span></span>
<span id="cb188-21"><a href="#cb188-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-22"><a href="#cb188-22" aria-hidden="true" tabindex="-1"></a>    lcs <span class="op">=</span> <span class="st">""</span></span>
<span id="cb188-23"><a href="#cb188-23" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span>, <span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb188-24"><a href="#cb188-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> j <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb188-25"><a href="#cb188-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> backtrack_matrix[i][j] <span class="op">==</span> <span class="st">"diag"</span>:</span>
<span id="cb188-26"><a href="#cb188-26" aria-hidden="true" tabindex="-1"></a>            lcs <span class="op">=</span> padded_seq1[i] <span class="op">+</span> lcs</span>
<span id="cb188-27"><a href="#cb188-27" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb188-28"><a href="#cb188-28" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb188-29"><a href="#cb188-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> backtrack_matrix[i][j] <span class="op">==</span> <span class="st">"left"</span>:</span>
<span id="cb188-30"><a href="#cb188-30" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb188-31"><a href="#cb188-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb188-32"><a href="#cb188-32" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb188-33"><a href="#cb188-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-34"><a href="#cb188-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lcs</span>
<span id="cb188-35"><a href="#cb188-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-36"><a href="#cb188-36" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb188-37"><a href="#cb188-37" aria-hidden="true" tabindex="-1"></a><span class="st">AACCTTGG</span></span>
<span id="cb188-38"><a href="#cb188-38" aria-hidden="true" tabindex="-1"></a><span class="st">ACACTGTGA</span></span>
<span id="cb188-39"><a href="#cb188-39" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb188-40"><a href="#cb188-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-41"><a href="#cb188-41" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb188-42"><a href="#cb188-42" aria-hidden="true" tabindex="-1"></a>sequence1 <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb188-43"><a href="#cb188-43" aria-hidden="true" tabindex="-1"></a>sequence2 <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb188-44"><a href="#cb188-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-45"><a href="#cb188-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(longest_common_subsequence(sequence1, sequence2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-longest-path-in-a-dag" class="level1" data-number="63">
<h1 data-number="63"><span class="header-section-number">63</span> Find the Longest Path in a DAG</h1>
<p>Longest Path in a DAG Problem. Find a longest path between two nodes in an edge-weighted DAG.</p>
<p>Given:&nbsp;An integer representing the source node of a graph, followed by an integer representing the sink node of the graph, followed by an edge-weighted graph. The graph is represented by a modified&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>&nbsp;in which the notation”0-&gt;1:7”indicates that an edge connects node 0 to node 1 with weight 7.</p>
<p>Return:&nbsp;The length of a longest path in the graph, followed by a longest path. (If multiple longest paths exist, you may return any one.)</p>
<section id="sample-dataset-63" class="level2" data-number="63.1">
<h2 data-number="63.1" class="anchored" data-anchor-id="sample-dataset-63"><span class="header-section-number">63.1</span> Sample Dataset</h2>
<pre><code>0
4
0-&gt;1:7
0-&gt;2:4
2-&gt;3:2
1-&gt;4:1
3-&gt;4:3</code></pre>
</section>
<section id="sample-output-63" class="level2" data-number="63.2">
<h2 data-number="63.2" class="anchored" data-anchor-id="sample-output-63"><span class="header-section-number">63.2</span> Sample Output</h2>
<pre><code>9
0-&gt;2-&gt;3-&gt;4</code></pre>
</section>
<section id="solution-63" class="level2" data-number="63.3">
<h2 data-number="63.3" class="anchored" data-anchor-id="solution-63"><span class="header-section-number">63.3</span> Solution</h2>
<div class="sourceCode" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Optional</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Node:</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, label: <span class="bu">str</span>):</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label: <span class="bu">str</span> <span class="op">=</span> label</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.parent_nodes: List[Tuple[<span class="st">'Node'</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.target_nodes: List[Tuple[<span class="st">'Node'</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.visited: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DAG:</span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nodes_dict: Dict[<span class="bu">str</span>, Node] <span class="op">=</span> {}</span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.distances: Dict[<span class="bu">str</span>, <span class="bu">float</span>] <span class="op">=</span> {}</span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.backtrack: Dict[<span class="bu">str</span>, Optional[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_node(<span class="va">self</span>, label: <span class="bu">str</span>) <span class="op">-&gt;</span> Node:</span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> label <span class="kw">in</span> <span class="va">self</span>.nodes_dict:</span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.nodes_dict[label]</span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a>        new_node <span class="op">=</span> Node(label)</span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nodes_dict[label] <span class="op">=</span> new_node</span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_node</span>
<span id="cb191-23"><a href="#cb191-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-24"><a href="#cb191-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_dag(<span class="va">self</span>, adjacency_list: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb191-25"><a href="#cb191-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> adjacency_list:</span>
<span id="cb191-26"><a href="#cb191-26" aria-hidden="true" tabindex="-1"></a>            source_label, temp <span class="op">=</span> line.split(<span class="st">"-&gt;"</span>)</span>
<span id="cb191-27"><a href="#cb191-27" aria-hidden="true" tabindex="-1"></a>            target_label, weight_str <span class="op">=</span> temp.split(<span class="st">":"</span>)</span>
<span id="cb191-28"><a href="#cb191-28" aria-hidden="true" tabindex="-1"></a>            weight <span class="op">=</span> <span class="bu">int</span>(weight_str)</span>
<span id="cb191-29"><a href="#cb191-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-30"><a href="#cb191-30" aria-hidden="true" tabindex="-1"></a>            source_node <span class="op">=</span> <span class="va">self</span>.add_node(source_label)</span>
<span id="cb191-31"><a href="#cb191-31" aria-hidden="true" tabindex="-1"></a>            target_node <span class="op">=</span> <span class="va">self</span>.add_node(target_label)</span>
<span id="cb191-32"><a href="#cb191-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-33"><a href="#cb191-33" aria-hidden="true" tabindex="-1"></a>            source_node.target_nodes.append((target_node, weight))</span>
<span id="cb191-34"><a href="#cb191-34" aria-hidden="true" tabindex="-1"></a>            target_node.parent_nodes.append((source_node, weight))</span>
<span id="cb191-35"><a href="#cb191-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-36"><a href="#cb191-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> topological_sort_util(<span class="va">self</span>, current_node: Node, sorted_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb191-37"><a href="#cb191-37" aria-hidden="true" tabindex="-1"></a>        current_node.visited <span class="op">=</span> <span class="va">True</span></span>
<span id="cb191-38"><a href="#cb191-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor, _ <span class="kw">in</span> current_node.target_nodes:</span>
<span id="cb191-39"><a href="#cb191-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> neighbor.visited:</span>
<span id="cb191-40"><a href="#cb191-40" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.topological_sort_util(neighbor, sorted_labels)</span>
<span id="cb191-41"><a href="#cb191-41" aria-hidden="true" tabindex="-1"></a>        sorted_labels.insert(<span class="dv">0</span>, current_node.label)</span>
<span id="cb191-42"><a href="#cb191-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-43"><a href="#cb191-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> topological_sort(<span class="va">self</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb191-44"><a href="#cb191-44" aria-hidden="true" tabindex="-1"></a>        sorted_labels: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb191-45"><a href="#cb191-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> <span class="va">self</span>.nodes_dict.values():</span>
<span id="cb191-46"><a href="#cb191-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> node.visited:</span>
<span id="cb191-47"><a href="#cb191-47" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.topological_sort_util(node, sorted_labels)</span>
<span id="cb191-48"><a href="#cb191-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sorted_labels</span>
<span id="cb191-49"><a href="#cb191-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-50"><a href="#cb191-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> longest_path(<span class="va">self</span>, source: <span class="bu">str</span>, sink: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb191-51"><a href="#cb191-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> label <span class="kw">in</span> <span class="va">self</span>.nodes_dict:</span>
<span id="cb191-52"><a href="#cb191-52" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.distances[label] <span class="op">=</span> <span class="bu">float</span>(<span class="st">"-inf"</span>)</span>
<span id="cb191-53"><a href="#cb191-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-54"><a href="#cb191-54" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.distances[source] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb191-55"><a href="#cb191-55" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.backtrack[source] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb191-56"><a href="#cb191-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-57"><a href="#cb191-57" aria-hidden="true" tabindex="-1"></a>        topological_order <span class="op">=</span> <span class="va">self</span>.topological_sort()</span>
<span id="cb191-58"><a href="#cb191-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> label <span class="kw">in</span> topological_order:</span>
<span id="cb191-59"><a href="#cb191-59" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> <span class="va">self</span>.nodes_dict[label]</span>
<span id="cb191-60"><a href="#cb191-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> target_node, weight <span class="kw">in</span> current_node.target_nodes:</span>
<span id="cb191-61"><a href="#cb191-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>.distances[target_node.label] <span class="op">&lt;</span> <span class="va">self</span>.distances[label] <span class="op">+</span> weight:</span>
<span id="cb191-62"><a href="#cb191-62" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.distances[target_node.label] <span class="op">=</span> <span class="va">self</span>.distances[label] <span class="op">+</span> weight</span>
<span id="cb191-63"><a href="#cb191-63" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.backtrack[target_node.label] <span class="op">=</span> label</span>
<span id="cb191-64"><a href="#cb191-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-65"><a href="#cb191-65" aria-hidden="true" tabindex="-1"></a>        path: List[<span class="bu">str</span>] <span class="op">=</span> [sink]</span>
<span id="cb191-66"><a href="#cb191-66" aria-hidden="true" tabindex="-1"></a>        current_label <span class="op">=</span> <span class="va">self</span>.backtrack[sink]</span>
<span id="cb191-67"><a href="#cb191-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_label <span class="op">!=</span> source:</span>
<span id="cb191-68"><a href="#cb191-68" aria-hidden="true" tabindex="-1"></a>            path <span class="op">=</span> [current_label] <span class="op">+</span> path</span>
<span id="cb191-69"><a href="#cb191-69" aria-hidden="true" tabindex="-1"></a>            current_label <span class="op">=</span> <span class="va">self</span>.backtrack[current_label]</span>
<span id="cb191-70"><a href="#cb191-70" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> [source] <span class="op">+</span> path</span>
<span id="cb191-71"><a href="#cb191-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.distances[sink], path</span>
<span id="cb191-72"><a href="#cb191-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-73"><a href="#cb191-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb191-74"><a href="#cb191-74" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb191-75"><a href="#cb191-75" aria-hidden="true" tabindex="-1"></a><span class="st">0</span></span>
<span id="cb191-76"><a href="#cb191-76" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb191-77"><a href="#cb191-77" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;1:7</span></span>
<span id="cb191-78"><a href="#cb191-78" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;2:4</span></span>
<span id="cb191-79"><a href="#cb191-79" aria-hidden="true" tabindex="-1"></a><span class="st">2-&gt;3:2</span></span>
<span id="cb191-80"><a href="#cb191-80" aria-hidden="true" tabindex="-1"></a><span class="st">1-&gt;4:1</span></span>
<span id="cb191-81"><a href="#cb191-81" aria-hidden="true" tabindex="-1"></a><span class="st">3-&gt;4:3</span></span>
<span id="cb191-82"><a href="#cb191-82" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb191-83"><a href="#cb191-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-84"><a href="#cb191-84" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb191-85"><a href="#cb191-85" aria-hidden="true" tabindex="-1"></a>source_label: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb191-86"><a href="#cb191-86" aria-hidden="true" tabindex="-1"></a>sink_label: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb191-87"><a href="#cb191-87" aria-hidden="true" tabindex="-1"></a>adjacency_list: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">2</span>:]</span>
<span id="cb191-88"><a href="#cb191-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-89"><a href="#cb191-89" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> DAG()</span>
<span id="cb191-90"><a href="#cb191-90" aria-hidden="true" tabindex="-1"></a>graph.construct_dag(adjacency_list)</span>
<span id="cb191-91"><a href="#cb191-91" aria-hidden="true" tabindex="-1"></a>longest_distance, longest_path <span class="op">=</span> graph.longest_path(source_label, sink_label)</span>
<span id="cb191-92"><a href="#cb191-92" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(longest_distance)</span>
<span id="cb191-93"><a href="#cb191-93" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(longest_path))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-alignment-of-two-strings" class="level1" data-number="64">
<h1 data-number="64"><span class="header-section-number">64</span> Find a Highest-Scoring Alignment of Two Strings</h1>
<p>Global Alignment Problem. Find the highest-scoring alignment between two strings using a scoring matrix.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>.</p>
<p>Return:&nbsp;The maximum alignment score of these strings followed by an alignment achieving this maximum score. Use the&nbsp;<a href="https://rosalind.info/glossary/blosum62/">BLOSUM62</a>&nbsp;scoring matrix and indel penalty σ = 5. (If multiple alignments achieving the maximum score exist, you may return any one.)</p>
<section id="sample-dataset-64" class="level2" data-number="64.1">
<h2 data-number="64.1" class="anchored" data-anchor-id="sample-dataset-64"><span class="header-section-number">64.1</span> Sample Dataset</h2>
<pre><code>PLEASANTLY
MEANLY</code></pre>
</section>
<section id="sample-output-64" class="level2" data-number="64.2">
<h2 data-number="64.2" class="anchored" data-anchor-id="sample-output-64"><span class="header-section-number">64.2</span> Sample Output</h2>
<pre><code>8
PLEASANTLY
-MEA--N-LY</code></pre>
</section>
<section id="solution-64" class="level2" data-number="64.3">
<h2 data-number="64.3" class="anchored" data-anchor-id="solution-64"><span class="header-section-number">64.3</span> Solution</h2>
<div class="sourceCode" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb194-21"><a href="#cb194-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-22"><a href="#cb194-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb194-23"><a href="#cb194-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb194-24"><a href="#cb194-24" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb194-25"><a href="#cb194-25" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb194-26"><a href="#cb194-26" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-27"><a href="#cb194-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-28"><a href="#cb194-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-29"><a href="#cb194-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-30"><a href="#cb194-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-31"><a href="#cb194-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-32"><a href="#cb194-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-33"><a href="#cb194-33" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb194-34"><a href="#cb194-34" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-35"><a href="#cb194-35" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb194-36"><a href="#cb194-36" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb194-37"><a href="#cb194-37" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-38"><a href="#cb194-38" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb194-39"><a href="#cb194-39" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-40"><a href="#cb194-40" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb194-41"><a href="#cb194-41" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb194-42"><a href="#cb194-42" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb194-43"><a href="#cb194-43" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb194-44"><a href="#cb194-44" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-45"><a href="#cb194-45" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb194-46"><a href="#cb194-46" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-47"><a href="#cb194-47" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-48"><a href="#cb194-48" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-49"><a href="#cb194-49" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb194-50"><a href="#cb194-50" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-51"><a href="#cb194-51" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb194-52"><a href="#cb194-52" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-53"><a href="#cb194-53" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb194-54"><a href="#cb194-54" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb194-55"><a href="#cb194-55" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-56"><a href="#cb194-56" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb194-57"><a href="#cb194-57" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb194-58"><a href="#cb194-58" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb194-59"><a href="#cb194-59" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb194-60"><a href="#cb194-60" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb194-61"><a href="#cb194-61" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb194-62"><a href="#cb194-62" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb194-63"><a href="#cb194-63" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-64"><a href="#cb194-64" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-65"><a href="#cb194-65" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-66"><a href="#cb194-66" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb194-67"><a href="#cb194-67" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-68"><a href="#cb194-68" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-69"><a href="#cb194-69" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-70"><a href="#cb194-70" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb194-71"><a href="#cb194-71" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb194-72"><a href="#cb194-72" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb194-73"><a href="#cb194-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb194-74"><a href="#cb194-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-75"><a href="#cb194-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> global_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, indel_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb194-76"><a href="#cb194-76" aria-hidden="true" tabindex="-1"></a>    padded_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence1</span>
<span id="cb194-77"><a href="#cb194-77" aria-hidden="true" tabindex="-1"></a>    padded_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence2</span>
<span id="cb194-78"><a href="#cb194-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-79"><a href="#cb194-79" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb194-80"><a href="#cb194-80" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[<span class="bu">str</span>]] <span class="op">=</span> [[<span class="st">''</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb194-81"><a href="#cb194-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-82"><a href="#cb194-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2)):</span>
<span id="cb194-83"><a href="#cb194-83" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>][j] <span class="op">=</span> <span class="op">-</span>indel_penalty <span class="op">*</span> j</span>
<span id="cb194-84"><a href="#cb194-84" aria-hidden="true" tabindex="-1"></a>        backtrack_matrix[<span class="dv">0</span>][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb194-85"><a href="#cb194-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-86"><a href="#cb194-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1)):</span>
<span id="cb194-87"><a href="#cb194-87" aria-hidden="true" tabindex="-1"></a>        score_matrix[i][<span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span>indel_penalty <span class="op">*</span> i</span>
<span id="cb194-88"><a href="#cb194-88" aria-hidden="true" tabindex="-1"></a>        backtrack_matrix[i][<span class="dv">0</span>] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb194-89"><a href="#cb194-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-90"><a href="#cb194-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb194-91"><a href="#cb194-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb194-92"><a href="#cb194-92" aria-hidden="true" tabindex="-1"></a>            key: Tuple[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> (padded_seq1[i], padded_seq2[j]) <span class="cf">if</span> (padded_seq1[i], padded_seq2[j]) <span class="kw">in</span> BLOSUM62 <span class="cf">else</span> (padded_seq2[j], padded_seq1[i])</span>
<span id="cb194-93"><a href="#cb194-93" aria-hidden="true" tabindex="-1"></a>            diagonal_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> BLOSUM62[key]</span>
<span id="cb194-94"><a href="#cb194-94" aria-hidden="true" tabindex="-1"></a>            up_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">-</span> indel_penalty</span>
<span id="cb194-95"><a href="#cb194-95" aria-hidden="true" tabindex="-1"></a>            left_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> indel_penalty</span>
<span id="cb194-96"><a href="#cb194-96" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(diagonal_score, up_score, left_score)</span>
<span id="cb194-97"><a href="#cb194-97" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb194-98"><a href="#cb194-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> diagonal_score:</span>
<span id="cb194-99"><a href="#cb194-99" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diagonal"</span></span>
<span id="cb194-100"><a href="#cb194-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> up_score:</span>
<span id="cb194-101"><a href="#cb194-101" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb194-102"><a href="#cb194-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb194-103"><a href="#cb194-103" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb194-104"><a href="#cb194-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-105"><a href="#cb194-105" aria-hidden="true" tabindex="-1"></a>    i: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb194-106"><a href="#cb194-106" aria-hidden="true" tabindex="-1"></a>    j: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb194-107"><a href="#cb194-107" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb194-108"><a href="#cb194-108" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb194-109"><a href="#cb194-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb194-110"><a href="#cb194-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">!=</span> <span class="dv">0</span> <span class="kw">or</span> j <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb194-111"><a href="#cb194-111" aria-hidden="true" tabindex="-1"></a>        direction: <span class="bu">str</span> <span class="op">=</span> backtrack_matrix[i][j]</span>
<span id="cb194-112"><a href="#cb194-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"diagonal"</span>:</span>
<span id="cb194-113"><a href="#cb194-113" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb194-114"><a href="#cb194-114" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb194-115"><a href="#cb194-115" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb194-116"><a href="#cb194-116" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb194-117"><a href="#cb194-117" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"up"</span>:</span>
<span id="cb194-118"><a href="#cb194-118" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb194-119"><a href="#cb194-119" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq2</span>
<span id="cb194-120"><a href="#cb194-120" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb194-121"><a href="#cb194-121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb194-122"><a href="#cb194-122" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq1</span>
<span id="cb194-123"><a href="#cb194-123" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb194-124"><a href="#cb194-124" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb194-125"><a href="#cb194-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-126"><a href="#cb194-126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score_matrix[<span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span>][<span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span>], aligned_seq1, aligned_seq2</span>
<span id="cb194-127"><a href="#cb194-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-128"><a href="#cb194-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb194-129"><a href="#cb194-129" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb194-130"><a href="#cb194-130" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb194-131"><a href="#cb194-131" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb194-132"><a href="#cb194-132" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb194-133"><a href="#cb194-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-134"><a href="#cb194-134" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb194-135"><a href="#cb194-135" aria-hidden="true" tabindex="-1"></a>sequence1: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb194-136"><a href="#cb194-136" aria-hidden="true" tabindex="-1"></a>sequence2: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb194-137"><a href="#cb194-137" aria-hidden="true" tabindex="-1"></a>alignment_score: <span class="bu">int</span></span>
<span id="cb194-138"><a href="#cb194-138" aria-hidden="true" tabindex="-1"></a>aligned_sequence1: <span class="bu">str</span></span>
<span id="cb194-139"><a href="#cb194-139" aria-hidden="true" tabindex="-1"></a>aligned_sequence2: <span class="bu">str</span></span>
<span id="cb194-140"><a href="#cb194-140" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_sequence1, aligned_sequence2 <span class="op">=</span> global_alignment(sequence1, sequence2)</span>
<span id="cb194-141"><a href="#cb194-141" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb194-142"><a href="#cb194-142" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence1)</span>
<span id="cb194-143"><a href="#cb194-143" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-local-alignment-of-two-strings" class="level1" data-number="65">
<h1 data-number="65"><span class="header-section-number">65</span> Find a Highest-Scoring Local Alignment of Two Strings</h1>
<p>Local Alignment Problem, Find the highest-scoring local alignment between two strings.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>.</p>
<p>Return:&nbsp;The maximum score of a local alignment of the strings, followed by a local alignment of these strings achieving the maximum score. Use the&nbsp;<a href="https://rosalind.info/glossary/pam250/">PAM250</a>&nbsp;scoring matrix and indel penalty σ = 5. (If multiple local alignments achieving the maximum score exist, you may return any one.)</p>
<section id="sample-dataset-65" class="level2" data-number="65.1">
<h2 data-number="65.1" class="anchored" data-anchor-id="sample-dataset-65"><span class="header-section-number">65.1</span> Sample Dataset</h2>
<pre><code>MEANLY
PENALTY</code></pre>
</section>
<section id="sample-output-65" class="level2" data-number="65.2">
<h2 data-number="65.2" class="anchored" data-anchor-id="sample-output-65"><span class="header-section-number">65.2</span> Sample Output</h2>
<pre><code>15
EANL-Y
ENALTY</code></pre>
</section>
<section id="solution-65" class="level2" data-number="65.3">
<h2 data-number="65.3" class="anchored" data-anchor-id="solution-65"><span class="header-section-number">65.3</span> Solution</h2>
<div class="sourceCode" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Optional</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>PAM250: Dict[<span class="bu">str</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> {</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'A'</span>: {<span class="st">'A'</span>: <span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">0</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">1</span>, <span class="st">'V'</span>: <span class="dv">0</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">'C'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="dv">12</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">5</span>,</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">'N'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'P'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">8</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">'D'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">4</span>, <span class="st">'E'</span>: <span class="dv">3</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">'E'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">3</span>, <span class="st">'E'</span>: <span class="dv">4</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">'F'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'F'</span>: <span class="dv">9</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="dv">0</span>, <span class="st">'Y'</span>: <span class="dv">7</span>},</span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>          <span class="st">'G'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="dv">1</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">5</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">5</span>},</span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">'H'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="dv">1</span>, <span class="st">'E'</span>: <span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'H'</span>: <span class="dv">6</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">3</span>, <span class="st">'R'</span>: <span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a>          <span class="st">'I'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="dv">1</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">5</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="dv">4</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">1</span>},</span>
<span id="cb197-20"><a href="#cb197-20" aria-hidden="true" tabindex="-1"></a>          <span class="st">'K'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">5</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb197-21"><a href="#cb197-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">3</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb197-22"><a href="#cb197-22" aria-hidden="true" tabindex="-1"></a>          <span class="st">'L'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'F'</span>: <span class="dv">2</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'L'</span>: <span class="dv">6</span>, <span class="st">'M'</span>: <span class="dv">4</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb197-23"><a href="#cb197-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'V'</span>: <span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">1</span>},</span>
<span id="cb197-24"><a href="#cb197-24" aria-hidden="true" tabindex="-1"></a>          <span class="st">'M'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="dv">0</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="dv">4</span>, <span class="st">'M'</span>: <span class="dv">6</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb197-25"><a href="#cb197-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb197-26"><a href="#cb197-26" aria-hidden="true" tabindex="-1"></a>          <span class="st">'N'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="dv">2</span>, <span class="st">'E'</span>: <span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb197-27"><a href="#cb197-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb197-28"><a href="#cb197-28" aria-hidden="true" tabindex="-1"></a>          <span class="st">'P'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb197-29"><a href="#cb197-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">6</span>, <span class="st">'Q'</span>: <span class="dv">0</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">5</span>},</span>
<span id="cb197-30"><a href="#cb197-30" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Q'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">2</span>, <span class="st">'E'</span>: <span class="dv">2</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'H'</span>: <span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb197-31"><a href="#cb197-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">4</span>, <span class="st">'R'</span>: <span class="dv">1</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb197-32"><a href="#cb197-32" aria-hidden="true" tabindex="-1"></a>          <span class="st">'R'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">3</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb197-33"><a href="#cb197-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">6</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb197-34"><a href="#cb197-34" aria-hidden="true" tabindex="-1"></a>          <span class="st">'S'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="dv">0</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb197-35"><a href="#cb197-35" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">1</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">2</span>, <span class="st">'T'</span>: <span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb197-36"><a href="#cb197-36" aria-hidden="true" tabindex="-1"></a>          <span class="st">'T'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="dv">0</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb197-37"><a href="#cb197-37" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">3</span>, <span class="st">'V'</span>: <span class="dv">0</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb197-38"><a href="#cb197-38" aria-hidden="true" tabindex="-1"></a>          <span class="st">'V'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">4</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb197-39"><a href="#cb197-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="dv">4</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb197-40"><a href="#cb197-40" aria-hidden="true" tabindex="-1"></a>          <span class="st">'W'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">8</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'F'</span>: <span class="dv">0</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb197-41"><a href="#cb197-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">'N'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'P'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'W'</span>: <span class="dv">17</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb197-42"><a href="#cb197-42" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Y'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'C'</span>: <span class="dv">0</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'F'</span>: <span class="dv">7</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb197-43"><a href="#cb197-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="dv">0</span>, <span class="st">'Y'</span>: <span class="dv">10</span>}}</span>
<span id="cb197-44"><a href="#cb197-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-45"><a href="#cb197-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> local_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, indel_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb197-46"><a href="#cb197-46" aria-hidden="true" tabindex="-1"></a>    padded_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence1</span>
<span id="cb197-47"><a href="#cb197-47" aria-hidden="true" tabindex="-1"></a>    padded_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence2</span>
<span id="cb197-48"><a href="#cb197-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-49"><a href="#cb197-49" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb197-50"><a href="#cb197-50" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[Optional[<span class="bu">str</span>]]] <span class="op">=</span> [[<span class="va">None</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb197-51"><a href="#cb197-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-52"><a href="#cb197-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb197-53"><a href="#cb197-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb197-54"><a href="#cb197-54" aria-hidden="true" tabindex="-1"></a>            key1: <span class="bu">str</span> <span class="op">=</span> padded_seq1[i] <span class="cf">if</span> padded_seq1[i] <span class="kw">in</span> PAM250 <span class="cf">else</span> padded_seq2[j]</span>
<span id="cb197-55"><a href="#cb197-55" aria-hidden="true" tabindex="-1"></a>            key2: <span class="bu">str</span> <span class="op">=</span> padded_seq2[j] <span class="cf">if</span> padded_seq1[i] <span class="kw">in</span> PAM250 <span class="cf">else</span> padded_seq1[i]</span>
<span id="cb197-56"><a href="#cb197-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-57"><a href="#cb197-57" aria-hidden="true" tabindex="-1"></a>            diagonal_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> PAM250[key1][key2]</span>
<span id="cb197-58"><a href="#cb197-58" aria-hidden="true" tabindex="-1"></a>            up_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">-</span> indel_penalty</span>
<span id="cb197-59"><a href="#cb197-59" aria-hidden="true" tabindex="-1"></a>            left_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> indel_penalty</span>
<span id="cb197-60"><a href="#cb197-60" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(diagonal_score, up_score, left_score, <span class="dv">0</span>)</span>
<span id="cb197-61"><a href="#cb197-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-62"><a href="#cb197-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> diagonal_score:</span>
<span id="cb197-63"><a href="#cb197-63" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diagonal"</span></span>
<span id="cb197-64"><a href="#cb197-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> up_score:</span>
<span id="cb197-65"><a href="#cb197-65" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb197-66"><a href="#cb197-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> left_score:</span>
<span id="cb197-67"><a href="#cb197-67" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb197-68"><a href="#cb197-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-69"><a href="#cb197-69" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb197-70"><a href="#cb197-70" aria-hidden="true" tabindex="-1"></a>    max_i: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb197-71"><a href="#cb197-71" aria-hidden="true" tabindex="-1"></a>    max_j: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb197-72"><a href="#cb197-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1)):</span>
<span id="cb197-73"><a href="#cb197-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2)):</span>
<span id="cb197-74"><a href="#cb197-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">&gt;</span> max_score:</span>
<span id="cb197-75"><a href="#cb197-75" aria-hidden="true" tabindex="-1"></a>                max_score <span class="op">=</span> score_matrix[i][j]</span>
<span id="cb197-76"><a href="#cb197-76" aria-hidden="true" tabindex="-1"></a>                max_i, max_j <span class="op">=</span> i, j</span>
<span id="cb197-77"><a href="#cb197-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-78"><a href="#cb197-78" aria-hidden="true" tabindex="-1"></a>    i: <span class="bu">int</span> <span class="op">=</span> max_i</span>
<span id="cb197-79"><a href="#cb197-79" aria-hidden="true" tabindex="-1"></a>    j: <span class="bu">int</span> <span class="op">=</span> max_j</span>
<span id="cb197-80"><a href="#cb197-80" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb197-81"><a href="#cb197-81" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb197-82"><a href="#cb197-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> backtrack_matrix[i][j] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb197-83"><a href="#cb197-83" aria-hidden="true" tabindex="-1"></a>        direction: <span class="bu">str</span> <span class="op">=</span> backtrack_matrix[i][j]</span>
<span id="cb197-84"><a href="#cb197-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"diagonal"</span>:</span>
<span id="cb197-85"><a href="#cb197-85" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb197-86"><a href="#cb197-86" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb197-87"><a href="#cb197-87" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb197-88"><a href="#cb197-88" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb197-89"><a href="#cb197-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"up"</span>:</span>
<span id="cb197-90"><a href="#cb197-90" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb197-91"><a href="#cb197-91" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq2</span>
<span id="cb197-92"><a href="#cb197-92" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb197-93"><a href="#cb197-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb197-94"><a href="#cb197-94" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq1</span>
<span id="cb197-95"><a href="#cb197-95" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb197-96"><a href="#cb197-96" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb197-97"><a href="#cb197-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-98"><a href="#cb197-98" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1, aligned_seq2</span>
<span id="cb197-99"><a href="#cb197-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-100"><a href="#cb197-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb197-101"><a href="#cb197-101" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb197-102"><a href="#cb197-102" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb197-103"><a href="#cb197-103" aria-hidden="true" tabindex="-1"></a><span class="st">PENALTY</span></span>
<span id="cb197-104"><a href="#cb197-104" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb197-105"><a href="#cb197-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-106"><a href="#cb197-106" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb197-107"><a href="#cb197-107" aria-hidden="true" tabindex="-1"></a>sequence1: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb197-108"><a href="#cb197-108" aria-hidden="true" tabindex="-1"></a>sequence2: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb197-109"><a href="#cb197-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-110"><a href="#cb197-110" aria-hidden="true" tabindex="-1"></a>alignment_score: <span class="bu">int</span></span>
<span id="cb197-111"><a href="#cb197-111" aria-hidden="true" tabindex="-1"></a>aligned_sequence1: <span class="bu">str</span></span>
<span id="cb197-112"><a href="#cb197-112" aria-hidden="true" tabindex="-1"></a>aligned_sequence2: <span class="bu">str</span></span>
<span id="cb197-113"><a href="#cb197-113" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_sequence1, aligned_sequence2 <span class="op">=</span> local_alignment(sequence1, sequence2)</span>
<span id="cb197-114"><a href="#cb197-114" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb197-115"><a href="#cb197-115" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence1)</span>
<span id="cb197-116"><a href="#cb197-116" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-edit-distance-between-two-strings" class="level1" data-number="66">
<h1 data-number="66"><span class="header-section-number">66</span> Compute the Edit Distance Between Two Strings</h1>
<p>Edit Distance Problem. Find the edit distance between two strings.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>.</p>
<p>Return:&nbsp;The&nbsp;<a href="https://rosalind.info/glossary/edit-distance/">edit distance</a>&nbsp;between these strings.</p>
<section id="sample-dataset-66" class="level2" data-number="66.1">
<h2 data-number="66.1" class="anchored" data-anchor-id="sample-dataset-66"><span class="header-section-number">66.1</span> Sample Dataset</h2>
<pre><code>PLEASANTLY
MEANLY</code></pre>
</section>
<section id="sample-output-66" class="level2" data-number="66.2">
<h2 data-number="66.2" class="anchored" data-anchor-id="sample-output-66"><span class="header-section-number">66.2</span> Sample Output</h2>
<pre><code>5</code></pre>
</section>
<section id="solution-66" class="level2" data-number="66.3">
<h2 data-number="66.3" class="anchored" data-anchor-id="solution-66"><span class="header-section-number">66.3</span> Solution</h2>
<div class="sourceCode" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_edit_distance(source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> {}</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(target) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>        distance_matrix[target_index, <span class="dv">0</span>] <span class="op">=</span> target_index</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(source) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>        distance_matrix[<span class="dv">0</span>, source_index] <span class="op">=</span> source_index</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(target)):</span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(source)):</span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> source[source_index] <span class="op">==</span> target[target_index]:</span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a>                distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> distance_matrix[target_index, source_index]</span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a>                distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> <span class="bu">min</span>([</span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index],</span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index, source_index],</span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index, source_index <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a>                ]) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distance_matrix[<span class="bu">len</span>(target), <span class="bu">len</span>(source)]</span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb200-26"><a href="#cb200-26" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb200-27"><a href="#cb200-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-28"><a href="#cb200-28" aria-hidden="true" tabindex="-1"></a>source, target <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb200-29"><a href="#cb200-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_edit_distance(source, target))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-fitting-alignment-of-two-strings" class="level1" data-number="67">
<h1 data-number="67"><span class="header-section-number">67</span> Find a Highest-Scoring Fitting Alignment of Two Strings</h1>
<p>Fitting Alignment Problem. Construct a highest-scoring fitting alignment between two strings.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA strings</a>&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, where&nbsp;<em>v</em>&nbsp;has length at most 10000 and&nbsp;<em>w</em>&nbsp;has length at most 1000.</p>
<p>Return:&nbsp;The maximum score of a fitting alignment of&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, followed by a fitting alignment achieving this maximum score. Use the simple scoring method in which matches count +1 and both the mismatch and indel penalties are equal to 1. (If multiple fitting alignments achieving the maximum score exist, you may return any one.)</p>
<section id="sample-dataset-67" class="level2" data-number="67.1">
<h2 data-number="67.1" class="anchored" data-anchor-id="sample-dataset-67"><span class="header-section-number">67.1</span> Sample Dataset</h2>
<pre><code>GTAGGCTTAAGGTTA
TAGATA</code></pre>
</section>
<section id="sample-output-67" class="level2" data-number="67.2">
<h2 data-number="67.2" class="anchored" data-anchor-id="sample-output-67"><span class="header-section-number">67.2</span> Sample Output</h2>
<pre><code>2
TAGGCTTA
TAGA--TA</code></pre>
</section>
<section id="solution-67" class="level2" data-number="67.3">
<h2 data-number="67.3" class="anchored" data-anchor-id="solution-67"><span class="header-section-number">67.3</span> Solution</h2>
<div class="sourceCode" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple, Dict</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_fitting_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>    score_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>    path_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>        score_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span>seq2_index</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>        path_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="st">"↑"</span></span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a>        path_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="st">"←"</span></span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a>    score_matrix[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2)):</span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1)):</span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true" tabindex="-1"></a>            current_position <span class="op">=</span> (seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> sequence1[seq1_index] <span class="op">==</span> sequence2[seq2_index] <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb203-19"><a href="#cb203-19" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb203-20"><a href="#cb203-20" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index] <span class="op">+</span> match_score,</span>
<span id="cb203-21"><a href="#cb203-21" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>,</span>
<span id="cb203-22"><a href="#cb203-22" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index] <span class="op">-</span> <span class="dv">1</span>,</span>
<span id="cb203-23"><a href="#cb203-23" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb203-24"><a href="#cb203-24" aria-hidden="true" tabindex="-1"></a>            score_matrix[current_position] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb203-25"><a href="#cb203-25" aria-hidden="true" tabindex="-1"></a>            path_matrix[current_position] <span class="op">=</span> [<span class="st">"↖"</span>, <span class="st">"↑"</span>, <span class="st">"←"</span>][options.index(<span class="bu">max</span>(options))]</span>
<span id="cb203-26"><a href="#cb203-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-27"><a href="#cb203-27" aria-hidden="true" tabindex="-1"></a>    final_scores <span class="op">=</span> [score_matrix[<span class="bu">len</span>(sequence2), i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb203-28"><a href="#cb203-28" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="bu">max</span>(final_scores)</span>
<span id="cb203-29"><a href="#cb203-29" aria-hidden="true" tabindex="-1"></a>    seq1_end_index <span class="op">=</span> final_scores.index(max_score)</span>
<span id="cb203-30"><a href="#cb203-30" aria-hidden="true" tabindex="-1"></a>    seq2_end_index <span class="op">=</span> <span class="bu">len</span>(sequence2)</span>
<span id="cb203-31"><a href="#cb203-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-32"><a href="#cb203-32" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb203-33"><a href="#cb203-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> seq1_end_index <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> seq2_end_index <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb203-34"><a href="#cb203-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↖"</span>:</span>
<span id="cb203-35"><a href="#cb203-35" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb203-36"><a href="#cb203-36" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb203-37"><a href="#cb203-37" aria-hidden="true" tabindex="-1"></a>            seq2_end_index, seq1_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span>, seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb203-38"><a href="#cb203-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"←"</span>:</span>
<span id="cb203-39"><a href="#cb203-39" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb203-40"><a href="#cb203-40" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb203-41"><a href="#cb203-41" aria-hidden="true" tabindex="-1"></a>            seq1_end_index <span class="op">=</span> seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb203-42"><a href="#cb203-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↑"</span>:</span>
<span id="cb203-43"><a href="#cb203-43" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb203-44"><a href="#cb203-44" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb203-45"><a href="#cb203-45" aria-hidden="true" tabindex="-1"></a>            seq2_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb203-46"><a href="#cb203-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-47"><a href="#cb203-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1[::<span class="op">-</span><span class="dv">1</span>], aligned_seq2[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb203-48"><a href="#cb203-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-49"><a href="#cb203-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb203-50"><a href="#cb203-50" aria-hidden="true" tabindex="-1"></a><span class="st">GTAGGCTTAAGGTTA</span></span>
<span id="cb203-51"><a href="#cb203-51" aria-hidden="true" tabindex="-1"></a><span class="st">TAGATA</span></span>
<span id="cb203-52"><a href="#cb203-52" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb203-53"><a href="#cb203-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-54"><a href="#cb203-54" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb203-55"><a href="#cb203-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>calculate_fitting_alignment(sequence1, sequence2), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-overlap-alignment-of-two-strings" class="level1" data-number="68">
<h1 data-number="68"><span class="header-section-number">68</span> Find a Highest-Scoring Overlap Alignment of Two Strings</h1>
<p>Overlap Alignment Problem. Construct a highest-scoring overlap alignment between two strings.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">protein strings</a>&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, each of length at most 1000.</p>
<p>Return:&nbsp;The score of an optimal overlap alignment of&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, followed by an alignment of a suffix&nbsp;<em>v’</em>&nbsp;of&nbsp;<em>v</em>&nbsp;and a prefix&nbsp;<em>w’</em>&nbsp;of&nbsp;<em>w</em>&nbsp;achieving this maximum score. Use an alignment score in which matches count +1 and both the mismatch and indel penalties are 2. (If multiple overlap alignments achieving the maximum score exist, you may return any one.)</p>
<section id="sample-dataset-68" class="level2" data-number="68.1">
<h2 data-number="68.1" class="anchored" data-anchor-id="sample-dataset-68"><span class="header-section-number">68.1</span> Sample Dataset</h2>
<pre><code>PAWHEAE
HEAGAWGHEE</code></pre>
</section>
<section id="sample-output-68" class="level2" data-number="68.2">
<h2 data-number="68.2" class="anchored" data-anchor-id="sample-output-68"><span class="header-section-number">68.2</span> Sample Output</h2>
<pre><code>1
HEAE
HEAG</code></pre>
</section>
<section id="solution-68" class="level2" data-number="68.3">
<h2 data-number="68.3" class="anchored" data-anchor-id="solution-68"><span class="header-section-number">68.3</span> Solution</h2>
<div class="sourceCode" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple, Dict</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_overlap_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, mismatch_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">2</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>    score_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>    path_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>        score_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> seq2_index <span class="op">*</span> mismatch_penalty</span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>        path_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="st">"↑"</span></span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a>        path_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="st">"←"</span></span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>    score_matrix[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2)):</span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1)):</span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a>            current_position <span class="op">=</span> (seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> sequence1[seq1_index] <span class="op">==</span> sequence2[seq2_index] <span class="cf">else</span> mismatch_penalty</span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb206-20"><a href="#cb206-20" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index] <span class="op">+</span> match_score,</span>
<span id="cb206-21"><a href="#cb206-21" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">+</span> mismatch_penalty,</span>
<span id="cb206-22"><a href="#cb206-22" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index] <span class="op">+</span> mismatch_penalty,</span>
<span id="cb206-23"><a href="#cb206-23" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb206-24"><a href="#cb206-24" aria-hidden="true" tabindex="-1"></a>            score_matrix[current_position] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb206-25"><a href="#cb206-25" aria-hidden="true" tabindex="-1"></a>            path_matrix[current_position] <span class="op">=</span> [<span class="st">"↖"</span>, <span class="st">"↑"</span>, <span class="st">"←"</span>][options.index(<span class="bu">max</span>(options))]</span>
<span id="cb206-26"><a href="#cb206-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-27"><a href="#cb206-27" aria-hidden="true" tabindex="-1"></a>    final_scores <span class="op">=</span> [score_matrix[seq2_index, <span class="bu">len</span>(sequence1)] <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb206-28"><a href="#cb206-28" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="bu">max</span>(final_scores)</span>
<span id="cb206-29"><a href="#cb206-29" aria-hidden="true" tabindex="-1"></a>    seq2_end_index <span class="op">=</span> final_scores.index(max_score)</span>
<span id="cb206-30"><a href="#cb206-30" aria-hidden="true" tabindex="-1"></a>    seq1_end_index <span class="op">=</span> <span class="bu">len</span>(sequence1)</span>
<span id="cb206-31"><a href="#cb206-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-32"><a href="#cb206-32" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb206-33"><a href="#cb206-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> seq1_end_index <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> seq2_end_index <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb206-34"><a href="#cb206-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↖"</span>:</span>
<span id="cb206-35"><a href="#cb206-35" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb206-36"><a href="#cb206-36" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb206-37"><a href="#cb206-37" aria-hidden="true" tabindex="-1"></a>            seq2_end_index, seq1_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span>, seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb206-38"><a href="#cb206-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"←"</span>:</span>
<span id="cb206-39"><a href="#cb206-39" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb206-40"><a href="#cb206-40" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb206-41"><a href="#cb206-41" aria-hidden="true" tabindex="-1"></a>            seq1_end_index <span class="op">=</span> seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb206-42"><a href="#cb206-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↑"</span>:</span>
<span id="cb206-43"><a href="#cb206-43" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb206-44"><a href="#cb206-44" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb206-45"><a href="#cb206-45" aria-hidden="true" tabindex="-1"></a>            seq2_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb206-46"><a href="#cb206-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-47"><a href="#cb206-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1[::<span class="op">-</span><span class="dv">1</span>], aligned_seq2[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb206-48"><a href="#cb206-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-49"><a href="#cb206-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb206-50"><a href="#cb206-50" aria-hidden="true" tabindex="-1"></a><span class="st">PAWHEAE</span></span>
<span id="cb206-51"><a href="#cb206-51" aria-hidden="true" tabindex="-1"></a><span class="st">HEAGAWGHEE</span></span>
<span id="cb206-52"><a href="#cb206-52" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb206-53"><a href="#cb206-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-54"><a href="#cb206-54" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb206-55"><a href="#cb206-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>calculate_overlap_alignment(sequence1, sequence2), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="align-two-strings-using-affine-gap-penalties" class="level1" data-number="69">
<h1 data-number="69"><span class="header-section-number">69</span> Align Two Strings Using Affine Gap Penalties</h1>
<p>Alignment with Affine Gap Penalties Problem. Construct a highest-scoring global alignment of two strings (with affine gap penalties).</p>
<p>Given:&nbsp;Two amino acid strings&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>&nbsp;(each of length at most 100).</p>
<p>Return:&nbsp;The maximum alignment score between&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, followed by an alignment of&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>&nbsp;achieving this maximum score. Use the&nbsp;<a href="https://rosalind.info/glossary/blosum62/">BLOSUM62</a>&nbsp;scoring matrix, a gap opening penalty of 11, and a gap extension penalty of 1.</p>
<section id="sample-dataset-69" class="level2" data-number="69.1">
<h2 data-number="69.1" class="anchored" data-anchor-id="sample-dataset-69"><span class="header-section-number">69.1</span> Sample Dataset</h2>
<pre><code>PRTEINS
PRTWPSEIN</code></pre>
</section>
<section id="sample-output-69" class="level2" data-number="69.2">
<h2 data-number="69.2" class="anchored" data-anchor-id="sample-output-69"><span class="header-section-number">69.2</span> Sample Output</h2>
<pre><code>8
PRT---EINS
PRTWPSEIN-</code></pre>
</section>
<section id="solution-69" class="level2" data-number="69.3">
<h2 data-number="69.3" class="anchored" data-anchor-id="solution-69"><span class="header-section-number">69.3</span> Solution</h2>
<div class="sourceCode" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List, Optional</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-17"><a href="#cb209-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-18"><a href="#cb209-18" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-19"><a href="#cb209-19" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb209-20"><a href="#cb209-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb209-21"><a href="#cb209-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-22"><a href="#cb209-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb209-23"><a href="#cb209-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb209-24"><a href="#cb209-24" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb209-25"><a href="#cb209-25" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb209-26"><a href="#cb209-26" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-27"><a href="#cb209-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-28"><a href="#cb209-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-29"><a href="#cb209-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-30"><a href="#cb209-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-31"><a href="#cb209-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-32"><a href="#cb209-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-33"><a href="#cb209-33" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb209-34"><a href="#cb209-34" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-35"><a href="#cb209-35" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb209-36"><a href="#cb209-36" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb209-37"><a href="#cb209-37" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-38"><a href="#cb209-38" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb209-39"><a href="#cb209-39" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-40"><a href="#cb209-40" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb209-41"><a href="#cb209-41" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb209-42"><a href="#cb209-42" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb209-43"><a href="#cb209-43" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb209-44"><a href="#cb209-44" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-45"><a href="#cb209-45" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb209-46"><a href="#cb209-46" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-47"><a href="#cb209-47" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-48"><a href="#cb209-48" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-49"><a href="#cb209-49" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb209-50"><a href="#cb209-50" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-51"><a href="#cb209-51" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb209-52"><a href="#cb209-52" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-53"><a href="#cb209-53" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb209-54"><a href="#cb209-54" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb209-55"><a href="#cb209-55" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-56"><a href="#cb209-56" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb209-57"><a href="#cb209-57" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb209-58"><a href="#cb209-58" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb209-59"><a href="#cb209-59" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb209-60"><a href="#cb209-60" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb209-61"><a href="#cb209-61" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb209-62"><a href="#cb209-62" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb209-63"><a href="#cb209-63" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-64"><a href="#cb209-64" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-65"><a href="#cb209-65" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-66"><a href="#cb209-66" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb209-67"><a href="#cb209-67" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-68"><a href="#cb209-68" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-69"><a href="#cb209-69" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-70"><a href="#cb209-70" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb209-71"><a href="#cb209-71" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb209-72"><a href="#cb209-72" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb209-73"><a href="#cb209-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb209-74"><a href="#cb209-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-75"><a href="#cb209-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> insert_gap(sequence: <span class="bu">str</span>, position: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb209-76"><a href="#cb209-76" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Insert a gap ('-') into the sequence at the specified position."""</span></span>
<span id="cb209-77"><a href="#cb209-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[:position] <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> sequence[position:]</span>
<span id="cb209-78"><a href="#cb209-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-79"><a href="#cb209-79" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> global_alignment_affine(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>, gap_open_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">11</span>, gap_extend_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb209-80"><a href="#cb209-80" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb209-81"><a href="#cb209-81" aria-hidden="true" tabindex="-1"></a><span class="co">    Perform global sequence alignment with affine gap penalty.</span></span>
<span id="cb209-82"><a href="#cb209-82" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb209-83"><a href="#cb209-83" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb209-84"><a href="#cb209-84" aria-hidden="true" tabindex="-1"></a><span class="co">    seq1 (str): First sequence to align</span></span>
<span id="cb209-85"><a href="#cb209-85" aria-hidden="true" tabindex="-1"></a><span class="co">    seq2 (str): Second sequence to align</span></span>
<span id="cb209-86"><a href="#cb209-86" aria-hidden="true" tabindex="-1"></a><span class="co">    gap_open_penalty (int): Penalty for opening a gap</span></span>
<span id="cb209-87"><a href="#cb209-87" aria-hidden="true" tabindex="-1"></a><span class="co">    gap_extend_penalty (int): Penalty for extending a gap</span></span>
<span id="cb209-88"><a href="#cb209-88" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb209-89"><a href="#cb209-89" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb209-90"><a href="#cb209-90" aria-hidden="true" tabindex="-1"></a><span class="co">    Tuple[int, str, str]: Alignment score and aligned sequences</span></span>
<span id="cb209-91"><a href="#cb209-91" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb209-92"><a href="#cb209-92" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> BLOSUM62</span>
<span id="cb209-93"><a href="#cb209-93" aria-hidden="true" tabindex="-1"></a>    match_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb209-94"><a href="#cb209-94" aria-hidden="true" tabindex="-1"></a>    gap_seq1_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb209-95"><a href="#cb209-95" aria-hidden="true" tabindex="-1"></a>    gap_seq2_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb209-96"><a href="#cb209-96" aria-hidden="true" tabindex="-1"></a>    prev_match: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb209-97"><a href="#cb209-97" aria-hidden="true" tabindex="-1"></a>    prev_gap_seq1: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb209-98"><a href="#cb209-98" aria-hidden="true" tabindex="-1"></a>    prev_gap_seq2: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb209-99"><a href="#cb209-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-100"><a href="#cb209-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize matrices</span></span>
<span id="cb209-101"><a href="#cb209-101" aria-hidden="true" tabindex="-1"></a>    gap_seq1_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> match_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> gap_seq2_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb209-102"><a href="#cb209-102" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb209-103"><a href="#cb209-103" aria-hidden="true" tabindex="-1"></a>        gap_seq1_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (i <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb209-104"><a href="#cb209-104" aria-hidden="true" tabindex="-1"></a>        match_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (i <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb209-105"><a href="#cb209-105" aria-hidden="true" tabindex="-1"></a>        gap_seq2_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">*</span> <span class="dv">10</span>  <span class="co"># Large penalty to avoid this case</span></span>
<span id="cb209-106"><a href="#cb209-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb209-107"><a href="#cb209-107" aria-hidden="true" tabindex="-1"></a>        gap_seq2_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (j <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb209-108"><a href="#cb209-108" aria-hidden="true" tabindex="-1"></a>        match_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (j <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb209-109"><a href="#cb209-109" aria-hidden="true" tabindex="-1"></a>        gap_seq1_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">*</span> <span class="dv">10</span>  <span class="co"># Large penalty to avoid this case</span></span>
<span id="cb209-110"><a href="#cb209-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-111"><a href="#cb209-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill matrices</span></span>
<span id="cb209-112"><a href="#cb209-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb209-113"><a href="#cb209-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb209-114"><a href="#cb209-114" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate scores for gap in seq1</span></span>
<span id="cb209-115"><a href="#cb209-115" aria-hidden="true" tabindex="-1"></a>            gap_seq1_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb209-116"><a href="#cb209-116" aria-hidden="true" tabindex="-1"></a>                gap_seq1_score[i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">+</span> gap_extend_penalty,</span>
<span id="cb209-117"><a href="#cb209-117" aria-hidden="true" tabindex="-1"></a>                match_score[i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">+</span> gap_open_penalty</span>
<span id="cb209-118"><a href="#cb209-118" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb209-119"><a href="#cb209-119" aria-hidden="true" tabindex="-1"></a>            gap_seq1_score[i, j] <span class="op">=</span> <span class="bu">max</span>(gap_seq1_options)</span>
<span id="cb209-120"><a href="#cb209-120" aria-hidden="true" tabindex="-1"></a>            prev_gap_seq1[i, j] <span class="op">=</span> gap_seq1_options.index(gap_seq1_score[i, j])</span>
<span id="cb209-121"><a href="#cb209-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-122"><a href="#cb209-122" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate scores for gap in seq2</span></span>
<span id="cb209-123"><a href="#cb209-123" aria-hidden="true" tabindex="-1"></a>            gap_seq2_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb209-124"><a href="#cb209-124" aria-hidden="true" tabindex="-1"></a>                gap_seq2_score[i, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_extend_penalty,</span>
<span id="cb209-125"><a href="#cb209-125" aria-hidden="true" tabindex="-1"></a>                match_score[i, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_open_penalty</span>
<span id="cb209-126"><a href="#cb209-126" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb209-127"><a href="#cb209-127" aria-hidden="true" tabindex="-1"></a>            gap_seq2_score[i, j] <span class="op">=</span> <span class="bu">max</span>(gap_seq2_options)</span>
<span id="cb209-128"><a href="#cb209-128" aria-hidden="true" tabindex="-1"></a>            prev_gap_seq2[i, j] <span class="op">=</span> gap_seq2_options.index(gap_seq2_score[i, j])</span>
<span id="cb209-129"><a href="#cb209-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-130"><a href="#cb209-130" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate match/mismatch score</span></span>
<span id="cb209-131"><a href="#cb209-131" aria-hidden="true" tabindex="-1"></a>            blosum_score: <span class="bu">int</span> <span class="op">=</span> scoring_matrix.get((seq1[i<span class="op">-</span><span class="dv">1</span>], seq2[j<span class="op">-</span><span class="dv">1</span>]), scoring_matrix.get((seq2[j<span class="op">-</span><span class="dv">1</span>], seq1[i<span class="op">-</span><span class="dv">1</span>]), <span class="dv">0</span>))</span>
<span id="cb209-132"><a href="#cb209-132" aria-hidden="true" tabindex="-1"></a>            match_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb209-133"><a href="#cb209-133" aria-hidden="true" tabindex="-1"></a>                gap_seq1_score[i, j],</span>
<span id="cb209-134"><a href="#cb209-134" aria-hidden="true" tabindex="-1"></a>                match_score[i <span class="op">-</span> <span class="dv">1</span>, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> blosum_score,</span>
<span id="cb209-135"><a href="#cb209-135" aria-hidden="true" tabindex="-1"></a>                gap_seq2_score[i, j]</span>
<span id="cb209-136"><a href="#cb209-136" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb209-137"><a href="#cb209-137" aria-hidden="true" tabindex="-1"></a>            match_score[i, j] <span class="op">=</span> <span class="bu">max</span>(match_options)</span>
<span id="cb209-138"><a href="#cb209-138" aria-hidden="true" tabindex="-1"></a>            prev_match[i, j] <span class="op">=</span> match_options.index(match_score[i, j])</span>
<span id="cb209-139"><a href="#cb209-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-140"><a href="#cb209-140" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback</span></span>
<span id="cb209-141"><a href="#cb209-141" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="bu">len</span>(seq1), <span class="bu">len</span>(seq2)</span>
<span id="cb209-142"><a href="#cb209-142" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> seq1, seq2</span>
<span id="cb209-143"><a href="#cb209-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-144"><a href="#cb209-144" aria-hidden="true" tabindex="-1"></a>    scores: List[<span class="bu">int</span>] <span class="op">=</span> [gap_seq1_score[i, j], match_score[i, j], gap_seq2_score[i, j]]</span>
<span id="cb209-145"><a href="#cb209-145" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">int</span> <span class="op">=</span> <span class="bu">max</span>(scores)</span>
<span id="cb209-146"><a href="#cb209-146" aria-hidden="true" tabindex="-1"></a>    current_matrix: <span class="bu">int</span> <span class="op">=</span> scores.index(max_score)</span>
<span id="cb209-147"><a href="#cb209-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-148"><a href="#cb209-148" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">*</span> j <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb209-149"><a href="#cb209-149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_matrix <span class="op">==</span> <span class="dv">0</span>:  <span class="co"># In gap_seq1_score matrix</span></span>
<span id="cb209-150"><a href="#cb209-150" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_gap_seq1[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb209-151"><a href="#cb209-151" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb209-152"><a href="#cb209-152" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb209-153"><a href="#cb209-153" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> insert_gap(aligned_seq2, j)</span>
<span id="cb209-154"><a href="#cb209-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> current_matrix <span class="op">==</span> <span class="dv">1</span>:  <span class="co"># In match_score matrix</span></span>
<span id="cb209-155"><a href="#cb209-155" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_match[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb209-156"><a href="#cb209-156" aria-hidden="true" tabindex="-1"></a>                i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb209-157"><a href="#cb209-157" aria-hidden="true" tabindex="-1"></a>                j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb209-158"><a href="#cb209-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb209-159"><a href="#cb209-159" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> prev_match[i, j]</span>
<span id="cb209-160"><a href="#cb209-160" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:  <span class="co"># In gap_seq2_score matrix</span></span>
<span id="cb209-161"><a href="#cb209-161" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_gap_seq2[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb209-162"><a href="#cb209-162" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb209-163"><a href="#cb209-163" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb209-164"><a href="#cb209-164" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> insert_gap(aligned_seq1, i)</span>
<span id="cb209-165"><a href="#cb209-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-166"><a href="#cb209-166" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle remaining overhangs</span></span>
<span id="cb209-167"><a href="#cb209-167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb209-168"><a href="#cb209-168" aria-hidden="true" tabindex="-1"></a>        aligned_seq2 <span class="op">=</span> insert_gap(aligned_seq2, <span class="dv">0</span>)</span>
<span id="cb209-169"><a href="#cb209-169" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb209-170"><a href="#cb209-170" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> j <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb209-171"><a href="#cb209-171" aria-hidden="true" tabindex="-1"></a>        aligned_seq1 <span class="op">=</span> insert_gap(aligned_seq1, <span class="dv">0</span>)</span>
<span id="cb209-172"><a href="#cb209-172" aria-hidden="true" tabindex="-1"></a>        j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb209-173"><a href="#cb209-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-174"><a href="#cb209-174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1, aligned_seq2</span>
<span id="cb209-175"><a href="#cb209-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-176"><a href="#cb209-176" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb209-177"><a href="#cb209-177" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb209-178"><a href="#cb209-178" aria-hidden="true" tabindex="-1"></a><span class="st">PRTEINS</span></span>
<span id="cb209-179"><a href="#cb209-179" aria-hidden="true" tabindex="-1"></a><span class="st">PRTWPSEIN</span></span>
<span id="cb209-180"><a href="#cb209-180" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb209-181"><a href="#cb209-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-182"><a href="#cb209-182" aria-hidden="true" tabindex="-1"></a>seq1, seq2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb209-183"><a href="#cb209-183" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_seq1, aligned_seq2 <span class="op">=</span> global_alignment_affine(seq1, seq2)</span>
<span id="cb209-184"><a href="#cb209-184" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score, aligned_seq1, aligned_seq2, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-middle-edge-in-an-alignment-graph-in-linear-space" class="level1" data-number="70">
<h1 data-number="70"><span class="header-section-number">70</span> Find a Middle Edge in an Alignment Graph in Linear Space</h1>
<p>Middle Edge in Linear Space Problem. Find a middle edge in the alignment graph in linear space.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>.</p>
<p>Return:&nbsp;A middle edge in the alignment graph of these strings, where the optimal path is defined by the&nbsp;<a href="https://rosalind.info/glossary/blosum62/">BLOSUM62</a>&nbsp;scoring matrix and a linear indel penalty equal to 5. Return the middle edge in the form”(<em>i</em>,&nbsp;<em>j</em>) (<em>k</em>,&nbsp;<em>l</em>)“, where (<em>i</em>,&nbsp;<em>j</em>) connects to (<em>k</em>,&nbsp;<em>l</em>).</p>
<section id="sample-dataset-70" class="level2" data-number="70.1">
<h2 data-number="70.1" class="anchored" data-anchor-id="sample-dataset-70"><span class="header-section-number">70.1</span> Sample Dataset</h2>
<pre><code>PLEASANTLY
MEASNLY</code></pre>
</section>
<section id="sample-output-70" class="level2" data-number="70.2">
<h2 data-number="70.2" class="anchored" data-anchor-id="sample-output-70"><span class="header-section-number">70.2</span> Sample Output</h2>
<pre><code>(4, 3) (5, 4)</code></pre>
</section>
<section id="solution-70" class="level2" data-number="70.3">
<h2 data-number="70.3" class="anchored" data-anchor-id="solution-70"><span class="header-section-number">70.3</span> Solution</h2>
<div class="sourceCode" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> floor</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-23"><a href="#cb212-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb212-24"><a href="#cb212-24" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb212-25"><a href="#cb212-25" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb212-26"><a href="#cb212-26" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb212-27"><a href="#cb212-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-28"><a href="#cb212-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-29"><a href="#cb212-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-30"><a href="#cb212-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-31"><a href="#cb212-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-32"><a href="#cb212-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-33"><a href="#cb212-33" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-34"><a href="#cb212-34" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb212-35"><a href="#cb212-35" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-36"><a href="#cb212-36" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb212-37"><a href="#cb212-37" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb212-38"><a href="#cb212-38" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-39"><a href="#cb212-39" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb212-40"><a href="#cb212-40" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-41"><a href="#cb212-41" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb212-42"><a href="#cb212-42" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb212-43"><a href="#cb212-43" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb212-44"><a href="#cb212-44" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb212-45"><a href="#cb212-45" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-46"><a href="#cb212-46" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb212-47"><a href="#cb212-47" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-48"><a href="#cb212-48" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-49"><a href="#cb212-49" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-50"><a href="#cb212-50" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb212-51"><a href="#cb212-51" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-52"><a href="#cb212-52" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb212-53"><a href="#cb212-53" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-54"><a href="#cb212-54" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb212-55"><a href="#cb212-55" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb212-56"><a href="#cb212-56" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-57"><a href="#cb212-57" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb212-58"><a href="#cb212-58" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb212-59"><a href="#cb212-59" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb212-60"><a href="#cb212-60" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb212-61"><a href="#cb212-61" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb212-62"><a href="#cb212-62" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb212-63"><a href="#cb212-63" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb212-64"><a href="#cb212-64" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-65"><a href="#cb212-65" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-66"><a href="#cb212-66" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-67"><a href="#cb212-67" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb212-68"><a href="#cb212-68" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-69"><a href="#cb212-69" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-70"><a href="#cb212-70" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-71"><a href="#cb212-71" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb212-72"><a href="#cb212-72" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb212-73"><a href="#cb212-73" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb212-74"><a href="#cb212-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb212-75"><a href="#cb212-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-76"><a href="#cb212-76" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_scores(</span>
<span id="cb212-77"><a href="#cb212-77" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb212-78"><a href="#cb212-78" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb212-79"><a href="#cb212-79" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb212-80"><a href="#cb212-80" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb212-81"><a href="#cb212-81" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], List[<span class="bu">int</span>]]:</span>
<span id="cb212-82"><a href="#cb212-82" aria-hidden="true" tabindex="-1"></a>    current_scores <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> gap_penalty, gap_penalty))</span>
<span id="cb212-83"><a href="#cb212-83" aria-hidden="true" tabindex="-1"></a>    backtrack <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb212-84"><a href="#cb212-84" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb212-85"><a href="#cb212-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb212-86"><a href="#cb212-86" aria-hidden="true" tabindex="-1"></a>        previous_scores <span class="op">=</span> current_scores[:]</span>
<span id="cb212-87"><a href="#cb212-87" aria-hidden="true" tabindex="-1"></a>        current_scores[<span class="dv">0</span>] <span class="op">=</span> previous_scores[<span class="dv">0</span>] <span class="op">+</span> gap_penalty</span>
<span id="cb212-88"><a href="#cb212-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb212-89"><a href="#cb212-89" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb212-90"><a href="#cb212-90" aria-hidden="true" tabindex="-1"></a>                previous_scores[i] <span class="op">+</span> gap_penalty,</span>
<span id="cb212-91"><a href="#cb212-91" aria-hidden="true" tabindex="-1"></a>                current_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_penalty,</span>
<span id="cb212-92"><a href="#cb212-92" aria-hidden="true" tabindex="-1"></a>                previous_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> scoring_matrix.get(</span>
<span id="cb212-93"><a href="#cb212-93" aria-hidden="true" tabindex="-1"></a>                    (sequence1[i <span class="op">-</span> <span class="dv">1</span>], sequence2[j <span class="op">-</span> <span class="dv">1</span>]),</span>
<span id="cb212-94"><a href="#cb212-94" aria-hidden="true" tabindex="-1"></a>                    scoring_matrix.get((sequence2[j <span class="op">-</span> <span class="dv">1</span>], sequence1[i <span class="op">-</span> <span class="dv">1</span>]), <span class="dv">0</span>)</span>
<span id="cb212-95"><a href="#cb212-95" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb212-96"><a href="#cb212-96" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb212-97"><a href="#cb212-97" aria-hidden="true" tabindex="-1"></a>            current_scores[i] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb212-98"><a href="#cb212-98" aria-hidden="true" tabindex="-1"></a>            backtrack[i] <span class="op">=</span> options.index(current_scores[i])</span>
<span id="cb212-99"><a href="#cb212-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb212-100"><a href="#cb212-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> current_scores, backtrack</span>
<span id="cb212-101"><a href="#cb212-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-102"><a href="#cb212-102" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_middle_edge(</span>
<span id="cb212-103"><a href="#cb212-103" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb212-104"><a href="#cb212-104" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb212-105"><a href="#cb212-105" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb212-106"><a href="#cb212-106" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb212-107"><a href="#cb212-107" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb212-108"><a href="#cb212-108" aria-hidden="true" tabindex="-1"></a>    midpoint <span class="op">=</span> floor(<span class="bu">len</span>(sequence2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb212-109"><a href="#cb212-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb212-110"><a href="#cb212-110" aria-hidden="true" tabindex="-1"></a>    forward_scores, _ <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb212-111"><a href="#cb212-111" aria-hidden="true" tabindex="-1"></a>        sequence1, sequence2[:midpoint], scoring_matrix, gap_penalty</span>
<span id="cb212-112"><a href="#cb212-112" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb212-113"><a href="#cb212-113" aria-hidden="true" tabindex="-1"></a>    reverse_scores, reverse_backtrack <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb212-114"><a href="#cb212-114" aria-hidden="true" tabindex="-1"></a>        sequence1[::<span class="op">-</span><span class="dv">1</span>], sequence2[midpoint:][::<span class="op">-</span><span class="dv">1</span>], scoring_matrix, gap_penalty</span>
<span id="cb212-115"><a href="#cb212-115" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb212-116"><a href="#cb212-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb212-117"><a href="#cb212-117" aria-hidden="true" tabindex="-1"></a>    total_scores <span class="op">=</span> [f <span class="op">+</span> r <span class="cf">for</span> f, r <span class="kw">in</span> <span class="bu">zip</span>(forward_scores, reverse_scores[::<span class="op">-</span><span class="dv">1</span>])]</span>
<span id="cb212-118"><a href="#cb212-118" aria-hidden="true" tabindex="-1"></a>    best_score_index <span class="op">=</span> total_scores.index(<span class="bu">max</span>(total_scores))</span>
<span id="cb212-119"><a href="#cb212-119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb212-120"><a href="#cb212-120" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> (best_score_index, midpoint)</span>
<span id="cb212-121"><a href="#cb212-121" aria-hidden="true" tabindex="-1"></a>    possible_moves <span class="op">=</span> [</span>
<span id="cb212-122"><a href="#cb212-122" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>], start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb212-123"><a href="#cb212-123" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>]),</span>
<span id="cb212-124"><a href="#cb212-124" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb212-125"><a href="#cb212-125" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb212-126"><a href="#cb212-126" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> possible_moves[reverse_backtrack[::<span class="op">-</span><span class="dv">1</span>][best_score_index]]</span>
<span id="cb212-127"><a href="#cb212-127" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb212-128"><a href="#cb212-128" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (start_node, end_node)</span>
<span id="cb212-129"><a href="#cb212-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-130"><a href="#cb212-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb212-131"><a href="#cb212-131" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb212-132"><a href="#cb212-132" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb212-133"><a href="#cb212-133" aria-hidden="true" tabindex="-1"></a><span class="st">MEASNLY</span></span>
<span id="cb212-134"><a href="#cb212-134" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb212-135"><a href="#cb212-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-136"><a href="#cb212-136" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb212-137"><a href="#cb212-137" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_middle_edge(sequence1, sequence2, BLOSUM62, <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb212-138"><a href="#cb212-138" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="align-two-strings-using-linear-space" class="level1" data-number="71">
<h1 data-number="71"><span class="header-section-number">71</span> Align Two Strings Using Linear Space</h1>
<p>Global Alignment in Linear Space Problem. Find the highest-scoring alignment between two strings using a scoring matrix in linear space.</p>
<p>Given:&nbsp;Two&nbsp;<strong>long</strong>&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>&nbsp;(of length approximately 10,000).</p>
<p>Return:&nbsp;The maximum alignment score of these strings, followed by an alignment achieving this maximum score. Use the&nbsp;<a href="https://rosalind.info/glossary/blosum62/">BLOSUM62</a>&nbsp;scoring matrix and indel penalty σ = 5.</p>
<section id="sample-dataset-71" class="level2" data-number="71.1">
<h2 data-number="71.1" class="anchored" data-anchor-id="sample-dataset-71"><span class="header-section-number">71.1</span> Sample Dataset</h2>
<pre><code>PLEASANTLY
MEANLY</code></pre>
</section>
<section id="sample-output-71" class="level2" data-number="71.2">
<h2 data-number="71.2" class="anchored" data-anchor-id="sample-output-71"><span class="header-section-number">71.2</span> Sample Output</h2>
<pre><code>8
PLEASANTLY
-MEA--N-LY</code></pre>
</section>
<section id="solution-71" class="level2" data-number="71.3">
<h2 data-number="71.3" class="anchored" data-anchor-id="solution-71"><span class="header-section-number">71.3</span> Solution</h2>
<div class="sourceCode" id="cb215"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> floor</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-19"><a href="#cb215-19" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-20"><a href="#cb215-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb215-21"><a href="#cb215-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb215-22"><a href="#cb215-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-23"><a href="#cb215-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb215-24"><a href="#cb215-24" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb215-25"><a href="#cb215-25" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb215-26"><a href="#cb215-26" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb215-27"><a href="#cb215-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-28"><a href="#cb215-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-29"><a href="#cb215-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-30"><a href="#cb215-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-31"><a href="#cb215-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-32"><a href="#cb215-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-33"><a href="#cb215-33" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-34"><a href="#cb215-34" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb215-35"><a href="#cb215-35" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-36"><a href="#cb215-36" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb215-37"><a href="#cb215-37" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb215-38"><a href="#cb215-38" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-39"><a href="#cb215-39" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb215-40"><a href="#cb215-40" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-41"><a href="#cb215-41" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb215-42"><a href="#cb215-42" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb215-43"><a href="#cb215-43" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb215-44"><a href="#cb215-44" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb215-45"><a href="#cb215-45" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-46"><a href="#cb215-46" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb215-47"><a href="#cb215-47" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-48"><a href="#cb215-48" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-49"><a href="#cb215-49" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-50"><a href="#cb215-50" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb215-51"><a href="#cb215-51" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-52"><a href="#cb215-52" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb215-53"><a href="#cb215-53" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-54"><a href="#cb215-54" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb215-55"><a href="#cb215-55" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb215-56"><a href="#cb215-56" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-57"><a href="#cb215-57" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb215-58"><a href="#cb215-58" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb215-59"><a href="#cb215-59" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb215-60"><a href="#cb215-60" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb215-61"><a href="#cb215-61" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb215-62"><a href="#cb215-62" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb215-63"><a href="#cb215-63" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb215-64"><a href="#cb215-64" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-65"><a href="#cb215-65" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-66"><a href="#cb215-66" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-67"><a href="#cb215-67" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb215-68"><a href="#cb215-68" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-69"><a href="#cb215-69" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-70"><a href="#cb215-70" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-71"><a href="#cb215-71" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb215-72"><a href="#cb215-72" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb215-73"><a href="#cb215-73" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb215-74"><a href="#cb215-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb215-75"><a href="#cb215-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-76"><a href="#cb215-76" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_scores(</span>
<span id="cb215-77"><a href="#cb215-77" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb215-78"><a href="#cb215-78" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb215-79"><a href="#cb215-79" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb215-80"><a href="#cb215-80" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb215-81"><a href="#cb215-81" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], List[<span class="bu">int</span>]]:</span>
<span id="cb215-82"><a href="#cb215-82" aria-hidden="true" tabindex="-1"></a>    current_scores <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> gap_penalty, gap_penalty))</span>
<span id="cb215-83"><a href="#cb215-83" aria-hidden="true" tabindex="-1"></a>    backtrack <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb215-84"><a href="#cb215-84" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-85"><a href="#cb215-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb215-86"><a href="#cb215-86" aria-hidden="true" tabindex="-1"></a>        previous_scores <span class="op">=</span> current_scores[:]</span>
<span id="cb215-87"><a href="#cb215-87" aria-hidden="true" tabindex="-1"></a>        current_scores[<span class="dv">0</span>] <span class="op">=</span> previous_scores[<span class="dv">0</span>] <span class="op">+</span> gap_penalty</span>
<span id="cb215-88"><a href="#cb215-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb215-89"><a href="#cb215-89" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb215-90"><a href="#cb215-90" aria-hidden="true" tabindex="-1"></a>                previous_scores[i] <span class="op">+</span> gap_penalty,</span>
<span id="cb215-91"><a href="#cb215-91" aria-hidden="true" tabindex="-1"></a>                current_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_penalty,</span>
<span id="cb215-92"><a href="#cb215-92" aria-hidden="true" tabindex="-1"></a>                previous_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> scoring_matrix.get(</span>
<span id="cb215-93"><a href="#cb215-93" aria-hidden="true" tabindex="-1"></a>                    (sequence1[i <span class="op">-</span> <span class="dv">1</span>], sequence2[j <span class="op">-</span> <span class="dv">1</span>]),</span>
<span id="cb215-94"><a href="#cb215-94" aria-hidden="true" tabindex="-1"></a>                    scoring_matrix.get((sequence2[j <span class="op">-</span> <span class="dv">1</span>], sequence1[i <span class="op">-</span> <span class="dv">1</span>]), <span class="dv">0</span>)</span>
<span id="cb215-95"><a href="#cb215-95" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb215-96"><a href="#cb215-96" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb215-97"><a href="#cb215-97" aria-hidden="true" tabindex="-1"></a>            current_scores[i] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb215-98"><a href="#cb215-98" aria-hidden="true" tabindex="-1"></a>            backtrack[i] <span class="op">=</span> options.index(current_scores[i])</span>
<span id="cb215-99"><a href="#cb215-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-100"><a href="#cb215-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> current_scores, backtrack</span>
<span id="cb215-101"><a href="#cb215-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-102"><a href="#cb215-102" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_middle_edge(</span>
<span id="cb215-103"><a href="#cb215-103" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb215-104"><a href="#cb215-104" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb215-105"><a href="#cb215-105" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb215-106"><a href="#cb215-106" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb215-107"><a href="#cb215-107" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb215-108"><a href="#cb215-108" aria-hidden="true" tabindex="-1"></a>    midpoint <span class="op">=</span> floor(<span class="bu">len</span>(sequence2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb215-109"><a href="#cb215-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-110"><a href="#cb215-110" aria-hidden="true" tabindex="-1"></a>    forward_scores, _ <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb215-111"><a href="#cb215-111" aria-hidden="true" tabindex="-1"></a>        sequence1, sequence2[:midpoint], scoring_matrix, gap_penalty</span>
<span id="cb215-112"><a href="#cb215-112" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb215-113"><a href="#cb215-113" aria-hidden="true" tabindex="-1"></a>    reverse_scores, reverse_backtrack <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb215-114"><a href="#cb215-114" aria-hidden="true" tabindex="-1"></a>        sequence1[::<span class="op">-</span><span class="dv">1</span>], sequence2[midpoint:][::<span class="op">-</span><span class="dv">1</span>], scoring_matrix, gap_penalty</span>
<span id="cb215-115"><a href="#cb215-115" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb215-116"><a href="#cb215-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-117"><a href="#cb215-117" aria-hidden="true" tabindex="-1"></a>    total_scores <span class="op">=</span> [f <span class="op">+</span> r <span class="cf">for</span> f, r <span class="kw">in</span> <span class="bu">zip</span>(forward_scores, reverse_scores[::<span class="op">-</span><span class="dv">1</span>])]</span>
<span id="cb215-118"><a href="#cb215-118" aria-hidden="true" tabindex="-1"></a>    best_score_index <span class="op">=</span> total_scores.index(<span class="bu">max</span>(total_scores))</span>
<span id="cb215-119"><a href="#cb215-119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-120"><a href="#cb215-120" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> (best_score_index, midpoint)</span>
<span id="cb215-121"><a href="#cb215-121" aria-hidden="true" tabindex="-1"></a>    possible_moves <span class="op">=</span> [</span>
<span id="cb215-122"><a href="#cb215-122" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>], start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb215-123"><a href="#cb215-123" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>]),</span>
<span id="cb215-124"><a href="#cb215-124" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb215-125"><a href="#cb215-125" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb215-126"><a href="#cb215-126" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> possible_moves[reverse_backtrack[::<span class="op">-</span><span class="dv">1</span>][best_score_index]]</span>
<span id="cb215-127"><a href="#cb215-127" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-128"><a href="#cb215-128" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (start_node, end_node)</span>
<span id="cb215-129"><a href="#cb215-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-130"><a href="#cb215-130" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_score(</span>
<span id="cb215-131"><a href="#cb215-131" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span>,</span>
<span id="cb215-132"><a href="#cb215-132" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span>,</span>
<span id="cb215-133"><a href="#cb215-133" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb215-134"><a href="#cb215-134" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb215-135"><a href="#cb215-135" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb215-136"><a href="#cb215-136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb215-137"><a href="#cb215-137" aria-hidden="true" tabindex="-1"></a>        gap_penalty <span class="cf">if</span> aligned_seq1[i] <span class="op">==</span> <span class="st">"-"</span> <span class="kw">or</span> aligned_seq2[i] <span class="op">==</span> <span class="st">"-"</span> <span class="cf">else</span></span>
<span id="cb215-138"><a href="#cb215-138" aria-hidden="true" tabindex="-1"></a>        scoring_matrix.get((aligned_seq1[i], aligned_seq2[i]),</span>
<span id="cb215-139"><a href="#cb215-139" aria-hidden="true" tabindex="-1"></a>                           scoring_matrix.get((aligned_seq2[i], aligned_seq1[i]), <span class="dv">0</span>))</span>
<span id="cb215-140"><a href="#cb215-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(aligned_seq1))</span>
<span id="cb215-141"><a href="#cb215-141" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb215-142"><a href="#cb215-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-143"><a href="#cb215-143" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_alignment_path(</span>
<span id="cb215-144"><a href="#cb215-144" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb215-145"><a href="#cb215-145" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb215-146"><a href="#cb215-146" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb215-147"><a href="#cb215-147" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb215-148"><a href="#cb215-148" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb215-149"><a href="#cb215-149" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> linear_space_alignment(top: <span class="bu">int</span>, bottom: <span class="bu">int</span>, left: <span class="bu">int</span>, right: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb215-150"><a href="#cb215-150" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> left <span class="op">==</span> right:</span>
<span id="cb215-151"><a href="#cb215-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"↓"</span> <span class="op">*</span> (bottom <span class="op">-</span> top)</span>
<span id="cb215-152"><a href="#cb215-152" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> top <span class="op">==</span> bottom:</span>
<span id="cb215-153"><a href="#cb215-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"→"</span> <span class="op">*</span> (right <span class="op">-</span> left)</span>
<span id="cb215-154"><a href="#cb215-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb215-155"><a href="#cb215-155" aria-hidden="true" tabindex="-1"></a>            ((i, j), (i2, j2)) <span class="op">=</span> find_middle_edge(</span>
<span id="cb215-156"><a href="#cb215-156" aria-hidden="true" tabindex="-1"></a>                sequence1[top:bottom], sequence2[left:right], scoring_matrix, gap_penalty</span>
<span id="cb215-157"><a href="#cb215-157" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb215-158"><a href="#cb215-158" aria-hidden="true" tabindex="-1"></a>            edge <span class="op">=</span> <span class="st">"↓"</span> <span class="cf">if</span> j <span class="op">==</span> j2 <span class="cf">else</span> <span class="st">"→"</span> <span class="cf">if</span> i <span class="op">==</span> i2 <span class="cf">else</span> <span class="st">"↘"</span></span>
<span id="cb215-159"><a href="#cb215-159" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> (</span>
<span id="cb215-160"><a href="#cb215-160" aria-hidden="true" tabindex="-1"></a>                linear_space_alignment(top, i <span class="op">+</span> top, left, j <span class="op">+</span> left) <span class="op">+</span></span>
<span id="cb215-161"><a href="#cb215-161" aria-hidden="true" tabindex="-1"></a>                edge <span class="op">+</span></span>
<span id="cb215-162"><a href="#cb215-162" aria-hidden="true" tabindex="-1"></a>                linear_space_alignment(i2 <span class="op">+</span> top, bottom, j2 <span class="op">+</span> left, right)</span>
<span id="cb215-163"><a href="#cb215-163" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb215-164"><a href="#cb215-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-165"><a href="#cb215-165" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linear_space_alignment(<span class="dv">0</span>, <span class="bu">len</span>(sequence1), <span class="dv">0</span>, <span class="bu">len</span>(sequence2))</span>
<span id="cb215-166"><a href="#cb215-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-167"><a href="#cb215-167" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_alignment(</span>
<span id="cb215-168"><a href="#cb215-168" aria-hidden="true" tabindex="-1"></a>    alignment_path: <span class="bu">str</span>,</span>
<span id="cb215-169"><a href="#cb215-169" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb215-170"><a href="#cb215-170" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span></span>
<span id="cb215-171"><a href="#cb215-171" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb215-172"><a href="#cb215-172" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb215-173"><a href="#cb215-173" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb215-174"><a href="#cb215-174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> direction <span class="kw">in</span> alignment_path:</span>
<span id="cb215-175"><a href="#cb215-175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"↘"</span>:</span>
<span id="cb215-176"><a href="#cb215-176" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[i]</span>
<span id="cb215-177"><a href="#cb215-177" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[j]</span>
<span id="cb215-178"><a href="#cb215-178" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb215-179"><a href="#cb215-179" aria-hidden="true" tabindex="-1"></a>            j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb215-180"><a href="#cb215-180" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"↓"</span>:</span>
<span id="cb215-181"><a href="#cb215-181" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[i]</span>
<span id="cb215-182"><a href="#cb215-182" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb215-183"><a href="#cb215-183" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb215-184"><a href="#cb215-184" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb215-185"><a href="#cb215-185" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb215-186"><a href="#cb215-186" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[j]</span>
<span id="cb215-187"><a href="#cb215-187" aria-hidden="true" tabindex="-1"></a>            j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb215-188"><a href="#cb215-188" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> aligned_seq1, aligned_seq2</span>
<span id="cb215-189"><a href="#cb215-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-190"><a href="#cb215-190" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb215-191"><a href="#cb215-191" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb215-192"><a href="#cb215-192" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb215-193"><a href="#cb215-193" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb215-194"><a href="#cb215-194" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb215-195"><a href="#cb215-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-196"><a href="#cb215-196" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb215-197"><a href="#cb215-197" aria-hidden="true" tabindex="-1"></a>scoring_matrix <span class="op">=</span> BLOSUM62</span>
<span id="cb215-198"><a href="#cb215-198" aria-hidden="true" tabindex="-1"></a>alignment_path <span class="op">=</span> find_alignment_path(sequence1, sequence2, scoring_matrix, <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb215-199"><a href="#cb215-199" aria-hidden="true" tabindex="-1"></a>aligned_seq1, aligned_seq2 <span class="op">=</span> construct_alignment(alignment_path, sequence1, sequence2)</span>
<span id="cb215-200"><a href="#cb215-200" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_alignment_score(aligned_seq1, aligned_seq2, scoring_matrix, <span class="op">-</span><span class="dv">5</span>))</span>
<span id="cb215-201"><a href="#cb215-201" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_seq1, aligned_seq2, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-multiple-sequence-alignment" class="level1" data-number="72">
<h1 data-number="72"><span class="header-section-number">72</span> Find a Highest-Scoring Multiple Sequence Alignment</h1>
<p>Multiple Longest Common Subsequence Problem. Find a longest common subsequence of multiple strings.</p>
<p>Given:&nbsp;Three&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA strings</a>.</p>
<p>Return:&nbsp;The maximum score of a multiple alignment of these three strings, followed by a multiple alignment of the three strings achieving this maximum. Use a scoring function in which the score of an alignment column is 1 if all three symbols are identical and 0 otherwise. (If more than one multiple alignment achieve the maximum, you may return any one.)</p>
<section id="sample-dataset-72" class="level2" data-number="72.1">
<h2 data-number="72.1" class="anchored" data-anchor-id="sample-dataset-72"><span class="header-section-number">72.1</span> Sample Dataset</h2>
<pre><code>ATATCCG
TCCGA
ATGTACTG</code></pre>
</section>
<section id="sample-output-72" class="level2" data-number="72.2">
<h2 data-number="72.2" class="anchored" data-anchor-id="sample-output-72"><span class="header-section-number">72.2</span> Sample Output</h2>
<pre><code>3
ATATCC-G-
---TCC-GA
ATGTACTG-</code></pre>
</section>
<section id="solution-72" class="level2" data-number="72.3">
<h2 data-number="72.3" class="anchored" data-anchor-id="solution-72"><span class="header-section-number">72.3</span> Solution</h2>
<div class="sourceCode" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the coordinates are non-negative in the alignment matrix</span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_valid_coordinate(pointer: Tuple[<span class="bu">int</span>, ...], position: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>([i <span class="op">&gt;=</span> <span class="dv">0</span> <span class="cf">for</span> i <span class="kw">in</span> get_previous_position(position, pointer)])</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the previous position given a current position and a pointer</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_previous_position(position: Tuple[<span class="bu">int</span>, ...], pointer: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, ...]:</span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>([p <span class="op">+</span> d <span class="cf">for</span> p, d <span class="kw">in</span> <span class="bu">zip</span>(position, pointer)])</span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the score for a given position and pointer</span></span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(sequences: List[<span class="bu">str</span>], position: Tuple[<span class="bu">int</span>, ...], pointer: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pointer <span class="op">==</span> (<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a>        bases <span class="op">=</span> [sequences[i][j] <span class="cf">for</span> i, j <span class="kw">in</span> <span class="bu">enumerate</span>(get_previous_position(position, pointer))]</span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">int</span>(<span class="bu">all</span>(base <span class="op">==</span> bases[<span class="dv">0</span>] <span class="cf">for</span> base <span class="kw">in</span> bases))</span>
<span id="cb218-17"><a href="#cb218-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb218-18"><a href="#cb218-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb218-19"><a href="#cb218-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-20"><a href="#cb218-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate possible previous cell pointers</span></span>
<span id="cb218-21"><a href="#cb218-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_moves(dimension: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">int</span>, ...]]:</span>
<span id="cb218-22"><a href="#cb218-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(product([<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>], repeat<span class="op">=</span>dimension))[<span class="dv">1</span>:]</span>
<span id="cb218-23"><a href="#cb218-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-24"><a href="#cb218-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiple_sequence_alignment(sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb218-25"><a href="#cb218-25" aria-hidden="true" tabindex="-1"></a>    scores: Dict[Tuple[<span class="bu">int</span>, ...], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb218-26"><a href="#cb218-26" aria-hidden="true" tabindex="-1"></a>    pointers: Dict[Tuple[<span class="bu">int</span>, ...], Tuple[<span class="bu">int</span>, ...]] <span class="op">=</span> {}</span>
<span id="cb218-27"><a href="#cb218-27" aria-hidden="true" tabindex="-1"></a>    scores[(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb218-28"><a href="#cb218-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb218-29"><a href="#cb218-29" aria-hidden="true" tabindex="-1"></a>    ranges <span class="op">=</span> [<span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(seq) <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> seq <span class="kw">in</span> sequences]</span>
<span id="cb218-30"><a href="#cb218-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb218-31"><a href="#cb218-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> position <span class="kw">in</span> product(<span class="op">*</span>ranges):</span>
<span id="cb218-32"><a href="#cb218-32" aria-hidden="true" tabindex="-1"></a>        valid_pointers <span class="op">=</span> <span class="bu">list</span>(<span class="bu">filter</span>(<span class="kw">lambda</span> x: is_valid_coordinate(x, position), generate_moves(<span class="dv">3</span>)))</span>
<span id="cb218-33"><a href="#cb218-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> valid_pointers:</span>
<span id="cb218-34"><a href="#cb218-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb218-35"><a href="#cb218-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb218-36"><a href="#cb218-36" aria-hidden="true" tabindex="-1"></a>        possible_scores <span class="op">=</span> [scores[get_previous_position(position, ptr)] <span class="op">+</span> calculate_score(sequences, position, ptr) <span class="cf">for</span> ptr <span class="kw">in</span> valid_pointers]</span>
<span id="cb218-37"><a href="#cb218-37" aria-hidden="true" tabindex="-1"></a>        scores[position] <span class="op">=</span> <span class="bu">max</span>(possible_scores)</span>
<span id="cb218-38"><a href="#cb218-38" aria-hidden="true" tabindex="-1"></a>        pointers[position] <span class="op">=</span> valid_pointers[possible_scores.index(<span class="bu">max</span>(possible_scores))]</span>
<span id="cb218-39"><a href="#cb218-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-40"><a href="#cb218-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback to recover alignment</span></span>
<span id="cb218-41"><a href="#cb218-41" aria-hidden="true" tabindex="-1"></a>    total_score <span class="op">=</span> scores[position]</span>
<span id="cb218-42"><a href="#cb218-42" aria-hidden="true" tabindex="-1"></a>    aligned_sequences <span class="op">=</span> [<span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>]</span>
<span id="cb218-43"><a href="#cb218-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb218-44"><a href="#cb218-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">any</span>([x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">for</span> x <span class="kw">in</span> position]):</span>
<span id="cb218-45"><a href="#cb218-45" aria-hidden="true" tabindex="-1"></a>        pointer <span class="op">=</span> pointers[position]</span>
<span id="cb218-46"><a href="#cb218-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, seq <span class="kw">in</span> <span class="bu">enumerate</span>(sequences):</span>
<span id="cb218-47"><a href="#cb218-47" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[i] <span class="op">+=</span> seq[position[i] <span class="op">-</span> <span class="dv">1</span>] <span class="cf">if</span> pointer[i] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span> <span class="cf">else</span> <span class="st">"-"</span></span>
<span id="cb218-48"><a href="#cb218-48" aria-hidden="true" tabindex="-1"></a>        position <span class="op">=</span> get_previous_position(position, pointer)</span>
<span id="cb218-49"><a href="#cb218-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-50"><a href="#cb218-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (total_score, </span>
<span id="cb218-51"><a href="#cb218-51" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">0</span>][::<span class="op">-</span><span class="dv">1</span>], </span>
<span id="cb218-52"><a href="#cb218-52" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">1</span>][::<span class="op">-</span><span class="dv">1</span>], </span>
<span id="cb218-53"><a href="#cb218-53" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">2</span>][::<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb218-54"><a href="#cb218-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-55"><a href="#cb218-55" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb218-56"><a href="#cb218-56" aria-hidden="true" tabindex="-1"></a><span class="st">ATATCCG</span></span>
<span id="cb218-57"><a href="#cb218-57" aria-hidden="true" tabindex="-1"></a><span class="st">TCCGA</span></span>
<span id="cb218-58"><a href="#cb218-58" aria-hidden="true" tabindex="-1"></a><span class="st">ATGTACTG</span></span>
<span id="cb218-59"><a href="#cb218-59" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb218-60"><a href="#cb218-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-61"><a href="#cb218-61" aria-hidden="true" tabindex="-1"></a>sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb218-62"><a href="#cb218-62" aria-hidden="true" tabindex="-1"></a>alignment_score, seq1, seq2, seq3 <span class="op">=</span> multiple_sequence_alignment(sequences)</span>
<span id="cb218-63"><a href="#cb218-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb218-64"><a href="#cb218-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq1)</span>
<span id="cb218-65"><a href="#cb218-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq2)</span>
<span id="cb218-66"><a href="#cb218-66" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-topological-ordering-of-a-dag" class="level1" data-number="73">
<h1 data-number="73"><span class="header-section-number">73</span> Find a Topological Ordering of a DAG</h1>
<p>Topological Ordering Problem. Find a topological ordering of a directed acyclic graph.</p>
<p>Given:&nbsp;The&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>&nbsp;of a graph (with nodes represented by integers).</p>
<p>Return:&nbsp;A topological ordering of this graph.</p>
<section id="sample-dataset-73" class="level2" data-number="73.1">
<h2 data-number="73.1" class="anchored" data-anchor-id="sample-dataset-73"><span class="header-section-number">73.1</span> Sample Dataset</h2>
<pre><code>1 -&gt; 2
2 -&gt; 3
4 -&gt; 2
5 -&gt; 3</code></pre>
</section>
<section id="sample-output-73" class="level2" data-number="73.2">
<h2 data-number="73.2" class="anchored" data-anchor-id="sample-output-73"><span class="header-section-number">73.2</span> Sample Output</h2>
<pre><code>1, 4, 5, 2, 3</code></pre>
</section>
<section id="solution-73" class="level2" data-number="73.3">
<h2 data-number="73.3" class="anchored" data-anchor-id="solution-73"><span class="header-section-number">73.3</span> Solution</h2>
<div class="sourceCode" id="cb221"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Set</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>NodeLabel <span class="op">=</span> <span class="bu">str</span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[NodeLabel, List[NodeLabel]]</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_graph(edge_list: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Graph:</span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a>    graph: Graph <span class="op">=</span> {}</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edge_list:</span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>        source, targets <span class="op">=</span> edge.split(<span class="st">" -&gt; "</span>)</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a>        target_list <span class="op">=</span> targets.split(<span class="st">","</span>)</span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> graph:</span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a>            graph[source] <span class="op">=</span> []</span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a>        graph[source].extend(target_list)</span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> target_list:</span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> target <span class="kw">not</span> <span class="kw">in</span> graph:</span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a>                graph[target] <span class="op">=</span> []</span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> depth_first_search(graph: Graph, node: NodeLabel, visited: Set[NodeLabel], stack: List[NodeLabel]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true" tabindex="-1"></a>    visited.add(node)</span>
<span id="cb221-21"><a href="#cb221-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> graph.get(node, []):</span>
<span id="cb221-22"><a href="#cb221-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb221-23"><a href="#cb221-23" aria-hidden="true" tabindex="-1"></a>            depth_first_search(graph, neighbor, visited, stack)</span>
<span id="cb221-24"><a href="#cb221-24" aria-hidden="true" tabindex="-1"></a>    stack.insert(<span class="dv">0</span>, node)</span>
<span id="cb221-25"><a href="#cb221-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-26"><a href="#cb221-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> topological_sort(graph: Graph) <span class="op">-&gt;</span> List[NodeLabel]:</span>
<span id="cb221-27"><a href="#cb221-27" aria-hidden="true" tabindex="-1"></a>    visited: Set[NodeLabel] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb221-28"><a href="#cb221-28" aria-hidden="true" tabindex="-1"></a>    stack: List[NodeLabel] <span class="op">=</span> []</span>
<span id="cb221-29"><a href="#cb221-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> graph:</span>
<span id="cb221-30"><a href="#cb221-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb221-31"><a href="#cb221-31" aria-hidden="true" tabindex="-1"></a>            depth_first_search(graph, node, visited, stack)</span>
<span id="cb221-32"><a href="#cb221-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stack</span>
<span id="cb221-33"><a href="#cb221-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-34"><a href="#cb221-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb221-35"><a href="#cb221-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_text.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb221-36"><a href="#cb221-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-37"><a href="#cb221-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb221-38"><a href="#cb221-38" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb221-39"><a href="#cb221-39" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 2</span></span>
<span id="cb221-40"><a href="#cb221-40" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 3</span></span>
<span id="cb221-41"><a href="#cb221-41" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; 2</span></span>
<span id="cb221-42"><a href="#cb221-42" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 3</span></span>
<span id="cb221-43"><a href="#cb221-43" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb221-44"><a href="#cb221-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-45"><a href="#cb221-45" aria-hidden="true" tabindex="-1"></a>edge_list <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb221-46"><a href="#cb221-46" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> create_graph(edge_list)</span>
<span id="cb221-47"><a href="#cb221-47" aria-hidden="true" tabindex="-1"></a>sorted_nodes <span class="op">=</span> topological_sort(graph)</span>
<span id="cb221-48"><a href="#cb221-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">", "</span>.join(sorted_nodes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-greedysorting-to-sort-a-permutation-by-reversals" class="level1" data-number="74">
<h1 data-number="74"><span class="header-section-number">74</span> Implement GreedySorting to Sort a Permutation by Reversals</h1>
<p>Implement&nbsp;<em>GreedySorting</em>.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/signed-permutation/">signed permutation</a>&nbsp;<em>P</em>.</p>
<p>Return:&nbsp;The sequence of permutations corresponding to applying&nbsp;<em>GreedySorting</em>&nbsp;to&nbsp;<em>P</em>, ending with the identity permutation.</p>
<section id="sample-dataset-74" class="level2" data-number="74.1">
<h2 data-number="74.1" class="anchored" data-anchor-id="sample-dataset-74"><span class="header-section-number">74.1</span> Sample Dataset</h2>
<pre><code>(-3 +4 +1 +5 -2)</code></pre>
</section>
<section id="sample-output-74" class="level2" data-number="74.2">
<h2 data-number="74.2" class="anchored" data-anchor-id="sample-output-74"><span class="header-section-number">74.2</span> Sample Output</h2>
<pre><code>(-1 -4 +3 +5 -2)
(+1 -4 +3 +5 -2)
(+1 +2 -5 -3 +4)
(+1 +2 +3 +5 +4)
(+1 +2 +3 -4 -5)
(+1 +2 +3 +4 -5)
(+1 +2 +3 +4 +5)</code></pre>
</section>
<section id="solution-74" class="level2" data-number="74.3">
<h2 data-number="74.3" class="anchored" data-anchor-id="solution-74"><span class="header-section-number">74.3</span> Solution</h2>
<div class="sourceCode" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> perform_k_sorting_reversal(permutation: List[<span class="bu">int</span>], k: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>    j <span class="op">=</span> k</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">abs</span>(permutation[j]) <span class="op">!=</span> k <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>        j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>    permutation[k:j<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> [<span class="op">-</span>x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">reversed</span>(permutation[k:j<span class="op">+</span><span class="dv">1</span>])]</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> permutation</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_sorting(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>    reversal_sequence: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(permutation)):</span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> permutation[k] <span class="op">!=</span> k <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>            permutation <span class="op">=</span> perform_k_sorting_reversal(permutation, k)</span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>            reversal_sequence.append(<span class="bu">list</span>(permutation))</span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversal_sequence</span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_permutation(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a>    cleaned_input <span class="op">=</span> input_text.strip().replace(<span class="st">"("</span>, <span class="st">""</span>).replace(<span class="st">")"</span>, <span class="st">""</span>)</span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> cleaned_input.split()]</span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-22"><a href="#cb224-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_permutation(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb224-23"><a href="#cb224-23" aria-hidden="true" tabindex="-1"></a>    formatted_elements <span class="op">=</span> [(<span class="st">"+"</span> <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">""</span>) <span class="op">+</span> <span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> permutation]</span>
<span id="cb224-24"><a href="#cb224-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join(formatted_elements) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb224-25"><a href="#cb224-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-26"><a href="#cb224-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb224-27"><a href="#cb224-27" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb224-28"><a href="#cb224-28" aria-hidden="true" tabindex="-1"></a><span class="st">(-3 +4 +1 +5 -2)</span></span>
<span id="cb224-29"><a href="#cb224-29" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb224-30"><a href="#cb224-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-31"><a href="#cb224-31" aria-hidden="true" tabindex="-1"></a>initial_permutation <span class="op">=</span> parse_permutation(sample_input)</span>
<span id="cb224-32"><a href="#cb224-32" aria-hidden="true" tabindex="-1"></a>sorting_sequence <span class="op">=</span> greedy_sorting(initial_permutation)</span>
<span id="cb224-33"><a href="#cb224-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-34"><a href="#cb224-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> permutation <span class="kw">in</span> sorting_sequence:</span>
<span id="cb224-35"><a href="#cb224-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(format_permutation(permutation))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-number-of-breakpoints-in-a-permutation" class="level1" data-number="75">
<h1 data-number="75"><span class="header-section-number">75</span> Compute the Number of Breakpoints in a Permutation</h1>
<p>Number of Breakpoints Problem. Find the number of breakpoints in a permutation.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/signed-permutation/">signed permutation</a>&nbsp;<em>P</em>.</p>
<p>Return:&nbsp;The number of breakpoints in&nbsp;<em>P</em>.</p>
<section id="sample-dataset-75" class="level2" data-number="75.1">
<h2 data-number="75.1" class="anchored" data-anchor-id="sample-dataset-75"><span class="header-section-number">75.1</span> Sample Dataset</h2>
<pre><code>(+3 +4 +5 -12 -8 -7 -6 +1 +2 +10 +9 -11 +13 +14)</code></pre>
</section>
<section id="sample-output-75" class="level2" data-number="75.2">
<h2 data-number="75.2" class="anchored" data-anchor-id="sample-output-75"><span class="header-section-number">75.2</span> Sample Output</h2>
<pre><code>8</code></pre>
</section>
<section id="solution-75" class="level2" data-number="75.3">
<h2 data-number="75.3" class="anchored" data-anchor-id="solution-75"><span class="header-section-number">75.3</span> Solution</h2>
<div class="sourceCode" id="cb227"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_breakpoints(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>    augmented_permutation <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> permutation <span class="op">+</span> [<span class="bu">max</span>(permutation) <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>    breakpoint_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(augmented_permutation) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> augmented_permutation[i] <span class="op">!=</span> augmented_permutation[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>            breakpoint_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> breakpoint_count</span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a><span class="st">(+3 +4 +5 -12 -8 -7 -6 +1 +2 +10 +9 -11 +13 +14)</span></span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-17"><a href="#cb227-17" aria-hidden="true" tabindex="-1"></a>permutation_string <span class="op">=</span> sample_input.strip()</span>
<span id="cb227-18"><a href="#cb227-18" aria-hidden="true" tabindex="-1"></a>permutation_string <span class="op">=</span> permutation_string.replace(<span class="st">"("</span>, <span class="st">""</span>).replace(<span class="st">")"</span>, <span class="st">""</span>)</span>
<span id="cb227-19"><a href="#cb227-19" aria-hidden="true" tabindex="-1"></a>permutation <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> permutation_string.split()]</span>
<span id="cb227-20"><a href="#cb227-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-21"><a href="#cb227-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_breakpoints(permutation))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-2-break-distance-between-a-pair-of-genomes" class="level1" data-number="76">
<h1 data-number="76"><span class="header-section-number">76</span> Compute the 2-Break Distance Between a Pair of Genomes</h1>
<p>2-Break Distance Problem. Find the 2-break distance between two genomes.</p>
<p>Given:&nbsp;Two genomes with circular chromosomes on the same set of synteny blocks.</p>
<p>Return:&nbsp;The 2-break distance between these two genomes.</p>
<section id="sample-dataset-76" class="level2" data-number="76.1">
<h2 data-number="76.1" class="anchored" data-anchor-id="sample-dataset-76"><span class="header-section-number">76.1</span> Sample Dataset</h2>
<pre><code>(+1 +2 +3 +4 +5 +6)
(+1 -3 -6 -5)(+2 -4)</code></pre>
</section>
<section id="sample-output-76" class="level2" data-number="76.2">
<h2 data-number="76.2" class="anchored" data-anchor-id="sample-output-76"><span class="header-section-number">76.2</span> Sample Output</h2>
<pre><code>3</code></pre>
</section>
<section id="solution-76" class="level2" data-number="76.3">
<h2 data-number="76.3" class="anchored" data-anchor-id="solution-76"><span class="header-section-number">76.3</span> Solution</h2>
<div class="sourceCode" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, DefaultDict</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>    visited: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>        visited.add(current_node)</span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a>                queue.append(neighbor)</span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-16"><a href="#cb230-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_genome_graph(genome_string: <span class="bu">str</span>) <span class="op">-&gt;</span> DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb230-17"><a href="#cb230-17" aria-hidden="true" tabindex="-1"></a>    genome_graph: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb230-18"><a href="#cb230-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, genome_string):</span>
<span id="cb230-19"><a href="#cb230-19" aria-hidden="true" tabindex="-1"></a>        chromosome <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, component.split()))</span>
<span id="cb230-20"><a href="#cb230-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb230-21"><a href="#cb230-21" aria-hidden="true" tabindex="-1"></a>            genome_graph[chromosome[i]].append(<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb230-22"><a href="#cb230-22" aria-hidden="true" tabindex="-1"></a>            genome_graph[<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>]].append(chromosome[i])</span>
<span id="cb230-23"><a href="#cb230-23" aria-hidden="true" tabindex="-1"></a>        genome_graph[chromosome[<span class="op">-</span><span class="dv">1</span>]].append(<span class="op">-</span>chromosome[<span class="dv">0</span>])</span>
<span id="cb230-24"><a href="#cb230-24" aria-hidden="true" tabindex="-1"></a>        genome_graph[<span class="op">-</span>chromosome[<span class="dv">0</span>]].append(chromosome[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb230-25"><a href="#cb230-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome_graph</span>
<span id="cb230-26"><a href="#cb230-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-27"><a href="#cb230-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> breakpoint_graph(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb230-28"><a href="#cb230-28" aria-hidden="true" tabindex="-1"></a>    combined_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb230-29"><a href="#cb230-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> genome1.keys():</span>
<span id="cb230-30"><a href="#cb230-30" aria-hidden="true" tabindex="-1"></a>        combined_graph[node] <span class="op">=</span> genome1[node] <span class="op">+</span> genome2[node]</span>
<span id="cb230-31"><a href="#cb230-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> combined_graph</span>
<span id="cb230-32"><a href="#cb230-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-33"><a href="#cb230-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_two_break_distance(genomes: List[DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb230-34"><a href="#cb230-34" aria-hidden="true" tabindex="-1"></a>    combined_graph <span class="op">=</span> breakpoint_graph(<span class="op">*</span>genomes)</span>
<span id="cb230-35"><a href="#cb230-35" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(combined_graph.keys())</span>
<span id="cb230-36"><a href="#cb230-36" aria-hidden="true" tabindex="-1"></a>    num_blocks <span class="op">=</span> <span class="bu">len</span>(nodes) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb230-37"><a href="#cb230-37" aria-hidden="true" tabindex="-1"></a>    num_components <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb230-38"><a href="#cb230-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb230-39"><a href="#cb230-39" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), combined_graph)</span>
<span id="cb230-40"><a href="#cb230-40" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">-=</span> component</span>
<span id="cb230-41"><a href="#cb230-41" aria-hidden="true" tabindex="-1"></a>        num_components <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb230-42"><a href="#cb230-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> num_blocks <span class="op">-</span> num_components</span>
<span id="cb230-43"><a href="#cb230-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-44"><a href="#cb230-44" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb230-45"><a href="#cb230-45" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 +2 +3 +4 +5 +6)</span></span>
<span id="cb230-46"><a href="#cb230-46" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 -3 -6 -5)(+2 -4)</span></span>
<span id="cb230-47"><a href="#cb230-47" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb230-48"><a href="#cb230-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-49"><a href="#cb230-49" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb230-50"><a href="#cb230-50" aria-hidden="true" tabindex="-1"></a>genomes <span class="op">=</span> [parse_genome_graph(genome_string) <span class="cf">for</span> genome_string <span class="kw">in</span> input_lines]</span>
<span id="cb230-51"><a href="#cb230-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_two_break_distance(genomes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-shortest-transformation-of-one-genome-into-another-by-2-breaks" class="level1" data-number="77">
<h1 data-number="77"><span class="header-section-number">77</span> Find a Shortest Transformation of One Genome into Another by 2-Breaks</h1>
<p>2-Break Sorting Problem. Find a shortest transformation of one genome into another by 2-breaks.</p>
<p>Given:&nbsp;Two genomes with circular chromosomes on the same set of synteny blocks.</p>
<p>Return:&nbsp;The sequence of genomes resulting from applying a shortest sequence of 2-breaks transforming one genome into the other.</p>
<section id="sample-dataset-77" class="level2" data-number="77.1">
<h2 data-number="77.1" class="anchored" data-anchor-id="sample-dataset-77"><span class="header-section-number">77.1</span> Sample Dataset</h2>
<pre><code>(+1 -2 -3 +4)
(+1 +2 -4 -3)</code></pre>
</section>
<section id="sample-output-77" class="level2" data-number="77.2">
<h2 data-number="77.2" class="anchored" data-anchor-id="sample-output-77"><span class="header-section-number">77.2</span> Sample Output</h2>
<pre><code>(+1 -2 -3 +4)
(+1 +2 -3 +4)
(+1 +2 -4 +3)
(+1 +2 -4 -3)</code></pre>
</section>
<section id="solution-77" class="level2" data-number="77.3">
<h2 data-number="77.3" class="anchored" data-anchor-id="solution-77"><span class="header-section-number">77.3</span> Solution</h2>
<div class="sourceCode" id="cb233"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, Generator, DefaultDict</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>    visited: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a>        visited.add(current_node)</span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a>                queue.append(neighbor)</span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb233-15"><a href="#cb233-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-16"><a href="#cb233-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_genome_graph(genome_string: <span class="bu">str</span>) <span class="op">-&gt;</span> DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb233-17"><a href="#cb233-17" aria-hidden="true" tabindex="-1"></a>    genome_graph: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb233-18"><a href="#cb233-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, genome_string):</span>
<span id="cb233-19"><a href="#cb233-19" aria-hidden="true" tabindex="-1"></a>        chromosome <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, component.split()))</span>
<span id="cb233-20"><a href="#cb233-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb233-21"><a href="#cb233-21" aria-hidden="true" tabindex="-1"></a>            genome_graph[chromosome[i]].append(<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb233-22"><a href="#cb233-22" aria-hidden="true" tabindex="-1"></a>            genome_graph[<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>]].append(chromosome[i])</span>
<span id="cb233-23"><a href="#cb233-23" aria-hidden="true" tabindex="-1"></a>        genome_graph[chromosome[<span class="op">-</span><span class="dv">1</span>]].append(<span class="op">-</span>chromosome[<span class="dv">0</span>])</span>
<span id="cb233-24"><a href="#cb233-24" aria-hidden="true" tabindex="-1"></a>        genome_graph[<span class="op">-</span>chromosome[<span class="dv">0</span>]].append(chromosome[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb233-25"><a href="#cb233-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome_graph</span>
<span id="cb233-26"><a href="#cb233-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-27"><a href="#cb233-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> breakpoint_graph(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb233-28"><a href="#cb233-28" aria-hidden="true" tabindex="-1"></a>    combined_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb233-29"><a href="#cb233-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> genome1.keys():</span>
<span id="cb233-30"><a href="#cb233-30" aria-hidden="true" tabindex="-1"></a>        combined_graph[node] <span class="op">=</span> genome1[node] <span class="op">+</span> genome2[node]</span>
<span id="cb233-31"><a href="#cb233-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> combined_graph</span>
<span id="cb233-32"><a href="#cb233-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-33"><a href="#cb233-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_perm(perm: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb233-34"><a href="#cb233-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>x<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> x <span class="kw">in</span> perm]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb233-35"><a href="#cb233-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-36"><a href="#cb233-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_components(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Generator[Set[<span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb233-37"><a href="#cb233-37" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb233-38"><a href="#cb233-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb233-39"><a href="#cb233-39" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), graph)</span>
<span id="cb233-40"><a href="#cb233-40" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> component</span>
<span id="cb233-41"><a href="#cb233-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> component</span>
<span id="cb233-42"><a href="#cb233-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-43"><a href="#cb233-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> non_trivial_cycle_nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">int</span>] <span class="op">|</span> <span class="va">None</span>:</span>
<span id="cb233-44"><a href="#cb233-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> find_components(graph):</span>
<span id="cb233-45"><a href="#cb233-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(component) <span class="op">&gt;</span> <span class="dv">2</span>:</span>
<span id="cb233-46"><a href="#cb233-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">list</span>(component)</span>
<span id="cb233-47"><a href="#cb233-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb233-48"><a href="#cb233-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-49"><a href="#cb233-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_genome_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb233-50"><a href="#cb233-50" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb233-51"><a href="#cb233-51" aria-hidden="true" tabindex="-1"></a>    visited: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb233-52"><a href="#cb233-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb233-53"><a href="#cb233-53" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb233-54"><a href="#cb233-54" aria-hidden="true" tabindex="-1"></a>        visited.append(current_node)</span>
<span id="cb233-55"><a href="#cb233-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb233-56"><a href="#cb233-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">-</span>neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb233-57"><a href="#cb233-57" aria-hidden="true" tabindex="-1"></a>                queue.append(<span class="op">-</span>neighbor)</span>
<span id="cb233-58"><a href="#cb233-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb233-59"><a href="#cb233-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-60"><a href="#cb233-60" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_genome_graph(genome_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb233-61"><a href="#cb233-61" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(genome_graph.keys())</span>
<span id="cb233-62"><a href="#cb233-62" aria-hidden="true" tabindex="-1"></a>    components: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb233-63"><a href="#cb233-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb233-64"><a href="#cb233-64" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_genome_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), genome_graph)</span>
<span id="cb233-65"><a href="#cb233-65" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> <span class="bu">set</span>(component)</span>
<span id="cb233-66"><a href="#cb233-66" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> <span class="bu">set</span>(<span class="op">-</span>x <span class="cf">for</span> x <span class="kw">in</span> component)</span>
<span id="cb233-67"><a href="#cb233-67" aria-hidden="true" tabindex="-1"></a>        components.append(component)</span>
<span id="cb233-68"><a href="#cb233-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">""</span>.join([format_perm(c) <span class="cf">for</span> c <span class="kw">in</span> components])</span>
<span id="cb233-69"><a href="#cb233-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-70"><a href="#cb233-70" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_edge(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node1: <span class="bu">int</span>, node2: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb233-71"><a href="#cb233-71" aria-hidden="true" tabindex="-1"></a>    graph[node1].append(node2)</span>
<span id="cb233-72"><a href="#cb233-72" aria-hidden="true" tabindex="-1"></a>    graph[node2].append(node1)</span>
<span id="cb233-73"><a href="#cb233-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-74"><a href="#cb233-74" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> del_edge(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node1: <span class="bu">int</span>, node2: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb233-75"><a href="#cb233-75" aria-hidden="true" tabindex="-1"></a>    graph[node1].remove(node2)</span>
<span id="cb233-76"><a href="#cb233-76" aria-hidden="true" tabindex="-1"></a>    graph[node2].remove(node1)</span>
<span id="cb233-77"><a href="#cb233-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-78"><a href="#cb233-78" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ba6d(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb233-79"><a href="#cb233-79" aria-hidden="true" tabindex="-1"></a>    combined_graph <span class="op">=</span> breakpoint_graph(genome1, genome2)</span>
<span id="cb233-80"><a href="#cb233-80" aria-hidden="true" tabindex="-1"></a>    nodes <span class="op">=</span> non_trivial_cycle_nodes(combined_graph)</span>
<span id="cb233-81"><a href="#cb233-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> format_genome_graph(genome1)</span>
<span id="cb233-82"><a href="#cb233-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb233-83"><a href="#cb233-83" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> nodes[<span class="dv">0</span>]</span>
<span id="cb233-84"><a href="#cb233-84" aria-hidden="true" tabindex="-1"></a>        i2 <span class="op">=</span> genome2[nodes[<span class="dv">0</span>]][<span class="dv">0</span>]</span>
<span id="cb233-85"><a href="#cb233-85" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> genome1[j][<span class="dv">0</span>]</span>
<span id="cb233-86"><a href="#cb233-86" aria-hidden="true" tabindex="-1"></a>        j2 <span class="op">=</span> genome1[i2][<span class="dv">0</span>]</span>
<span id="cb233-87"><a href="#cb233-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-88"><a href="#cb233-88" aria-hidden="true" tabindex="-1"></a>        del_edge(genome1, i, j)</span>
<span id="cb233-89"><a href="#cb233-89" aria-hidden="true" tabindex="-1"></a>        del_edge(genome1, i2, j2)</span>
<span id="cb233-90"><a href="#cb233-90" aria-hidden="true" tabindex="-1"></a>        add_edge(genome1, j, i2)</span>
<span id="cb233-91"><a href="#cb233-91" aria-hidden="true" tabindex="-1"></a>        add_edge(genome1, j2, i)</span>
<span id="cb233-92"><a href="#cb233-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-93"><a href="#cb233-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> format_genome_graph(genome1)</span>
<span id="cb233-94"><a href="#cb233-94" aria-hidden="true" tabindex="-1"></a>        combined_graph <span class="op">=</span> breakpoint_graph(genome1, genome2)</span>
<span id="cb233-95"><a href="#cb233-95" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> non_trivial_cycle_nodes(combined_graph)</span>
<span id="cb233-96"><a href="#cb233-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-97"><a href="#cb233-97" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb233-98"><a href="#cb233-98" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 -2 -3 +4)</span></span>
<span id="cb233-99"><a href="#cb233-99" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 +2 -4 -3)</span></span>
<span id="cb233-100"><a href="#cb233-100" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb233-101"><a href="#cb233-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-102"><a href="#cb233-102" aria-hidden="true" tabindex="-1"></a>genome1, genome2 <span class="op">=</span> [parse_genome_graph(s) <span class="cf">for</span> s <span class="kw">in</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)]</span>
<span id="cb233-103"><a href="#cb233-103" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> genome <span class="kw">in</span> ba6d(genome1, genome2):</span>
<span id="cb233-104"><a href="#cb233-104" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(genome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-shared-k-mers-of-a-pair-of-strings" class="level1" data-number="78">
<h1 data-number="78"><span class="header-section-number">78</span> Find All Shared k-mers of a Pair of Strings</h1>
<p>Shared&nbsp;<em>k</em>-mers Problem. Given two strings, find all their shared k-mers.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and two strings.</p>
<p>Return:&nbsp;All&nbsp;<em>k</em>-mers shared by these strings, in the form of ordered pairs (<em>x</em>,&nbsp;<em>y</em>) corresponding to starting positions of these k-mers in the respective strings.</p>
<section id="sample-dataset-78" class="level2" data-number="78.1">
<h2 data-number="78.1" class="anchored" data-anchor-id="sample-dataset-78"><span class="header-section-number">78.1</span> Sample Dataset</h2>
<pre><code>3
AAACTCATC
TTTCAAATC</code></pre>
</section>
<section id="sample-output-78" class="level2" data-number="78.2">
<h2 data-number="78.2" class="anchored" data-anchor-id="sample-output-78"><span class="header-section-number">78.2</span> Sample Output</h2>
<pre><code>(0, 4)
(0, 0)
(4, 2)
(6, 6)</code></pre>
</section>
<section id="solution-78" class="level2" data-number="78.3">
<h2 data-number="78.3" class="anchored" data-anchor-id="solution-78"><span class="header-section-number">78.3</span> Solution</h2>
<div class="sourceCode" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/tomorrow-lab\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb237" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Rosalind Textbook track 문제풀이"</span></span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Taeyoon Kim"</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Python, Rosalind, Bioinformatics, Tip]</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> false</span></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-09-28"</span></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> last-modified</span></span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a><span class="al">![](Rosalind_textbookTrack.png)</span>{width=100% fig-align="center"}</span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a>Phillip Compeau 와 Pavel Pevzner 가 쓴 책 "<span class="co">[</span><span class="ot">능동적 접근 방식의 생물정보학 알고리즘</span><span class="co">](https://www.bioinformaticsalgorithms.org/)</span>" 에서 제공되는 연습 문제 모음입니다.</span>
<span id="cb237-13"><a href="#cb237-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-14"><a href="#cb237-14" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Rosalind</span><span class="co">](https://rosalind.info/)</span> 는 <span class="co">[</span><span class="ot">프로젝트 오일러</span><span class="co">](http://projecteuler.net/)</span>, <span class="co">[</span><span class="ot">구글 코드 잼</span><span class="co">](http://code.google.com/codejam)</span> 에서 영감을 얻었습니다. 이 프로젝트의 이름은 DNA 이중나선을 발견하는 데 기여한 <span class="co">[</span><span class="ot">로잘린드 프랭클린</span><span class="co">](http://en.wikipedia.org/wiki/Rosalind_Franklin)</span> 에서 따왔습니다. Rosalind 는 프로그래밍 실력을 키우고자 하는 생물학자와 분자생물학의 계산 문제를 접해본 적이 없는 프로그래머들에게 도움이 될 것입니다.</span>
<span id="cb237-15"><a href="#cb237-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-16"><a href="#cb237-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compute the Number of Times a Pattern Appears in a Text</span></span>
<span id="cb237-17"><a href="#cb237-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-18"><a href="#cb237-18" aria-hidden="true" tabindex="-1"></a>This is the first problem in a collection of"code challenges"to accompany&nbsp;<span class="co">[</span><span class="ot">Bioinformatics Algorithms: An Active-Learning Approach</span><span class="co">](http://bioinformaticsalgorithms.org/)</span>&nbsp;by Phillip Compeau &amp; Pavel Pevzner.</span>
<span id="cb237-19"><a href="#cb237-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-20"><a href="#cb237-20" aria-hidden="true" tabindex="-1"></a>A&nbsp;<span class="co">[</span><span class="ot">k-mer</span><span class="co">](https://rosalind.info/glossary/k-mer/)</span>&nbsp;is a&nbsp;<span class="co">[</span><span class="ot">string</span><span class="co">](https://rosalind.info/glossary/string/)</span>&nbsp;of length&nbsp;*k*. We define&nbsp;*Count*(*Text*,&nbsp;*Pattern*) as the number of times that a&nbsp;*k*-mer&nbsp;*Pattern*&nbsp;appears as a&nbsp;[substring](https://rosalind.info/glossary/substring/)&nbsp;of&nbsp;*Text*.</span>
<span id="cb237-21"><a href="#cb237-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-22"><a href="#cb237-22" aria-hidden="true" tabindex="-1"></a>For example, We note that&nbsp;$Count(CGATATATCCATAGCGATATATCCATAG,ATAATA)$ is equal to 3 (not 2) since we should account for overlapping occurrences of&nbsp;*Pattern*&nbsp;in&nbsp;*Text*.</span>
<span id="cb237-23"><a href="#cb237-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-24"><a href="#cb237-24" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;{DNA strings}}&nbsp;*Text*&nbsp;and&nbsp;*Pattern*.</span>
<span id="cb237-25"><a href="#cb237-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-26"><a href="#cb237-26" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;*Count*(*Text*,&nbsp;*Pattern*).</span>
<span id="cb237-27"><a href="#cb237-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-28"><a href="#cb237-28" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb237-29"><a href="#cb237-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-30"><a href="#cb237-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-31"><a href="#cb237-31" aria-hidden="true" tabindex="-1"></a><span class="in">GCGCG</span></span>
<span id="cb237-32"><a href="#cb237-32" aria-hidden="true" tabindex="-1"></a><span class="in">GCG</span></span>
<span id="cb237-33"><a href="#cb237-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-34"><a href="#cb237-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-35"><a href="#cb237-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb237-36"><a href="#cb237-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-37"><a href="#cb237-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-38"><a href="#cb237-38" aria-hidden="true" tabindex="-1"></a><span class="in">2</span></span>
<span id="cb237-39"><a href="#cb237-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-40"><a href="#cb237-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-41"><a href="#cb237-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb237-42"><a href="#cb237-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-43"><a href="#cb237-43" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb237-44"><a href="#cb237-44" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb237-45"><a href="#cb237-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-46"><a href="#cb237-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb237-47"><a href="#cb237-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb237-48"><a href="#cb237-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-49"><a href="#cb237-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i:i <span class="op">+</span> size]</span>
<span id="cb237-50"><a href="#cb237-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-51"><a href="#cb237-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-52"><a href="#cb237-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count how many times the pattern occurs in the text."""</span></span>
<span id="cb237-53"><a href="#cb237-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb237-54"><a href="#cb237-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-55"><a href="#cb237-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-56"><a href="#cb237-56" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-57"><a href="#cb237-57" aria-hidden="true" tabindex="-1"></a><span class="st">GCGCG</span></span>
<span id="cb237-58"><a href="#cb237-58" aria-hidden="true" tabindex="-1"></a><span class="st">GCG</span></span>
<span id="cb237-59"><a href="#cb237-59" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-60"><a href="#cb237-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-61"><a href="#cb237-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern</span></span>
<span id="cb237-62"><a href="#cb237-62" aria-hidden="true" tabindex="-1"></a>text, pattern <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-63"><a href="#cb237-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-64"><a href="#cb237-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the count of pattern occurrences in text</span></span>
<span id="cb237-65"><a href="#cb237-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_pattern_occurrences(text, pattern))</span>
<span id="cb237-66"><a href="#cb237-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-67"><a href="#cb237-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-68"><a href="#cb237-68" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find the Most Frequent Words in a String</span></span>
<span id="cb237-69"><a href="#cb237-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-70"><a href="#cb237-70" aria-hidden="true" tabindex="-1"></a>We say that&nbsp;*Pattern*&nbsp;is a&nbsp;**most frequent&nbsp;k-mer**&nbsp;in&nbsp;*Text*&nbsp;if it maximizes&nbsp;*Count*(*Text*,&nbsp;*Pattern*) among all&nbsp;<span class="co">[</span><span class="ot">k-mers</span><span class="co">](https://rosalind.info/glossary/k-mer/)</span>. For example,"ACTAT"is a most frequent 5-mer in"ACAACTATGCATCACTATCGGGAACTATCCT", and"ATA"is a most frequent 3-mer of"CGATATATCCATAG".</span>
<span id="cb237-71"><a href="#cb237-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-72"><a href="#cb237-72" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;<span class="co">[</span><span class="ot">DNA string</span><span class="co">](https://rosalind.info/glossary/dna-string/)</span>&nbsp;*Text*&nbsp;and an integer&nbsp;*k*.</span>
<span id="cb237-73"><a href="#cb237-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-74"><a href="#cb237-74" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All most frequent&nbsp;*k*-mers in&nbsp;*Text*&nbsp;(in any order).</span>
<span id="cb237-75"><a href="#cb237-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-76"><a href="#cb237-76" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb237-77"><a href="#cb237-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-78"><a href="#cb237-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-79"><a href="#cb237-79" aria-hidden="true" tabindex="-1"></a><span class="in">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb237-80"><a href="#cb237-80" aria-hidden="true" tabindex="-1"></a><span class="in">4</span></span>
<span id="cb237-81"><a href="#cb237-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-82"><a href="#cb237-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-83"><a href="#cb237-83" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb237-84"><a href="#cb237-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-85"><a href="#cb237-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-86"><a href="#cb237-86" aria-hidden="true" tabindex="-1"></a><span class="in">CATG GCAT</span></span>
<span id="cb237-87"><a href="#cb237-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-88"><a href="#cb237-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-89"><a href="#cb237-89" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb237-90"><a href="#cb237-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-91"><a href="#cb237-91" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb237-92"><a href="#cb237-92" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb237-93"><a href="#cb237-93" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb237-94"><a href="#cb237-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-95"><a href="#cb237-95" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-96"><a href="#cb237-96" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb237-97"><a href="#cb237-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-98"><a href="#cb237-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-99"><a href="#cb237-99" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb237-100"><a href="#cb237-100" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count occurrences of each k-mer in the text."""</span></span>
<span id="cb237-101"><a href="#cb237-101" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb237-102"><a href="#cb237-102" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(text, k):</span>
<span id="cb237-103"><a href="#cb237-103" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-104"><a href="#cb237-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb237-105"><a href="#cb237-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-106"><a href="#cb237-106" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> most_frequent_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-107"><a href="#cb237-107" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find the most frequent k-mers."""</span></span>
<span id="cb237-108"><a href="#cb237-108" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb237-109"><a href="#cb237-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb237-110"><a href="#cb237-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-111"><a href="#cb237-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-112"><a href="#cb237-112" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-113"><a href="#cb237-113" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb237-114"><a href="#cb237-114" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb237-115"><a href="#cb237-115" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-116"><a href="#cb237-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-117"><a href="#cb237-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern size</span></span>
<span id="cb237-118"><a href="#cb237-118" aria-hidden="true" tabindex="-1"></a>text, k <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-119"><a href="#cb237-119" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="bu">int</span>(k)</span>
<span id="cb237-120"><a href="#cb237-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-121"><a href="#cb237-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Find and print the most frequent k-mers</span></span>
<span id="cb237-122"><a href="#cb237-122" aria-hidden="true" tabindex="-1"></a>most_frequent <span class="op">=</span> most_frequent_kmers(count_kmers(text, k))</span>
<span id="cb237-123"><a href="#cb237-123" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent)</span>
<span id="cb237-124"><a href="#cb237-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-125"><a href="#cb237-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-126"><a href="#cb237-126" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find the Reverse Complement of a String</span></span>
<span id="cb237-127"><a href="#cb237-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-128"><a href="#cb237-128" aria-hidden="true" tabindex="-1"></a>Find the reverse complement of a DNA string.</span>
<span id="cb237-129"><a href="#cb237-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-130"><a href="#cb237-130" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A DNA string&nbsp;*Pattern*.</span>
<span id="cb237-131"><a href="#cb237-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-132"><a href="#cb237-132" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;$\overline{Pattern}$, the reverse complement of&nbsp;*Pattern*.</span>
<span id="cb237-133"><a href="#cb237-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-134"><a href="#cb237-134" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb237-135"><a href="#cb237-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-136"><a href="#cb237-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-137"><a href="#cb237-137" aria-hidden="true" tabindex="-1"></a><span class="in">AAAACCCGGT</span></span>
<span id="cb237-138"><a href="#cb237-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-139"><a href="#cb237-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-140"><a href="#cb237-140" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb237-141"><a href="#cb237-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-142"><a href="#cb237-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-143"><a href="#cb237-143" aria-hidden="true" tabindex="-1"></a><span class="in">ACCGGGTTTT</span></span>
<span id="cb237-144"><a href="#cb237-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-145"><a href="#cb237-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-146"><a href="#cb237-146" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb237-147"><a href="#cb237-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-148"><a href="#cb237-148" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb237-149"><a href="#cb237-149" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-150"><a href="#cb237-150" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Return the reverse complement of a DNA sequence."""</span></span>
<span id="cb237-151"><a href="#cb237-151" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb237-152"><a href="#cb237-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-153"><a href="#cb237-153" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-154"><a href="#cb237-154" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-155"><a href="#cb237-155" aria-hidden="true" tabindex="-1"></a><span class="st">AAAACCCGGT</span></span>
<span id="cb237-156"><a href="#cb237-156" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-157"><a href="#cb237-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-158"><a href="#cb237-158" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the reverse complement</span></span>
<span id="cb237-159"><a href="#cb237-159" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip().split()[<span class="dv">0</span>]</span>
<span id="cb237-160"><a href="#cb237-160" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reverse_complement(sequence))</span>
<span id="cb237-161"><a href="#cb237-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-162"><a href="#cb237-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-163"><a href="#cb237-163" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find All Occurrences of a Pattern in a String</span></span>
<span id="cb237-164"><a href="#cb237-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-165"><a href="#cb237-165" aria-hidden="true" tabindex="-1"></a>Pattern Matching Problem, Find all occurrences of a pattern in a string.</span>
<span id="cb237-166"><a href="#cb237-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-167"><a href="#cb237-167" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Strings&nbsp;*Pattern*&nbsp;and&nbsp;*Genome*.</span>
<span id="cb237-168"><a href="#cb237-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-169"><a href="#cb237-169" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All starting positions in&nbsp;*Genome*&nbsp;where&nbsp;*Pattern*&nbsp;appears as a substring. Use&nbsp;<span class="co">[</span><span class="ot">0-based indexing</span><span class="co">](https://rosalind.info/glossary/0-based-numbering/)</span>.</span>
<span id="cb237-170"><a href="#cb237-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-171"><a href="#cb237-171" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb237-172"><a href="#cb237-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-173"><a href="#cb237-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-174"><a href="#cb237-174" aria-hidden="true" tabindex="-1"></a><span class="in">ATAT</span></span>
<span id="cb237-175"><a href="#cb237-175" aria-hidden="true" tabindex="-1"></a><span class="in">GATATATGCATATACTT</span></span>
<span id="cb237-176"><a href="#cb237-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-177"><a href="#cb237-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-178"><a href="#cb237-178" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb237-179"><a href="#cb237-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-180"><a href="#cb237-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-181"><a href="#cb237-181" aria-hidden="true" tabindex="-1"></a><span class="in">1 3 9</span></span>
<span id="cb237-182"><a href="#cb237-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-183"><a href="#cb237-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-184"><a href="#cb237-184" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb237-185"><a href="#cb237-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-186"><a href="#cb237-186" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb237-187"><a href="#cb237-187" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Generator</span>
<span id="cb237-188"><a href="#cb237-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-189"><a href="#cb237-189" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-190"><a href="#cb237-190" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb237-191"><a href="#cb237-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-192"><a href="#cb237-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-193"><a href="#cb237-193" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_pattern_indices(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb237-194"><a href="#cb237-194" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Yield starting indices where the pattern is found in the text."""</span></span>
<span id="cb237-195"><a href="#cb237-195" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, <span class="bu">len</span>(pattern))):</span>
<span id="cb237-196"><a href="#cb237-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> substring <span class="op">==</span> pattern:</span>
<span id="cb237-197"><a href="#cb237-197" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> i</span>
<span id="cb237-198"><a href="#cb237-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-199"><a href="#cb237-199" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-200"><a href="#cb237-200" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-201"><a href="#cb237-201" aria-hidden="true" tabindex="-1"></a><span class="st">ATAT</span></span>
<span id="cb237-202"><a href="#cb237-202" aria-hidden="true" tabindex="-1"></a><span class="st">GATATATGCATATACTT</span></span>
<span id="cb237-203"><a href="#cb237-203" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-204"><a href="#cb237-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-205"><a href="#cb237-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into pattern and text</span></span>
<span id="cb237-206"><a href="#cb237-206" aria-hidden="true" tabindex="-1"></a>pattern, text <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-207"><a href="#cb237-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-208"><a href="#cb237-208" aria-hidden="true" tabindex="-1"></a><span class="co"># Print indices where the pattern is found</span></span>
<span id="cb237-209"><a href="#cb237-209" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_pattern_indices(text, pattern))</span>
<span id="cb237-210"><a href="#cb237-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-211"><a href="#cb237-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-212"><a href="#cb237-212" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find Patterns Forming Clumps in a String</span></span>
<span id="cb237-213"><a href="#cb237-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-214"><a href="#cb237-214" aria-hidden="true" tabindex="-1"></a>Clump Finding Problem, Find patterns forming clumps in a string.</span>
<span id="cb237-215"><a href="#cb237-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-216"><a href="#cb237-216" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;*Genome*, and integers&nbsp;*k*,&nbsp;*L*, and&nbsp;*t*.</span>
<span id="cb237-217"><a href="#cb237-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-218"><a href="#cb237-218" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All distinct&nbsp;*k*-mers forming (*L*,&nbsp;*t*)-clumps in&nbsp;*Genome*.</span>
<span id="cb237-219"><a href="#cb237-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-220"><a href="#cb237-220" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb237-221"><a href="#cb237-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-222"><a href="#cb237-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-223"><a href="#cb237-223" aria-hidden="true" tabindex="-1"></a><span class="in">CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC</span></span>
<span id="cb237-224"><a href="#cb237-224" aria-hidden="true" tabindex="-1"></a><span class="in">5 75 4</span></span>
<span id="cb237-225"><a href="#cb237-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-226"><a href="#cb237-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-227"><a href="#cb237-227" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb237-228"><a href="#cb237-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-229"><a href="#cb237-229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-230"><a href="#cb237-230" aria-hidden="true" tabindex="-1"></a><span class="in">CGACA GAAGA AATGT</span></span>
<span id="cb237-231"><a href="#cb237-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-232"><a href="#cb237-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-233"><a href="#cb237-233" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb237-234"><a href="#cb237-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-235"><a href="#cb237-235" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb237-236"><a href="#cb237-236" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb237-237"><a href="#cb237-237" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb237-238"><a href="#cb237-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-239"><a href="#cb237-239" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-240"><a href="#cb237-240" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb237-241"><a href="#cb237-241" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-242"><a href="#cb237-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-243"><a href="#cb237-243" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb237-244"><a href="#cb237-244" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions of k-length kmers within the text."""</span></span>
<span id="cb237-245"><a href="#cb237-245" aria-hidden="true" tabindex="-1"></a>    kmer_positions <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb237-246"><a href="#cb237-246" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, k)):</span>
<span id="cb237-247"><a href="#cb237-247" aria-hidden="true" tabindex="-1"></a>        kmer_positions[substring].append(i)</span>
<span id="cb237-248"><a href="#cb237-248" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_positions</span>
<span id="cb237-249"><a href="#cb237-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-250"><a href="#cb237-250" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> has_clump(positions: List[<span class="bu">int</span>], L: <span class="bu">int</span>, t: <span class="bu">int</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb237-251"><a href="#cb237-251" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Check if a given array of kmers at positions forms a clump of t within L."""</span></span>
<span id="cb237-252"><a href="#cb237-252" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(positions) <span class="op">-</span> t <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-253"><a href="#cb237-253" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (positions[i <span class="op">+</span> t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> k <span class="op">-</span> positions[i]) <span class="op">&lt;=</span> L:</span>
<span id="cb237-254"><a href="#cb237-254" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb237-255"><a href="#cb237-255" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb237-256"><a href="#cb237-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-257"><a href="#cb237-257" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-258"><a href="#cb237-258" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-259"><a href="#cb237-259" aria-hidden="true" tabindex="-1"></a><span class="st">CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC</span></span>
<span id="cb237-260"><a href="#cb237-260" aria-hidden="true" tabindex="-1"></a><span class="st">5 75 4</span></span>
<span id="cb237-261"><a href="#cb237-261" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-262"><a href="#cb237-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-263"><a href="#cb237-263" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into sequence and parameters</span></span>
<span id="cb237-264"><a href="#cb237-264" aria-hidden="true" tabindex="-1"></a>seq, params <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-265"><a href="#cb237-265" aria-hidden="true" tabindex="-1"></a>k, L, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb237-266"><a href="#cb237-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-267"><a href="#cb237-267" aria-hidden="true" tabindex="-1"></a><span class="co"># Find kmers and print those forming clumps</span></span>
<span id="cb237-268"><a href="#cb237-268" aria-hidden="true" tabindex="-1"></a>kmers <span class="op">=</span> find_kmers(seq, k)</span>
<span id="cb237-269"><a href="#cb237-269" aria-hidden="true" tabindex="-1"></a>clumps <span class="op">=</span> [kmer <span class="cf">for</span> kmer <span class="kw">in</span> kmers <span class="cf">if</span> has_clump(kmers[kmer], L, t, k)]</span>
<span id="cb237-270"><a href="#cb237-270" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>clumps)</span>
<span id="cb237-271"><a href="#cb237-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-272"><a href="#cb237-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-273"><a href="#cb237-273" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find a Position in a Genome Minimizing the Skew</span></span>
<span id="cb237-274"><a href="#cb237-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-275"><a href="#cb237-275" aria-hidden="true" tabindex="-1"></a>Minimum Skew Problem, Find a position in a genome minimizing the skew.</span>
<span id="cb237-276"><a href="#cb237-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-277"><a href="#cb237-277" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A DNA string&nbsp;*Genome*.</span>
<span id="cb237-278"><a href="#cb237-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-279"><a href="#cb237-279" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All integer(s)&nbsp;*i*&nbsp;minimizing&nbsp;*Skew*(*Prefix__i*&nbsp;(*Text*)) over all values of&nbsp;*i*&nbsp;(from 0 to |*Genome*|).</span>
<span id="cb237-280"><a href="#cb237-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-281"><a href="#cb237-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb237-282"><a href="#cb237-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-283"><a href="#cb237-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-284"><a href="#cb237-284" aria-hidden="true" tabindex="-1"></a><span class="in">CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</span></span>
<span id="cb237-285"><a href="#cb237-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-286"><a href="#cb237-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-287"><a href="#cb237-287" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb237-288"><a href="#cb237-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-289"><a href="#cb237-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-290"><a href="#cb237-290" aria-hidden="true" tabindex="-1"></a><span class="in">53 97</span></span>
<span id="cb237-291"><a href="#cb237-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-292"><a href="#cb237-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-293"><a href="#cb237-293" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb237-294"><a href="#cb237-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-295"><a href="#cb237-295" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb237-296"><a href="#cb237-296" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb237-297"><a href="#cb237-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-298"><a href="#cb237-298" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minima(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb237-299"><a href="#cb237-299" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions with the minimum skew in a DNA sequence."""</span></span>
<span id="cb237-300"><a href="#cb237-300" aria-hidden="true" tabindex="-1"></a>    skew <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb237-301"><a href="#cb237-301" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> {<span class="st">"G"</span>: <span class="dv">1</span>, <span class="st">"C"</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"T"</span>: <span class="dv">0</span>}</span>
<span id="cb237-302"><a href="#cb237-302" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-303"><a href="#cb237-303" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(seq):</span>
<span id="cb237-304"><a href="#cb237-304" aria-hidden="true" tabindex="-1"></a>        skew.append(skew[i] <span class="op">+</span> delta[nucleotide])</span>
<span id="cb237-305"><a href="#cb237-305" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-306"><a href="#cb237-306" aria-hidden="true" tabindex="-1"></a>    min_skew <span class="op">=</span> <span class="bu">min</span>(skew)</span>
<span id="cb237-307"><a href="#cb237-307" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (i <span class="cf">for</span> i, value <span class="kw">in</span> <span class="bu">enumerate</span>(skew) <span class="cf">if</span> value <span class="op">==</span> min_skew)</span>
<span id="cb237-308"><a href="#cb237-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-309"><a href="#cb237-309" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-310"><a href="#cb237-310" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-311"><a href="#cb237-311" aria-hidden="true" tabindex="-1"></a><span class="st">CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</span></span>
<span id="cb237-312"><a href="#cb237-312" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-313"><a href="#cb237-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-314"><a href="#cb237-314" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the positions with minimum skew</span></span>
<span id="cb237-315"><a href="#cb237-315" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip()</span>
<span id="cb237-316"><a href="#cb237-316" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_minima(sequence))</span>
<span id="cb237-317"><a href="#cb237-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-318"><a href="#cb237-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-319"><a href="#cb237-319" aria-hidden="true" tabindex="-1"></a><span class="fu"># Compute the Hamming Distance Between Two Strings</span></span>
<span id="cb237-320"><a href="#cb237-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-321"><a href="#cb237-321" aria-hidden="true" tabindex="-1"></a>Hamming Distance Problem, Compute the Hamming distance between two DNA strings.</span>
<span id="cb237-322"><a href="#cb237-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-323"><a href="#cb237-323" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two DNA strings.</span>
<span id="cb237-324"><a href="#cb237-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-325"><a href="#cb237-325" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An integer value representing the Hamming distance.</span>
<span id="cb237-326"><a href="#cb237-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-327"><a href="#cb237-327" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb237-328"><a href="#cb237-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-329"><a href="#cb237-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-330"><a href="#cb237-330" aria-hidden="true" tabindex="-1"></a><span class="in">GGGCCGTTGGT</span></span>
<span id="cb237-331"><a href="#cb237-331" aria-hidden="true" tabindex="-1"></a><span class="in">GGACCGTTGAC</span></span>
<span id="cb237-332"><a href="#cb237-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-333"><a href="#cb237-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-334"><a href="#cb237-334" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb237-335"><a href="#cb237-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-336"><a href="#cb237-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-337"><a href="#cb237-337" aria-hidden="true" tabindex="-1"></a><span class="in">3</span></span>
<span id="cb237-338"><a href="#cb237-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-339"><a href="#cb237-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-340"><a href="#cb237-340" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb237-341"><a href="#cb237-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-342"><a href="#cb237-342" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb237-343"><a href="#cb237-343" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> zip_longest</span>
<span id="cb237-344"><a href="#cb237-344" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb237-345"><a href="#cb237-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-346"><a href="#cb237-346" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-347"><a href="#cb237-347" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> zip_longest(sequence1, sequence2, fillvalue<span class="op">=</span><span class="va">None</span>))</span>
<span id="cb237-348"><a href="#cb237-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-349"><a href="#cb237-349" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_dna_sequences(input_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb237-350"><a href="#cb237-350" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>(input_string.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>))</span>
<span id="cb237-351"><a href="#cb237-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-352"><a href="#cb237-352" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-353"><a href="#cb237-353" aria-hidden="true" tabindex="-1"></a>Sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-354"><a href="#cb237-354" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCCGTTGGT</span></span>
<span id="cb237-355"><a href="#cb237-355" aria-hidden="true" tabindex="-1"></a><span class="st">GGACCGTTGAC</span></span>
<span id="cb237-356"><a href="#cb237-356" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-357"><a href="#cb237-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-358"><a href="#cb237-358" aria-hidden="true" tabindex="-1"></a>dna_sequence1, dna_sequence2 <span class="op">=</span> parse_dna_sequences(Sample_input)</span>
<span id="cb237-359"><a href="#cb237-359" aria-hidden="true" tabindex="-1"></a>hamming_distance <span class="op">=</span> calculate_hamming_distance(dna_sequence1, dna_sequence2)</span>
<span id="cb237-360"><a href="#cb237-360" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(hamming_distance)</span>
<span id="cb237-361"><a href="#cb237-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-362"><a href="#cb237-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-363"><a href="#cb237-363" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find All Approximate Occurrences of a Pattern in a String</span></span>
<span id="cb237-364"><a href="#cb237-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-365"><a href="#cb237-365" aria-hidden="true" tabindex="-1"></a>Approximate Pattern Matching Problem, Find all approximate occurrences of a pattern in a string.</span>
<span id="cb237-366"><a href="#cb237-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-367"><a href="#cb237-367" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Strings&nbsp;*Pattern*&nbsp;and&nbsp;*Text*&nbsp;along with an integer&nbsp;*d*.</span>
<span id="cb237-368"><a href="#cb237-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-369"><a href="#cb237-369" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All starting positions where&nbsp;*Pattern*&nbsp;appears as a substring of&nbsp;*Text*&nbsp;with at most&nbsp;*d*&nbsp;mismatches.</span>
<span id="cb237-370"><a href="#cb237-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-371"><a href="#cb237-371" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb237-372"><a href="#cb237-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-373"><a href="#cb237-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-374"><a href="#cb237-374" aria-hidden="true" tabindex="-1"></a><span class="in">ATTCTGGA</span></span>
<span id="cb237-375"><a href="#cb237-375" aria-hidden="true" tabindex="-1"></a><span class="in">CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC</span></span>
<span id="cb237-376"><a href="#cb237-376" aria-hidden="true" tabindex="-1"></a><span class="in">3</span></span>
<span id="cb237-377"><a href="#cb237-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-378"><a href="#cb237-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-379"><a href="#cb237-379" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb237-380"><a href="#cb237-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-381"><a href="#cb237-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-382"><a href="#cb237-382" aria-hidden="true" tabindex="-1"></a><span class="in">6 7 26 27 78</span></span>
<span id="cb237-383"><a href="#cb237-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-384"><a href="#cb237-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-385"><a href="#cb237-385" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb237-386"><a href="#cb237-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-387"><a href="#cb237-387" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb237-388"><a href="#cb237-388" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb237-389"><a href="#cb237-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-390"><a href="#cb237-390" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-391"><a href="#cb237-391" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb237-392"><a href="#cb237-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-393"><a href="#cb237-393" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-394"><a href="#cb237-394" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb237-395"><a href="#cb237-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-396"><a href="#cb237-396" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_approximate_matches(pattern: <span class="bu">str</span>, genome: <span class="bu">str</span>, max_mismatch: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">int</span>]:</span>
<span id="cb237-397"><a href="#cb237-397" aria-hidden="true" tabindex="-1"></a>    pattern_length <span class="op">=</span> <span class="bu">len</span>(pattern)</span>
<span id="cb237-398"><a href="#cb237-398" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (position <span class="cf">for</span> position, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(genome, pattern_length))</span>
<span id="cb237-399"><a href="#cb237-399" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_mismatch)</span>
<span id="cb237-400"><a href="#cb237-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-401"><a href="#cb237-401" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb237-402"><a href="#cb237-402" aria-hidden="true" tabindex="-1"></a>    pattern, genome, max_mismatch_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-403"><a href="#cb237-403" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pattern, genome, <span class="bu">int</span>(max_mismatch_str)</span>
<span id="cb237-404"><a href="#cb237-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-405"><a href="#cb237-405" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-406"><a href="#cb237-406" aria-hidden="true" tabindex="-1"></a><span class="st">ATTCTGGA</span></span>
<span id="cb237-407"><a href="#cb237-407" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC</span></span>
<span id="cb237-408"><a href="#cb237-408" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb237-409"><a href="#cb237-409" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-410"><a href="#cb237-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-411"><a href="#cb237-411" aria-hidden="true" tabindex="-1"></a>pattern, genome, max_mismatch <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb237-412"><a href="#cb237-412" aria-hidden="true" tabindex="-1"></a>match_positions <span class="op">=</span> <span class="bu">list</span>(find_approximate_matches(pattern, genome, max_mismatch))</span>
<span id="cb237-413"><a href="#cb237-413" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>match_positions)</span>
<span id="cb237-414"><a href="#cb237-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-415"><a href="#cb237-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-416"><a href="#cb237-416" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find the Most Frequent Words with Mismatches in a String</span></span>
<span id="cb237-417"><a href="#cb237-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-418"><a href="#cb237-418" aria-hidden="true" tabindex="-1"></a>Frequent Words with Mismatches Problem, Find the most frequent k-mers with mismatches in a string.</span>
<span id="cb237-419"><a href="#cb237-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-420"><a href="#cb237-420" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;*Text*&nbsp;as well as integers&nbsp;*k*&nbsp;and&nbsp;*d*.</span>
<span id="cb237-421"><a href="#cb237-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-422"><a href="#cb237-422" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All most frequent&nbsp;*k*-mers with up to&nbsp;*d*&nbsp;mismatches in&nbsp;*Text*.</span>
<span id="cb237-423"><a href="#cb237-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-424"><a href="#cb237-424" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb237-425"><a href="#cb237-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-426"><a href="#cb237-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-427"><a href="#cb237-427" aria-hidden="true" tabindex="-1"></a><span class="in">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb237-428"><a href="#cb237-428" aria-hidden="true" tabindex="-1"></a><span class="in">4 1</span></span>
<span id="cb237-429"><a href="#cb237-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-430"><a href="#cb237-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-431"><a href="#cb237-431" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb237-432"><a href="#cb237-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-433"><a href="#cb237-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-434"><a href="#cb237-434" aria-hidden="true" tabindex="-1"></a><span class="in">ATGC ATGT GATG</span></span>
<span id="cb237-435"><a href="#cb237-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-436"><a href="#cb237-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-437"><a href="#cb237-437" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb237-438"><a href="#cb237-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-439"><a href="#cb237-439" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb237-440"><a href="#cb237-440" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb237-441"><a href="#cb237-441" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb237-442"><a href="#cb237-442" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb237-443"><a href="#cb237-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-444"><a href="#cb237-444" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-445"><a href="#cb237-445" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb237-446"><a href="#cb237-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-447"><a href="#cb237-447" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-448"><a href="#cb237-448" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb237-449"><a href="#cb237-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-450"><a href="#cb237-450" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna_sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb237-451"><a href="#cb237-451" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb237-452"><a href="#cb237-452" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna_sequence, kmer_length):</span>
<span id="cb237-453"><a href="#cb237-453" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-454"><a href="#cb237-454" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb237-455"><a href="#cb237-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-456"><a href="#cb237-456" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-457"><a href="#cb237-457" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb237-458"><a href="#cb237-458" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb237-459"><a href="#cb237-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-460"><a href="#cb237-460" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-461"><a href="#cb237-461" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb237-462"><a href="#cb237-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-463"><a href="#cb237-463" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(observed_kmers: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb237-464"><a href="#cb237-464" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb237-465"><a href="#cb237-465" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(observed_kmers[observed_kmer] </span>
<span id="cb237-466"><a href="#cb237-466" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> observed_kmer <span class="kw">in</span> observed_kmers </span>
<span id="cb237-467"><a href="#cb237-467" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb237-468"><a href="#cb237-468" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb237-469"><a href="#cb237-469" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb237-470"><a href="#cb237-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-471"><a href="#cb237-471" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb237-472"><a href="#cb237-472" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-473"><a href="#cb237-473" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb237-474"><a href="#cb237-474" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb237-475"><a href="#cb237-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-476"><a href="#cb237-476" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-477"><a href="#cb237-477" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb237-478"><a href="#cb237-478" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb237-479"><a href="#cb237-479" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-480"><a href="#cb237-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-481"><a href="#cb237-481" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb237-482"><a href="#cb237-482" aria-hidden="true" tabindex="-1"></a>observed_kmers <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb237-483"><a href="#cb237-483" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(observed_kmers, max_mismatches, kmer_length))</span>
<span id="cb237-484"><a href="#cb237-484" aria-hidden="true" tabindex="-1"></a>most_frequent_kmers <span class="op">=</span> find_most_frequent(approximate_kmer_counts)</span>
<span id="cb237-485"><a href="#cb237-485" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent_kmers)</span>
<span id="cb237-486"><a href="#cb237-486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-487"><a href="#cb237-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-488"><a href="#cb237-488" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find Frequent Words with Mismatches and Reverse Complements</span></span>
<span id="cb237-489"><a href="#cb237-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-490"><a href="#cb237-490" aria-hidden="true" tabindex="-1"></a>Frequent Words with Mismatches and Reverse Complements Problem. Find the most frequent k-mers (with mismatches and reverse complements) in a DNA string.</span>
<span id="cb237-491"><a href="#cb237-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-492"><a href="#cb237-492" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A DNA string&nbsp;*Text*&nbsp;as well as integers&nbsp;*k*&nbsp;and&nbsp;*d*.</span>
<span id="cb237-493"><a href="#cb237-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-494"><a href="#cb237-494" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All&nbsp;*k*-mers&nbsp;*Pattern*&nbsp;maximizing the sum&nbsp;*Count__d*(*Text*,&nbsp;$Pattern$) +&nbsp;*Count__d*(*Text*,&nbsp;$\overline{Pattern}$}) over all possible&nbsp;*k*-mers.</span>
<span id="cb237-495"><a href="#cb237-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-496"><a href="#cb237-496" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb237-497"><a href="#cb237-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-498"><a href="#cb237-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-499"><a href="#cb237-499" aria-hidden="true" tabindex="-1"></a><span class="in">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb237-500"><a href="#cb237-500" aria-hidden="true" tabindex="-1"></a><span class="in">4 1</span></span>
<span id="cb237-501"><a href="#cb237-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-502"><a href="#cb237-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-503"><a href="#cb237-503" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb237-504"><a href="#cb237-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-505"><a href="#cb237-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-506"><a href="#cb237-506" aria-hidden="true" tabindex="-1"></a><span class="in">ATGT ACAT</span></span>
<span id="cb237-507"><a href="#cb237-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-508"><a href="#cb237-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-509"><a href="#cb237-509" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb237-510"><a href="#cb237-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-511"><a href="#cb237-511" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb237-512"><a href="#cb237-512" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb237-513"><a href="#cb237-513" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb237-514"><a href="#cb237-514" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb237-515"><a href="#cb237-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-516"><a href="#cb237-516" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(dna: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-517"><a href="#cb237-517" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb237-518"><a href="#cb237-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-519"><a href="#cb237-519" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-520"><a href="#cb237-520" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb237-521"><a href="#cb237-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-522"><a href="#cb237-522" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna: <span class="bu">str</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-523"><a href="#cb237-523" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna[i:i <span class="op">+</span> length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna) <span class="op">-</span> length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb237-524"><a href="#cb237-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-525"><a href="#cb237-525" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb237-526"><a href="#cb237-526" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb237-527"><a href="#cb237-527" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna, kmer_length):</span>
<span id="cb237-528"><a href="#cb237-528" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-529"><a href="#cb237-529" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb237-530"><a href="#cb237-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-531"><a href="#cb237-531" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-532"><a href="#cb237-532" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb237-533"><a href="#cb237-533" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb237-534"><a href="#cb237-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-535"><a href="#cb237-535" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-536"><a href="#cb237-536" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb237-537"><a href="#cb237-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-538"><a href="#cb237-538" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb237-539"><a href="#cb237-539" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb237-540"><a href="#cb237-540" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb237-541"><a href="#cb237-541" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb237-542"><a href="#cb237-542" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb237-543"><a href="#cb237-543" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">if</span> hamming_distance(reverse_complement(potential_kmer), observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb237-544"><a href="#cb237-544" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb237-545"><a href="#cb237-545" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb237-546"><a href="#cb237-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-547"><a href="#cb237-547" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb237-548"><a href="#cb237-548" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-549"><a href="#cb237-549" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb237-550"><a href="#cb237-550" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb237-551"><a href="#cb237-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-552"><a href="#cb237-552" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-553"><a href="#cb237-553" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb237-554"><a href="#cb237-554" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb237-555"><a href="#cb237-555" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-556"><a href="#cb237-556" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb237-557"><a href="#cb237-557" aria-hidden="true" tabindex="-1"></a>kmer_counts <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb237-558"><a href="#cb237-558" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(kmer_counts, max_mismatches, kmer_length))</span>
<span id="cb237-559"><a href="#cb237-559" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_most_frequent(approximate_kmer_counts))</span>
<span id="cb237-560"><a href="#cb237-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-561"><a href="#cb237-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-562"><a href="#cb237-562" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generate the Frequency Array of a String</span></span>
<span id="cb237-563"><a href="#cb237-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-564"><a href="#cb237-564" aria-hidden="true" tabindex="-1"></a>Computing a Frequency Array, Generate the frequency array of a DNA string.</span>
<span id="cb237-565"><a href="#cb237-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-566"><a href="#cb237-566" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;<span class="co">[</span><span class="ot">DNA string</span><span class="co">](https://rosalind.info/glossary/dna-string/)</span>&nbsp;*Text*&nbsp;and an integer&nbsp;*k*.</span>
<span id="cb237-567"><a href="#cb237-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-568"><a href="#cb237-568" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The frequency array of&nbsp;*k*-mers in&nbsp;*Text*.</span>
<span id="cb237-569"><a href="#cb237-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-570"><a href="#cb237-570" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb237-571"><a href="#cb237-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-572"><a href="#cb237-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-573"><a href="#cb237-573" aria-hidden="true" tabindex="-1"></a><span class="in">ACGCGGCTCTGAAA</span></span>
<span id="cb237-574"><a href="#cb237-574" aria-hidden="true" tabindex="-1"></a><span class="in">2</span></span>
<span id="cb237-575"><a href="#cb237-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-576"><a href="#cb237-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-577"><a href="#cb237-577" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb237-578"><a href="#cb237-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-579"><a href="#cb237-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-580"><a href="#cb237-580" aria-hidden="true" tabindex="-1"></a><span class="in">2 1 0 0 0 0 2 2 1 2 1 0 0 1 1 0</span></span>
<span id="cb237-581"><a href="#cb237-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb237-582"><a href="#cb237-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-583"><a href="#cb237-583" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb237-584"><a href="#cb237-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-585"><a href="#cb237-585" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb237-586"><a href="#cb237-586" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict, Tuple</span>
<span id="cb237-587"><a href="#cb237-587" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb237-588"><a href="#cb237-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-589"><a href="#cb237-589" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-590"><a href="#cb237-590" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (text[i : i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb237-591"><a href="#cb237-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-592"><a href="#cb237-592" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-593"><a href="#cb237-593" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb237-594"><a href="#cb237-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-595"><a href="#cb237-595" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(s1: <span class="bu">str</span>, s2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-596"><a href="#cb237-596" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(s1, s2))</span>
<span id="cb237-597"><a href="#cb237-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-598"><a href="#cb237-598" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(k: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-599"><a href="#cb237-599" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>k))</span>
<span id="cb237-600"><a href="#cb237-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-601"><a href="#cb237-601" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb237-602"><a href="#cb237-602" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb237-603"><a href="#cb237-603" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb237-604"><a href="#cb237-604" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb237-605"><a href="#cb237-605" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb237-606"><a href="#cb237-606" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb237-607"><a href="#cb237-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-608"><a href="#cb237-608" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_frequencies(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-609"><a href="#cb237-609" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [count_pattern_occurrences(sequence, kmer) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length)]</span>
<span id="cb237-610"><a href="#cb237-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-611"><a href="#cb237-611" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb237-612"><a href="#cb237-612" aria-hidden="true" tabindex="-1"></a>    sequence, kmer_length <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-613"><a href="#cb237-613" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(kmer_length)</span>
<span id="cb237-614"><a href="#cb237-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-615"><a href="#cb237-615" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-616"><a href="#cb237-616" aria-hidden="true" tabindex="-1"></a><span class="st">ACGCGGCTCTGAAA</span></span>
<span id="cb237-617"><a href="#cb237-617" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb237-618"><a href="#cb237-618" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-619"><a href="#cb237-619" aria-hidden="true" tabindex="-1"></a>sequence, kmer_length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb237-620"><a href="#cb237-620" aria-hidden="true" tabindex="-1"></a>kmer_frequencies <span class="op">=</span> calculate_kmer_frequencies(sequence, kmer_length)</span>
<span id="cb237-621"><a href="#cb237-621" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>kmer_frequencies</span>
<span id="cb237-622"><a href="#cb237-622" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-623"><a href="#cb237-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-624"><a href="#cb237-624" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement PatternToNumber</span></span>
<span id="cb237-625"><a href="#cb237-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-626"><a href="#cb237-626" aria-hidden="true" tabindex="-1"></a>Implement PatternToNumber, Convert a DNA string to a number.</span>
<span id="cb237-627"><a href="#cb237-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-628"><a href="#cb237-628" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[DNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>.</span>
<span id="cb237-629"><a href="#cb237-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-630"><a href="#cb237-630" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>PatternToNumber<span class="op">*</span>(<span class="op">*</span>Pattern<span class="op">*</span>).</span>
<span id="cb237-631"><a href="#cb237-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-632"><a href="#cb237-632" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-633"><a href="#cb237-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-634"><a href="#cb237-634" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-635"><a href="#cb237-635" aria-hidden="true" tabindex="-1"></a>AGT</span>
<span id="cb237-636"><a href="#cb237-636" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-637"><a href="#cb237-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-638"><a href="#cb237-638" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-639"><a href="#cb237-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-640"><a href="#cb237-640" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-641"><a href="#cb237-641" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span></span>
<span id="cb237-642"><a href="#cb237-642" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-643"><a href="#cb237-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-644"><a href="#cb237-644" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-645"><a href="#cb237-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-646"><a href="#cb237-646" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-647"><a href="#cb237-647" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple</span>
<span id="cb237-648"><a href="#cb237-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-649"><a href="#cb237-649" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_nucleotide_to_number_map() <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb237-650"><a href="#cb237-650" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb237-651"><a href="#cb237-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-652"><a href="#cb237-652" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_nucleotide_to_number(nucleotide: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-653"><a href="#cb237-653" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotide_map[nucleotide]</span>
<span id="cb237-654"><a href="#cb237-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-655"><a href="#cb237-655" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_dna_pattern_to_number(dna_pattern: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-656"><a href="#cb237-656" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> dna_pattern:</span>
<span id="cb237-657"><a href="#cb237-657" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb237-658"><a href="#cb237-658" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">4</span> <span class="op">*</span> convert_dna_pattern_to_number(dna_pattern[:<span class="op">-</span><span class="dv">1</span>], nucleotide_map) <span class="op">+</span> convert_nucleotide_to_number(dna_pattern[<span class="op">-</span><span class="dv">1</span>], nucleotide_map)</span>
<span id="cb237-659"><a href="#cb237-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-660"><a href="#cb237-660" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-661"><a href="#cb237-661" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_data.strip()</span>
<span id="cb237-662"><a href="#cb237-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-663"><a href="#cb237-663" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-664"><a href="#cb237-664" aria-hidden="true" tabindex="-1"></a><span class="st">AGT</span></span>
<span id="cb237-665"><a href="#cb237-665" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-666"><a href="#cb237-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-667"><a href="#cb237-667" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb237-668"><a href="#cb237-668" aria-hidden="true" tabindex="-1"></a>nucleotide_map <span class="op">=</span> create_nucleotide_to_number_map()</span>
<span id="cb237-669"><a href="#cb237-669" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> convert_dna_pattern_to_number(dna_pattern, nucleotide_map)</span>
<span id="cb237-670"><a href="#cb237-670" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb237-671"><a href="#cb237-671" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-672"><a href="#cb237-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-673"><a href="#cb237-673" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement NumberToPattern</span></span>
<span id="cb237-674"><a href="#cb237-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-675"><a href="#cb237-675" aria-hidden="true" tabindex="-1"></a>Implement NumberToPattern, Convert an integer to its corresponding DNA string.</span>
<span id="cb237-676"><a href="#cb237-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-677"><a href="#cb237-677" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>index<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>k<span class="op">*</span>.</span>
<span id="cb237-678"><a href="#cb237-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-679"><a href="#cb237-679" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>NumberToPattern<span class="op">*</span>(<span class="op">*</span>index<span class="op">*</span>,&nbsp;<span class="op">*</span>k<span class="op">*</span>).</span>
<span id="cb237-680"><a href="#cb237-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-681"><a href="#cb237-681" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-682"><a href="#cb237-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-683"><a href="#cb237-683" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-684"><a href="#cb237-684" aria-hidden="true" tabindex="-1"></a><span class="dv">45</span></span>
<span id="cb237-685"><a href="#cb237-685" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb237-686"><a href="#cb237-686" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-687"><a href="#cb237-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-688"><a href="#cb237-688" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-689"><a href="#cb237-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-690"><a href="#cb237-690" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-691"><a href="#cb237-691" aria-hidden="true" tabindex="-1"></a>AGTC</span>
<span id="cb237-692"><a href="#cb237-692" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-693"><a href="#cb237-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-694"><a href="#cb237-694" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-695"><a href="#cb237-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-696"><a href="#cb237-696" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-697"><a href="#cb237-697" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb237-698"><a href="#cb237-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-699"><a href="#cb237-699" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_nucleotide(index: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-700"><a href="#cb237-700" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb237-701"><a href="#cb237-701" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotides[index]</span>
<span id="cb237-702"><a href="#cb237-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-703"><a href="#cb237-703" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_dna_pattern(index: <span class="bu">int</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-704"><a href="#cb237-704" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> length <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb237-705"><a href="#cb237-705" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> number_to_nucleotide(index)</span>
<span id="cb237-706"><a href="#cb237-706" aria-hidden="true" tabindex="-1"></a>    quotient, remainder <span class="op">=</span> <span class="bu">divmod</span>(index, <span class="dv">4</span>)</span>
<span id="cb237-707"><a href="#cb237-707" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> number_to_dna_pattern(quotient, length <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> number_to_nucleotide(remainder)</span>
<span id="cb237-708"><a href="#cb237-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-709"><a href="#cb237-709" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb237-710"><a href="#cb237-710" aria-hidden="true" tabindex="-1"></a>    index_str, length_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-711"><a href="#cb237-711" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">int</span>(index_str), <span class="bu">int</span>(length_str)</span>
<span id="cb237-712"><a href="#cb237-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-713"><a href="#cb237-713" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-714"><a href="#cb237-714" aria-hidden="true" tabindex="-1"></a><span class="st">45</span></span>
<span id="cb237-715"><a href="#cb237-715" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb237-716"><a href="#cb237-716" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-717"><a href="#cb237-717" aria-hidden="true" tabindex="-1"></a>index, length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb237-718"><a href="#cb237-718" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> number_to_dna_pattern(index, length)</span>
<span id="cb237-719"><a href="#cb237-719" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dna_pattern)</span>
<span id="cb237-720"><a href="#cb237-720" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-721"><a href="#cb237-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-722"><a href="#cb237-722" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the d-Neighborhood of a String</span></span>
<span id="cb237-723"><a href="#cb237-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-724"><a href="#cb237-724" aria-hidden="true" tabindex="-1"></a>Generate the d<span class="op">-</span>Neighborhood of a String Find <span class="bu">all</span> the neighbors of a pattern.</span>
<span id="cb237-725"><a href="#cb237-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-726"><a href="#cb237-726" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[DNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>&nbsp;and an integer&nbsp;<span class="op">*</span>d<span class="op">*</span>.</span>
<span id="cb237-727"><a href="#cb237-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-728"><a href="#cb237-728" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The collection of strings&nbsp;<span class="op">*</span>Neighbors<span class="op">*</span>(<span class="op">*</span>Pattern<span class="op">*</span>,&nbsp;<span class="op">*</span>d<span class="op">*</span>).</span>
<span id="cb237-729"><a href="#cb237-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-730"><a href="#cb237-730" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-731"><a href="#cb237-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-732"><a href="#cb237-732" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-733"><a href="#cb237-733" aria-hidden="true" tabindex="-1"></a>ACG</span>
<span id="cb237-734"><a href="#cb237-734" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb237-735"><a href="#cb237-735" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-736"><a href="#cb237-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-737"><a href="#cb237-737" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-738"><a href="#cb237-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-739"><a href="#cb237-739" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-740"><a href="#cb237-740" aria-hidden="true" tabindex="-1"></a>CCG</span>
<span id="cb237-741"><a href="#cb237-741" aria-hidden="true" tabindex="-1"></a>TCG</span>
<span id="cb237-742"><a href="#cb237-742" aria-hidden="true" tabindex="-1"></a>GCG</span>
<span id="cb237-743"><a href="#cb237-743" aria-hidden="true" tabindex="-1"></a>AAG</span>
<span id="cb237-744"><a href="#cb237-744" aria-hidden="true" tabindex="-1"></a>ATG</span>
<span id="cb237-745"><a href="#cb237-745" aria-hidden="true" tabindex="-1"></a>AGG</span>
<span id="cb237-746"><a href="#cb237-746" aria-hidden="true" tabindex="-1"></a>ACA</span>
<span id="cb237-747"><a href="#cb237-747" aria-hidden="true" tabindex="-1"></a>ACC</span>
<span id="cb237-748"><a href="#cb237-748" aria-hidden="true" tabindex="-1"></a>ACT</span>
<span id="cb237-749"><a href="#cb237-749" aria-hidden="true" tabindex="-1"></a>ACG</span>
<span id="cb237-750"><a href="#cb237-750" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-751"><a href="#cb237-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-752"><a href="#cb237-752" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-753"><a href="#cb237-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-754"><a href="#cb237-754" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-755"><a href="#cb237-755" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Set, List, Tuple, Iterator</span>
<span id="cb237-756"><a href="#cb237-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-757"><a href="#cb237-757" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-758"><a href="#cb237-758" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb237-759"><a href="#cb237-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-760"><a href="#cb237-760" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_immediate_neighbors(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-761"><a href="#cb237-761" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb237-762"><a href="#cb237-762" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, current_base <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb237-763"><a href="#cb237-763" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> new_base <span class="kw">in</span> nucleotides:</span>
<span id="cb237-764"><a href="#cb237-764" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> new_base <span class="op">!=</span> current_base:</span>
<span id="cb237-765"><a href="#cb237-765" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> sequence[:i] <span class="op">+</span> new_base <span class="op">+</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:]</span>
<span id="cb237-766"><a href="#cb237-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-767"><a href="#cb237-767" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb237-768"><a href="#cb237-768" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb237-769"><a href="#cb237-769" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb237-770"><a href="#cb237-770" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb237-771"><a href="#cb237-771" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb237-772"><a href="#cb237-772" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb237-773"><a href="#cb237-773" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-774"><a href="#cb237-774" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb237-775"><a href="#cb237-775" aria-hidden="true" tabindex="-1"></a>    suffix_neighbors <span class="op">=</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance)</span>
<span id="cb237-776"><a href="#cb237-776" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> suffix <span class="kw">in</span> suffix_neighbors:</span>
<span id="cb237-777"><a href="#cb237-777" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], suffix) <span class="op">&lt;</span> max_distance:</span>
<span id="cb237-778"><a href="#cb237-778" aria-hidden="true" tabindex="-1"></a>            neighbors.update(base <span class="op">+</span> suffix <span class="cf">for</span> base <span class="kw">in</span> nucleotides)</span>
<span id="cb237-779"><a href="#cb237-779" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-780"><a href="#cb237-780" aria-hidden="true" tabindex="-1"></a>            neighbors.add(sequence[<span class="dv">0</span>] <span class="op">+</span> suffix)</span>
<span id="cb237-781"><a href="#cb237-781" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbors</span>
<span id="cb237-782"><a href="#cb237-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-783"><a href="#cb237-783" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb237-784"><a href="#cb237-784" aria-hidden="true" tabindex="-1"></a>    sequence, distance <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-785"><a href="#cb237-785" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(distance)</span>
<span id="cb237-786"><a href="#cb237-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-787"><a href="#cb237-787" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-788"><a href="#cb237-788" aria-hidden="true" tabindex="-1"></a><span class="st">ACG</span></span>
<span id="cb237-789"><a href="#cb237-789" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb237-790"><a href="#cb237-790" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-791"><a href="#cb237-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-792"><a href="#cb237-792" aria-hidden="true" tabindex="-1"></a>sequence, max_distance <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb237-793"><a href="#cb237-793" aria-hidden="true" tabindex="-1"></a>neighbor_sequences <span class="op">=</span> generate_neighbors(sequence, max_distance)</span>
<span id="cb237-794"><a href="#cb237-794" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(neighbor_sequences), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-795"><a href="#cb237-795" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-796"><a href="#cb237-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-797"><a href="#cb237-797" aria-hidden="true" tabindex="-1"></a><span class="op">----</span></span>
<span id="cb237-798"><a href="#cb237-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-799"><a href="#cb237-799" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Probability of a Hidden Path</span></span>
<span id="cb237-800"><a href="#cb237-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-801"><a href="#cb237-801" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A hidden path $π$ followed by the states&nbsp;<span class="op">*</span>States<span class="op">*</span>&nbsp;and transition matrix&nbsp;<span class="op">*</span>Transition<span class="op">*</span>&nbsp;of an HMM ($Σ$,&nbsp;<span class="op">*</span>States<span class="op">*</span>,&nbsp;<span class="op">*</span>Transition<span class="op">*</span>,&nbsp;<span class="op">*</span>Emission<span class="op">*</span>).</span>
<span id="cb237-802"><a href="#cb237-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-803"><a href="#cb237-803" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The probability of this path, $Pr(π)$. You may assume that initial probabilities are equal.</span>
<span id="cb237-804"><a href="#cb237-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-805"><a href="#cb237-805" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-806"><a href="#cb237-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-807"><a href="#cb237-807" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-808"><a href="#cb237-808" aria-hidden="true" tabindex="-1"></a>AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB</span>
<span id="cb237-809"><a href="#cb237-809" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-810"><a href="#cb237-810" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb237-811"><a href="#cb237-811" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-812"><a href="#cb237-812" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb237-813"><a href="#cb237-813" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.194</span>   <span class="fl">0.806</span></span>
<span id="cb237-814"><a href="#cb237-814" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.273</span>   <span class="fl">0.727</span></span>
<span id="cb237-815"><a href="#cb237-815" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-816"><a href="#cb237-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-817"><a href="#cb237-817" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-818"><a href="#cb237-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-819"><a href="#cb237-819" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-820"><a href="#cb237-820" aria-hidden="true" tabindex="-1"></a><span class="fl">5.01732865318e-19</span></span>
<span id="cb237-821"><a href="#cb237-821" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-822"><a href="#cb237-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-823"><a href="#cb237-823" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-824"><a href="#cb237-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-825"><a href="#cb237-825" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-826"><a href="#cb237-826" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb237-827"><a href="#cb237-827" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb237-828"><a href="#cb237-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-829"><a href="#cb237-829" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hidden_path_data(input_lines):</span>
<span id="cb237-830"><a href="#cb237-830" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb237-831"><a href="#cb237-831" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb237-832"><a href="#cb237-832" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb237-833"><a href="#cb237-833" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb237-834"><a href="#cb237-834" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb237-835"><a href="#cb237-835" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-836"><a href="#cb237-836" aria-hidden="true" tabindex="-1"></a>    transition_probabilities <span class="op">=</span> {}</span>
<span id="cb237-837"><a href="#cb237-837" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb237-838"><a href="#cb237-838" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb237-839"><a href="#cb237-839" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb237-840"><a href="#cb237-840" aria-hidden="true" tabindex="-1"></a>            current_state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb237-841"><a href="#cb237-841" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> next_state, probability <span class="kw">in</span> <span class="bu">zip</span>(states, row_data[<span class="dv">1</span>:]):</span>
<span id="cb237-842"><a href="#cb237-842" aria-hidden="true" tabindex="-1"></a>                transition_probabilities[(current_state, next_state)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb237-843"><a href="#cb237-843" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-844"><a href="#cb237-844" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hidden_path, transition_probabilities</span>
<span id="cb237-845"><a href="#cb237-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-846"><a href="#cb237-846" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hidden_path_probability(hidden_path, transition_probabilities):</span>
<span id="cb237-847"><a href="#cb237-847" aria-hidden="true" tabindex="-1"></a>    initial_probability <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb237-848"><a href="#cb237-848" aria-hidden="true" tabindex="-1"></a>    path_probability <span class="op">=</span> initial_probability <span class="op">*</span> prod(</span>
<span id="cb237-849"><a href="#cb237-849" aria-hidden="true" tabindex="-1"></a>        transition_probabilities[state_pair] </span>
<span id="cb237-850"><a href="#cb237-850" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> state_pair <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, hidden_path[<span class="dv">1</span>:])</span>
<span id="cb237-851"><a href="#cb237-851" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb237-852"><a href="#cb237-852" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path_probability</span>
<span id="cb237-853"><a href="#cb237-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-854"><a href="#cb237-854" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-855"><a href="#cb237-855" aria-hidden="true" tabindex="-1"></a><span class="st">AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB</span></span>
<span id="cb237-856"><a href="#cb237-856" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-857"><a href="#cb237-857" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb237-858"><a href="#cb237-858" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-859"><a href="#cb237-859" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb237-860"><a href="#cb237-860" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.194   0.806</span></span>
<span id="cb237-861"><a href="#cb237-861" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.273   0.727</span></span>
<span id="cb237-862"><a href="#cb237-862" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-863"><a href="#cb237-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-864"><a href="#cb237-864" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb237-865"><a href="#cb237-865" aria-hidden="true" tabindex="-1"></a>hidden_path, transition_probabilities <span class="op">=</span> parse_hidden_path_data(input_lines)</span>
<span id="cb237-866"><a href="#cb237-866" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_hidden_path_probability(hidden_path, transition_probabilities)</span>
<span id="cb237-867"><a href="#cb237-867" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span>
<span id="cb237-868"><a href="#cb237-868" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-869"><a href="#cb237-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-870"><a href="#cb237-870" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Probability of an Outcome Given a Hidden Path</span></span>
<span id="cb237-871"><a href="#cb237-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-872"><a href="#cb237-872" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>x<span class="op">*</span>, followed by the alphabet&nbsp;<span class="op">*</span>Σ<span class="op">*</span>&nbsp;from which&nbsp;<span class="op">*</span>x<span class="op">*</span>&nbsp;was constructed, followed by a hidden path&nbsp;<span class="op">*</span>π<span class="op">*</span>, followed by the states&nbsp;<span class="op">*</span>States<span class="op">*</span>&nbsp;and emission matrix&nbsp;<span class="op">*</span>Emission<span class="op">*</span>&nbsp;of an HMM (<span class="op">*</span>Σ<span class="op">*</span>,&nbsp;<span class="op">*</span>States<span class="op">*</span>,&nbsp;<span class="op">*</span>Transition<span class="op">*</span>,&nbsp;<span class="op">*</span>Emission<span class="op">*</span>).</span>
<span id="cb237-873"><a href="#cb237-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-874"><a href="#cb237-874" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The conditional probability $Pr(x<span class="op">|</span>π)$ that string&nbsp;<span class="op">*</span>x<span class="op">*</span>&nbsp;will be emitted by the HMM given the hidden path&nbsp;<span class="op">*</span>π<span class="op">*</span>.</span>
<span id="cb237-875"><a href="#cb237-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-876"><a href="#cb237-876" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-877"><a href="#cb237-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-878"><a href="#cb237-878" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-879"><a href="#cb237-879" aria-hidden="true" tabindex="-1"></a>xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx</span>
<span id="cb237-880"><a href="#cb237-880" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-881"><a href="#cb237-881" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb237-882"><a href="#cb237-882" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-883"><a href="#cb237-883" aria-hidden="true" tabindex="-1"></a>BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB</span>
<span id="cb237-884"><a href="#cb237-884" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-885"><a href="#cb237-885" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb237-886"><a href="#cb237-886" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-887"><a href="#cb237-887" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb237-888"><a href="#cb237-888" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.612</span>   <span class="fl">0.314</span>   <span class="fl">0.074</span> </span>
<span id="cb237-889"><a href="#cb237-889" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.346</span>   <span class="fl">0.317</span>   <span class="fl">0.336</span></span>
<span id="cb237-890"><a href="#cb237-890" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-891"><a href="#cb237-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-892"><a href="#cb237-892" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-893"><a href="#cb237-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-894"><a href="#cb237-894" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-895"><a href="#cb237-895" aria-hidden="true" tabindex="-1"></a><span class="fl">1.93157070893e-28</span></span>
<span id="cb237-896"><a href="#cb237-896" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-897"><a href="#cb237-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-898"><a href="#cb237-898" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-899"><a href="#cb237-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-900"><a href="#cb237-900" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-901"><a href="#cb237-901" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb237-902"><a href="#cb237-902" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb237-903"><a href="#cb237-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-904"><a href="#cb237-904" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_emission_data(input_lines):</span>
<span id="cb237-905"><a href="#cb237-905" aria-hidden="true" tabindex="-1"></a>    emission_sequence <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb237-906"><a href="#cb237-906" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb237-907"><a href="#cb237-907" aria-hidden="true" tabindex="-1"></a>    symbols <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb237-908"><a href="#cb237-908" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb237-909"><a href="#cb237-909" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb237-910"><a href="#cb237-910" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb237-911"><a href="#cb237-911" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb237-912"><a href="#cb237-912" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb237-913"><a href="#cb237-913" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb237-914"><a href="#cb237-914" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-915"><a href="#cb237-915" aria-hidden="true" tabindex="-1"></a>    emission_probabilities <span class="op">=</span> {}</span>
<span id="cb237-916"><a href="#cb237-916" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb237-917"><a href="#cb237-917" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb237-918"><a href="#cb237-918" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb237-919"><a href="#cb237-919" aria-hidden="true" tabindex="-1"></a>            state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb237-920"><a href="#cb237-920" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> symbol, probability <span class="kw">in</span> <span class="bu">zip</span>(symbols, row_data[<span class="dv">1</span>:]):</span>
<span id="cb237-921"><a href="#cb237-921" aria-hidden="true" tabindex="-1"></a>                emission_probabilities[(state, symbol)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb237-922"><a href="#cb237-922" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-923"><a href="#cb237-923" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emission_sequence, hidden_path, emission_probabilities</span>
<span id="cb237-924"><a href="#cb237-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-925"><a href="#cb237-925" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities):</span>
<span id="cb237-926"><a href="#cb237-926" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prod(emission_probabilities[state_symbol] <span class="cf">for</span> state_symbol <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, emission_sequence))</span>
<span id="cb237-927"><a href="#cb237-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-928"><a href="#cb237-928" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-929"><a href="#cb237-929" aria-hidden="true" tabindex="-1"></a><span class="st">xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx</span></span>
<span id="cb237-930"><a href="#cb237-930" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-931"><a href="#cb237-931" aria-hidden="true" tabindex="-1"></a><span class="st">x y z</span></span>
<span id="cb237-932"><a href="#cb237-932" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-933"><a href="#cb237-933" aria-hidden="true" tabindex="-1"></a><span class="st">BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB</span></span>
<span id="cb237-934"><a href="#cb237-934" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-935"><a href="#cb237-935" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb237-936"><a href="#cb237-936" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-937"><a href="#cb237-937" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb237-938"><a href="#cb237-938" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.612   0.314   0.074 </span></span>
<span id="cb237-939"><a href="#cb237-939" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.346   0.317   0.336</span></span>
<span id="cb237-940"><a href="#cb237-940" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-941"><a href="#cb237-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-942"><a href="#cb237-942" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb237-943"><a href="#cb237-943" aria-hidden="true" tabindex="-1"></a>emission_sequence, hidden_path, emission_probabilities <span class="op">=</span> parse_emission_data(input_lines)</span>
<span id="cb237-944"><a href="#cb237-944" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities)</span>
<span id="cb237-945"><a href="#cb237-945" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span>
<span id="cb237-946"><a href="#cb237-946" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-947"><a href="#cb237-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-948"><a href="#cb237-948" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement the Viterbi Algorithm</span></span>
<span id="cb237-949"><a href="#cb237-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-950"><a href="#cb237-950" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>x<span class="op">*</span>, followed by the alphabet&nbsp;<span class="op">*</span>Σ<span class="op">*</span>&nbsp;from which&nbsp;<span class="op">*</span>x<span class="op">*</span>&nbsp;was constructed, followed by the states&nbsp;<span class="op">*</span>States<span class="op">*</span>, transition matrix&nbsp;<span class="op">*</span>Transition<span class="op">*</span>, <span class="kw">and</span> emission matrix&nbsp;<span class="op">*</span>Emission<span class="op">*</span>&nbsp;of an HMM (<span class="op">*</span>Σ<span class="op">*</span>,&nbsp;<span class="op">*</span>States<span class="op">*</span>,&nbsp;<span class="op">*</span>Transition<span class="op">*</span>,&nbsp;<span class="op">*</span>Emission<span class="op">*</span>).</span>
<span id="cb237-951"><a href="#cb237-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-952"><a href="#cb237-952" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A path that maximizes the (unconditional) probability Pr(<span class="op">*</span>x<span class="op">*</span>,&nbsp;<span class="op">*</span>π<span class="op">*</span>) over <span class="bu">all</span> possible paths&nbsp;<span class="op">*</span>π<span class="op">*</span>.</span>
<span id="cb237-953"><a href="#cb237-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-954"><a href="#cb237-954" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-955"><a href="#cb237-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-956"><a href="#cb237-956" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-957"><a href="#cb237-957" aria-hidden="true" tabindex="-1"></a>xyxzzxyxyy</span>
<span id="cb237-958"><a href="#cb237-958" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-959"><a href="#cb237-959" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb237-960"><a href="#cb237-960" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-961"><a href="#cb237-961" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb237-962"><a href="#cb237-962" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-963"><a href="#cb237-963" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb237-964"><a href="#cb237-964" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.641</span>   <span class="fl">0.359</span></span>
<span id="cb237-965"><a href="#cb237-965" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.729</span>   <span class="fl">0.271</span></span>
<span id="cb237-966"><a href="#cb237-966" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-967"><a href="#cb237-967" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb237-968"><a href="#cb237-968" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.117</span>   <span class="fl">0.691</span>   <span class="fl">0.192</span>   </span>
<span id="cb237-969"><a href="#cb237-969" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.097</span>   <span class="fl">0.42</span>    <span class="fl">0.483</span></span>
<span id="cb237-970"><a href="#cb237-970" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-971"><a href="#cb237-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-972"><a href="#cb237-972" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-973"><a href="#cb237-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-974"><a href="#cb237-974" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-975"><a href="#cb237-975" aria-hidden="true" tabindex="-1"></a>AAABBAAAAA</span>
<span id="cb237-976"><a href="#cb237-976" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-977"><a href="#cb237-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-978"><a href="#cb237-978" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-979"><a href="#cb237-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-980"><a href="#cb237-980" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-981"><a href="#cb237-981" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb237-982"><a href="#cb237-982" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb237-983"><a href="#cb237-983" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb237-984"><a href="#cb237-984" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb237-985"><a href="#cb237-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-986"><a href="#cb237-986" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb237-987"><a href="#cb237-987" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb237-988"><a href="#cb237-988" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb237-989"><a href="#cb237-989" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb237-990"><a href="#cb237-990" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb237-991"><a href="#cb237-991" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb237-992"><a href="#cb237-992" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb237-993"><a href="#cb237-993" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-994"><a href="#cb237-994" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-995"><a href="#cb237-995" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb237-996"><a href="#cb237-996" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb237-997"><a href="#cb237-997" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb237-998"><a href="#cb237-998" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb237-999"><a href="#cb237-999" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb237-1000"><a href="#cb237-1000" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-1001"><a href="#cb237-1001" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb237-1002"><a href="#cb237-1002" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-1003"><a href="#cb237-1003" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb237-1004"><a href="#cb237-1004" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb237-1005"><a href="#cb237-1005" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb237-1006"><a href="#cb237-1006" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb237-1007"><a href="#cb237-1007" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb237-1008"><a href="#cb237-1008" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-1009"><a href="#cb237-1009" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb237-1010"><a href="#cb237-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1011"><a href="#cb237-1011" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-1012"><a href="#cb237-1012" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> <span class="bu">len</span>(states)</span>
<span id="cb237-1013"><a href="#cb237-1013" aria-hidden="true" tabindex="-1"></a>    sequence_length <span class="op">=</span> <span class="bu">len</span>(sequence)</span>
<span id="cb237-1014"><a href="#cb237-1014" aria-hidden="true" tabindex="-1"></a>    viterbi_matrix <span class="op">=</span> np.zeros((sequence_length, num_states))</span>
<span id="cb237-1015"><a href="#cb237-1015" aria-hidden="true" tabindex="-1"></a>    backpointer <span class="op">=</span> np.zeros((sequence_length, num_states), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb237-1016"><a href="#cb237-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1017"><a href="#cb237-1017" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the first column of the viterbi matrix</span></span>
<span id="cb237-1018"><a href="#cb237-1018" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-1019"><a href="#cb237-1019" aria-hidden="true" tabindex="-1"></a>        viterbi_matrix[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> num_states)</span>
<span id="cb237-1020"><a href="#cb237-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1021"><a href="#cb237-1021" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill in the rest of the viterbi matrix</span></span>
<span id="cb237-1022"><a href="#cb237-1022" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, sequence_length):</span>
<span id="cb237-1023"><a href="#cb237-1023" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-1024"><a href="#cb237-1024" aria-hidden="true" tabindex="-1"></a>            probabilities <span class="op">=</span> [</span>
<span id="cb237-1025"><a href="#cb237-1025" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[previous_state, current_state]) <span class="op">+</span> </span>
<span id="cb237-1026"><a href="#cb237-1026" aria-hidden="true" tabindex="-1"></a>                log(emission_matrix[current_state, sequence[t]]) <span class="op">+</span> </span>
<span id="cb237-1027"><a href="#cb237-1027" aria-hidden="true" tabindex="-1"></a>                viterbi_matrix[t<span class="op">-</span><span class="dv">1</span>, k]</span>
<span id="cb237-1028"><a href="#cb237-1028" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb237-1029"><a href="#cb237-1029" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb237-1030"><a href="#cb237-1030" aria-hidden="true" tabindex="-1"></a>            max_prob_index <span class="op">=</span> probabilities.index(<span class="bu">max</span>(probabilities))</span>
<span id="cb237-1031"><a href="#cb237-1031" aria-hidden="true" tabindex="-1"></a>            backpointer[t, j] <span class="op">=</span> max_prob_index</span>
<span id="cb237-1032"><a href="#cb237-1032" aria-hidden="true" tabindex="-1"></a>            viterbi_matrix[t, j] <span class="op">=</span> <span class="bu">max</span>(probabilities)</span>
<span id="cb237-1033"><a href="#cb237-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1034"><a href="#cb237-1034" aria-hidden="true" tabindex="-1"></a>    best_path_index <span class="op">=</span> np.argmax(viterbi_matrix[<span class="op">-</span><span class="dv">1</span>, :])</span>
<span id="cb237-1035"><a href="#cb237-1035" aria-hidden="true" tabindex="-1"></a>    best_path <span class="op">=</span> states[best_path_index]</span>
<span id="cb237-1036"><a href="#cb237-1036" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(sequence_length <span class="op">-</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb237-1037"><a href="#cb237-1037" aria-hidden="true" tabindex="-1"></a>        best_path_index <span class="op">=</span> backpointer[t, best_path_index]</span>
<span id="cb237-1038"><a href="#cb237-1038" aria-hidden="true" tabindex="-1"></a>        best_path <span class="op">=</span> states[best_path_index] <span class="op">+</span> best_path</span>
<span id="cb237-1039"><a href="#cb237-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1040"><a href="#cb237-1040" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_path</span>
<span id="cb237-1041"><a href="#cb237-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1042"><a href="#cb237-1042" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb237-1043"><a href="#cb237-1043" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-1044"><a href="#cb237-1044" aria-hidden="true" tabindex="-1"></a><span class="st">xyxzzxyxyy</span></span>
<span id="cb237-1045"><a href="#cb237-1045" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1046"><a href="#cb237-1046" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb237-1047"><a href="#cb237-1047" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1048"><a href="#cb237-1048" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb237-1049"><a href="#cb237-1049" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1050"><a href="#cb237-1050" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb237-1051"><a href="#cb237-1051" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.641   0.359</span></span>
<span id="cb237-1052"><a href="#cb237-1052" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.729   0.271</span></span>
<span id="cb237-1053"><a href="#cb237-1053" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1054"><a href="#cb237-1054" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb237-1055"><a href="#cb237-1055" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.117   0.691   0.192   </span></span>
<span id="cb237-1056"><a href="#cb237-1056" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.097   0.42    0.483</span></span>
<span id="cb237-1057"><a href="#cb237-1057" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-1058"><a href="#cb237-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1059"><a href="#cb237-1059" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb237-1060"><a href="#cb237-1060" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb237-1061"><a href="#cb237-1061" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb237-1062"><a href="#cb237-1062" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb237-1063"><a href="#cb237-1063" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1064"><a href="#cb237-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1065"><a href="#cb237-1065" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Probability of a String Emitted by an HMM</span></span>
<span id="cb237-1066"><a href="#cb237-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1067"><a href="#cb237-1067" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>x<span class="op">*</span>, followed by the alphabet&nbsp;<span class="op">*</span>Σ<span class="op">*</span>&nbsp;from which&nbsp;<span class="op">*</span>x<span class="op">*</span>&nbsp;was constructed, followed by the states&nbsp;<span class="op">*</span>States<span class="op">*</span>, transition matrix&nbsp;<span class="op">*</span>Transition<span class="op">*</span>, <span class="kw">and</span> emission matrix&nbsp;<span class="op">*</span>Emission<span class="op">*</span>&nbsp;of an HMM (<span class="op">*</span>Σ<span class="op">*</span>,&nbsp;<span class="op">*</span>States<span class="op">*</span>,&nbsp;<span class="op">*</span>Transition<span class="op">*</span>,&nbsp;<span class="op">*</span>Emission<span class="op">*</span>).</span>
<span id="cb237-1068"><a href="#cb237-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1069"><a href="#cb237-1069" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The probability Pr(<span class="op">*</span>x<span class="op">*</span>) that the HMM emits&nbsp;<span class="op">*</span>x<span class="op">*</span>.</span>
<span id="cb237-1070"><a href="#cb237-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1071"><a href="#cb237-1071" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-1072"><a href="#cb237-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1073"><a href="#cb237-1073" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1074"><a href="#cb237-1074" aria-hidden="true" tabindex="-1"></a>xzyyzzyzyy</span>
<span id="cb237-1075"><a href="#cb237-1075" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1076"><a href="#cb237-1076" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb237-1077"><a href="#cb237-1077" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1078"><a href="#cb237-1078" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb237-1079"><a href="#cb237-1079" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1080"><a href="#cb237-1080" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb237-1081"><a href="#cb237-1081" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.303</span>   <span class="fl">0.697</span> </span>
<span id="cb237-1082"><a href="#cb237-1082" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.831</span>   <span class="fl">0.169</span> </span>
<span id="cb237-1083"><a href="#cb237-1083" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1084"><a href="#cb237-1084" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb237-1085"><a href="#cb237-1085" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.533</span>   <span class="fl">0.065</span>   <span class="fl">0.402</span> </span>
<span id="cb237-1086"><a href="#cb237-1086" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.342</span>   <span class="fl">0.334</span>   <span class="fl">0.324</span></span>
<span id="cb237-1087"><a href="#cb237-1087" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1088"><a href="#cb237-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1089"><a href="#cb237-1089" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-1090"><a href="#cb237-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1091"><a href="#cb237-1091" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1092"><a href="#cb237-1092" aria-hidden="true" tabindex="-1"></a><span class="fl">1.1005510319694847e-06</span></span>
<span id="cb237-1093"><a href="#cb237-1093" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1094"><a href="#cb237-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1095"><a href="#cb237-1095" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-1096"><a href="#cb237-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1097"><a href="#cb237-1097" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-1098"><a href="#cb237-1098" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb237-1099"><a href="#cb237-1099" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb237-1100"><a href="#cb237-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1101"><a href="#cb237-1101" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator):</span>
<span id="cb237-1102"><a href="#cb237-1102" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb237-1103"><a href="#cb237-1103" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb237-1104"><a href="#cb237-1104" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb237-1105"><a href="#cb237-1105" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb237-1106"><a href="#cb237-1106" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb237-1107"><a href="#cb237-1107" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb237-1108"><a href="#cb237-1108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-1109"><a href="#cb237-1109" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-1110"><a href="#cb237-1110" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb237-1111"><a href="#cb237-1111" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb237-1112"><a href="#cb237-1112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb237-1113"><a href="#cb237-1113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb237-1114"><a href="#cb237-1114" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb237-1115"><a href="#cb237-1115" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-1116"><a href="#cb237-1116" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb237-1117"><a href="#cb237-1117" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-1118"><a href="#cb237-1118" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb237-1119"><a href="#cb237-1119" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb237-1120"><a href="#cb237-1120" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb237-1121"><a href="#cb237-1121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb237-1122"><a href="#cb237-1122" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb237-1123"><a href="#cb237-1123" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-1124"><a href="#cb237-1124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb237-1125"><a href="#cb237-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1126"><a href="#cb237-1126" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix):</span>
<span id="cb237-1127"><a href="#cb237-1127" aria-hidden="true" tabindex="-1"></a>    probability_matrix <span class="op">=</span> np.ones((<span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(states)))</span>
<span id="cb237-1128"><a href="#cb237-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1129"><a href="#cb237-1129" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-1130"><a href="#cb237-1130" aria-hidden="true" tabindex="-1"></a>        probability_matrix[<span class="dv">0</span>, i] <span class="op">=</span> emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states)</span>
<span id="cb237-1131"><a href="#cb237-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1132"><a href="#cb237-1132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb237-1133"><a href="#cb237-1133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-1134"><a href="#cb237-1134" aria-hidden="true" tabindex="-1"></a>            probability_matrix[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb237-1135"><a href="#cb237-1135" aria-hidden="true" tabindex="-1"></a>                transition_matrix[previous_state, current_state] <span class="op">*</span> </span>
<span id="cb237-1136"><a href="#cb237-1136" aria-hidden="true" tabindex="-1"></a>                emission_matrix[current_state, emission] <span class="op">*</span> </span>
<span id="cb237-1137"><a href="#cb237-1137" aria-hidden="true" tabindex="-1"></a>                probability_matrix[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb237-1138"><a href="#cb237-1138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb237-1139"><a href="#cb237-1139" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb237-1140"><a href="#cb237-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1141"><a href="#cb237-1141" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(probability_matrix[i, :])</span>
<span id="cb237-1142"><a href="#cb237-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1143"><a href="#cb237-1143" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-1144"><a href="#cb237-1144" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzzyzyy</span></span>
<span id="cb237-1145"><a href="#cb237-1145" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1146"><a href="#cb237-1146" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb237-1147"><a href="#cb237-1147" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1148"><a href="#cb237-1148" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb237-1149"><a href="#cb237-1149" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1150"><a href="#cb237-1150" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb237-1151"><a href="#cb237-1151" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.303   0.697 </span></span>
<span id="cb237-1152"><a href="#cb237-1152" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.831   0.169 </span></span>
<span id="cb237-1153"><a href="#cb237-1153" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1154"><a href="#cb237-1154" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb237-1155"><a href="#cb237-1155" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.533   0.065   0.402 </span></span>
<span id="cb237-1156"><a href="#cb237-1156" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.342   0.334   0.324</span></span>
<span id="cb237-1157"><a href="#cb237-1157" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-1158"><a href="#cb237-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1159"><a href="#cb237-1159" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb237-1160"><a href="#cb237-1160" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb237-1161"><a href="#cb237-1161" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb237-1162"><a href="#cb237-1162" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb237-1163"><a href="#cb237-1163" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1164"><a href="#cb237-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1165"><a href="#cb237-1165" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct a Profile HMM</span></span>
<span id="cb237-1166"><a href="#cb237-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1167"><a href="#cb237-1167" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A threshold&nbsp;<span class="op">*</span>θ<span class="op">*</span>, followed by an alphabet&nbsp;<span class="op">*</span>Σ<span class="op">*</span>, followed by a multiple alignment&nbsp;<span class="op">*</span>Alignment<span class="op">*</span>&nbsp;whose strings are formed from&nbsp;<span class="op">*</span>Σ<span class="op">*</span>.</span>
<span id="cb237-1168"><a href="#cb237-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1169"><a href="#cb237-1169" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The transition <span class="kw">and</span> emission probabilities of the profile HMM&nbsp;<span class="op">*</span>HMM<span class="op">*</span>(<span class="op">*</span>Alignment<span class="op">*</span>,&nbsp;<span class="op">*</span>θ<span class="op">*</span>).</span>
<span id="cb237-1170"><a href="#cb237-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1171"><a href="#cb237-1171" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-1172"><a href="#cb237-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1173"><a href="#cb237-1173" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1174"><a href="#cb237-1174" aria-hidden="true" tabindex="-1"></a><span class="fl">0.289</span></span>
<span id="cb237-1175"><a href="#cb237-1175" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1176"><a href="#cb237-1176" aria-hidden="true" tabindex="-1"></a>A   B   C   D   E</span>
<span id="cb237-1177"><a href="#cb237-1177" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1178"><a href="#cb237-1178" aria-hidden="true" tabindex="-1"></a>EBA</span>
<span id="cb237-1179"><a href="#cb237-1179" aria-hidden="true" tabindex="-1"></a>EBD</span>
<span id="cb237-1180"><a href="#cb237-1180" aria-hidden="true" tabindex="-1"></a>EB<span class="op">-</span></span>
<span id="cb237-1181"><a href="#cb237-1181" aria-hidden="true" tabindex="-1"></a>EED</span>
<span id="cb237-1182"><a href="#cb237-1182" aria-hidden="true" tabindex="-1"></a>EBD</span>
<span id="cb237-1183"><a href="#cb237-1183" aria-hidden="true" tabindex="-1"></a>EBE</span>
<span id="cb237-1184"><a href="#cb237-1184" aria-hidden="true" tabindex="-1"></a>E<span class="op">-</span>D</span>
<span id="cb237-1185"><a href="#cb237-1185" aria-hidden="true" tabindex="-1"></a>EBD</span>
<span id="cb237-1186"><a href="#cb237-1186" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1187"><a href="#cb237-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1188"><a href="#cb237-1188" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-1189"><a href="#cb237-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1190"><a href="#cb237-1190" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1191"><a href="#cb237-1191" aria-hidden="true" tabindex="-1"></a>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E</span>
<span id="cb237-1192"><a href="#cb237-1192" aria-hidden="true" tabindex="-1"></a>S   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span> <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1193"><a href="#cb237-1193" aria-hidden="true" tabindex="-1"></a>I0  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1194"><a href="#cb237-1194" aria-hidden="true" tabindex="-1"></a>M1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.875</span>   <span class="fl">0.125</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1195"><a href="#cb237-1195" aria-hidden="true" tabindex="-1"></a>D1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1196"><a href="#cb237-1196" aria-hidden="true" tabindex="-1"></a>I1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1197"><a href="#cb237-1197" aria-hidden="true" tabindex="-1"></a>M2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.857</span>   <span class="fl">0.143</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1198"><a href="#cb237-1198" aria-hidden="true" tabindex="-1"></a>D2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span> <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1199"><a href="#cb237-1199" aria-hidden="true" tabindex="-1"></a>I2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1200"><a href="#cb237-1200" aria-hidden="true" tabindex="-1"></a>M3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span></span>
<span id="cb237-1201"><a href="#cb237-1201" aria-hidden="true" tabindex="-1"></a>D3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span></span>
<span id="cb237-1202"><a href="#cb237-1202" aria-hidden="true" tabindex="-1"></a>I3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1203"><a href="#cb237-1203" aria-hidden="true" tabindex="-1"></a>E   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1204"><a href="#cb237-1204" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1205"><a href="#cb237-1205" aria-hidden="true" tabindex="-1"></a>    A   B   C   D   E</span>
<span id="cb237-1206"><a href="#cb237-1206" aria-hidden="true" tabindex="-1"></a>S   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1207"><a href="#cb237-1207" aria-hidden="true" tabindex="-1"></a>I0  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1208"><a href="#cb237-1208" aria-hidden="true" tabindex="-1"></a>M1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span></span>
<span id="cb237-1209"><a href="#cb237-1209" aria-hidden="true" tabindex="-1"></a>D1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1210"><a href="#cb237-1210" aria-hidden="true" tabindex="-1"></a>I1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1211"><a href="#cb237-1211" aria-hidden="true" tabindex="-1"></a>M2  <span class="dv">0</span>   <span class="fl">0.857</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.143</span></span>
<span id="cb237-1212"><a href="#cb237-1212" aria-hidden="true" tabindex="-1"></a>D2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1213"><a href="#cb237-1213" aria-hidden="true" tabindex="-1"></a>I2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1214"><a href="#cb237-1214" aria-hidden="true" tabindex="-1"></a>M3  <span class="fl">0.143</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.714</span>   <span class="fl">0.143</span></span>
<span id="cb237-1215"><a href="#cb237-1215" aria-hidden="true" tabindex="-1"></a>D3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1216"><a href="#cb237-1216" aria-hidden="true" tabindex="-1"></a>I3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1217"><a href="#cb237-1217" aria-hidden="true" tabindex="-1"></a>E   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1218"><a href="#cb237-1218" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1219"><a href="#cb237-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1220"><a href="#cb237-1220" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-1221"><a href="#cb237-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1222"><a href="#cb237-1222" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-1223"><a href="#cb237-1223" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb237-1224"><a href="#cb237-1224" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb237-1225"><a href="#cb237-1225" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator</span>
<span id="cb237-1226"><a href="#cb237-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1227"><a href="#cb237-1227" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb237-1228"><a href="#cb237-1228" aria-hidden="true" tabindex="-1"></a>    threshold <span class="op">=</span> <span class="bu">float</span>(<span class="bu">next</span>(input_iterator).rstrip())</span>
<span id="cb237-1229"><a href="#cb237-1229" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb237-1230"><a href="#cb237-1230" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb237-1231"><a href="#cb237-1231" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb237-1232"><a href="#cb237-1232" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_iterator])</span>
<span id="cb237-1233"><a href="#cb237-1233" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, alphabet, alignment</span>
<span id="cb237-1234"><a href="#cb237-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1235"><a href="#cb237-1235" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-1236"><a href="#cb237-1236" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb237-1237"><a href="#cb237-1237" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb237-1238"><a href="#cb237-1238" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb237-1239"><a href="#cb237-1239" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb237-1240"><a href="#cb237-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1241"><a href="#cb237-1241" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1242"><a href="#cb237-1242" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb237-1243"><a href="#cb237-1243" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb237-1244"><a href="#cb237-1244" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb237-1245"><a href="#cb237-1245" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb237-1246"><a href="#cb237-1246" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb237-1247"><a href="#cb237-1247" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb237-1248"><a href="#cb237-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1249"><a href="#cb237-1249" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1250"><a href="#cb237-1250" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb237-1251"><a href="#cb237-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1252"><a href="#cb237-1252" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-1253"><a href="#cb237-1253" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb237-1254"><a href="#cb237-1254" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb237-1255"><a href="#cb237-1255" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb237-1256"><a href="#cb237-1256" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb237-1257"><a href="#cb237-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1258"><a href="#cb237-1258" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probabilities(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-1259"><a href="#cb237-1259" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb237-1260"><a href="#cb237-1260" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb237-1261"><a href="#cb237-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1262"><a href="#cb237-1262" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probabilities(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-1263"><a href="#cb237-1263" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb237-1264"><a href="#cb237-1264" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb237-1265"><a href="#cb237-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1266"><a href="#cb237-1266" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-1267"><a href="#cb237-1267" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb237-1268"><a href="#cb237-1268" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-1269"><a href="#cb237-1269" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb237-1270"><a href="#cb237-1270" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb237-1271"><a href="#cb237-1271" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb237-1272"><a href="#cb237-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1273"><a href="#cb237-1273" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1274"><a href="#cb237-1274" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-1275"><a href="#cb237-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1276"><a href="#cb237-1276" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1277"><a href="#cb237-1277" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-1278"><a href="#cb237-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1279"><a href="#cb237-1279" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb237-1280"><a href="#cb237-1280" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb237-1281"><a href="#cb237-1281" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb237-1282"><a href="#cb237-1282" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb237-1283"><a href="#cb237-1283" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb237-1284"><a href="#cb237-1284" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb237-1285"><a href="#cb237-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1286"><a href="#cb237-1286" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb237-1287"><a href="#cb237-1287" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-1288"><a href="#cb237-1288" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb237-1289"><a href="#cb237-1289" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb237-1290"><a href="#cb237-1290" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb237-1291"><a href="#cb237-1291" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1292"><a href="#cb237-1292" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb237-1293"><a href="#cb237-1293" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb237-1294"><a href="#cb237-1294" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb237-1295"><a href="#cb237-1295" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb237-1296"><a href="#cb237-1296" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1297"><a href="#cb237-1297" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb237-1298"><a href="#cb237-1298" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb237-1299"><a href="#cb237-1299" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb237-1300"><a href="#cb237-1300" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb237-1301"><a href="#cb237-1301" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1302"><a href="#cb237-1302" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb237-1303"><a href="#cb237-1303" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb237-1304"><a href="#cb237-1304" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1305"><a href="#cb237-1305" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1306"><a href="#cb237-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1307"><a href="#cb237-1307" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb237-1308"><a href="#cb237-1308" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb237-1309"><a href="#cb237-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1310"><a href="#cb237-1310" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb237-1311"><a href="#cb237-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1312"><a href="#cb237-1312" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-1313"><a href="#cb237-1313" aria-hidden="true" tabindex="-1"></a><span class="st">0.289</span></span>
<span id="cb237-1314"><a href="#cb237-1314" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1315"><a href="#cb237-1315" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb237-1316"><a href="#cb237-1316" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1317"><a href="#cb237-1317" aria-hidden="true" tabindex="-1"></a><span class="st">EBA</span></span>
<span id="cb237-1318"><a href="#cb237-1318" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb237-1319"><a href="#cb237-1319" aria-hidden="true" tabindex="-1"></a><span class="st">EB-</span></span>
<span id="cb237-1320"><a href="#cb237-1320" aria-hidden="true" tabindex="-1"></a><span class="st">EED</span></span>
<span id="cb237-1321"><a href="#cb237-1321" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb237-1322"><a href="#cb237-1322" aria-hidden="true" tabindex="-1"></a><span class="st">EBE</span></span>
<span id="cb237-1323"><a href="#cb237-1323" aria-hidden="true" tabindex="-1"></a><span class="st">E-D</span></span>
<span id="cb237-1324"><a href="#cb237-1324" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb237-1325"><a href="#cb237-1325" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-1326"><a href="#cb237-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1327"><a href="#cb237-1327" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb237-1328"><a href="#cb237-1328" aria-hidden="true" tabindex="-1"></a>threshold, alphabet, alignment <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb237-1329"><a href="#cb237-1329" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb237-1330"><a href="#cb237-1330" aria-hidden="true" tabindex="-1"></a>print_transition_probabilities(transition_probs)</span>
<span id="cb237-1331"><a href="#cb237-1331" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb237-1332"><a href="#cb237-1332" aria-hidden="true" tabindex="-1"></a>print_emission_probabilities(emission_probs, alphabet)</span>
<span id="cb237-1333"><a href="#cb237-1333" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1334"><a href="#cb237-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1335"><a href="#cb237-1335" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct a Profile HMM with Pseudocounts</span></span>
<span id="cb237-1336"><a href="#cb237-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1337"><a href="#cb237-1337" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A threshold&nbsp;<span class="op">*</span>θ<span class="op">*</span>&nbsp;and a pseudocount&nbsp;<span class="op">*</span>σ<span class="op">*</span>, followed by an alphabet&nbsp;<span class="op">*</span>Σ<span class="op">*</span>, followed by a multiple alignment&nbsp;<span class="op">*</span>Alignment<span class="op">*</span>&nbsp;whose strings are formed from&nbsp;<span class="op">*</span>Σ<span class="op">*</span>.</span>
<span id="cb237-1338"><a href="#cb237-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1339"><a href="#cb237-1339" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The transition <span class="kw">and</span> emission probabilities of the profile HMM&nbsp;<span class="op">*</span>HMM<span class="op">*</span>(<span class="op">*</span>Alignment<span class="op">*</span>,&nbsp;<span class="op">*</span>θ<span class="op">*</span>,&nbsp;<span class="op">*</span>σ<span class="op">*</span>).</span>
<span id="cb237-1340"><a href="#cb237-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1341"><a href="#cb237-1341" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-1342"><a href="#cb237-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1343"><a href="#cb237-1343" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1344"><a href="#cb237-1344" aria-hidden="true" tabindex="-1"></a><span class="fl">0.358</span>   <span class="fl">0.01</span></span>
<span id="cb237-1345"><a href="#cb237-1345" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1346"><a href="#cb237-1346" aria-hidden="true" tabindex="-1"></a>A   B   C   D   E</span>
<span id="cb237-1347"><a href="#cb237-1347" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1348"><a href="#cb237-1348" aria-hidden="true" tabindex="-1"></a>ADA</span>
<span id="cb237-1349"><a href="#cb237-1349" aria-hidden="true" tabindex="-1"></a>ADA</span>
<span id="cb237-1350"><a href="#cb237-1350" aria-hidden="true" tabindex="-1"></a>AAA</span>
<span id="cb237-1351"><a href="#cb237-1351" aria-hidden="true" tabindex="-1"></a>ADC</span>
<span id="cb237-1352"><a href="#cb237-1352" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>DA</span>
<span id="cb237-1353"><a href="#cb237-1353" aria-hidden="true" tabindex="-1"></a>D<span class="op">-</span>A</span>
<span id="cb237-1354"><a href="#cb237-1354" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1355"><a href="#cb237-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1356"><a href="#cb237-1356" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-1357"><a href="#cb237-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1358"><a href="#cb237-1358" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1359"><a href="#cb237-1359" aria-hidden="true" tabindex="-1"></a>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E</span>
<span id="cb237-1360"><a href="#cb237-1360" aria-hidden="true" tabindex="-1"></a>S   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.819</span>   <span class="fl">0.172</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1361"><a href="#cb237-1361" aria-hidden="true" tabindex="-1"></a>I0  <span class="dv">0</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1362"><a href="#cb237-1362" aria-hidden="true" tabindex="-1"></a>M1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.786</span>   <span class="fl">0.204</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1363"><a href="#cb237-1363" aria-hidden="true" tabindex="-1"></a>D1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.981</span>   <span class="fl">0.01</span>    <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1364"><a href="#cb237-1364" aria-hidden="true" tabindex="-1"></a>I1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1365"><a href="#cb237-1365" aria-hidden="true" tabindex="-1"></a>M2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.981</span>   <span class="fl">0.01</span>    <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1366"><a href="#cb237-1366" aria-hidden="true" tabindex="-1"></a>D2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.981</span>   <span class="fl">0.01</span>    <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1367"><a href="#cb237-1367" aria-hidden="true" tabindex="-1"></a>I2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1368"><a href="#cb237-1368" aria-hidden="true" tabindex="-1"></a>M3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.99</span></span>
<span id="cb237-1369"><a href="#cb237-1369" aria-hidden="true" tabindex="-1"></a>D3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.5</span> <span class="fl">0.5</span></span>
<span id="cb237-1370"><a href="#cb237-1370" aria-hidden="true" tabindex="-1"></a>I3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.5</span> <span class="fl">0.5</span></span>
<span id="cb237-1371"><a href="#cb237-1371" aria-hidden="true" tabindex="-1"></a>E   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1372"><a href="#cb237-1372" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1373"><a href="#cb237-1373" aria-hidden="true" tabindex="-1"></a>    A   B   C   D   E</span>
<span id="cb237-1374"><a href="#cb237-1374" aria-hidden="true" tabindex="-1"></a>S   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1375"><a href="#cb237-1375" aria-hidden="true" tabindex="-1"></a>I0  <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span></span>
<span id="cb237-1376"><a href="#cb237-1376" aria-hidden="true" tabindex="-1"></a>M1  <span class="fl">0.771</span>   <span class="fl">0.01</span>    <span class="fl">0.01</span>    <span class="fl">0.2</span> <span class="fl">0.01</span></span>
<span id="cb237-1377"><a href="#cb237-1377" aria-hidden="true" tabindex="-1"></a>D1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1378"><a href="#cb237-1378" aria-hidden="true" tabindex="-1"></a>I1  <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span></span>
<span id="cb237-1379"><a href="#cb237-1379" aria-hidden="true" tabindex="-1"></a>M2  <span class="fl">0.2</span> <span class="fl">0.01</span>    <span class="fl">0.01</span>    <span class="fl">0.771</span>   <span class="fl">0.01</span></span>
<span id="cb237-1380"><a href="#cb237-1380" aria-hidden="true" tabindex="-1"></a>D2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1381"><a href="#cb237-1381" aria-hidden="true" tabindex="-1"></a>I2  <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span></span>
<span id="cb237-1382"><a href="#cb237-1382" aria-hidden="true" tabindex="-1"></a>M3  <span class="fl">0.803</span>   <span class="fl">0.01</span>    <span class="fl">0.168</span>   <span class="fl">0.01</span>    <span class="fl">0.01</span></span>
<span id="cb237-1383"><a href="#cb237-1383" aria-hidden="true" tabindex="-1"></a>D3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1384"><a href="#cb237-1384" aria-hidden="true" tabindex="-1"></a>I3  <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span></span>
<span id="cb237-1385"><a href="#cb237-1385" aria-hidden="true" tabindex="-1"></a>E   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb237-1386"><a href="#cb237-1386" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1387"><a href="#cb237-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1388"><a href="#cb237-1388" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-1389"><a href="#cb237-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1390"><a href="#cb237-1390" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-1391"><a href="#cb237-1391" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb237-1392"><a href="#cb237-1392" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb237-1393"><a href="#cb237-1393" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb237-1394"><a href="#cb237-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1395"><a href="#cb237-1395" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1396"><a href="#cb237-1396" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb237-1397"><a href="#cb237-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1398"><a href="#cb237-1398" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1399"><a href="#cb237-1399" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb237-1400"><a href="#cb237-1400" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb237-1401"><a href="#cb237-1401" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb237-1402"><a href="#cb237-1402" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb237-1403"><a href="#cb237-1403" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb237-1404"><a href="#cb237-1404" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb237-1405"><a href="#cb237-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1406"><a href="#cb237-1406" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-1407"><a href="#cb237-1407" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb237-1408"><a href="#cb237-1408" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb237-1409"><a href="#cb237-1409" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb237-1410"><a href="#cb237-1410" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb237-1411"><a href="#cb237-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1412"><a href="#cb237-1412" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probs(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-1413"><a href="#cb237-1413" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb237-1414"><a href="#cb237-1414" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb237-1415"><a href="#cb237-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1416"><a href="#cb237-1416" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probs(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-1417"><a href="#cb237-1417" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb237-1418"><a href="#cb237-1418" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb237-1419"><a href="#cb237-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1420"><a href="#cb237-1420" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-1421"><a href="#cb237-1421" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb237-1422"><a href="#cb237-1422" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-1423"><a href="#cb237-1423" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb237-1424"><a href="#cb237-1424" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb237-1425"><a href="#cb237-1425" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb237-1426"><a href="#cb237-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1427"><a href="#cb237-1427" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1428"><a href="#cb237-1428" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-1429"><a href="#cb237-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1430"><a href="#cb237-1430" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1431"><a href="#cb237-1431" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-1432"><a href="#cb237-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1433"><a href="#cb237-1433" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-1434"><a href="#cb237-1434" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb237-1435"><a href="#cb237-1435" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb237-1436"><a href="#cb237-1436" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb237-1437"><a href="#cb237-1437" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb237-1438"><a href="#cb237-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1439"><a href="#cb237-1439" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb237-1440"><a href="#cb237-1440" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb237-1441"><a href="#cb237-1441" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb237-1442"><a href="#cb237-1442" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb237-1443"><a href="#cb237-1443" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb237-1444"><a href="#cb237-1444" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb237-1445"><a href="#cb237-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1446"><a href="#cb237-1446" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb237-1447"><a href="#cb237-1447" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-1448"><a href="#cb237-1448" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb237-1449"><a href="#cb237-1449" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb237-1450"><a href="#cb237-1450" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb237-1451"><a href="#cb237-1451" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1452"><a href="#cb237-1452" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb237-1453"><a href="#cb237-1453" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb237-1454"><a href="#cb237-1454" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb237-1455"><a href="#cb237-1455" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb237-1456"><a href="#cb237-1456" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1457"><a href="#cb237-1457" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb237-1458"><a href="#cb237-1458" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb237-1459"><a href="#cb237-1459" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb237-1460"><a href="#cb237-1460" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb237-1461"><a href="#cb237-1461" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1462"><a href="#cb237-1462" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb237-1463"><a href="#cb237-1463" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb237-1464"><a href="#cb237-1464" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1465"><a href="#cb237-1465" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1466"><a href="#cb237-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1467"><a href="#cb237-1467" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb237-1468"><a href="#cb237-1468" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb237-1469"><a href="#cb237-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1470"><a href="#cb237-1470" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb237-1471"><a href="#cb237-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1472"><a href="#cb237-1472" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb237-1473"><a href="#cb237-1473" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_handle).rstrip().split())</span>
<span id="cb237-1474"><a href="#cb237-1474" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb237-1475"><a href="#cb237-1475" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_handle).split()</span>
<span id="cb237-1476"><a href="#cb237-1476" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb237-1477"><a href="#cb237-1477" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_handle])</span>
<span id="cb237-1478"><a href="#cb237-1478" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, pseudocount, alphabet, alignment</span>
<span id="cb237-1479"><a href="#cb237-1479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1480"><a href="#cb237-1480" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_transition_pseudocounts(transition_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1481"><a href="#cb237-1481" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb237-1482"><a href="#cb237-1482" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb237-1483"><a href="#cb237-1483" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb237-1484"><a href="#cb237-1484" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb237-1485"><a href="#cb237-1485" aria-hidden="true" tabindex="-1"></a>        transition_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span> : i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">5</span>, (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span> : (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb237-1486"><a href="#cb237-1486" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(transition_matrix)</span>
<span id="cb237-1487"><a href="#cb237-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1488"><a href="#cb237-1488" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_emission_pseudocounts(emission_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1489"><a href="#cb237-1489" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb237-1490"><a href="#cb237-1490" aria-hidden="true" tabindex="-1"></a>    emission_matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb237-1491"><a href="#cb237-1491" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb237-1492"><a href="#cb237-1492" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb237-1493"><a href="#cb237-1493" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb237-1494"><a href="#cb237-1494" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(emission_matrix)</span>
<span id="cb237-1495"><a href="#cb237-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1496"><a href="#cb237-1496" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_pseudocount_profile_hmm(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb237-1497"><a href="#cb237-1497" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb237-1498"><a href="#cb237-1498" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_transition_pseudocounts(transition_probs, pseudocount)</span>
<span id="cb237-1499"><a href="#cb237-1499" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_emission_pseudocounts(emission_probs, pseudocount)</span>
<span id="cb237-1500"><a href="#cb237-1500" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb237-1501"><a href="#cb237-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1502"><a href="#cb237-1502" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-1503"><a href="#cb237-1503" aria-hidden="true" tabindex="-1"></a><span class="st">0.358   0.01</span></span>
<span id="cb237-1504"><a href="#cb237-1504" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1505"><a href="#cb237-1505" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb237-1506"><a href="#cb237-1506" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1507"><a href="#cb237-1507" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb237-1508"><a href="#cb237-1508" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb237-1509"><a href="#cb237-1509" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb237-1510"><a href="#cb237-1510" aria-hidden="true" tabindex="-1"></a><span class="st">ADC</span></span>
<span id="cb237-1511"><a href="#cb237-1511" aria-hidden="true" tabindex="-1"></a><span class="st">-DA</span></span>
<span id="cb237-1512"><a href="#cb237-1512" aria-hidden="true" tabindex="-1"></a><span class="st">D-A</span></span>
<span id="cb237-1513"><a href="#cb237-1513" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-1514"><a href="#cb237-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1515"><a href="#cb237-1515" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb237-1516"><a href="#cb237-1516" aria-hidden="true" tabindex="-1"></a>threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb237-1517"><a href="#cb237-1517" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_pseudocount_profile_hmm(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb237-1518"><a href="#cb237-1518" aria-hidden="true" tabindex="-1"></a>print_transition_probs(transition_probs)</span>
<span id="cb237-1519"><a href="#cb237-1519" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb237-1520"><a href="#cb237-1520" aria-hidden="true" tabindex="-1"></a>print_emission_probs(emission_probs, alphabet)</span>
<span id="cb237-1521"><a href="#cb237-1521" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1522"><a href="#cb237-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1523"><a href="#cb237-1523" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a Multiple Sequence Alignment with a Profile HMM</span></span>
<span id="cb237-1524"><a href="#cb237-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1525"><a href="#cb237-1525" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string Text, a multiple alignment Alignment, a threshold θ, <span class="kw">and</span> a pseudocount σ.</span>
<span id="cb237-1526"><a href="#cb237-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1527"><a href="#cb237-1527" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An optimal hidden path emitting Text <span class="kw">in</span> HMM(Alignment,θ,σ).</span>
<span id="cb237-1528"><a href="#cb237-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1529"><a href="#cb237-1529" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-1530"><a href="#cb237-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1531"><a href="#cb237-1531" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1532"><a href="#cb237-1532" aria-hidden="true" tabindex="-1"></a>AEFDFDC</span>
<span id="cb237-1533"><a href="#cb237-1533" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1534"><a href="#cb237-1534" aria-hidden="true" tabindex="-1"></a><span class="fl">0.4</span> <span class="fl">0.01</span></span>
<span id="cb237-1535"><a href="#cb237-1535" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1536"><a href="#cb237-1536" aria-hidden="true" tabindex="-1"></a>A   B   C   D   E   F</span>
<span id="cb237-1537"><a href="#cb237-1537" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1538"><a href="#cb237-1538" aria-hidden="true" tabindex="-1"></a>ACDEFACADF</span>
<span id="cb237-1539"><a href="#cb237-1539" aria-hidden="true" tabindex="-1"></a>AFDA<span class="op">---</span>CCF</span>
<span id="cb237-1540"><a href="#cb237-1540" aria-hidden="true" tabindex="-1"></a>A<span class="op">--</span>EFD<span class="op">-</span>FDC</span>
<span id="cb237-1541"><a href="#cb237-1541" aria-hidden="true" tabindex="-1"></a>ACAEF<span class="op">--</span>A<span class="op">-</span>C</span>
<span id="cb237-1542"><a href="#cb237-1542" aria-hidden="true" tabindex="-1"></a>ADDEFAAADF</span>
<span id="cb237-1543"><a href="#cb237-1543" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1544"><a href="#cb237-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1545"><a href="#cb237-1545" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-1546"><a href="#cb237-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1547"><a href="#cb237-1547" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1548"><a href="#cb237-1548" aria-hidden="true" tabindex="-1"></a>M1 D2 D3 M4 M5 I5 M6 M7 M8</span>
<span id="cb237-1549"><a href="#cb237-1549" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1550"><a href="#cb237-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1551"><a href="#cb237-1551" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-1552"><a href="#cb237-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1553"><a href="#cb237-1553" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-1554"><a href="#cb237-1554" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb237-1555"><a href="#cb237-1555" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb237-1556"><a href="#cb237-1556" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator</span>
<span id="cb237-1557"><a href="#cb237-1557" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb237-1558"><a href="#cb237-1558" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf, log</span>
<span id="cb237-1559"><a href="#cb237-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1560"><a href="#cb237-1560" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-1561"><a href="#cb237-1561" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb237-1562"><a href="#cb237-1562" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-1563"><a href="#cb237-1563" aria-hidden="true" tabindex="-1"></a>        labels.extend([<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>])</span>
<span id="cb237-1564"><a href="#cb237-1564" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb237-1565"><a href="#cb237-1565" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb237-1566"><a href="#cb237-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1567"><a href="#cb237-1567" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1568"><a href="#cb237-1568" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb237-1569"><a href="#cb237-1569" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb237-1570"><a href="#cb237-1570" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb237-1571"><a href="#cb237-1571" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb237-1572"><a href="#cb237-1572" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb237-1573"><a href="#cb237-1573" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb237-1574"><a href="#cb237-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1575"><a href="#cb237-1575" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1576"><a href="#cb237-1576" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb237-1577"><a href="#cb237-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1578"><a href="#cb237-1578" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1579"><a href="#cb237-1579" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-1580"><a href="#cb237-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1581"><a href="#cb237-1581" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(num_states: <span class="bu">int</span>, num_symbols: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1582"><a href="#cb237-1582" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_symbols), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-1583"><a href="#cb237-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1584"><a href="#cb237-1584" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_index(state_num: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-1585"><a href="#cb237-1585" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb237-1586"><a href="#cb237-1586" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (state_num <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb237-1587"><a href="#cb237-1587" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb237-1588"><a href="#cb237-1588" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> state_num <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb237-1589"><a href="#cb237-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1590"><a href="#cb237-1590" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb237-1591"><a href="#cb237-1591" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb237-1592"><a href="#cb237-1592" aria-hidden="true" tabindex="-1"></a>    valid_length <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb237-1593"><a href="#cb237-1593" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_length <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb237-1594"><a href="#cb237-1594" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_length)</span>
<span id="cb237-1595"><a href="#cb237-1595" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_length, <span class="bu">len</span>(alphabet))</span>
<span id="cb237-1596"><a href="#cb237-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1597"><a href="#cb237-1597" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb237-1598"><a href="#cb237-1598" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-1599"><a href="#cb237-1599" aria-hidden="true" tabindex="-1"></a>        valid_col_count <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb237-1600"><a href="#cb237-1600" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb237-1601"><a href="#cb237-1601" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[col]:</span>
<span id="cb237-1602"><a href="#cb237-1602" aria-hidden="true" tabindex="-1"></a>                valid_col_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1603"><a href="#cb237-1603" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb237-1604"><a href="#cb237-1604" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"del"</span>)</span>
<span id="cb237-1605"><a href="#cb237-1605" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb237-1606"><a href="#cb237-1606" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"match"</span>)</span>
<span id="cb237-1607"><a href="#cb237-1607" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1608"><a href="#cb237-1608" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb237-1609"><a href="#cb237-1609" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb237-1610"><a href="#cb237-1610" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb237-1611"><a href="#cb237-1611" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"ins"</span>)</span>
<span id="cb237-1612"><a href="#cb237-1612" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1613"><a href="#cb237-1613" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb237-1614"><a href="#cb237-1614" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb237-1615"><a href="#cb237-1615" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1616"><a href="#cb237-1616" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1617"><a href="#cb237-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1618"><a href="#cb237-1618" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb237-1619"><a href="#cb237-1619" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb237-1620"><a href="#cb237-1620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1621"><a href="#cb237-1621" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb237-1622"><a href="#cb237-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1623"><a href="#cb237-1623" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_transitions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1624"><a href="#cb237-1624" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb237-1625"><a href="#cb237-1625" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb237-1626"><a href="#cb237-1626" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb237-1627"><a href="#cb237-1627" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb237-1628"><a href="#cb237-1628" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>:i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">5</span>, (i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">1</span>:(i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb237-1629"><a href="#cb237-1629" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb237-1630"><a href="#cb237-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1631"><a href="#cb237-1631" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_emissions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1632"><a href="#cb237-1632" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb237-1633"><a href="#cb237-1633" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb237-1634"><a href="#cb237-1634" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb237-1635"><a href="#cb237-1635" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb237-1636"><a href="#cb237-1636" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb237-1637"><a href="#cb237-1637" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb237-1638"><a href="#cb237-1638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1639"><a href="#cb237-1639" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm_with_pseudocounts(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb237-1640"><a href="#cb237-1640" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb237-1641"><a href="#cb237-1641" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_pseudocounts_to_transitions(transition_probs, pseudocount)</span>
<span id="cb237-1642"><a href="#cb237-1642" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_pseudocounts_to_emissions(emission_probs, pseudocount)</span>
<span id="cb237-1643"><a href="#cb237-1643" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb237-1644"><a href="#cb237-1644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1645"><a href="#cb237-1645" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input_data(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb237-1646"><a href="#cb237-1646" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb237-1647"><a href="#cb237-1647" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb237-1648"><a href="#cb237-1648" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_iterator).rstrip().split())</span>
<span id="cb237-1649"><a href="#cb237-1649" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb237-1650"><a href="#cb237-1650" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb237-1651"><a href="#cb237-1651" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb237-1652"><a href="#cb237-1652" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(x.strip()) <span class="cf">for</span> x <span class="kw">in</span> input_iterator])</span>
<span id="cb237-1653"><a href="#cb237-1653" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, threshold, pseudocount, alphabet, alignment</span>
<span id="cb237-1654"><a href="#cb237-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1655"><a href="#cb237-1655" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_transition_probs_to_dict(matrix: np.ndarray) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb237-1656"><a href="#cb237-1656" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb237-1657"><a href="#cb237-1657" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb237-1658"><a href="#cb237-1658" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb237-1659"><a href="#cb237-1659" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb237-1660"><a href="#cb237-1660" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb237-1661"><a href="#cb237-1661" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb237-1662"><a href="#cb237-1662" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb237-1663"><a href="#cb237-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1664"><a href="#cb237-1664" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_emission_probs_to_dict(matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb237-1665"><a href="#cb237-1665" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb237-1666"><a href="#cb237-1666" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb237-1667"><a href="#cb237-1667" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb237-1668"><a href="#cb237-1668" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb237-1669"><a href="#cb237-1669" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, symbol <span class="kw">in</span> <span class="bu">enumerate</span>(alphabet):</span>
<span id="cb237-1670"><a href="#cb237-1670" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], symbol] <span class="op">=</span> matrix[i][j]</span>
<span id="cb237-1671"><a href="#cb237-1671" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb237-1672"><a href="#cb237-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1673"><a href="#cb237-1673" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_hmm_graph(transition_probs: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]:</span>
<span id="cb237-1674"><a href="#cb237-1674" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_edge(source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-1675"><a href="#cb237-1675" aria-hidden="true" tabindex="-1"></a>        graph[source].append({<span class="st">"node"</span>: target, <span class="st">"weight"</span>: transition_probs[source, target]})</span>
<span id="cb237-1676"><a href="#cb237-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1677"><a href="#cb237-1677" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb237-1678"><a href="#cb237-1678" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target <span class="kw">in</span> [<span class="st">"I0"</span>, <span class="st">"M1"</span>, <span class="st">"D1"</span>]:</span>
<span id="cb237-1679"><a href="#cb237-1679" aria-hidden="true" tabindex="-1"></a>        add_edge(<span class="st">"S"</span>, target)</span>
<span id="cb237-1680"><a href="#cb237-1680" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb237-1681"><a href="#cb237-1681" aria-hidden="true" tabindex="-1"></a>        source <span class="op">=</span> <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb237-1682"><a href="#cb237-1682" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [source, <span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb237-1683"><a href="#cb237-1683" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb237-1684"><a href="#cb237-1684" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states):</span>
<span id="cb237-1685"><a href="#cb237-1685" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb237-1686"><a href="#cb237-1686" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb237-1687"><a href="#cb237-1687" aria-hidden="true" tabindex="-1"></a>                add_edge(source, target)</span>
<span id="cb237-1688"><a href="#cb237-1688" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb237-1689"><a href="#cb237-1689" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="st">"E"</span>]:</span>
<span id="cb237-1690"><a href="#cb237-1690" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb237-1691"><a href="#cb237-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1692"><a href="#cb237-1692" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb237-1693"><a href="#cb237-1693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1694"><a href="#cb237-1694" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_topological_order(num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb237-1695"><a href="#cb237-1695" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"S"</span>, <span class="dv">0</span>)</span>
<span id="cb237-1696"><a href="#cb237-1696" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb237-1697"><a href="#cb237-1697" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="ss">f"D</span><span class="sc">{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)</span>
<span id="cb237-1698"><a href="#cb237-1698" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(seq_length):</span>
<span id="cb237-1699"><a href="#cb237-1699" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="st">"I0"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb237-1700"><a href="#cb237-1700" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb237-1701"><a href="#cb237-1701" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> state_type <span class="kw">in</span> [<span class="st">"M"</span>, <span class="st">"D"</span>, <span class="st">"I"</span>]:</span>
<span id="cb237-1702"><a href="#cb237-1702" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> (<span class="ss">f"</span><span class="sc">{</span>state_type<span class="sc">}{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb237-1703"><a href="#cb237-1703" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"E"</span>, seq_length <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb237-1704"><a href="#cb237-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1705"><a href="#cb237-1705" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_previous_nodes(current_node: <span class="bu">str</span>, current_col: <span class="bu">int</span>, num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb237-1706"><a href="#cb237-1706" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"E"</span>:</span>
<span id="cb237-1707"><a href="#cb237-1707" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length)]</span>
<span id="cb237-1708"><a href="#cb237-1708" aria-hidden="true" tabindex="-1"></a>    state_num <span class="op">=</span> <span class="bu">int</span>(current_node[<span class="dv">1</span>:])</span>
<span id="cb237-1709"><a href="#cb237-1709" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb237-1710"><a href="#cb237-1710" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)]</span>
<span id="cb237-1711"><a href="#cb237-1711" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"I0"</span>:</span>
<span id="cb237-1712"><a href="#cb237-1712" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb237-1713"><a href="#cb237-1713" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"M1"</span>:</span>
<span id="cb237-1714"><a href="#cb237-1714" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb237-1715"><a href="#cb237-1715" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"I"</span>:</span>
<span id="cb237-1716"><a href="#cb237-1716" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb237-1717"><a href="#cb237-1717" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"M"</span>:</span>
<span id="cb237-1718"><a href="#cb237-1718" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb237-1719"><a href="#cb237-1719" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"D"</span>:</span>
<span id="cb237-1720"><a href="#cb237-1720" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"I0"</span>, current_col)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col)]</span>
<span id="cb237-1721"><a href="#cb237-1721" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb237-1722"><a href="#cb237-1722" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Unhandled node: </span><span class="sc">{</span>current_node<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb237-1723"><a href="#cb237-1723" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb237-1724"><a href="#cb237-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1725"><a href="#cb237-1725" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simplify_graph(graph: Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict[<span class="bu">str</span>, <span class="bu">float</span>]]:</span>
<span id="cb237-1726"><a href="#cb237-1726" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {k: {x[<span class="st">"node"</span>]: x[<span class="st">"weight"</span>] <span class="cf">for</span> x <span class="kw">in</span> v} <span class="cf">for</span> k, v <span class="kw">in</span> graph.items()}</span>
<span id="cb237-1727"><a href="#cb237-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1728"><a href="#cb237-1728" aria-hidden="true" tabindex="-1"></a><span class="co"># Main execution</span></span>
<span id="cb237-1729"><a href="#cb237-1729" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input):</span>
<span id="cb237-1730"><a href="#cb237-1730" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb237-1731"><a href="#cb237-1731" aria-hidden="true" tabindex="-1"></a>    sequence, threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input_data(input_lines)</span>
<span id="cb237-1732"><a href="#cb237-1732" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm_with_pseudocounts(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb237-1733"><a href="#cb237-1733" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (transition_probs.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb237-1734"><a href="#cb237-1734" aria-hidden="true" tabindex="-1"></a>    transition_probs_dict <span class="op">=</span> convert_transition_probs_to_dict(transition_probs)</span>
<span id="cb237-1735"><a href="#cb237-1735" aria-hidden="true" tabindex="-1"></a>    emission_probs_dict <span class="op">=</span> convert_emission_probs_to_dict(emission_probs, alphabet)</span>
<span id="cb237-1736"><a href="#cb237-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1737"><a href="#cb237-1737" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> build_hmm_graph(transition_probs_dict, num_states)</span>
<span id="cb237-1738"><a href="#cb237-1738" aria-hidden="true" tabindex="-1"></a>    topological_order <span class="op">=</span> generate_topological_order(num_states, <span class="bu">len</span>(sequence))</span>
<span id="cb237-1739"><a href="#cb237-1739" aria-hidden="true" tabindex="-1"></a>    simplified_graph <span class="op">=</span> simplify_graph(graph)</span>
<span id="cb237-1740"><a href="#cb237-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1741"><a href="#cb237-1741" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dynamic programming to find the most probable path</span></span>
<span id="cb237-1742"><a href="#cb237-1742" aria-hidden="true" tabindex="-1"></a>    previous_node <span class="op">=</span> <span class="bu">next</span>(topological_order)</span>
<span id="cb237-1743"><a href="#cb237-1743" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> {previous_node: <span class="dv">0</span>}</span>
<span id="cb237-1744"><a href="#cb237-1744" aria-hidden="true" tabindex="-1"></a>    backpointers <span class="op">=</span> {previous_node: (<span class="va">None</span>, <span class="va">None</span>)}</span>
<span id="cb237-1745"><a href="#cb237-1745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1746"><a href="#cb237-1746" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_node, current_col <span class="kw">in</span> topological_order:</span>
<span id="cb237-1747"><a href="#cb237-1747" aria-hidden="true" tabindex="-1"></a>        backpointers[(current_node, current_col)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-1748"><a href="#cb237-1748" aria-hidden="true" tabindex="-1"></a>        scores[(current_node, current_col)] <span class="op">=</span> <span class="op">-</span>inf</span>
<span id="cb237-1749"><a href="#cb237-1749" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> prev_node, prev_col <span class="kw">in</span> get_previous_nodes(current_node, current_col, num_states, <span class="bu">len</span>(sequence)):</span>
<span id="cb237-1750"><a href="#cb237-1750" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_col <span class="op">&lt;</span> current_col <span class="kw">and</span> current_node <span class="op">!=</span> <span class="st">"E"</span>:</span>
<span id="cb237-1751"><a href="#cb237-1751" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> emission_probs_dict[current_node, sequence[current_col <span class="op">-</span> <span class="dv">1</span>]]</span>
<span id="cb237-1752"><a href="#cb237-1752" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb237-1753"><a href="#cb237-1753" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb237-1754"><a href="#cb237-1754" aria-hidden="true" tabindex="-1"></a>            log_prob <span class="op">=</span> log(simplified_graph[prev_node][current_node]) <span class="op">+</span> log(emission_prob) <span class="op">+</span> scores[(prev_node, prev_col)]</span>
<span id="cb237-1755"><a href="#cb237-1755" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> log_prob <span class="op">&gt;</span> scores[(current_node, current_col)]:</span>
<span id="cb237-1756"><a href="#cb237-1756" aria-hidden="true" tabindex="-1"></a>                scores[(current_node, current_col)] <span class="op">=</span> log_prob</span>
<span id="cb237-1757"><a href="#cb237-1757" aria-hidden="true" tabindex="-1"></a>                backpointers[(current_node, current_col)] <span class="op">=</span> (prev_node, prev_col)</span>
<span id="cb237-1758"><a href="#cb237-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1759"><a href="#cb237-1759" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback to find the path</span></span>
<span id="cb237-1760"><a href="#cb237-1760" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> []</span>
<span id="cb237-1761"><a href="#cb237-1761" aria-hidden="true" tabindex="-1"></a>    position <span class="op">=</span> (<span class="st">"E"</span>, <span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb237-1762"><a href="#cb237-1762" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> position[<span class="dv">0</span>]:</span>
<span id="cb237-1763"><a href="#cb237-1763" aria-hidden="true" tabindex="-1"></a>        path.append(backpointers[position][<span class="dv">0</span>])</span>
<span id="cb237-1764"><a href="#cb237-1764" aria-hidden="true" tabindex="-1"></a>        position <span class="op">=</span> backpointers[position]</span>
<span id="cb237-1765"><a href="#cb237-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1766"><a href="#cb237-1766" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>path[::<span class="op">-</span><span class="dv">1</span>][<span class="dv">2</span>:])</span>
<span id="cb237-1767"><a href="#cb237-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1768"><a href="#cb237-1768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1769"><a href="#cb237-1769" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-1770"><a href="#cb237-1770" aria-hidden="true" tabindex="-1"></a><span class="st">AEFDFDC</span></span>
<span id="cb237-1771"><a href="#cb237-1771" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1772"><a href="#cb237-1772" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.01</span></span>
<span id="cb237-1773"><a href="#cb237-1773" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1774"><a href="#cb237-1774" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E   F</span></span>
<span id="cb237-1775"><a href="#cb237-1775" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1776"><a href="#cb237-1776" aria-hidden="true" tabindex="-1"></a><span class="st">ACDEFACADF</span></span>
<span id="cb237-1777"><a href="#cb237-1777" aria-hidden="true" tabindex="-1"></a><span class="st">AFDA---CCF</span></span>
<span id="cb237-1778"><a href="#cb237-1778" aria-hidden="true" tabindex="-1"></a><span class="st">A--EFD-FDC</span></span>
<span id="cb237-1779"><a href="#cb237-1779" aria-hidden="true" tabindex="-1"></a><span class="st">ACAEF--A-C</span></span>
<span id="cb237-1780"><a href="#cb237-1780" aria-hidden="true" tabindex="-1"></a><span class="st">ADDEFAAADF</span></span>
<span id="cb237-1781"><a href="#cb237-1781" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-1782"><a href="#cb237-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1783"><a href="#cb237-1783" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb237-1784"><a href="#cb237-1784" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1785"><a href="#cb237-1785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1786"><a href="#cb237-1786" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the Parameters of an HMM</span></span>
<span id="cb237-1787"><a href="#cb237-1787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1788"><a href="#cb237-1788" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of emitted symbols x <span class="op">=</span> x1... xn <span class="kw">in</span> an alphabet ∑ <span class="kw">and</span> a path $π <span class="op">=</span> π_1... π_n$ generated by a k<span class="op">-</span>state HMM <span class="cf">with</span> unknown transition <span class="kw">and</span> emission probabilities.</span>
<span id="cb237-1789"><a href="#cb237-1789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1790"><a href="#cb237-1790" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A matrix of transition probabilities Transition <span class="kw">and</span> a matrix of emission probabilities Emission that maximize $Pr(x,π)$ over <span class="bu">all</span> possible matrices of transition <span class="kw">and</span> emission probabilities.</span>
<span id="cb237-1791"><a href="#cb237-1791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1792"><a href="#cb237-1792" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-1793"><a href="#cb237-1793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1794"><a href="#cb237-1794" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1795"><a href="#cb237-1795" aria-hidden="true" tabindex="-1"></a>yzzzyxzxxx</span>
<span id="cb237-1796"><a href="#cb237-1796" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1797"><a href="#cb237-1797" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb237-1798"><a href="#cb237-1798" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1799"><a href="#cb237-1799" aria-hidden="true" tabindex="-1"></a>BBABABABAB</span>
<span id="cb237-1800"><a href="#cb237-1800" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1801"><a href="#cb237-1801" aria-hidden="true" tabindex="-1"></a>A   B   C</span>
<span id="cb237-1802"><a href="#cb237-1802" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1803"><a href="#cb237-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1804"><a href="#cb237-1804" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-1805"><a href="#cb237-1805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1806"><a href="#cb237-1806" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1807"><a href="#cb237-1807" aria-hidden="true" tabindex="-1"></a>A   B   C</span>
<span id="cb237-1808"><a href="#cb237-1808" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.0</span> <span class="fl">1.0</span> <span class="fl">0.0</span></span>
<span id="cb237-1809"><a href="#cb237-1809" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.8</span> <span class="fl">0.2</span> <span class="fl">0.0</span></span>
<span id="cb237-1810"><a href="#cb237-1810" aria-hidden="true" tabindex="-1"></a>C   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span></span>
<span id="cb237-1811"><a href="#cb237-1811" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1812"><a href="#cb237-1812" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb237-1813"><a href="#cb237-1813" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.25</span>    <span class="fl">0.25</span>    <span class="fl">0.5</span></span>
<span id="cb237-1814"><a href="#cb237-1814" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.5</span> <span class="fl">0.167</span>   <span class="fl">0.333</span></span>
<span id="cb237-1815"><a href="#cb237-1815" aria-hidden="true" tabindex="-1"></a>C   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span></span>
<span id="cb237-1816"><a href="#cb237-1816" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1817"><a href="#cb237-1817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1818"><a href="#cb237-1818" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-1819"><a href="#cb237-1819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1820"><a href="#cb237-1820" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-1821"><a href="#cb237-1821" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb237-1822"><a href="#cb237-1822" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb237-1823"><a href="#cb237-1823" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator, Union</span>
<span id="cb237-1824"><a href="#cb237-1824" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb237-1825"><a href="#cb237-1825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1826"><a href="#cb237-1826" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1827"><a href="#cb237-1827" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb237-1828"><a href="#cb237-1828" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb237-1829"><a href="#cb237-1829" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb237-1830"><a href="#cb237-1830" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb237-1831"><a href="#cb237-1831" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb237-1832"><a href="#cb237-1832" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb237-1833"><a href="#cb237-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1834"><a href="#cb237-1834" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1835"><a href="#cb237-1835" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb237-1836"><a href="#cb237-1836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1837"><a href="#cb237-1837" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-1838"><a href="#cb237-1838" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb237-1839"><a href="#cb237-1839" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb237-1840"><a href="#cb237-1840" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb237-1841"><a href="#cb237-1841" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb237-1842"><a href="#cb237-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1843"><a href="#cb237-1843" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], <span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-1844"><a href="#cb237-1844" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb237-1845"><a href="#cb237-1845" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-1846"><a href="#cb237-1846" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb237-1847"><a href="#cb237-1847" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-1848"><a href="#cb237-1848" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb237-1849"><a href="#cb237-1849" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-1850"><a href="#cb237-1850" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb237-1851"><a href="#cb237-1851" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, alphabet, path, states</span>
<span id="cb237-1852"><a href="#cb237-1852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1853"><a href="#cb237-1853" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_dict(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb237-1854"><a href="#cb237-1854" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb237-1855"><a href="#cb237-1855" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb237-1856"><a href="#cb237-1856" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">1</span>]):</span>
<span id="cb237-1857"><a href="#cb237-1857" aria-hidden="true" tabindex="-1"></a>            result[row_labels[i], column_labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb237-1858"><a href="#cb237-1858" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb237-1859"><a href="#cb237-1859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1860"><a href="#cb237-1860" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb237-1861"><a href="#cb237-1861" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-1862"><a href="#cb237-1862" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_state, next_state <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb237-1863"><a href="#cb237-1863" aria-hidden="true" tabindex="-1"></a>        transition_matrix[states.index(current_state)][states.index(next_state)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1864"><a href="#cb237-1864" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> normalize_matrix(transition_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb237-1865"><a href="#cb237-1865" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb237-1866"><a href="#cb237-1866" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(transition_matrix, states, states)</span>
<span id="cb237-1867"><a href="#cb237-1867" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb237-1868"><a href="#cb237-1868" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> transition_matrix</span>
<span id="cb237-1869"><a href="#cb237-1869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1870"><a href="#cb237-1870" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb237-1871"><a href="#cb237-1871" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-1872"><a href="#cb237-1872" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> state, symbol <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb237-1873"><a href="#cb237-1873" aria-hidden="true" tabindex="-1"></a>        emission_matrix[states.index(state)][alphabet.index(symbol)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1874"><a href="#cb237-1874" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> normalize_matrix(emission_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb237-1875"><a href="#cb237-1875" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb237-1876"><a href="#cb237-1876" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(emission_matrix, states, alphabet)</span>
<span id="cb237-1877"><a href="#cb237-1877" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb237-1878"><a href="#cb237-1878" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> emission_matrix</span>
<span id="cb237-1879"><a href="#cb237-1879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1880"><a href="#cb237-1880" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-1881"><a href="#cb237-1881" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb237-1882"><a href="#cb237-1882" aria-hidden="true" tabindex="-1"></a>    sequence, alphabet, path, states <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb237-1883"><a href="#cb237-1883" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states)</span>
<span id="cb237-1884"><a href="#cb237-1884" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states)</span>
<span id="cb237-1885"><a href="#cb237-1885" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, states, states)</span>
<span id="cb237-1886"><a href="#cb237-1886" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb237-1887"><a href="#cb237-1887" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, states, alphabet)</span>
<span id="cb237-1888"><a href="#cb237-1888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1889"><a href="#cb237-1889" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-1890"><a href="#cb237-1890" aria-hidden="true" tabindex="-1"></a><span class="st">yzzzyxzxxx</span></span>
<span id="cb237-1891"><a href="#cb237-1891" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1892"><a href="#cb237-1892" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb237-1893"><a href="#cb237-1893" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1894"><a href="#cb237-1894" aria-hidden="true" tabindex="-1"></a><span class="st">BBABABABAB</span></span>
<span id="cb237-1895"><a href="#cb237-1895" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-1896"><a href="#cb237-1896" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C</span></span>
<span id="cb237-1897"><a href="#cb237-1897" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-1898"><a href="#cb237-1898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1899"><a href="#cb237-1899" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb237-1900"><a href="#cb237-1900" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1901"><a href="#cb237-1901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1902"><a href="#cb237-1902" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement Viterbi Learning</span></span>
<span id="cb237-1903"><a href="#cb237-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1904"><a href="#cb237-1904" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of emitted symbols&nbsp;$x<span class="op">=</span>x_1... x_n$&nbsp;in an alphabet&nbsp;<span class="op">*</span>A<span class="op">*</span>, generated by a&nbsp;<span class="op">*</span>k<span class="op">*-</span>state HMM <span class="cf">with</span> unknown transition <span class="kw">and</span> emission probabilities, initial&nbsp;<span class="op">*</span>Transition<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>Emission<span class="op">*</span>&nbsp;matrices <span class="kw">and</span> a number of iterations&nbsp;<span class="op">*</span>i<span class="op">*</span>.</span>
<span id="cb237-1905"><a href="#cb237-1905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1906"><a href="#cb237-1906" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A matrix of transition probabilities&nbsp;<span class="op">*</span>Transition<span class="op">*</span>&nbsp;and a matrix of emission probabilities&nbsp;<span class="op">*</span>Emission<span class="op">*</span>&nbsp;that maximizes $Pr(x,π)$ over <span class="bu">all</span> possible transition <span class="kw">and</span> emission matrices <span class="kw">and</span> over <span class="bu">all</span> hidden paths&nbsp;<span class="op">*</span>π<span class="op">*</span>.</span>
<span id="cb237-1907"><a href="#cb237-1907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1908"><a href="#cb237-1908" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-1909"><a href="#cb237-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1910"><a href="#cb237-1910" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1911"><a href="#cb237-1911" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span></span>
<span id="cb237-1912"><a href="#cb237-1912" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1913"><a href="#cb237-1913" aria-hidden="true" tabindex="-1"></a>xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz</span>
<span id="cb237-1914"><a href="#cb237-1914" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1915"><a href="#cb237-1915" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb237-1916"><a href="#cb237-1916" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1917"><a href="#cb237-1917" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb237-1918"><a href="#cb237-1918" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1919"><a href="#cb237-1919" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb237-1920"><a href="#cb237-1920" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.582</span>   <span class="fl">0.418</span></span>
<span id="cb237-1921"><a href="#cb237-1921" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.272</span>   <span class="fl">0.728</span></span>
<span id="cb237-1922"><a href="#cb237-1922" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1923"><a href="#cb237-1923" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb237-1924"><a href="#cb237-1924" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.129</span>   <span class="fl">0.35</span>    <span class="fl">0.52</span></span>
<span id="cb237-1925"><a href="#cb237-1925" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.422</span>   <span class="fl">0.151</span>   <span class="fl">0.426</span></span>
<span id="cb237-1926"><a href="#cb237-1926" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1927"><a href="#cb237-1927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1928"><a href="#cb237-1928" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-1929"><a href="#cb237-1929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1930"><a href="#cb237-1930" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1931"><a href="#cb237-1931" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb237-1932"><a href="#cb237-1932" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.875</span>   <span class="fl">0.125</span></span>
<span id="cb237-1933"><a href="#cb237-1933" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.011</span>   <span class="fl">0.989</span></span>
<span id="cb237-1934"><a href="#cb237-1934" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-1935"><a href="#cb237-1935" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb237-1936"><a href="#cb237-1936" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.0</span> <span class="fl">0.75</span>    <span class="fl">0.25</span></span>
<span id="cb237-1937"><a href="#cb237-1937" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.402</span>   <span class="fl">0.174</span>   <span class="fl">0.424</span></span>
<span id="cb237-1938"><a href="#cb237-1938" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-1939"><a href="#cb237-1939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1940"><a href="#cb237-1940" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-1941"><a href="#cb237-1941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1942"><a href="#cb237-1942" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-1943"><a href="#cb237-1943" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb237-1944"><a href="#cb237-1944" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb237-1945"><a href="#cb237-1945" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb237-1946"><a href="#cb237-1946" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb237-1947"><a href="#cb237-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1948"><a href="#cb237-1948" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-1949"><a href="#cb237-1949" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)))</span>
<span id="cb237-1950"><a href="#cb237-1950" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb237-1951"><a href="#cb237-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1952"><a href="#cb237-1952" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-1953"><a href="#cb237-1953" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states))</span>
<span id="cb237-1954"><a href="#cb237-1954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1955"><a href="#cb237-1955" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb237-1956"><a href="#cb237-1956" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-1957"><a href="#cb237-1957" aria-hidden="true" tabindex="-1"></a>            opt <span class="op">=</span> [</span>
<span id="cb237-1958"><a href="#cb237-1958" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[prev, state]) <span class="op">+</span> log(emission_matrix[state, emission]) <span class="op">+</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb237-1959"><a href="#cb237-1959" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb237-1960"><a href="#cb237-1960" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb237-1961"><a href="#cb237-1961" aria-hidden="true" tabindex="-1"></a>            p <span class="op">=</span> opt.index(<span class="bu">max</span>(opt))</span>
<span id="cb237-1962"><a href="#cb237-1962" aria-hidden="true" tabindex="-1"></a>            ptr[i, j] <span class="op">=</span> p</span>
<span id="cb237-1963"><a href="#cb237-1963" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">max</span>(opt)</span>
<span id="cb237-1964"><a href="#cb237-1964" aria-hidden="true" tabindex="-1"></a>    ind <span class="op">=</span> np.argmax(mat[i, :])</span>
<span id="cb237-1965"><a href="#cb237-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1966"><a href="#cb237-1966" aria-hidden="true" tabindex="-1"></a>    state_sequence <span class="op">=</span> states[ind]</span>
<span id="cb237-1967"><a href="#cb237-1967" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb237-1968"><a href="#cb237-1968" aria-hidden="true" tabindex="-1"></a>        state_sequence <span class="op">=</span> states[ptr[i, ind]] <span class="op">+</span> state_sequence</span>
<span id="cb237-1969"><a href="#cb237-1969" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> ptr[i, ind]</span>
<span id="cb237-1970"><a href="#cb237-1970" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-1971"><a href="#cb237-1971" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> state_sequence</span>
<span id="cb237-1972"><a href="#cb237-1972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1973"><a href="#cb237-1973" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-1974"><a href="#cb237-1974" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb237-1975"><a href="#cb237-1975" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb237-1976"><a href="#cb237-1976" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb237-1977"><a href="#cb237-1977" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb237-1978"><a href="#cb237-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1979"><a href="#cb237-1979" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>, min_val: <span class="bu">float</span> <span class="op">=</span> <span class="fl">1e-16</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-1980"><a href="#cb237-1980" aria-hidden="true" tabindex="-1"></a>    normalized <span class="op">=</span> matrix <span class="op">/</span> matrix.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb237-1981"><a href="#cb237-1981" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros:</span>
<span id="cb237-1982"><a href="#cb237-1982" aria-hidden="true" tabindex="-1"></a>        normalized[normalized <span class="op">==</span> <span class="dv">0</span>] <span class="op">=</span> min_val</span>
<span id="cb237-1983"><a href="#cb237-1983" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalized</span>
<span id="cb237-1984"><a href="#cb237-1984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1985"><a href="#cb237-1985" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb237-1986"><a href="#cb237-1986" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-1987"><a href="#cb237-1987" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb237-1988"><a href="#cb237-1988" aria-hidden="true" tabindex="-1"></a>        tmat[states.index(a)][states.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1989"><a href="#cb237-1989" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> normalize_matrix(tmat)</span>
<span id="cb237-1990"><a href="#cb237-1990" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb237-1991"><a href="#cb237-1991" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], states[j]): tmat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states))}</span>
<span id="cb237-1992"><a href="#cb237-1992" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tmat</span>
<span id="cb237-1993"><a href="#cb237-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-1994"><a href="#cb237-1994" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb237-1995"><a href="#cb237-1995" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-1996"><a href="#cb237-1996" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb237-1997"><a href="#cb237-1997" aria-hidden="true" tabindex="-1"></a>        emat[states.index(a)][alphabet.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-1998"><a href="#cb237-1998" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> normalize_matrix(emat)</span>
<span id="cb237-1999"><a href="#cb237-1999" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb237-2000"><a href="#cb237-2000" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], alphabet[j]): emat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(alphabet))}</span>
<span id="cb237-2001"><a href="#cb237-2001" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emat</span>
<span id="cb237-2002"><a href="#cb237-2002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2003"><a href="#cb237-2003" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-2004"><a href="#cb237-2004" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(column_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-2005"><a href="#cb237-2005" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb237-2006"><a href="#cb237-2006" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(column_labels):</span>
<span id="cb237-2007"><a href="#cb237-2007" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb237-2008"><a href="#cb237-2008" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, column_labels)</span>
<span id="cb237-2009"><a href="#cb237-2009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2010"><a href="#cb237-2010" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: StringIO) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb237-2011"><a href="#cb237-2011" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb237-2012"><a href="#cb237-2012" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2013"><a href="#cb237-2013" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb237-2014"><a href="#cb237-2014" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2015"><a href="#cb237-2015" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb237-2016"><a href="#cb237-2016" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2017"><a href="#cb237-2017" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb237-2018"><a href="#cb237-2018" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2019"><a href="#cb237-2019" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-2020"><a href="#cb237-2020" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb237-2021"><a href="#cb237-2021" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb237-2022"><a href="#cb237-2022" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb237-2023"><a href="#cb237-2023" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb237-2024"><a href="#cb237-2024" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb237-2025"><a href="#cb237-2025" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2026"><a href="#cb237-2026" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-2027"><a href="#cb237-2027" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb237-2028"><a href="#cb237-2028" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb237-2029"><a href="#cb237-2029" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb237-2030"><a href="#cb237-2030" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb237-2031"><a href="#cb237-2031" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb237-2032"><a href="#cb237-2032" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, sequence, states, alphabet, transition_matrix, emission_matrix</span>
<span id="cb237-2033"><a href="#cb237-2033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2034"><a href="#cb237-2034" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-2035"><a href="#cb237-2035" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb237-2036"><a href="#cb237-2036" aria-hidden="true" tabindex="-1"></a>    niter, sequence, states, alphabet, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb237-2037"><a href="#cb237-2037" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb237-2038"><a href="#cb237-2038" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb237-2039"><a href="#cb237-2039" aria-hidden="true" tabindex="-1"></a>        transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb237-2040"><a href="#cb237-2040" aria-hidden="true" tabindex="-1"></a>        emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb237-2041"><a href="#cb237-2041" aria-hidden="true" tabindex="-1"></a>    print_dict(transition_matrix, states, states)</span>
<span id="cb237-2042"><a href="#cb237-2042" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb237-2043"><a href="#cb237-2043" aria-hidden="true" tabindex="-1"></a>    print_dict(emission_matrix, states, alphabet)</span>
<span id="cb237-2044"><a href="#cb237-2044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2045"><a href="#cb237-2045" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-2046"><a href="#cb237-2046" aria-hidden="true" tabindex="-1"></a><span class="st">100</span></span>
<span id="cb237-2047"><a href="#cb237-2047" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2048"><a href="#cb237-2048" aria-hidden="true" tabindex="-1"></a><span class="st">xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz</span></span>
<span id="cb237-2049"><a href="#cb237-2049" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2050"><a href="#cb237-2050" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb237-2051"><a href="#cb237-2051" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2052"><a href="#cb237-2052" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb237-2053"><a href="#cb237-2053" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2054"><a href="#cb237-2054" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb237-2055"><a href="#cb237-2055" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.582   0.418</span></span>
<span id="cb237-2056"><a href="#cb237-2056" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.272   0.728</span></span>
<span id="cb237-2057"><a href="#cb237-2057" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2058"><a href="#cb237-2058" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb237-2059"><a href="#cb237-2059" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.129   0.35    0.52</span></span>
<span id="cb237-2060"><a href="#cb237-2060" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.422   0.151   0.426</span></span>
<span id="cb237-2061"><a href="#cb237-2061" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-2062"><a href="#cb237-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2063"><a href="#cb237-2063" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb237-2064"><a href="#cb237-2064" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2065"><a href="#cb237-2065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2066"><a href="#cb237-2066" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the Soft Decoding Problem</span></span>
<span id="cb237-2067"><a href="#cb237-2067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2068"><a href="#cb237-2068" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>x<span class="op">*</span>, followed by the alphabet&nbsp;<span class="op">*</span>Σ<span class="op">*</span>&nbsp;from which&nbsp;<span class="op">*</span>x<span class="op">*</span>&nbsp;was constructed, followed by the states&nbsp;<span class="op">*</span>States<span class="op">*</span>, transition matrix&nbsp;<span class="op">*</span>Transition<span class="op">*</span>, <span class="kw">and</span> emission matrix&nbsp;<span class="op">*</span>Emission<span class="op">*</span>&nbsp;of an HMM (<span class="op">*</span>Σ<span class="op">*</span>,&nbsp;<span class="op">*</span>States<span class="op">*</span>,&nbsp;<span class="op">*</span>Transition<span class="op">*</span>,&nbsp;<span class="op">*</span>Emission<span class="op">*</span>).</span>
<span id="cb237-2069"><a href="#cb237-2069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2070"><a href="#cb237-2070" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The probability $Pr(π_i<span class="op">=</span>k<span class="op">|</span>x)$ that the HMM was <span class="kw">in</span> state k at step i (<span class="cf">for</span> each state k <span class="kw">and</span> each step i).</span>
<span id="cb237-2071"><a href="#cb237-2071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2072"><a href="#cb237-2072" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-2073"><a href="#cb237-2073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2074"><a href="#cb237-2074" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2075"><a href="#cb237-2075" aria-hidden="true" tabindex="-1"></a>zyxxxxyxzz</span>
<span id="cb237-2076"><a href="#cb237-2076" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-2077"><a href="#cb237-2077" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb237-2078"><a href="#cb237-2078" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-2079"><a href="#cb237-2079" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb237-2080"><a href="#cb237-2080" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-2081"><a href="#cb237-2081" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb237-2082"><a href="#cb237-2082" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.911</span>   <span class="fl">0.089</span></span>
<span id="cb237-2083"><a href="#cb237-2083" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.228</span>   <span class="fl">0.772</span></span>
<span id="cb237-2084"><a href="#cb237-2084" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-2085"><a href="#cb237-2085" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb237-2086"><a href="#cb237-2086" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.356</span>   <span class="fl">0.191</span>   <span class="fl">0.453</span> </span>
<span id="cb237-2087"><a href="#cb237-2087" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.04</span>    <span class="fl">0.467</span>   <span class="fl">0.493</span></span>
<span id="cb237-2088"><a href="#cb237-2088" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2089"><a href="#cb237-2089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2090"><a href="#cb237-2090" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-2091"><a href="#cb237-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2092"><a href="#cb237-2092" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2093"><a href="#cb237-2093" aria-hidden="true" tabindex="-1"></a>A   B </span>
<span id="cb237-2094"><a href="#cb237-2094" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5438</span>  <span class="fl">0.4562</span> </span>
<span id="cb237-2095"><a href="#cb237-2095" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6492</span>  <span class="fl">0.3508</span> </span>
<span id="cb237-2096"><a href="#cb237-2096" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9647</span>  <span class="fl">0.0353</span> </span>
<span id="cb237-2097"><a href="#cb237-2097" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9936</span>  <span class="fl">0.0064</span> </span>
<span id="cb237-2098"><a href="#cb237-2098" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9957</span>  <span class="fl">0.0043</span> </span>
<span id="cb237-2099"><a href="#cb237-2099" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9891</span>  <span class="fl">0.0109</span> </span>
<span id="cb237-2100"><a href="#cb237-2100" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9154</span>  <span class="fl">0.0846</span> </span>
<span id="cb237-2101"><a href="#cb237-2101" aria-hidden="true" tabindex="-1"></a><span class="fl">0.964</span>   <span class="fl">0.036</span> </span>
<span id="cb237-2102"><a href="#cb237-2102" aria-hidden="true" tabindex="-1"></a><span class="fl">0.8737</span>  <span class="fl">0.1263</span> </span>
<span id="cb237-2103"><a href="#cb237-2103" aria-hidden="true" tabindex="-1"></a><span class="fl">0.8167</span>  <span class="fl">0.1833</span></span>
<span id="cb237-2104"><a href="#cb237-2104" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2105"><a href="#cb237-2105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2106"><a href="#cb237-2106" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-2107"><a href="#cb237-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2108"><a href="#cb237-2108" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-2109"><a href="#cb237-2109" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb237-2110"><a href="#cb237-2110" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb237-2111"><a href="#cb237-2111" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb237-2112"><a href="#cb237-2112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2113"><a href="#cb237-2113" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb237-2114"><a href="#cb237-2114" aria-hidden="true" tabindex="-1"></a>    seq: <span class="bu">str</span> <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb237-2115"><a href="#cb237-2115" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2116"><a href="#cb237-2116" aria-hidden="true" tabindex="-1"></a>    alphabet: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb237-2117"><a href="#cb237-2117" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2118"><a href="#cb237-2118" aria-hidden="true" tabindex="-1"></a>    states: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb237-2119"><a href="#cb237-2119" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2120"><a href="#cb237-2120" aria-hidden="true" tabindex="-1"></a>    lines: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-2121"><a href="#cb237-2121" aria-hidden="true" tabindex="-1"></a>    tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb237-2122"><a href="#cb237-2122" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb237-2123"><a href="#cb237-2123" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb237-2124"><a href="#cb237-2124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb237-2125"><a href="#cb237-2125" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb237-2126"><a href="#cb237-2126" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2127"><a href="#cb237-2127" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-2128"><a href="#cb237-2128" aria-hidden="true" tabindex="-1"></a>    emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb237-2129"><a href="#cb237-2129" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb237-2130"><a href="#cb237-2130" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb237-2131"><a href="#cb237-2131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb237-2132"><a href="#cb237-2132" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb237-2133"><a href="#cb237-2133" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq, states, tmat, emat</span>
<span id="cb237-2134"><a href="#cb237-2134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2135"><a href="#cb237-2135" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-2136"><a href="#cb237-2136" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb237-2137"><a href="#cb237-2137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2138"><a href="#cb237-2138" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-2139"><a href="#cb237-2139" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb237-2140"><a href="#cb237-2140" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb237-2141"><a href="#cb237-2141" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-2142"><a href="#cb237-2142" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb237-2143"><a href="#cb237-2143" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb237-2144"><a href="#cb237-2144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb237-2145"><a href="#cb237-2145" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb237-2146"><a href="#cb237-2146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2147"><a href="#cb237-2147" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb237-2148"><a href="#cb237-2148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2149"><a href="#cb237-2149" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-2150"><a href="#cb237-2150" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb237-2151"><a href="#cb237-2151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2152"><a href="#cb237-2152" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb237-2153"><a href="#cb237-2153" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-2154"><a href="#cb237-2154" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb237-2155"><a href="#cb237-2155" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb237-2156"><a href="#cb237-2156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb237-2157"><a href="#cb237-2157" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb237-2158"><a href="#cb237-2158" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb237-2159"><a href="#cb237-2159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2160"><a href="#cb237-2160" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-2161"><a href="#cb237-2161" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb237-2162"><a href="#cb237-2162" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb237-2163"><a href="#cb237-2163" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb237-2164"><a href="#cb237-2164" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb237-2165"><a href="#cb237-2165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2166"><a href="#cb237-2166" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-2167"><a href="#cb237-2167" aria-hidden="true" tabindex="-1"></a>    input_lines: Iterator[<span class="bu">str</span>] <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb237-2168"><a href="#cb237-2168" aria-hidden="true" tabindex="-1"></a>    seq, states, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb237-2169"><a href="#cb237-2169" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> soft_decode(seq, states, tmat, emat)</span>
<span id="cb237-2170"><a href="#cb237-2170" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>states, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb237-2171"><a href="#cb237-2171" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> r <span class="kw">in</span> np.<span class="bu">round</span>(tot, <span class="dv">4</span>):</span>
<span id="cb237-2172"><a href="#cb237-2172" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb237-2173"><a href="#cb237-2173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2174"><a href="#cb237-2174" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-2175"><a href="#cb237-2175" aria-hidden="true" tabindex="-1"></a><span class="st">zyxxxxyxzz</span></span>
<span id="cb237-2176"><a href="#cb237-2176" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2177"><a href="#cb237-2177" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb237-2178"><a href="#cb237-2178" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2179"><a href="#cb237-2179" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb237-2180"><a href="#cb237-2180" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2181"><a href="#cb237-2181" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb237-2182"><a href="#cb237-2182" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.911   0.089</span></span>
<span id="cb237-2183"><a href="#cb237-2183" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.228   0.772</span></span>
<span id="cb237-2184"><a href="#cb237-2184" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2185"><a href="#cb237-2185" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb237-2186"><a href="#cb237-2186" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.356   0.191   0.453 </span></span>
<span id="cb237-2187"><a href="#cb237-2187" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.04    0.467   0.493</span></span>
<span id="cb237-2188"><a href="#cb237-2188" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-2189"><a href="#cb237-2189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2190"><a href="#cb237-2190" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb237-2191"><a href="#cb237-2191" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2192"><a href="#cb237-2192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2193"><a href="#cb237-2193" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement Baum-Welch Learning</span></span>
<span id="cb237-2194"><a href="#cb237-2194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2195"><a href="#cb237-2195" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of emitted symbols $x<span class="op">=</span>x_1...x_n$ <span class="kw">in</span> an alphabet A, generated by a k<span class="op">-</span>state HMM <span class="cf">with</span> unknown transition <span class="kw">and</span> emission probabilities, initial Transition <span class="kw">and</span> Emission matrices <span class="kw">and</span> a number of iterations I.</span>
<span id="cb237-2196"><a href="#cb237-2196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2197"><a href="#cb237-2197" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A matrix of transition probabilities Transition <span class="kw">and</span> a matrix of emission probabilities Emission that maximizes $Pr(x,π)$ over <span class="bu">all</span> possible transition <span class="kw">and</span> emission matrices <span class="kw">and</span> over <span class="bu">all</span> hidden paths π.</span>
<span id="cb237-2198"><a href="#cb237-2198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2199"><a href="#cb237-2199" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-2200"><a href="#cb237-2200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2201"><a href="#cb237-2201" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2202"><a href="#cb237-2202" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span>
<span id="cb237-2203"><a href="#cb237-2203" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-2204"><a href="#cb237-2204" aria-hidden="true" tabindex="-1"></a>xzyyzyzyxy</span>
<span id="cb237-2205"><a href="#cb237-2205" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-2206"><a href="#cb237-2206" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb237-2207"><a href="#cb237-2207" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-2208"><a href="#cb237-2208" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb237-2209"><a href="#cb237-2209" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-2210"><a href="#cb237-2210" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb237-2211"><a href="#cb237-2211" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.019</span>   <span class="fl">0.981</span> </span>
<span id="cb237-2212"><a href="#cb237-2212" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.668</span>   <span class="fl">0.332</span> </span>
<span id="cb237-2213"><a href="#cb237-2213" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-2214"><a href="#cb237-2214" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb237-2215"><a href="#cb237-2215" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.175</span>   <span class="fl">0.003</span>   <span class="fl">0.821</span> </span>
<span id="cb237-2216"><a href="#cb237-2216" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.196</span>   <span class="fl">0.512</span>   <span class="fl">0.293</span></span>
<span id="cb237-2217"><a href="#cb237-2217" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2218"><a href="#cb237-2218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2219"><a href="#cb237-2219" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-2220"><a href="#cb237-2220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2221"><a href="#cb237-2221" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2222"><a href="#cb237-2222" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb237-2223"><a href="#cb237-2223" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.000</span>   <span class="fl">1.000</span>   </span>
<span id="cb237-2224"><a href="#cb237-2224" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.786</span>   <span class="fl">0.214</span>   </span>
<span id="cb237-2225"><a href="#cb237-2225" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb237-2226"><a href="#cb237-2226" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb237-2227"><a href="#cb237-2227" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.242</span>   <span class="fl">0.000</span>   <span class="fl">0.758</span>   </span>
<span id="cb237-2228"><a href="#cb237-2228" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.172</span>   <span class="fl">0.828</span>   <span class="fl">0.000</span></span>
<span id="cb237-2229"><a href="#cb237-2229" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2230"><a href="#cb237-2230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2231"><a href="#cb237-2231" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-2232"><a href="#cb237-2232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2233"><a href="#cb237-2233" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-2234"><a href="#cb237-2234" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb237-2235"><a href="#cb237-2235" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb237-2236"><a href="#cb237-2236" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb237-2237"><a href="#cb237-2237" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb237-2238"><a href="#cb237-2238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2239"><a href="#cb237-2239" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-2240"><a href="#cb237-2240" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb237-2241"><a href="#cb237-2241" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb237-2242"><a href="#cb237-2242" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb237-2243"><a href="#cb237-2243" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb237-2244"><a href="#cb237-2244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2245"><a href="#cb237-2245" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-2246"><a href="#cb237-2246" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(col_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-2247"><a href="#cb237-2247" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb237-2248"><a href="#cb237-2248" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(col_labels):</span>
<span id="cb237-2249"><a href="#cb237-2249" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb237-2250"><a href="#cb237-2250" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, col_labels)</span>
<span id="cb237-2251"><a href="#cb237-2251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2252"><a href="#cb237-2252" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb237-2253"><a href="#cb237-2253" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb237-2254"><a href="#cb237-2254" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2255"><a href="#cb237-2255" aria-hidden="true" tabindex="-1"></a>    seq <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb237-2256"><a href="#cb237-2256" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2257"><a href="#cb237-2257" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb237-2258"><a href="#cb237-2258" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2259"><a href="#cb237-2259" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb237-2260"><a href="#cb237-2260" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2261"><a href="#cb237-2261" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-2262"><a href="#cb237-2262" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> {</span>
<span id="cb237-2263"><a href="#cb237-2263" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb237-2264"><a href="#cb237-2264" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb237-2265"><a href="#cb237-2265" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb237-2266"><a href="#cb237-2266" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb237-2267"><a href="#cb237-2267" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb237-2268"><a href="#cb237-2268" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-2269"><a href="#cb237-2269" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> {</span>
<span id="cb237-2270"><a href="#cb237-2270" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb237-2271"><a href="#cb237-2271" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb237-2272"><a href="#cb237-2272" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb237-2273"><a href="#cb237-2273" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb237-2274"><a href="#cb237-2274" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, seq, states, alphabet, tmat, emat</span>
<span id="cb237-2275"><a href="#cb237-2275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2276"><a href="#cb237-2276" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-2277"><a href="#cb237-2277" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb237-2278"><a href="#cb237-2278" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-2279"><a href="#cb237-2279" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb237-2280"><a href="#cb237-2280" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb237-2281"><a href="#cb237-2281" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-2282"><a href="#cb237-2282" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb237-2283"><a href="#cb237-2283" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb237-2284"><a href="#cb237-2284" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb237-2285"><a href="#cb237-2285" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb237-2286"><a href="#cb237-2286" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb237-2287"><a href="#cb237-2287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2288"><a href="#cb237-2288" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-2289"><a href="#cb237-2289" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb237-2290"><a href="#cb237-2290" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb237-2291"><a href="#cb237-2291" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-2292"><a href="#cb237-2292" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb237-2293"><a href="#cb237-2293" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb237-2294"><a href="#cb237-2294" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb237-2295"><a href="#cb237-2295" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb237-2296"><a href="#cb237-2296" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb237-2297"><a href="#cb237-2297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2298"><a href="#cb237-2298" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-2299"><a href="#cb237-2299" aria-hidden="true" tabindex="-1"></a>    tot <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb237-2300"><a href="#cb237-2300" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb237-2301"><a href="#cb237-2301" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb237-2302"><a href="#cb237-2302" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb237-2303"><a href="#cb237-2303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2304"><a href="#cb237-2304" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> as_dict(x: np.ndarray, r: List[<span class="bu">str</span>], c: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb237-2305"><a href="#cb237-2305" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb237-2306"><a href="#cb237-2306" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">0</span>]):</span>
<span id="cb237-2307"><a href="#cb237-2307" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">1</span>]):</span>
<span id="cb237-2308"><a href="#cb237-2308" aria-hidden="true" tabindex="-1"></a>            g[r[i], c[j]] <span class="op">=</span> x[i][j]</span>
<span id="cb237-2309"><a href="#cb237-2309" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g</span>
<span id="cb237-2310"><a href="#cb237-2310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2311"><a href="#cb237-2311" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_pi2(seq: <span class="bu">str</span>, fwd: np.ndarray, bak: np.ndarray, tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], states: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb237-2312"><a href="#cb237-2312" aria-hidden="true" tabindex="-1"></a>    rep_mat <span class="op">=</span> np.zeros((fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>, <span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-2313"><a href="#cb237-2313" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb237-2314"><a href="#cb237-2314" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, s1 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-2315"><a href="#cb237-2315" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k, s2 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb237-2316"><a href="#cb237-2316" aria-hidden="true" tabindex="-1"></a>                weight <span class="op">=</span> tmat[s1, s2] <span class="op">*</span> emat[s2, seq[i <span class="op">+</span> <span class="dv">1</span>]]</span>
<span id="cb237-2317"><a href="#cb237-2317" aria-hidden="true" tabindex="-1"></a>                rep_mat[i, j, k] <span class="op">=</span> (</span>
<span id="cb237-2318"><a href="#cb237-2318" aria-hidden="true" tabindex="-1"></a>                    fwd[i, j] <span class="op">*</span> bak[i <span class="op">+</span> <span class="dv">1</span>, k] <span class="op">*</span> weight <span class="op">/</span> <span class="bu">sum</span>(fwd[i, :] <span class="op">*</span> bak[i, :])</span>
<span id="cb237-2319"><a href="#cb237-2319" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb237-2320"><a href="#cb237-2320" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rep_mat</span>
<span id="cb237-2321"><a href="#cb237-2321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2322"><a href="#cb237-2322" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_tmat(seq: <span class="bu">str</span>, st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb237-2323"><a href="#cb237-2323" aria-hidden="true" tabindex="-1"></a>    fwd <span class="op">=</span> forward(seq, st, tmat, emat)</span>
<span id="cb237-2324"><a href="#cb237-2324" aria-hidden="true" tabindex="-1"></a>    bak <span class="op">=</span> backward(seq, st, tmat, emat)</span>
<span id="cb237-2325"><a href="#cb237-2325" aria-hidden="true" tabindex="-1"></a>    pi2 <span class="op">=</span> estimate_pi2(seq, fwd, bak, tmat, emat, st)</span>
<span id="cb237-2326"><a href="#cb237-2326" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> np.<span class="bu">sum</span>(pi2, <span class="dv">0</span>)</span>
<span id="cb237-2327"><a href="#cb237-2327" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> tmat_new <span class="op">/</span> np.<span class="bu">sum</span>(tmat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb237-2328"><a href="#cb237-2328" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(tmat_new, st, st)</span>
<span id="cb237-2329"><a href="#cb237-2329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2330"><a href="#cb237-2330" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emat(seq: <span class="bu">str</span>, al: List[<span class="bu">str</span>], st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb237-2331"><a href="#cb237-2331" aria-hidden="true" tabindex="-1"></a>    pi1 <span class="op">=</span> soft_decode(seq, st, tmat, emat)</span>
<span id="cb237-2332"><a href="#cb237-2332" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> np.zeros((<span class="bu">len</span>(st), <span class="bu">len</span>(al)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb237-2333"><a href="#cb237-2333" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(al):</span>
<span id="cb237-2334"><a href="#cb237-2334" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> np.array(<span class="bu">list</span>(seq)) <span class="op">==</span> emission</span>
<span id="cb237-2335"><a href="#cb237-2335" aria-hidden="true" tabindex="-1"></a>        emat_new[:, i] <span class="op">=</span> np.<span class="bu">sum</span>(pi1[ind, :], <span class="dv">0</span>)</span>
<span id="cb237-2336"><a href="#cb237-2336" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> emat_new <span class="op">/</span> np.<span class="bu">sum</span>(emat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb237-2337"><a href="#cb237-2337" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(emat_new, st, al)</span>
<span id="cb237-2338"><a href="#cb237-2338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2339"><a href="#cb237-2339" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-2340"><a href="#cb237-2340" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb237-2341"><a href="#cb237-2341" aria-hidden="true" tabindex="-1"></a>    niter, seq, st, al, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb237-2342"><a href="#cb237-2342" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb237-2343"><a href="#cb237-2343" aria-hidden="true" tabindex="-1"></a>        tmat2 <span class="op">=</span> estimate_tmat(seq, st, tmat, emat)</span>
<span id="cb237-2344"><a href="#cb237-2344" aria-hidden="true" tabindex="-1"></a>        emat2 <span class="op">=</span> estimate_emat(seq, al, st, tmat, emat)</span>
<span id="cb237-2345"><a href="#cb237-2345" aria-hidden="true" tabindex="-1"></a>        emat, tmat <span class="op">=</span> emat2, tmat2</span>
<span id="cb237-2346"><a href="#cb237-2346" aria-hidden="true" tabindex="-1"></a>    print_dict(tmat, st, st)</span>
<span id="cb237-2347"><a href="#cb237-2347" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb237-2348"><a href="#cb237-2348" aria-hidden="true" tabindex="-1"></a>    print_dict(emat, st, al)</span>
<span id="cb237-2349"><a href="#cb237-2349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2350"><a href="#cb237-2350" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-2351"><a href="#cb237-2351" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb237-2352"><a href="#cb237-2352" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2353"><a href="#cb237-2353" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzyzyxy</span></span>
<span id="cb237-2354"><a href="#cb237-2354" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2355"><a href="#cb237-2355" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb237-2356"><a href="#cb237-2356" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2357"><a href="#cb237-2357" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb237-2358"><a href="#cb237-2358" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2359"><a href="#cb237-2359" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb237-2360"><a href="#cb237-2360" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.019   0.981 </span></span>
<span id="cb237-2361"><a href="#cb237-2361" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.668   0.332 </span></span>
<span id="cb237-2362"><a href="#cb237-2362" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb237-2363"><a href="#cb237-2363" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb237-2364"><a href="#cb237-2364" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.175   0.003   0.821 </span></span>
<span id="cb237-2365"><a href="#cb237-2365" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.196   0.512   0.293</span></span>
<span id="cb237-2366"><a href="#cb237-2366" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-2367"><a href="#cb237-2367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2368"><a href="#cb237-2368" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb237-2369"><a href="#cb237-2369" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2370"><a href="#cb237-2370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2371"><a href="#cb237-2371" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the Graph of a Spectrum</span></span>
<span id="cb237-2372"><a href="#cb237-2372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2373"><a href="#cb237-2373" aria-hidden="true" tabindex="-1"></a><span class="co">## Spectrum Graph Construction</span></span>
<span id="cb237-2374"><a href="#cb237-2374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2375"><a href="#cb237-2375" aria-hidden="true" tabindex="-1"></a>Construct the graph of a spectrum.</span>
<span id="cb237-2376"><a href="#cb237-2376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2377"><a href="#cb237-2377" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A space<span class="op">-</span>delimited <span class="bu">list</span> of integers&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>.</span>
<span id="cb237-2378"><a href="#cb237-2378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2379"><a href="#cb237-2379" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>Graph(Spectrum)<span class="op">*</span>.</span>
<span id="cb237-2380"><a href="#cb237-2380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2381"><a href="#cb237-2381" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Note:<span class="op">**</span>&nbsp;In this chapter, <span class="bu">all</span> dataset problems implicitly use the standard integer<span class="op">-</span>valued mass table <span class="cf">for</span> the regular twenty amino acids. Examples sometimes use imaginary amino acids X <span class="kw">and</span> Z having respective integer masses <span class="dv">4</span> <span class="kw">and</span> <span class="fl">5.</span></span>
<span id="cb237-2382"><a href="#cb237-2382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2383"><a href="#cb237-2383" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-2384"><a href="#cb237-2384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2385"><a href="#cb237-2385" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2386"><a href="#cb237-2386" aria-hidden="true" tabindex="-1"></a><span class="dv">57</span> <span class="dv">71</span> <span class="dv">154</span> <span class="dv">185</span> <span class="dv">301</span> <span class="dv">332</span> <span class="dv">415</span> <span class="dv">429</span> <span class="dv">486</span></span>
<span id="cb237-2387"><a href="#cb237-2387" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2388"><a href="#cb237-2388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2389"><a href="#cb237-2389" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-2390"><a href="#cb237-2390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2391"><a href="#cb237-2391" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2392"><a href="#cb237-2392" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">57</span>:G</span>
<span id="cb237-2393"><a href="#cb237-2393" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">71</span>:A</span>
<span id="cb237-2394"><a href="#cb237-2394" aria-hidden="true" tabindex="-1"></a><span class="dv">57</span><span class="op">-&gt;</span><span class="dv">154</span>:P</span>
<span id="cb237-2395"><a href="#cb237-2395" aria-hidden="true" tabindex="-1"></a><span class="dv">57</span><span class="op">-&gt;</span><span class="dv">185</span>:K</span>
<span id="cb237-2396"><a href="#cb237-2396" aria-hidden="true" tabindex="-1"></a><span class="dv">71</span><span class="op">-&gt;</span><span class="dv">185</span>:N</span>
<span id="cb237-2397"><a href="#cb237-2397" aria-hidden="true" tabindex="-1"></a><span class="dv">154</span><span class="op">-&gt;</span><span class="dv">301</span>:F</span>
<span id="cb237-2398"><a href="#cb237-2398" aria-hidden="true" tabindex="-1"></a><span class="dv">185</span><span class="op">-&gt;</span><span class="dv">332</span>:F</span>
<span id="cb237-2399"><a href="#cb237-2399" aria-hidden="true" tabindex="-1"></a><span class="dv">301</span><span class="op">-&gt;</span><span class="dv">415</span>:N</span>
<span id="cb237-2400"><a href="#cb237-2400" aria-hidden="true" tabindex="-1"></a><span class="dv">301</span><span class="op">-&gt;</span><span class="dv">429</span>:K</span>
<span id="cb237-2401"><a href="#cb237-2401" aria-hidden="true" tabindex="-1"></a><span class="dv">332</span><span class="op">-&gt;</span><span class="dv">429</span>:P</span>
<span id="cb237-2402"><a href="#cb237-2402" aria-hidden="true" tabindex="-1"></a><span class="dv">415</span><span class="op">-&gt;</span><span class="dv">486</span>:A</span>
<span id="cb237-2403"><a href="#cb237-2403" aria-hidden="true" tabindex="-1"></a><span class="dv">429</span><span class="op">-&gt;</span><span class="dv">486</span>:G</span>
<span id="cb237-2404"><a href="#cb237-2404" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2405"><a href="#cb237-2405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2406"><a href="#cb237-2406" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-2407"><a href="#cb237-2407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2408"><a href="#cb237-2408" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-2409"><a href="#cb237-2409" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb237-2410"><a href="#cb237-2410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2411"><a href="#cb237-2411" aria-hidden="true" tabindex="-1"></a><span class="co"># Amino acid weights dictionary</span></span>
<span id="cb237-2412"><a href="#cb237-2412" aria-hidden="true" tabindex="-1"></a>amino_acid_weights <span class="op">=</span> {</span>
<span id="cb237-2413"><a href="#cb237-2413" aria-hidden="true" tabindex="-1"></a>    <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'V'</span>: <span class="dv">99</span>,</span>
<span id="cb237-2414"><a href="#cb237-2414" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>,</span>
<span id="cb237-2415"><a href="#cb237-2415" aria-hidden="true" tabindex="-1"></a>    <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb237-2416"><a href="#cb237-2416" aria-hidden="true" tabindex="-1"></a>    <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'Y'</span>: <span class="dv">163</span>, <span class="st">'W'</span>: <span class="dv">186</span></span>
<span id="cb237-2417"><a href="#cb237-2417" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb237-2418"><a href="#cb237-2418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2419"><a href="#cb237-2419" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spectrum_graph(masses):</span>
<span id="cb237-2420"><a href="#cb237-2420" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reverse mapping of weights to amino acids</span></span>
<span id="cb237-2421"><a href="#cb237-2421" aria-hidden="true" tabindex="-1"></a>    weight_to_amino_acid <span class="op">=</span> {weight: aa <span class="cf">for</span> aa, weight <span class="kw">in</span> amino_acid_weights.items()}</span>
<span id="cb237-2422"><a href="#cb237-2422" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-2423"><a href="#cb237-2423" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb237-2424"><a href="#cb237-2424" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-2425"><a href="#cb237-2425" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create graph based on mass differences</span></span>
<span id="cb237-2426"><a href="#cb237-2426" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(masses)):</span>
<span id="cb237-2427"><a href="#cb237-2427" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(masses)):</span>
<span id="cb237-2428"><a href="#cb237-2428" aria-hidden="true" tabindex="-1"></a>            difference <span class="op">=</span> masses[j] <span class="op">-</span> masses[i]</span>
<span id="cb237-2429"><a href="#cb237-2429" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> difference <span class="kw">in</span> weight_to_amino_acid:</span>
<span id="cb237-2430"><a href="#cb237-2430" aria-hidden="true" tabindex="-1"></a>                graph[masses[i]].append({<span class="st">"n"</span>: masses[j], <span class="st">"l"</span>: weight_to_amino_acid[difference]})</span>
<span id="cb237-2431"><a href="#cb237-2431" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-2432"><a href="#cb237-2432" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb237-2433"><a href="#cb237-2433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2434"><a href="#cb237-2434" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-2435"><a href="#cb237-2435" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"57 71 154 185 301 332 415 429 486"</span></span>
<span id="cb237-2436"><a href="#cb237-2436" aria-hidden="true" tabindex="-1"></a>masses <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, sample_input.split()))</span>
<span id="cb237-2437"><a href="#cb237-2437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2438"><a href="#cb237-2438" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the spectrum graph</span></span>
<span id="cb237-2439"><a href="#cb237-2439" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> start_mass, edges <span class="kw">in</span> spectrum_graph(masses).items():</span>
<span id="cb237-2440"><a href="#cb237-2440" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb237-2441"><a href="#cb237-2441" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>start_mass<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>edge[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>edge[<span class="st">'l'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb237-2442"><a href="#cb237-2442" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2443"><a href="#cb237-2443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2444"><a href="#cb237-2444" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement MotifEnumeration</span></span>
<span id="cb237-2445"><a href="#cb237-2445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2446"><a href="#cb237-2446" aria-hidden="true" tabindex="-1"></a>Implanted Motif Problem. Implement MotifEnumeration (shown above) to find <span class="bu">all</span> (k, d)<span class="op">-</span>motifs <span class="kw">in</span> a collection of strings.</span>
<span id="cb237-2447"><a href="#cb237-2447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2448"><a href="#cb237-2448" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>d<span class="op">*</span>, followed by a collection of strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb237-2449"><a href="#cb237-2449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2450"><a href="#cb237-2450" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All (<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>d<span class="op">*</span>)<span class="op">-</span>motifs in&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb237-2451"><a href="#cb237-2451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2452"><a href="#cb237-2452" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-2453"><a href="#cb237-2453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2454"><a href="#cb237-2454" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2455"><a href="#cb237-2455" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">1</span></span>
<span id="cb237-2456"><a href="#cb237-2456" aria-hidden="true" tabindex="-1"></a>ATTTGGC</span>
<span id="cb237-2457"><a href="#cb237-2457" aria-hidden="true" tabindex="-1"></a>TGCCTTA</span>
<span id="cb237-2458"><a href="#cb237-2458" aria-hidden="true" tabindex="-1"></a>CGGTATC</span>
<span id="cb237-2459"><a href="#cb237-2459" aria-hidden="true" tabindex="-1"></a>GAAAATT</span>
<span id="cb237-2460"><a href="#cb237-2460" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2461"><a href="#cb237-2461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2462"><a href="#cb237-2462" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-2463"><a href="#cb237-2463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2464"><a href="#cb237-2464" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2465"><a href="#cb237-2465" aria-hidden="true" tabindex="-1"></a>ATA ATT GTT TTT</span>
<span id="cb237-2466"><a href="#cb237-2466" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2467"><a href="#cb237-2467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2468"><a href="#cb237-2468" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-2469"><a href="#cb237-2469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2470"><a href="#cb237-2470" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-2471"><a href="#cb237-2471" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Iterator</span>
<span id="cb237-2472"><a href="#cb237-2472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2473"><a href="#cb237-2473" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-2474"><a href="#cb237-2474" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb237-2475"><a href="#cb237-2475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2476"><a href="#cb237-2476" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb237-2477"><a href="#cb237-2477" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb237-2478"><a href="#cb237-2478" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb237-2479"><a href="#cb237-2479" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb237-2480"><a href="#cb237-2480" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb237-2481"><a href="#cb237-2481" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb237-2482"><a href="#cb237-2482" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-2483"><a href="#cb237-2483" aria-hidden="true" tabindex="-1"></a>    neighbor_set <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb237-2484"><a href="#cb237-2484" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance):</span>
<span id="cb237-2485"><a href="#cb237-2485" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], neighbor) <span class="op">&lt;</span> max_distance:</span>
<span id="cb237-2486"><a href="#cb237-2486" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb237-2487"><a href="#cb237-2487" aria-hidden="true" tabindex="-1"></a>                neighbor_set.add(nucleotide <span class="op">+</span> neighbor)</span>
<span id="cb237-2488"><a href="#cb237-2488" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-2489"><a href="#cb237-2489" aria-hidden="true" tabindex="-1"></a>            neighbor_set.add(sequence[<span class="dv">0</span>] <span class="op">+</span> neighbor)</span>
<span id="cb237-2490"><a href="#cb237-2490" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbor_set</span>
<span id="cb237-2491"><a href="#cb237-2491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2492"><a href="#cb237-2492" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-2493"><a href="#cb237-2493" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-2494"><a href="#cb237-2494" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb237-2495"><a href="#cb237-2495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2496"><a href="#cb237-2496" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_kmers(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb237-2497"><a href="#cb237-2497" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(kmer <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length))</span>
<span id="cb237-2498"><a href="#cb237-2498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2499"><a href="#cb237-2499" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> contains_approximate_match(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb237-2500"><a href="#cb237-2500" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">any</span>(calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_distance </span>
<span id="cb237-2501"><a href="#cb237-2501" aria-hidden="true" tabindex="-1"></a>               <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb237-2502"><a href="#cb237-2502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2503"><a href="#cb237-2503" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enumerate_motifs(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb237-2504"><a href="#cb237-2504" aria-hidden="true" tabindex="-1"></a>    motif_patterns <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb237-2505"><a href="#cb237-2505" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> get_all_kmers(dna_sequences, kmer_length):</span>
<span id="cb237-2506"><a href="#cb237-2506" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor_kmer <span class="kw">in</span> generate_neighbors(kmer, max_distance):</span>
<span id="cb237-2507"><a href="#cb237-2507" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(contains_approximate_match(neighbor_kmer, sequence, max_distance) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences):</span>
<span id="cb237-2508"><a href="#cb237-2508" aria-hidden="true" tabindex="-1"></a>                motif_patterns.add(neighbor_kmer)</span>
<span id="cb237-2509"><a href="#cb237-2509" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> motif_patterns</span>
<span id="cb237-2510"><a href="#cb237-2510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2511"><a href="#cb237-2511" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-2512"><a href="#cb237-2512" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-2513"><a href="#cb237-2513" aria-hidden="true" tabindex="-1"></a><span class="st">3 1</span></span>
<span id="cb237-2514"><a href="#cb237-2514" aria-hidden="true" tabindex="-1"></a><span class="st">ATTTGGC</span></span>
<span id="cb237-2515"><a href="#cb237-2515" aria-hidden="true" tabindex="-1"></a><span class="st">TGCCTTA</span></span>
<span id="cb237-2516"><a href="#cb237-2516" aria-hidden="true" tabindex="-1"></a><span class="st">CGGTATC</span></span>
<span id="cb237-2517"><a href="#cb237-2517" aria-hidden="true" tabindex="-1"></a><span class="st">GAAAATT</span></span>
<span id="cb237-2518"><a href="#cb237-2518" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-2519"><a href="#cb237-2519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2520"><a href="#cb237-2520" aria-hidden="true" tabindex="-1"></a>input_params, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-2521"><a href="#cb237-2521" aria-hidden="true" tabindex="-1"></a>kmer_length, max_distance <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_params.split())</span>
<span id="cb237-2522"><a href="#cb237-2522" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(enumerate_motifs(dna_sequences, kmer_length, max_distance)))</span>
<span id="cb237-2523"><a href="#cb237-2523" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2524"><a href="#cb237-2524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2525"><a href="#cb237-2525" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Median String</span></span>
<span id="cb237-2526"><a href="#cb237-2526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2527"><a href="#cb237-2527" aria-hidden="true" tabindex="-1"></a>Median String Problem, Find a median string.</span>
<span id="cb237-2528"><a href="#cb237-2528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2529"><a href="#cb237-2529" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and a collection of strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb237-2530"><a href="#cb237-2530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2531"><a href="#cb237-2531" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>&nbsp;that minimizes&nbsp;<span class="op">*</span>d<span class="op">*</span>(<span class="op">*</span>Pattern<span class="op">*</span>,&nbsp;<span class="op">*</span>Dna<span class="op">*</span>) over all&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb237-2532"><a href="#cb237-2532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2533"><a href="#cb237-2533" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-2534"><a href="#cb237-2534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2535"><a href="#cb237-2535" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2536"><a href="#cb237-2536" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span>
<span id="cb237-2537"><a href="#cb237-2537" aria-hidden="true" tabindex="-1"></a>AAATTGACGCAT</span>
<span id="cb237-2538"><a href="#cb237-2538" aria-hidden="true" tabindex="-1"></a>GACGACCACGTT</span>
<span id="cb237-2539"><a href="#cb237-2539" aria-hidden="true" tabindex="-1"></a>CGTCAGCGCCTG</span>
<span id="cb237-2540"><a href="#cb237-2540" aria-hidden="true" tabindex="-1"></a>GCTGAGCACCGG</span>
<span id="cb237-2541"><a href="#cb237-2541" aria-hidden="true" tabindex="-1"></a>AGTACGGGACAG</span>
<span id="cb237-2542"><a href="#cb237-2542" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2543"><a href="#cb237-2543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2544"><a href="#cb237-2544" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-2545"><a href="#cb237-2545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2546"><a href="#cb237-2546" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2547"><a href="#cb237-2547" aria-hidden="true" tabindex="-1"></a>ACG</span>
<span id="cb237-2548"><a href="#cb237-2548" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2549"><a href="#cb237-2549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2550"><a href="#cb237-2550" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-2551"><a href="#cb237-2551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2552"><a href="#cb237-2552" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-2553"><a href="#cb237-2553" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb237-2554"><a href="#cb237-2554" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb237-2555"><a href="#cb237-2555" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb237-2556"><a href="#cb237-2556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2557"><a href="#cb237-2557" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-2558"><a href="#cb237-2558" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-2559"><a href="#cb237-2559" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb237-2560"><a href="#cb237-2560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2561"><a href="#cb237-2561" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-2562"><a href="#cb237-2562" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(nucleotides) <span class="cf">for</span> nucleotides <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb237-2563"><a href="#cb237-2563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2564"><a href="#cb237-2564" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-2565"><a href="#cb237-2565" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(nucleotide1 <span class="op">!=</span> nucleotide2 <span class="cf">for</span> nucleotide1, nucleotide2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb237-2566"><a href="#cb237-2566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2567"><a href="#cb237-2567" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-2568"><a href="#cb237-2568" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(substring, pattern) <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb237-2569"><a href="#cb237-2569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2570"><a href="#cb237-2570" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_total_distance(pattern: <span class="bu">str</span>, dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-2571"><a href="#cb237-2571" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, sequence) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences)</span>
<span id="cb237-2572"><a href="#cb237-2572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2573"><a href="#cb237-2573" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_median_string(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-2574"><a href="#cb237-2574" aria-hidden="true" tabindex="-1"></a>    min_distance <span class="op">=</span> math.inf</span>
<span id="cb237-2575"><a href="#cb237-2575" aria-hidden="true" tabindex="-1"></a>    median_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb237-2576"><a href="#cb237-2576" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-2577"><a href="#cb237-2577" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb237-2578"><a href="#cb237-2578" aria-hidden="true" tabindex="-1"></a>        current_distance <span class="op">=</span> calculate_total_distance(kmer, dna_sequences)</span>
<span id="cb237-2579"><a href="#cb237-2579" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_distance <span class="op">&lt;</span> min_distance:</span>
<span id="cb237-2580"><a href="#cb237-2580" aria-hidden="true" tabindex="-1"></a>            min_distance <span class="op">=</span> current_distance</span>
<span id="cb237-2581"><a href="#cb237-2581" aria-hidden="true" tabindex="-1"></a>            median_kmer <span class="op">=</span> kmer</span>
<span id="cb237-2582"><a href="#cb237-2582" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-2583"><a href="#cb237-2583" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> median_kmer</span>
<span id="cb237-2584"><a href="#cb237-2584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2585"><a href="#cb237-2585" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-2586"><a href="#cb237-2586" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-2587"><a href="#cb237-2587" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb237-2588"><a href="#cb237-2588" aria-hidden="true" tabindex="-1"></a><span class="st">AAATTGACGCAT</span></span>
<span id="cb237-2589"><a href="#cb237-2589" aria-hidden="true" tabindex="-1"></a><span class="st">GACGACCACGTT</span></span>
<span id="cb237-2590"><a href="#cb237-2590" aria-hidden="true" tabindex="-1"></a><span class="st">CGTCAGCGCCTG</span></span>
<span id="cb237-2591"><a href="#cb237-2591" aria-hidden="true" tabindex="-1"></a><span class="st">GCTGAGCACCGG</span></span>
<span id="cb237-2592"><a href="#cb237-2592" aria-hidden="true" tabindex="-1"></a><span class="st">AGTACGGGACAG</span></span>
<span id="cb237-2593"><a href="#cb237-2593" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-2594"><a href="#cb237-2594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2595"><a href="#cb237-2595" aria-hidden="true" tabindex="-1"></a>kmer_length, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-2596"><a href="#cb237-2596" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_median_string(dna_sequences, <span class="bu">int</span>(kmer_length))</span>
<span id="cb237-2597"><a href="#cb237-2597" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb237-2598"><a href="#cb237-2598" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2599"><a href="#cb237-2599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2600"><a href="#cb237-2600" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Profile-most Probable k-mer in a String</span></span>
<span id="cb237-2601"><a href="#cb237-2601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2602"><a href="#cb237-2602" aria-hidden="true" tabindex="-1"></a>Profile<span class="op">-</span>most Probable&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer Problem, Find a Profile<span class="op">-</span>most probable k<span class="op">-</span>mer <span class="kw">in</span> a string.</span>
<span id="cb237-2603"><a href="#cb237-2603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2604"><a href="#cb237-2604" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>, an integer&nbsp;<span class="op">*</span>k<span class="op">*</span>, <span class="kw">and</span> a <span class="dv">4</span> ×&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;matrix&nbsp;<span class="op">*</span>Profile<span class="op">*</span>.</span>
<span id="cb237-2605"><a href="#cb237-2605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2606"><a href="#cb237-2606" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A&nbsp;<span class="op">*</span>Profile<span class="op">*-</span>most probable&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer in&nbsp;<span class="op">*</span>Text<span class="op">*</span>. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb237-2607"><a href="#cb237-2607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2608"><a href="#cb237-2608" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-2609"><a href="#cb237-2609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2610"><a href="#cb237-2610" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2611"><a href="#cb237-2611" aria-hidden="true" tabindex="-1"></a>ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT</span>
<span id="cb237-2612"><a href="#cb237-2612" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb237-2613"><a href="#cb237-2613" aria-hidden="true" tabindex="-1"></a><span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.3</span> <span class="fl">0.2</span> <span class="fl">0.3</span></span>
<span id="cb237-2614"><a href="#cb237-2614" aria-hidden="true" tabindex="-1"></a><span class="fl">0.4</span> <span class="fl">0.3</span> <span class="fl">0.1</span> <span class="fl">0.5</span> <span class="fl">0.1</span></span>
<span id="cb237-2615"><a href="#cb237-2615" aria-hidden="true" tabindex="-1"></a><span class="fl">0.3</span> <span class="fl">0.3</span> <span class="fl">0.5</span> <span class="fl">0.2</span> <span class="fl">0.4</span></span>
<span id="cb237-2616"><a href="#cb237-2616" aria-hidden="true" tabindex="-1"></a><span class="fl">0.1</span> <span class="fl">0.2</span> <span class="fl">0.1</span> <span class="fl">0.1</span> <span class="fl">0.2</span></span>
<span id="cb237-2617"><a href="#cb237-2617" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2618"><a href="#cb237-2618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2619"><a href="#cb237-2619" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-2620"><a href="#cb237-2620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2621"><a href="#cb237-2621" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2622"><a href="#cb237-2622" aria-hidden="true" tabindex="-1"></a>CCGAG</span>
<span id="cb237-2623"><a href="#cb237-2623" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2624"><a href="#cb237-2624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2625"><a href="#cb237-2625" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-2626"><a href="#cb237-2626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2627"><a href="#cb237-2627" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-2628"><a href="#cb237-2628" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb237-2629"><a href="#cb237-2629" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb237-2630"><a href="#cb237-2630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2631"><a href="#cb237-2631" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-2632"><a href="#cb237-2632" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-2633"><a href="#cb237-2633" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb237-2634"><a href="#cb237-2634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2635"><a href="#cb237-2635" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_profile_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile_matrix: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-2636"><a href="#cb237-2636" aria-hidden="true" tabindex="-1"></a>    nucleotide_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb237-2637"><a href="#cb237-2637" aria-hidden="true" tabindex="-1"></a>    max_probability <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb237-2638"><a href="#cb237-2638" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb237-2639"><a href="#cb237-2639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2640"><a href="#cb237-2640" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length):</span>
<span id="cb237-2641"><a href="#cb237-2641" aria-hidden="true" tabindex="-1"></a>        kmer_probability <span class="op">=</span> math.prod(profile_matrix[nucleotide_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb237-2642"><a href="#cb237-2642" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb237-2643"><a href="#cb237-2643" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb237-2644"><a href="#cb237-2644" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb237-2645"><a href="#cb237-2645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2646"><a href="#cb237-2646" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb237-2647"><a href="#cb237-2647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2648"><a href="#cb237-2648" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-2649"><a href="#cb237-2649" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-2650"><a href="#cb237-2650" aria-hidden="true" tabindex="-1"></a><span class="st">ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT</span></span>
<span id="cb237-2651"><a href="#cb237-2651" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb237-2652"><a href="#cb237-2652" aria-hidden="true" tabindex="-1"></a><span class="st">0.2 0.2 0.3 0.2 0.3</span></span>
<span id="cb237-2653"><a href="#cb237-2653" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.3 0.1 0.5 0.1</span></span>
<span id="cb237-2654"><a href="#cb237-2654" aria-hidden="true" tabindex="-1"></a><span class="st">0.3 0.3 0.5 0.2 0.4</span></span>
<span id="cb237-2655"><a href="#cb237-2655" aria-hidden="true" tabindex="-1"></a><span class="st">0.1 0.2 0.1 0.1 0.2</span></span>
<span id="cb237-2656"><a href="#cb237-2656" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-2657"><a href="#cb237-2657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2658"><a href="#cb237-2658" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, <span class="op">*</span>profile_rows <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-2659"><a href="#cb237-2659" aria-hidden="true" tabindex="-1"></a>profile_matrix <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">float</span>, row.split())) <span class="cf">for</span> row <span class="kw">in</span> profile_rows]</span>
<span id="cb237-2660"><a href="#cb237-2660" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_profile_most_probable_kmer(dna_sequence, <span class="bu">int</span>(kmer_length), profile_matrix)</span>
<span id="cb237-2661"><a href="#cb237-2661" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb237-2662"><a href="#cb237-2662" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2663"><a href="#cb237-2663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2664"><a href="#cb237-2664" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement GreedyMotifSearch</span></span>
<span id="cb237-2665"><a href="#cb237-2665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2666"><a href="#cb237-2666" aria-hidden="true" tabindex="-1"></a> Implement, GreedyMotifSearch.</span>
<span id="cb237-2667"><a href="#cb237-2667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2668"><a href="#cb237-2668" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>t<span class="op">*</span>, followed by a collection of strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb237-2669"><a href="#cb237-2669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2670"><a href="#cb237-2670" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A collection of strings&nbsp;<span class="op">*</span>BestMotifs<span class="op">*</span>&nbsp;resulting <span class="im">from</span> running&nbsp;<span class="op">*</span>GreedyMotifSearch<span class="op">*</span>(<span class="op">*</span>Dna<span class="op">*</span>,&nbsp;<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>t<span class="op">*</span>). If at <span class="bu">any</span> step you find more than one&nbsp;<span class="op">*</span>Profile<span class="op">*-</span>most probable&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer <span class="kw">in</span> a given string, use the one occurring first.</span>
<span id="cb237-2671"><a href="#cb237-2671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2672"><a href="#cb237-2672" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-2673"><a href="#cb237-2673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2674"><a href="#cb237-2674" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2675"><a href="#cb237-2675" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">5</span></span>
<span id="cb237-2676"><a href="#cb237-2676" aria-hidden="true" tabindex="-1"></a>GGCGTTCAGGCA</span>
<span id="cb237-2677"><a href="#cb237-2677" aria-hidden="true" tabindex="-1"></a>AAGAATCAGTCA</span>
<span id="cb237-2678"><a href="#cb237-2678" aria-hidden="true" tabindex="-1"></a>CAAGGAGTTCGC</span>
<span id="cb237-2679"><a href="#cb237-2679" aria-hidden="true" tabindex="-1"></a>CACGTCAATCAC</span>
<span id="cb237-2680"><a href="#cb237-2680" aria-hidden="true" tabindex="-1"></a>CAATAATATTCG</span>
<span id="cb237-2681"><a href="#cb237-2681" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2682"><a href="#cb237-2682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2683"><a href="#cb237-2683" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-2684"><a href="#cb237-2684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2685"><a href="#cb237-2685" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2686"><a href="#cb237-2686" aria-hidden="true" tabindex="-1"></a>CAG</span>
<span id="cb237-2687"><a href="#cb237-2687" aria-hidden="true" tabindex="-1"></a>CAG</span>
<span id="cb237-2688"><a href="#cb237-2688" aria-hidden="true" tabindex="-1"></a>CAA</span>
<span id="cb237-2689"><a href="#cb237-2689" aria-hidden="true" tabindex="-1"></a>CAA</span>
<span id="cb237-2690"><a href="#cb237-2690" aria-hidden="true" tabindex="-1"></a>CAA</span>
<span id="cb237-2691"><a href="#cb237-2691" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2692"><a href="#cb237-2692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2693"><a href="#cb237-2693" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-2694"><a href="#cb237-2694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2695"><a href="#cb237-2695" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-2696"><a href="#cb237-2696" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb237-2697"><a href="#cb237-2697" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb237-2698"><a href="#cb237-2698" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb237-2699"><a href="#cb237-2699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2700"><a href="#cb237-2700" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-2701"><a href="#cb237-2701" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-2702"><a href="#cb237-2702" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb237-2703"><a href="#cb237-2703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2704"><a href="#cb237-2704" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-2705"><a href="#cb237-2705" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb237-2706"><a href="#cb237-2706" aria-hidden="true" tabindex="-1"></a>    max_probability: <span class="bu">float</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb237-2707"><a href="#cb237-2707" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb237-2708"><a href="#cb237-2708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2709"><a href="#cb237-2709" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length):</span>
<span id="cb237-2710"><a href="#cb237-2710" aria-hidden="true" tabindex="-1"></a>        kmer_probability: <span class="bu">float</span> <span class="op">=</span> math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb237-2711"><a href="#cb237-2711" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb237-2712"><a href="#cb237-2712" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb237-2713"><a href="#cb237-2713" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb237-2714"><a href="#cb237-2714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2715"><a href="#cb237-2715" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb237-2716"><a href="#cb237-2716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2717"><a href="#cb237-2717" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(sequences: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb237-2718"><a href="#cb237-2718" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb237-2719"><a href="#cb237-2719" aria-hidden="true" tabindex="-1"></a>    profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> [[] <span class="cf">for</span> _ <span class="kw">in</span> nucleotides]</span>
<span id="cb237-2720"><a href="#cb237-2720" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(nucleotides):</span>
<span id="cb237-2721"><a href="#cb237-2721" aria-hidden="true" tabindex="-1"></a>        profile[i] <span class="op">=</span> [</span>
<span id="cb237-2722"><a href="#cb237-2722" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> sequences) <span class="op">+</span> pseudocount) <span class="op">/</span> <span class="bu">len</span>(sequences)</span>
<span id="cb237-2723"><a href="#cb237-2723" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequences[<span class="dv">0</span>]))</span>
<span id="cb237-2724"><a href="#cb237-2724" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb237-2725"><a href="#cb237-2725" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb237-2726"><a href="#cb237-2726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2727"><a href="#cb237-2727" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-2728"><a href="#cb237-2728" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-2729"><a href="#cb237-2729" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>])):</span>
<span id="cb237-2730"><a href="#cb237-2730" aria-hidden="true" tabindex="-1"></a>        column: List[<span class="bu">str</span>] <span class="op">=</span> [motif[i] <span class="cf">for</span> motif <span class="kw">in</span> motifs]</span>
<span id="cb237-2731"><a href="#cb237-2731" aria-hidden="true" tabindex="-1"></a>        most_common: <span class="bu">str</span> <span class="op">=</span> Counter(column).most_common()[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb237-2732"><a href="#cb237-2732" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">sum</span>(nucleotide <span class="op">!=</span> most_common <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb237-2733"><a href="#cb237-2733" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb237-2734"><a href="#cb237-2734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2735"><a href="#cb237-2735" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-2736"><a href="#cb237-2736" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [seq[:kmer_length] <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb237-2737"><a href="#cb237-2737" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb237-2738"><a href="#cb237-2738" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb237-2739"><a href="#cb237-2739" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(dna_sequences)):</span>
<span id="cb237-2740"><a href="#cb237-2740" aria-hidden="true" tabindex="-1"></a>            current_profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount<span class="op">=</span>pseudocount)</span>
<span id="cb237-2741"><a href="#cb237-2741" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(dna_sequences[i], kmer_length, current_profile))</span>
<span id="cb237-2742"><a href="#cb237-2742" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb237-2743"><a href="#cb237-2743" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb237-2744"><a href="#cb237-2744" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb237-2745"><a href="#cb237-2745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2746"><a href="#cb237-2746" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-2747"><a href="#cb237-2747" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-2748"><a href="#cb237-2748" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb237-2749"><a href="#cb237-2749" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb237-2750"><a href="#cb237-2750" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb237-2751"><a href="#cb237-2751" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb237-2752"><a href="#cb237-2752" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb237-2753"><a href="#cb237-2753" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb237-2754"><a href="#cb237-2754" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-2755"><a href="#cb237-2755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2756"><a href="#cb237-2756" aria-hidden="true" tabindex="-1"></a>ints, <span class="op">*</span>dna <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-2757"><a href="#cb237-2757" aria-hidden="true" tabindex="-1"></a>k, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, ints.split())</span>
<span id="cb237-2758"><a href="#cb237-2758" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna, k)</span>
<span id="cb237-2759"><a href="#cb237-2759" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-2760"><a href="#cb237-2760" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2761"><a href="#cb237-2761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2762"><a href="#cb237-2762" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement GreedyMotifSearch with Pseudocounts</span></span>
<span id="cb237-2763"><a href="#cb237-2763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2764"><a href="#cb237-2764" aria-hidden="true" tabindex="-1"></a>Implement.&nbsp;<span class="op">*</span>GreedyMotifSearch<span class="op">*</span>&nbsp;with Pseudocounts.</span>
<span id="cb237-2765"><a href="#cb237-2765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2766"><a href="#cb237-2766" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>t<span class="op">*</span>, followed by a collection of strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb237-2767"><a href="#cb237-2767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2768"><a href="#cb237-2768" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A collection of strings&nbsp;<span class="op">*</span>BestMotifs<span class="op">*</span>&nbsp;resulting <span class="im">from</span> running&nbsp;<span class="op">*</span>GreedyMotifSearch<span class="op">*</span>(<span class="op">*</span>Dna<span class="op">*</span>,&nbsp;<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>t<span class="op">*</span>) <span class="cf">with</span> pseudocounts. If at <span class="bu">any</span> step you find more than one&nbsp;<span class="op">*</span>Profile<span class="op">*-</span>most probable&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer <span class="kw">in</span> a given string, use the one occurring first.</span>
<span id="cb237-2769"><a href="#cb237-2769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2770"><a href="#cb237-2770" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-2771"><a href="#cb237-2771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2772"><a href="#cb237-2772" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2773"><a href="#cb237-2773" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">5</span></span>
<span id="cb237-2774"><a href="#cb237-2774" aria-hidden="true" tabindex="-1"></a>GGCGTTCAGGCA</span>
<span id="cb237-2775"><a href="#cb237-2775" aria-hidden="true" tabindex="-1"></a>AAGAATCAGTCA</span>
<span id="cb237-2776"><a href="#cb237-2776" aria-hidden="true" tabindex="-1"></a>CAAGGAGTTCGC</span>
<span id="cb237-2777"><a href="#cb237-2777" aria-hidden="true" tabindex="-1"></a>CACGTCAATCAC</span>
<span id="cb237-2778"><a href="#cb237-2778" aria-hidden="true" tabindex="-1"></a>CAATAATATTCG</span>
<span id="cb237-2779"><a href="#cb237-2779" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2780"><a href="#cb237-2780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2781"><a href="#cb237-2781" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-2782"><a href="#cb237-2782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2783"><a href="#cb237-2783" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2784"><a href="#cb237-2784" aria-hidden="true" tabindex="-1"></a>TTC</span>
<span id="cb237-2785"><a href="#cb237-2785" aria-hidden="true" tabindex="-1"></a>ATC</span>
<span id="cb237-2786"><a href="#cb237-2786" aria-hidden="true" tabindex="-1"></a>TTC</span>
<span id="cb237-2787"><a href="#cb237-2787" aria-hidden="true" tabindex="-1"></a>ATC</span>
<span id="cb237-2788"><a href="#cb237-2788" aria-hidden="true" tabindex="-1"></a>TTC</span>
<span id="cb237-2789"><a href="#cb237-2789" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2790"><a href="#cb237-2790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2791"><a href="#cb237-2791" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-2792"><a href="#cb237-2792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2793"><a href="#cb237-2793" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-2794"><a href="#cb237-2794" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb237-2795"><a href="#cb237-2795" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb237-2796"><a href="#cb237-2796" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb237-2797"><a href="#cb237-2797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2798"><a href="#cb237-2798" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-2799"><a href="#cb237-2799" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-2800"><a href="#cb237-2800" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb237-2801"><a href="#cb237-2801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2802"><a href="#cb237-2802" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-2803"><a href="#cb237-2803" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb237-2804"><a href="#cb237-2804" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb237-2805"><a href="#cb237-2805" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb237-2806"><a href="#cb237-2806" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][position] </span>
<span id="cb237-2807"><a href="#cb237-2807" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">for</span> position, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb237-2808"><a href="#cb237-2808" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb237-2809"><a href="#cb237-2809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2810"><a href="#cb237-2810" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb237-2811"><a href="#cb237-2811" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb237-2812"><a href="#cb237-2812" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb237-2813"><a href="#cb237-2813" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb237-2814"><a href="#cb237-2814" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-2815"><a href="#cb237-2815" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb237-2816"><a href="#cb237-2816" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> motif_count </span>
<span id="cb237-2817"><a href="#cb237-2817" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb237-2818"><a href="#cb237-2818" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb237-2819"><a href="#cb237-2819" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb237-2820"><a href="#cb237-2820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2821"><a href="#cb237-2821" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-2822"><a href="#cb237-2822" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb237-2823"><a href="#cb237-2823" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb237-2824"><a href="#cb237-2824" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb237-2825"><a href="#cb237-2825" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb237-2826"><a href="#cb237-2826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2827"><a href="#cb237-2827" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-2828"><a href="#cb237-2828" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [sequence[:kmer_length] <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences]</span>
<span id="cb237-2829"><a href="#cb237-2829" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-2830"><a href="#cb237-2830" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb237-2831"><a href="#cb237-2831" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb237-2832"><a href="#cb237-2832" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences[<span class="dv">1</span>:]:</span>
<span id="cb237-2833"><a href="#cb237-2833" aria-hidden="true" tabindex="-1"></a>            profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount)</span>
<span id="cb237-2834"><a href="#cb237-2834" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(sequence, kmer_length, profile))</span>
<span id="cb237-2835"><a href="#cb237-2835" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-2836"><a href="#cb237-2836" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb237-2837"><a href="#cb237-2837" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb237-2838"><a href="#cb237-2838" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-2839"><a href="#cb237-2839" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb237-2840"><a href="#cb237-2840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2841"><a href="#cb237-2841" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-2842"><a href="#cb237-2842" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-2843"><a href="#cb237-2843" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb237-2844"><a href="#cb237-2844" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb237-2845"><a href="#cb237-2845" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb237-2846"><a href="#cb237-2846" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb237-2847"><a href="#cb237-2847" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb237-2848"><a href="#cb237-2848" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb237-2849"><a href="#cb237-2849" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-2850"><a href="#cb237-2850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2851"><a href="#cb237-2851" aria-hidden="true" tabindex="-1"></a>k_value, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb237-2852"><a href="#cb237-2852" aria-hidden="true" tabindex="-1"></a>k_value <span class="op">=</span> <span class="bu">int</span>(k_value)</span>
<span id="cb237-2853"><a href="#cb237-2853" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna_sequences, k_value, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb237-2854"><a href="#cb237-2854" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-2855"><a href="#cb237-2855" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2856"><a href="#cb237-2856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2857"><a href="#cb237-2857" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement RandomizedMotifSearch</span></span>
<span id="cb237-2858"><a href="#cb237-2858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2859"><a href="#cb237-2859" aria-hidden="true" tabindex="-1"></a>Implement&nbsp;<span class="op">*</span>RandomizedMotifSearch<span class="op">*</span>.</span>
<span id="cb237-2860"><a href="#cb237-2860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2861"><a href="#cb237-2861" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Positive integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>t<span class="op">*</span>, followed by a collection of strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb237-2862"><a href="#cb237-2862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2863"><a href="#cb237-2863" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A collection&nbsp;<span class="op">*</span>BestMotifs<span class="op">*</span>&nbsp;resulting <span class="im">from</span> running&nbsp;<span class="op">*</span>RandomizedMotifSearch<span class="op">*</span>(<span class="op">*</span>Dna<span class="op">*</span>,&nbsp;<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>t<span class="op">*</span>) <span class="dv">1000</span> times. Remember to use pseudocounts<span class="op">!</span></span>
<span id="cb237-2864"><a href="#cb237-2864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2865"><a href="#cb237-2865" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-2866"><a href="#cb237-2866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2867"><a href="#cb237-2867" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2868"><a href="#cb237-2868" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="dv">5</span></span>
<span id="cb237-2869"><a href="#cb237-2869" aria-hidden="true" tabindex="-1"></a>CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA</span>
<span id="cb237-2870"><a href="#cb237-2870" aria-hidden="true" tabindex="-1"></a>GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG</span>
<span id="cb237-2871"><a href="#cb237-2871" aria-hidden="true" tabindex="-1"></a>TAGTACCGAGACCGAAAGAAGTATACAGGCGT</span>
<span id="cb237-2872"><a href="#cb237-2872" aria-hidden="true" tabindex="-1"></a>TAGATCAAGTTTCAGGTGCACGTCGGTGAACC</span>
<span id="cb237-2873"><a href="#cb237-2873" aria-hidden="true" tabindex="-1"></a>AATCCACCAGCTCCACGTGCAATGTTGGCCTA</span>
<span id="cb237-2874"><a href="#cb237-2874" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2875"><a href="#cb237-2875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2876"><a href="#cb237-2876" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-2877"><a href="#cb237-2877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2878"><a href="#cb237-2878" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2879"><a href="#cb237-2879" aria-hidden="true" tabindex="-1"></a>AACGGCCA</span>
<span id="cb237-2880"><a href="#cb237-2880" aria-hidden="true" tabindex="-1"></a>AAGTGCCA</span>
<span id="cb237-2881"><a href="#cb237-2881" aria-hidden="true" tabindex="-1"></a>TAGTACCG</span>
<span id="cb237-2882"><a href="#cb237-2882" aria-hidden="true" tabindex="-1"></a>AAGTTTCA</span>
<span id="cb237-2883"><a href="#cb237-2883" aria-hidden="true" tabindex="-1"></a>ACGTGCAA</span>
<span id="cb237-2884"><a href="#cb237-2884" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2885"><a href="#cb237-2885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2886"><a href="#cb237-2886" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-2887"><a href="#cb237-2887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2888"><a href="#cb237-2888" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-2889"><a href="#cb237-2889" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Callable</span>
<span id="cb237-2890"><a href="#cb237-2890" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb237-2891"><a href="#cb237-2891" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> randint</span>
<span id="cb237-2892"><a href="#cb237-2892" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb237-2893"><a href="#cb237-2893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2894"><a href="#cb237-2894" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-2895"><a href="#cb237-2895" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [sequence[i:i<span class="op">+</span>kmer_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-2896"><a href="#cb237-2896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2897"><a href="#cb237-2897" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-2898"><a href="#cb237-2898" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb237-2899"><a href="#cb237-2899" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb237-2900"><a href="#cb237-2900" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb237-2901"><a href="#cb237-2901" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][j] <span class="cf">for</span> j, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb237-2902"><a href="#cb237-2902" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb237-2903"><a href="#cb237-2903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2904"><a href="#cb237-2904" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb237-2905"><a href="#cb237-2905" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb237-2906"><a href="#cb237-2906" aria-hidden="true" tabindex="-1"></a>    profile <span class="op">=</span> []</span>
<span id="cb237-2907"><a href="#cb237-2907" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb237-2908"><a href="#cb237-2908" aria-hidden="true" tabindex="-1"></a>        profile.append([</span>
<span id="cb237-2909"><a href="#cb237-2909" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (<span class="bu">len</span>(motifs) <span class="op">+</span> <span class="dv">4</span> <span class="op">*</span> pseudocount)</span>
<span id="cb237-2910"><a href="#cb237-2910" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>]))</span>
<span id="cb237-2911"><a href="#cb237-2911" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb237-2912"><a href="#cb237-2912" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb237-2913"><a href="#cb237-2913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2914"><a href="#cb237-2914" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-2915"><a href="#cb237-2915" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb237-2916"><a href="#cb237-2916" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb237-2917"><a href="#cb237-2917" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb237-2918"><a href="#cb237-2918" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb237-2919"><a href="#cb237-2919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2920"><a href="#cb237-2920" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-2921"><a href="#cb237-2921" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb237-2922"><a href="#cb237-2922" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start : start <span class="op">+</span> kmer_length]</span>
<span id="cb237-2923"><a href="#cb237-2923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2924"><a href="#cb237-2924" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_motifs(profile: List[List[<span class="bu">float</span>]], dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-2925"><a href="#cb237-2925" aria-hidden="true" tabindex="-1"></a>    kmer_length <span class="op">=</span> <span class="bu">len</span>(profile[<span class="dv">0</span>])</span>
<span id="cb237-2926"><a href="#cb237-2926" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [find_most_probable_kmer(seq, kmer_length, profile) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb237-2927"><a href="#cb237-2927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2928"><a href="#cb237-2928" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> randomized_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-2929"><a href="#cb237-2929" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb237-2930"><a href="#cb237-2930" aria-hidden="true" tabindex="-1"></a>    best_score <span class="op">=</span> math.inf</span>
<span id="cb237-2931"><a href="#cb237-2931" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-2932"><a href="#cb237-2932" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb237-2933"><a href="#cb237-2933" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb237-2934"><a href="#cb237-2934" aria-hidden="true" tabindex="-1"></a>        motifs <span class="op">=</span> find_motifs(profile, dna_sequences)</span>
<span id="cb237-2935"><a href="#cb237-2935" aria-hidden="true" tabindex="-1"></a>        current_score <span class="op">=</span> calculate_score(motifs)</span>
<span id="cb237-2936"><a href="#cb237-2936" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-2937"><a href="#cb237-2937" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_score <span class="op">&gt;=</span> best_score:</span>
<span id="cb237-2938"><a href="#cb237-2938" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> best_score, motifs</span>
<span id="cb237-2939"><a href="#cb237-2939" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-2940"><a href="#cb237-2940" aria-hidden="true" tabindex="-1"></a>        best_score <span class="op">=</span> current_score</span>
<span id="cb237-2941"><a href="#cb237-2941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2942"><a href="#cb237-2942" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-2943"><a href="#cb237-2943" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb237-2944"><a href="#cb237-2944" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-2945"><a href="#cb237-2945" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb237-2946"><a href="#cb237-2946" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb237-2947"><a href="#cb237-2947" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb237-2948"><a href="#cb237-2948" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb237-2949"><a href="#cb237-2949" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-2950"><a href="#cb237-2950" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb237-2951"><a href="#cb237-2951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2952"><a href="#cb237-2952" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-2953"><a href="#cb237-2953" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-2954"><a href="#cb237-2954" aria-hidden="true" tabindex="-1"></a><span class="st">8 5</span></span>
<span id="cb237-2955"><a href="#cb237-2955" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA</span></span>
<span id="cb237-2956"><a href="#cb237-2956" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG</span></span>
<span id="cb237-2957"><a href="#cb237-2957" aria-hidden="true" tabindex="-1"></a><span class="st">TAGTACCGAGACCGAAAGAAGTATACAGGCGT</span></span>
<span id="cb237-2958"><a href="#cb237-2958" aria-hidden="true" tabindex="-1"></a><span class="st">TAGATCAAGTTTCAGGTGCACGTCGGTGAACC</span></span>
<span id="cb237-2959"><a href="#cb237-2959" aria-hidden="true" tabindex="-1"></a><span class="st">AATCCACCAGCTCCACGTGCAATGTTGGCCTA</span></span>
<span id="cb237-2960"><a href="#cb237-2960" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-2961"><a href="#cb237-2961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2962"><a href="#cb237-2962" aria-hidden="true" tabindex="-1"></a>kmer_length, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb237-2963"><a href="#cb237-2963" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb237-2964"><a href="#cb237-2964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2965"><a href="#cb237-2965" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(randomized_motif_search, <span class="dv">1000</span>, dna_sequences, kmer_length)</span>
<span id="cb237-2966"><a href="#cb237-2966" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-2967"><a href="#cb237-2967" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2968"><a href="#cb237-2968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2969"><a href="#cb237-2969" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement GibbsSampler</span></span>
<span id="cb237-2970"><a href="#cb237-2970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2971"><a href="#cb237-2971" aria-hidden="true" tabindex="-1"></a>Implement,&nbsp;<span class="op">*</span>GibbsSampler<span class="op">*</span>.</span>
<span id="cb237-2972"><a href="#cb237-2972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2973"><a href="#cb237-2973" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>t<span class="op">*</span>, and&nbsp;<span class="op">*</span>N<span class="op">*</span>, followed by a collection of strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb237-2974"><a href="#cb237-2974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2975"><a href="#cb237-2975" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The strings&nbsp;<span class="op">*</span>BestMotifs<span class="op">*</span>&nbsp;resulting <span class="im">from</span> running&nbsp;<span class="op">*</span>GibbsSampler<span class="op">*</span>(<span class="op">*</span>Dna<span class="op">*</span>,&nbsp;<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>t<span class="op">*</span>,&nbsp;<span class="op">*</span>N<span class="op">*</span>) <span class="cf">with</span> <span class="dv">20</span> random starts. Remember to use pseudocounts<span class="op">!</span></span>
<span id="cb237-2976"><a href="#cb237-2976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2977"><a href="#cb237-2977" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-2978"><a href="#cb237-2978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2979"><a href="#cb237-2979" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2980"><a href="#cb237-2980" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="dv">5</span> <span class="dv">100</span></span>
<span id="cb237-2981"><a href="#cb237-2981" aria-hidden="true" tabindex="-1"></a>CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA</span>
<span id="cb237-2982"><a href="#cb237-2982" aria-hidden="true" tabindex="-1"></a>GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG</span>
<span id="cb237-2983"><a href="#cb237-2983" aria-hidden="true" tabindex="-1"></a>TAGTACCGAGACCGAAAGAAGTATACAGGCGT</span>
<span id="cb237-2984"><a href="#cb237-2984" aria-hidden="true" tabindex="-1"></a>TAGATCAAGTTTCAGGTGCACGTCGGTGAACC</span>
<span id="cb237-2985"><a href="#cb237-2985" aria-hidden="true" tabindex="-1"></a>AATCCACCAGCTCCACGTGCAATGTTGGCCTA</span>
<span id="cb237-2986"><a href="#cb237-2986" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2987"><a href="#cb237-2987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2988"><a href="#cb237-2988" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-2989"><a href="#cb237-2989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2990"><a href="#cb237-2990" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2991"><a href="#cb237-2991" aria-hidden="true" tabindex="-1"></a>TCTCGGGG</span>
<span id="cb237-2992"><a href="#cb237-2992" aria-hidden="true" tabindex="-1"></a>CCAAGGTG</span>
<span id="cb237-2993"><a href="#cb237-2993" aria-hidden="true" tabindex="-1"></a>TACAGGCG</span>
<span id="cb237-2994"><a href="#cb237-2994" aria-hidden="true" tabindex="-1"></a>TTCAGGTG</span>
<span id="cb237-2995"><a href="#cb237-2995" aria-hidden="true" tabindex="-1"></a>TCCACGTG</span>
<span id="cb237-2996"><a href="#cb237-2996" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-2997"><a href="#cb237-2997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-2998"><a href="#cb237-2998" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-2999"><a href="#cb237-2999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3000"><a href="#cb237-3000" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-3001"><a href="#cb237-3001" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, Tuple, Callable</span>
<span id="cb237-3002"><a href="#cb237-3002" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb237-3003"><a href="#cb237-3003" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb237-3004"><a href="#cb237-3004" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb237-3005"><a href="#cb237-3005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3006"><a href="#cb237-3006" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-3007"><a href="#cb237-3007" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-3008"><a href="#cb237-3008" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb237-3009"><a href="#cb237-3009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3010"><a href="#cb237-3010" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb237-3011"><a href="#cb237-3011" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb237-3012"><a href="#cb237-3012" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb237-3013"><a href="#cb237-3013" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb237-3014"><a href="#cb237-3014" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-3015"><a href="#cb237-3015" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb237-3016"><a href="#cb237-3016" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (motif_count <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>pseudocount)</span>
<span id="cb237-3017"><a href="#cb237-3017" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb237-3018"><a href="#cb237-3018" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb237-3019"><a href="#cb237-3019" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb237-3020"><a href="#cb237-3020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3021"><a href="#cb237-3021" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-3022"><a href="#cb237-3022" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb237-3023"><a href="#cb237-3023" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb237-3024"><a href="#cb237-3024" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb237-3025"><a href="#cb237-3025" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb237-3026"><a href="#cb237-3026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3027"><a href="#cb237-3027" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-3028"><a href="#cb237-3028" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb237-3029"><a href="#cb237-3029" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb237-3030"><a href="#cb237-3030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3031"><a href="#cb237-3031" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-3032"><a href="#cb237-3032" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb237-3033"><a href="#cb237-3033" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb237-3034"><a href="#cb237-3034" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb237-3035"><a href="#cb237-3035" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb237-3036"><a href="#cb237-3036" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb237-3037"><a href="#cb237-3037" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb237-3038"><a href="#cb237-3038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3039"><a href="#cb237-3039" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_probabilities(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb237-3040"><a href="#cb237-3040" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb237-3041"><a href="#cb237-3041" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb237-3042"><a href="#cb237-3042" aria-hidden="true" tabindex="-1"></a>        math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb237-3043"><a href="#cb237-3043" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length)</span>
<span id="cb237-3044"><a href="#cb237-3044" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb237-3045"><a href="#cb237-3045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3046"><a href="#cb237-3046" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-3047"><a href="#cb237-3047" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> calculate_kmer_probabilities(sequence, kmer_length, profile)</span>
<span id="cb237-3048"><a href="#cb237-3048" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.choices(<span class="bu">range</span>(<span class="bu">len</span>(probabilities)), probabilities)[<span class="dv">0</span>]</span>
<span id="cb237-3049"><a href="#cb237-3049" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb237-3050"><a href="#cb237-3050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3051"><a href="#cb237-3051" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gibbs_sampler(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, num_iterations: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-3052"><a href="#cb237-3052" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb237-3053"><a href="#cb237-3053" aria-hidden="true" tabindex="-1"></a>    best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb237-3054"><a href="#cb237-3054" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_iterations):</span>
<span id="cb237-3055"><a href="#cb237-3055" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(dna_sequences) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb237-3056"><a href="#cb237-3056" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs[:i] <span class="op">+</span> motifs[i <span class="op">+</span> <span class="dv">1</span> :], pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb237-3057"><a href="#cb237-3057" aria-hidden="true" tabindex="-1"></a>        motifs[i] <span class="op">=</span> select_random_kmer(dna_sequences[i], kmer_length, profile)</span>
<span id="cb237-3058"><a href="#cb237-3058" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb237-3059"><a href="#cb237-3059" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb237-3060"><a href="#cb237-3060" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> calculate_score(best_motifs), best_motifs</span>
<span id="cb237-3061"><a href="#cb237-3061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3062"><a href="#cb237-3062" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-3063"><a href="#cb237-3063" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-3064"><a href="#cb237-3064" aria-hidden="true" tabindex="-1"></a><span class="st">8 5 100</span></span>
<span id="cb237-3065"><a href="#cb237-3065" aria-hidden="true" tabindex="-1"></a><span class="st">TCTCGGGG</span></span>
<span id="cb237-3066"><a href="#cb237-3066" aria-hidden="true" tabindex="-1"></a><span class="st">CCAAGGTG</span></span>
<span id="cb237-3067"><a href="#cb237-3067" aria-hidden="true" tabindex="-1"></a><span class="st">TACAGGCG</span></span>
<span id="cb237-3068"><a href="#cb237-3068" aria-hidden="true" tabindex="-1"></a><span class="st">TTCAGGTG</span></span>
<span id="cb237-3069"><a href="#cb237-3069" aria-hidden="true" tabindex="-1"></a><span class="st">TCCACGTG</span></span>
<span id="cb237-3070"><a href="#cb237-3070" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-3071"><a href="#cb237-3071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3072"><a href="#cb237-3072" aria-hidden="true" tabindex="-1"></a>kmer_length, num_sequences, num_iterations, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb237-3073"><a href="#cb237-3073" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb237-3074"><a href="#cb237-3074" aria-hidden="true" tabindex="-1"></a>num_iterations <span class="op">=</span> <span class="bu">int</span>(num_iterations)</span>
<span id="cb237-3075"><a href="#cb237-3075" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(gibbs_sampler, <span class="dv">20</span>, dna_sequences, kmer_length, num_iterations)</span>
<span id="cb237-3076"><a href="#cb237-3076" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-3077"><a href="#cb237-3077" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3078"><a href="#cb237-3078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3079"><a href="#cb237-3079" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement DistanceBetweenPatternAndStrings</span></span>
<span id="cb237-3080"><a href="#cb237-3080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3081"><a href="#cb237-3081" aria-hidden="true" tabindex="-1"></a>Compute DistanceBetweenPatternAndStrings. <span class="op">*</span>Find the distance between a pattern <span class="kw">and</span> a <span class="bu">set</span> of strings.<span class="op">*</span>.</span>
<span id="cb237-3082"><a href="#cb237-3082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3083"><a href="#cb237-3083" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[DNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>&nbsp;and a collection of DNA strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb237-3084"><a href="#cb237-3084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3085"><a href="#cb237-3085" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>DistanceBetweenPatternAndStrings<span class="op">*</span>(<span class="op">*</span>Pattern<span class="op">*</span>,&nbsp;<span class="op">*</span>Dna<span class="op">*</span>).</span>
<span id="cb237-3086"><a href="#cb237-3086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3087"><a href="#cb237-3087" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-3088"><a href="#cb237-3088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3089"><a href="#cb237-3089" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3090"><a href="#cb237-3090" aria-hidden="true" tabindex="-1"></a>AAA</span>
<span id="cb237-3091"><a href="#cb237-3091" aria-hidden="true" tabindex="-1"></a>TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</span>
<span id="cb237-3092"><a href="#cb237-3092" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3093"><a href="#cb237-3093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3094"><a href="#cb237-3094" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-3095"><a href="#cb237-3095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3096"><a href="#cb237-3096" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3097"><a href="#cb237-3097" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb237-3098"><a href="#cb237-3098" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3099"><a href="#cb237-3099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3100"><a href="#cb237-3100" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-3101"><a href="#cb237-3101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3102"><a href="#cb237-3102" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-3103"><a href="#cb237-3103" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator</span>
<span id="cb237-3104"><a href="#cb237-3104" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb237-3105"><a href="#cb237-3105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3106"><a href="#cb237-3106" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-3107"><a href="#cb237-3107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-3108"><a href="#cb237-3108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb237-3109"><a href="#cb237-3109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3110"><a href="#cb237-3110" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-3111"><a href="#cb237-3111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb237-3112"><a href="#cb237-3112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3113"><a href="#cb237-3113" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-3114"><a href="#cb237-3114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(kmer, pattern) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb237-3115"><a href="#cb237-3115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3116"><a href="#cb237-3116" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_pattern_distance_to_strings(pattern: <span class="bu">str</span>, dna_strings: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-3117"><a href="#cb237-3117" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, dna_string) <span class="cf">for</span> dna_string <span class="kw">in</span> dna_strings)</span>
<span id="cb237-3118"><a href="#cb237-3118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3119"><a href="#cb237-3119" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-3120"><a href="#cb237-3120" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-3121"><a href="#cb237-3121" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb237-3122"><a href="#cb237-3122" aria-hidden="true" tabindex="-1"></a><span class="st">TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</span></span>
<span id="cb237-3123"><a href="#cb237-3123" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-3124"><a href="#cb237-3124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3125"><a href="#cb237-3125" aria-hidden="true" tabindex="-1"></a>pattern, dna_strings_raw <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-3126"><a href="#cb237-3126" aria-hidden="true" tabindex="-1"></a>dna_strings <span class="op">=</span> dna_strings_raw.split()</span>
<span id="cb237-3127"><a href="#cb237-3127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3128"><a href="#cb237-3128" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_pattern_distance_to_strings(pattern, dna_strings)</span>
<span id="cb237-3129"><a href="#cb237-3129" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb237-3130"><a href="#cb237-3130" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3131"><a href="#cb237-3131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3132"><a href="#cb237-3132" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the k-mer Composition of a String</span></span>
<span id="cb237-3133"><a href="#cb237-3133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3134"><a href="#cb237-3134" aria-hidden="true" tabindex="-1"></a>String Composition Problem, Generate the k<span class="op">-</span>mer composition of a string.</span>
<span id="cb237-3135"><a href="#cb237-3135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3136"><a href="#cb237-3136" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and a string&nbsp;<span class="op">*</span>Text<span class="op">*</span>.</span>
<span id="cb237-3137"><a href="#cb237-3137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3138"><a href="#cb237-3138" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>Composition__k<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>) (the&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers can be provided <span class="kw">in</span> <span class="bu">any</span> order).</span>
<span id="cb237-3139"><a href="#cb237-3139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3140"><a href="#cb237-3140" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-3141"><a href="#cb237-3141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3142"><a href="#cb237-3142" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3143"><a href="#cb237-3143" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb237-3144"><a href="#cb237-3144" aria-hidden="true" tabindex="-1"></a>CAATCCAAC</span>
<span id="cb237-3145"><a href="#cb237-3145" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3146"><a href="#cb237-3146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3147"><a href="#cb237-3147" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-3148"><a href="#cb237-3148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3149"><a href="#cb237-3149" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3150"><a href="#cb237-3150" aria-hidden="true" tabindex="-1"></a>CAATC</span>
<span id="cb237-3151"><a href="#cb237-3151" aria-hidden="true" tabindex="-1"></a>AATCC</span>
<span id="cb237-3152"><a href="#cb237-3152" aria-hidden="true" tabindex="-1"></a>ATCCA</span>
<span id="cb237-3153"><a href="#cb237-3153" aria-hidden="true" tabindex="-1"></a>TCCAA</span>
<span id="cb237-3154"><a href="#cb237-3154" aria-hidden="true" tabindex="-1"></a>CCAAC</span>
<span id="cb237-3155"><a href="#cb237-3155" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3156"><a href="#cb237-3156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3157"><a href="#cb237-3157" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-3158"><a href="#cb237-3158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3159"><a href="#cb237-3159" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-3160"><a href="#cb237-3160" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator</span>
<span id="cb237-3161"><a href="#cb237-3161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3162"><a href="#cb237-3162" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb237-3163"><a href="#cb237-3163" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-3164"><a href="#cb237-3164" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i:i <span class="op">+</span> kmer_length]</span>
<span id="cb237-3165"><a href="#cb237-3165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3166"><a href="#cb237-3166" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-3167"><a href="#cb237-3167" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb237-3168"><a href="#cb237-3168" aria-hidden="true" tabindex="-1"></a><span class="st">CAATCCAAC</span></span>
<span id="cb237-3169"><a href="#cb237-3169" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-3170"><a href="#cb237-3170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3171"><a href="#cb237-3171" aria-hidden="true" tabindex="-1"></a>input_lines: <span class="bu">list</span>[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-3172"><a href="#cb237-3172" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb237-3173"><a href="#cb237-3173" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb237-3174"><a href="#cb237-3174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3175"><a href="#cb237-3175" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequence, kmer_length):</span>
<span id="cb237-3176"><a href="#cb237-3176" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(kmer)</span>
<span id="cb237-3177"><a href="#cb237-3177" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3178"><a href="#cb237-3178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3179"><a href="#cb237-3179" aria-hidden="true" tabindex="-1"></a><span class="co"># Reconstruct a String from its Genome Path</span></span>
<span id="cb237-3180"><a href="#cb237-3180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3181"><a href="#cb237-3181" aria-hidden="true" tabindex="-1"></a>String Spelled by a Genome Path Problem, Find the string spelled by a genome path.</span>
<span id="cb237-3182"><a href="#cb237-3182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3183"><a href="#cb237-3183" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers&nbsp;<span class="op">*</span>Pattern1,..., Patternn<span class="op">*</span>&nbsp;such that the last&nbsp;<span class="op">*</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">*</span>&nbsp;symbols of&nbsp;<span class="op">*</span>Patterni<span class="op">*</span>&nbsp;are equal to the first&nbsp;<span class="op">*</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">*</span>&nbsp;symbols of&nbsp;<span class="op">*</span>Patterni<span class="op">+</span><span class="dv">1</span><span class="op">*</span>&nbsp;for&nbsp;<span class="op">*</span>i<span class="op">*</span>&nbsp;from <span class="dv">1</span> to n<span class="op">-</span><span class="fl">1.</span></span>
<span id="cb237-3184"><a href="#cb237-3184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3185"><a href="#cb237-3185" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;of length&nbsp;<span class="op">*</span>k<span class="op">+</span>n<span class="op">-</span><span class="dv">1</span><span class="op">*</span>&nbsp;where the&nbsp;<span class="op">*</span>i<span class="op">*-</span>th&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer in&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;is equal to&nbsp;<span class="op">*</span>Patterni<span class="op">*</span>&nbsp;for all&nbsp;<span class="op">*</span>i<span class="op">*</span>.</span>
<span id="cb237-3186"><a href="#cb237-3186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3187"><a href="#cb237-3187" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-3188"><a href="#cb237-3188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3189"><a href="#cb237-3189" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3190"><a href="#cb237-3190" aria-hidden="true" tabindex="-1"></a>ACCGA</span>
<span id="cb237-3191"><a href="#cb237-3191" aria-hidden="true" tabindex="-1"></a>CCGAA</span>
<span id="cb237-3192"><a href="#cb237-3192" aria-hidden="true" tabindex="-1"></a>CGAAG</span>
<span id="cb237-3193"><a href="#cb237-3193" aria-hidden="true" tabindex="-1"></a>GAAGC</span>
<span id="cb237-3194"><a href="#cb237-3194" aria-hidden="true" tabindex="-1"></a>AAGCT</span>
<span id="cb237-3195"><a href="#cb237-3195" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3196"><a href="#cb237-3196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3197"><a href="#cb237-3197" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-3198"><a href="#cb237-3198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3199"><a href="#cb237-3199" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3200"><a href="#cb237-3200" aria-hidden="true" tabindex="-1"></a>ACCGAAGCT</span>
<span id="cb237-3201"><a href="#cb237-3201" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3202"><a href="#cb237-3202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3203"><a href="#cb237-3203" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-3204"><a href="#cb237-3204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3205"><a href="#cb237-3205" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-3206"><a href="#cb237-3206" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb237-3207"><a href="#cb237-3207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3208"><a href="#cb237-3208" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_dna_sequence(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-3209"><a href="#cb237-3209" aria-hidden="true" tabindex="-1"></a>    reconstructed_sequence: <span class="bu">str</span> <span class="op">=</span> kmers[<span class="dv">0</span>]</span>
<span id="cb237-3210"><a href="#cb237-3210" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(kmers)):</span>
<span id="cb237-3211"><a href="#cb237-3211" aria-hidden="true" tabindex="-1"></a>        reconstructed_sequence <span class="op">+=</span> kmers[i][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb237-3212"><a href="#cb237-3212" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_sequence</span>
<span id="cb237-3213"><a href="#cb237-3213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3214"><a href="#cb237-3214" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-3215"><a href="#cb237-3215" aria-hidden="true" tabindex="-1"></a><span class="st">ACCGA</span></span>
<span id="cb237-3216"><a href="#cb237-3216" aria-hidden="true" tabindex="-1"></a><span class="st">CCGAA</span></span>
<span id="cb237-3217"><a href="#cb237-3217" aria-hidden="true" tabindex="-1"></a><span class="st">CGAAG</span></span>
<span id="cb237-3218"><a href="#cb237-3218" aria-hidden="true" tabindex="-1"></a><span class="st">GAAGC</span></span>
<span id="cb237-3219"><a href="#cb237-3219" aria-hidden="true" tabindex="-1"></a><span class="st">AAGCT</span></span>
<span id="cb237-3220"><a href="#cb237-3220" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-3221"><a href="#cb237-3221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3222"><a href="#cb237-3222" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-3223"><a href="#cb237-3223" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_dna_sequence(kmer_list))</span>
<span id="cb237-3224"><a href="#cb237-3224" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3225"><a href="#cb237-3225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3226"><a href="#cb237-3226" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the Overlap Graph of a Collection of k-mers</span></span>
<span id="cb237-3227"><a href="#cb237-3227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3228"><a href="#cb237-3228" aria-hidden="true" tabindex="-1"></a>Overlap Graph Problem, Construct the overlap graph of a collection of k<span class="op">-</span>mers.</span>
<span id="cb237-3229"><a href="#cb237-3229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3230"><a href="#cb237-3230" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>&nbsp;of&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers.</span>
<span id="cb237-3231"><a href="#cb237-3231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3232"><a href="#cb237-3232" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The overlap graph&nbsp;<span class="op">*</span>Overlap<span class="op">*</span>(<span class="op">*</span>Patterns<span class="op">*</span>), <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb237-3233"><a href="#cb237-3233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3234"><a href="#cb237-3234" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-3235"><a href="#cb237-3235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3236"><a href="#cb237-3236" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3237"><a href="#cb237-3237" aria-hidden="true" tabindex="-1"></a>ATGCG</span>
<span id="cb237-3238"><a href="#cb237-3238" aria-hidden="true" tabindex="-1"></a>GCATG</span>
<span id="cb237-3239"><a href="#cb237-3239" aria-hidden="true" tabindex="-1"></a>CATGC</span>
<span id="cb237-3240"><a href="#cb237-3240" aria-hidden="true" tabindex="-1"></a>AGGCA</span>
<span id="cb237-3241"><a href="#cb237-3241" aria-hidden="true" tabindex="-1"></a>GGCAT</span>
<span id="cb237-3242"><a href="#cb237-3242" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3243"><a href="#cb237-3243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3244"><a href="#cb237-3244" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-3245"><a href="#cb237-3245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3246"><a href="#cb237-3246" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3247"><a href="#cb237-3247" aria-hidden="true" tabindex="-1"></a>GCATG <span class="op">-&gt;</span> CATGC</span>
<span id="cb237-3248"><a href="#cb237-3248" aria-hidden="true" tabindex="-1"></a>CATGC <span class="op">-&gt;</span> ATGCG</span>
<span id="cb237-3249"><a href="#cb237-3249" aria-hidden="true" tabindex="-1"></a>AGGCA <span class="op">-&gt;</span> GGCAT</span>
<span id="cb237-3250"><a href="#cb237-3250" aria-hidden="true" tabindex="-1"></a>GGCAT <span class="op">-&gt;</span> GCATG</span>
<span id="cb237-3251"><a href="#cb237-3251" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3252"><a href="#cb237-3252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3253"><a href="#cb237-3253" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-3254"><a href="#cb237-3254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3255"><a href="#cb237-3255" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-3256"><a href="#cb237-3256" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb237-3257"><a href="#cb237-3257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3258"><a href="#cb237-3258" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> overlap_graph(patterns: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>]]:</span>
<span id="cb237-3259"><a href="#cb237-3259" aria-hidden="true" tabindex="-1"></a>    adj_list <span class="op">=</span> []</span>
<span id="cb237-3260"><a href="#cb237-3260" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb237-3261"><a href="#cb237-3261" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb237-3262"><a href="#cb237-3262" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">!=</span> j <span class="kw">and</span> patterns[i][<span class="dv">1</span>:] <span class="op">==</span> patterns[j][:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb237-3263"><a href="#cb237-3263" aria-hidden="true" tabindex="-1"></a>                adj_list.append((patterns[i], patterns[j]))</span>
<span id="cb237-3264"><a href="#cb237-3264" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adj_list</span>
<span id="cb237-3265"><a href="#cb237-3265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3266"><a href="#cb237-3266" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-3267"><a href="#cb237-3267" aria-hidden="true" tabindex="-1"></a><span class="st">ATGCG</span></span>
<span id="cb237-3268"><a href="#cb237-3268" aria-hidden="true" tabindex="-1"></a><span class="st">GCATG</span></span>
<span id="cb237-3269"><a href="#cb237-3269" aria-hidden="true" tabindex="-1"></a><span class="st">CATGC</span></span>
<span id="cb237-3270"><a href="#cb237-3270" aria-hidden="true" tabindex="-1"></a><span class="st">AGGCA</span></span>
<span id="cb237-3271"><a href="#cb237-3271" aria-hidden="true" tabindex="-1"></a><span class="st">GGCAT</span></span>
<span id="cb237-3272"><a href="#cb237-3272" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-3273"><a href="#cb237-3273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3274"><a href="#cb237-3274" aria-hidden="true" tabindex="-1"></a>Patterns: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-3275"><a href="#cb237-3275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3276"><a href="#cb237-3276" aria-hidden="true" tabindex="-1"></a>adj_list <span class="op">=</span> overlap_graph(Patterns)</span>
<span id="cb237-3277"><a href="#cb237-3277" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> adj_list:</span>
<span id="cb237-3278"><a href="#cb237-3278" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>edge[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span>edge[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb237-3279"><a href="#cb237-3279" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3280"><a href="#cb237-3280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3281"><a href="#cb237-3281" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the De Bruijn Graph of a String</span></span>
<span id="cb237-3282"><a href="#cb237-3282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3283"><a href="#cb237-3283" aria-hidden="true" tabindex="-1"></a>De Bruijn Graph <span class="im">from</span> a String Problem. Construct the de Bruijn graph of a string.</span>
<span id="cb237-3284"><a href="#cb237-3284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3285"><a href="#cb237-3285" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and a string&nbsp;<span class="op">*</span>Text<span class="op">*</span>.</span>
<span id="cb237-3286"><a href="#cb237-3286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3287"><a href="#cb237-3287" aria-hidden="true" tabindex="-1"></a>Return:<span class="op">*</span>DeBruijn__k<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>), <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb237-3288"><a href="#cb237-3288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3289"><a href="#cb237-3289" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-3290"><a href="#cb237-3290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3291"><a href="#cb237-3291" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3292"><a href="#cb237-3292" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb237-3293"><a href="#cb237-3293" aria-hidden="true" tabindex="-1"></a>AAGATTCTCTAC</span>
<span id="cb237-3294"><a href="#cb237-3294" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3295"><a href="#cb237-3295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3296"><a href="#cb237-3296" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-3297"><a href="#cb237-3297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3298"><a href="#cb237-3298" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3299"><a href="#cb237-3299" aria-hidden="true" tabindex="-1"></a>AAG <span class="op">-&gt;</span> AGA</span>
<span id="cb237-3300"><a href="#cb237-3300" aria-hidden="true" tabindex="-1"></a>AGA <span class="op">-&gt;</span> GAT</span>
<span id="cb237-3301"><a href="#cb237-3301" aria-hidden="true" tabindex="-1"></a>ATT <span class="op">-&gt;</span> TTC</span>
<span id="cb237-3302"><a href="#cb237-3302" aria-hidden="true" tabindex="-1"></a>CTA <span class="op">-&gt;</span> TAC</span>
<span id="cb237-3303"><a href="#cb237-3303" aria-hidden="true" tabindex="-1"></a>CTC <span class="op">-&gt;</span> TCT</span>
<span id="cb237-3304"><a href="#cb237-3304" aria-hidden="true" tabindex="-1"></a>GAT <span class="op">-&gt;</span> ATT</span>
<span id="cb237-3305"><a href="#cb237-3305" aria-hidden="true" tabindex="-1"></a>TCT <span class="op">-&gt;</span> CTA,CTC</span>
<span id="cb237-3306"><a href="#cb237-3306" aria-hidden="true" tabindex="-1"></a>TTC <span class="op">-&gt;</span> TCT</span>
<span id="cb237-3307"><a href="#cb237-3307" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3308"><a href="#cb237-3308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3309"><a href="#cb237-3309" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-3310"><a href="#cb237-3310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3311"><a href="#cb237-3311" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-3312"><a href="#cb237-3312" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> OrderedDict</span>
<span id="cb237-3313"><a href="#cb237-3313" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, OrderedDict <span class="im">as</span> OrderedDictType</span>
<span id="cb237-3314"><a href="#cb237-3314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3315"><a href="#cb237-3315" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]]:</span>
<span id="cb237-3316"><a href="#cb237-3316" aria-hidden="true" tabindex="-1"></a>    adjacency_list: OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]] <span class="op">=</span> OrderedDict()</span>
<span id="cb237-3317"><a href="#cb237-3317" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-3318"><a href="#cb237-3318" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">2</span>):</span>
<span id="cb237-3319"><a href="#cb237-3319" aria-hidden="true" tabindex="-1"></a>        adjacency_list[sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb237-3320"><a href="#cb237-3320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3321"><a href="#cb237-3321" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-3322"><a href="#cb237-3322" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb237-3323"><a href="#cb237-3323" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:i <span class="op">+</span> kmer_length]</span>
<span id="cb237-3324"><a href="#cb237-3324" aria-hidden="true" tabindex="-1"></a>        adjacency_list[prefix].add(suffix)</span>
<span id="cb237-3325"><a href="#cb237-3325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3326"><a href="#cb237-3326" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb237-3327"><a href="#cb237-3327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3328"><a href="#cb237-3328" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-3329"><a href="#cb237-3329" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb237-3330"><a href="#cb237-3330" aria-hidden="true" tabindex="-1"></a><span class="st">AAGATTCTCTAC</span></span>
<span id="cb237-3331"><a href="#cb237-3331" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-3332"><a href="#cb237-3332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3333"><a href="#cb237-3333" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-3334"><a href="#cb237-3334" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb237-3335"><a href="#cb237-3335" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb237-3336"><a href="#cb237-3336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3337"><a href="#cb237-3337" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(dna_sequence, kmer_length)</span>
<span id="cb237-3338"><a href="#cb237-3338" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb237-3339"><a href="#cb237-3339" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> neighbors:</span>
<span id="cb237-3340"><a href="#cb237-3340" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb237-3341"><a href="#cb237-3341" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3342"><a href="#cb237-3342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3343"><a href="#cb237-3343" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the De Bruijn Graph of a Collection of k-mers</span></span>
<span id="cb237-3344"><a href="#cb237-3344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3345"><a href="#cb237-3345" aria-hidden="true" tabindex="-1"></a>De Bruijn Graph from&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers Problem. Construct the de Bruijn graph <span class="im">from</span> a collection of k<span class="op">-</span>mers.</span>
<span id="cb237-3346"><a href="#cb237-3346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3347"><a href="#cb237-3347" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection of&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>.</span>
<span id="cb237-3348"><a href="#cb237-3348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3349"><a href="#cb237-3349" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The de Bruijn graph&nbsp;<span class="op">*</span>DeBruijn<span class="op">*</span>(<span class="op">*</span>Patterns<span class="op">*</span>), <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb237-3350"><a href="#cb237-3350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3351"><a href="#cb237-3351" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-3352"><a href="#cb237-3352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3353"><a href="#cb237-3353" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3354"><a href="#cb237-3354" aria-hidden="true" tabindex="-1"></a>GAGG</span>
<span id="cb237-3355"><a href="#cb237-3355" aria-hidden="true" tabindex="-1"></a>CAGG</span>
<span id="cb237-3356"><a href="#cb237-3356" aria-hidden="true" tabindex="-1"></a>GGGG</span>
<span id="cb237-3357"><a href="#cb237-3357" aria-hidden="true" tabindex="-1"></a>GGGA</span>
<span id="cb237-3358"><a href="#cb237-3358" aria-hidden="true" tabindex="-1"></a>CAGG</span>
<span id="cb237-3359"><a href="#cb237-3359" aria-hidden="true" tabindex="-1"></a>AGGG</span>
<span id="cb237-3360"><a href="#cb237-3360" aria-hidden="true" tabindex="-1"></a>GGAG</span>
<span id="cb237-3361"><a href="#cb237-3361" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3362"><a href="#cb237-3362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3363"><a href="#cb237-3363" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-3364"><a href="#cb237-3364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3365"><a href="#cb237-3365" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3366"><a href="#cb237-3366" aria-hidden="true" tabindex="-1"></a>GAG <span class="op">-&gt;</span> AGG</span>
<span id="cb237-3367"><a href="#cb237-3367" aria-hidden="true" tabindex="-1"></a>CAG <span class="op">-&gt;</span> AGG,AGG</span>
<span id="cb237-3368"><a href="#cb237-3368" aria-hidden="true" tabindex="-1"></a>GGG <span class="op">-&gt;</span> GGG,GGA</span>
<span id="cb237-3369"><a href="#cb237-3369" aria-hidden="true" tabindex="-1"></a>AGG <span class="op">-&gt;</span> GGG</span>
<span id="cb237-3370"><a href="#cb237-3370" aria-hidden="true" tabindex="-1"></a>GGA <span class="op">-&gt;</span> GAG</span>
<span id="cb237-3371"><a href="#cb237-3371" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3372"><a href="#cb237-3372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3373"><a href="#cb237-3373" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-3374"><a href="#cb237-3374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3375"><a href="#cb237-3375" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-3376"><a href="#cb237-3376" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb237-3377"><a href="#cb237-3377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3378"><a href="#cb237-3378" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-3379"><a href="#cb237-3379" aria-hidden="true" tabindex="-1"></a>    adjacency_list: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb237-3380"><a href="#cb237-3380" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb237-3381"><a href="#cb237-3381" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb237-3382"><a href="#cb237-3382" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb237-3383"><a href="#cb237-3383" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_list:</span>
<span id="cb237-3384"><a href="#cb237-3384" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb237-3385"><a href="#cb237-3385" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-3386"><a href="#cb237-3386" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix].append(suffix)</span>
<span id="cb237-3387"><a href="#cb237-3387" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb237-3388"><a href="#cb237-3388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3389"><a href="#cb237-3389" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-3390"><a href="#cb237-3390" aria-hidden="true" tabindex="-1"></a><span class="st">GAGG</span></span>
<span id="cb237-3391"><a href="#cb237-3391" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb237-3392"><a href="#cb237-3392" aria-hidden="true" tabindex="-1"></a><span class="st">GGGG</span></span>
<span id="cb237-3393"><a href="#cb237-3393" aria-hidden="true" tabindex="-1"></a><span class="st">GGGA</span></span>
<span id="cb237-3394"><a href="#cb237-3394" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb237-3395"><a href="#cb237-3395" aria-hidden="true" tabindex="-1"></a><span class="st">AGGG</span></span>
<span id="cb237-3396"><a href="#cb237-3396" aria-hidden="true" tabindex="-1"></a><span class="st">GGAG</span></span>
<span id="cb237-3397"><a href="#cb237-3397" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-3398"><a href="#cb237-3398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3399"><a href="#cb237-3399" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-3400"><a href="#cb237-3400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3401"><a href="#cb237-3401" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmer_list)</span>
<span id="cb237-3402"><a href="#cb237-3402" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb237-3403"><a href="#cb237-3403" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb237-3404"><a href="#cb237-3404" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3405"><a href="#cb237-3405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3406"><a href="#cb237-3406" aria-hidden="true" tabindex="-1"></a><span class="co"># Find an Eulerian Cycle in a Graph</span></span>
<span id="cb237-3407"><a href="#cb237-3407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3408"><a href="#cb237-3408" aria-hidden="true" tabindex="-1"></a>Eulerian Cycle Problem, Find an Eulerian cycle <span class="kw">in</span> a graph.</span>
<span id="cb237-3409"><a href="#cb237-3409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3410"><a href="#cb237-3410" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An Eulerian directed graph, <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb237-3411"><a href="#cb237-3411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3412"><a href="#cb237-3412" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An&nbsp;[Eulerian cycle](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>eulerian<span class="op">-</span>cycle<span class="op">/</span>)&nbsp;in this graph.</span>
<span id="cb237-3413"><a href="#cb237-3413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3414"><a href="#cb237-3414" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-3415"><a href="#cb237-3415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3416"><a href="#cb237-3416" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3417"><a href="#cb237-3417" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb237-3418"><a href="#cb237-3418" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">0</span></span>
<span id="cb237-3419"><a href="#cb237-3419" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">1</span>,<span class="dv">6</span></span>
<span id="cb237-3420"><a href="#cb237-3420" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb237-3421"><a href="#cb237-3421" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb237-3422"><a href="#cb237-3422" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="op">-&gt;</span> <span class="dv">4</span></span>
<span id="cb237-3423"><a href="#cb237-3423" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">-&gt;</span> <span class="dv">5</span>,<span class="dv">8</span></span>
<span id="cb237-3424"><a href="#cb237-3424" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="op">-&gt;</span> <span class="dv">9</span></span>
<span id="cb237-3425"><a href="#cb237-3425" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="op">-&gt;</span> <span class="dv">7</span></span>
<span id="cb237-3426"><a href="#cb237-3426" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span> <span class="op">-&gt;</span> <span class="dv">6</span></span>
<span id="cb237-3427"><a href="#cb237-3427" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3428"><a href="#cb237-3428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3429"><a href="#cb237-3429" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-3430"><a href="#cb237-3430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3431"><a href="#cb237-3431" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3432"><a href="#cb237-3432" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">8</span><span class="op">-&gt;</span><span class="dv">7</span><span class="op">-&gt;</span><span class="dv">9</span><span class="op">-&gt;</span><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">1</span><span class="op">-&gt;</span><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">6</span></span>
<span id="cb237-3433"><a href="#cb237-3433" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3434"><a href="#cb237-3434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3435"><a href="#cb237-3435" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-3436"><a href="#cb237-3436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3437"><a href="#cb237-3437" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-3438"><a href="#cb237-3438" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb237-3439"><a href="#cb237-3439" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb237-3440"><a href="#cb237-3440" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb237-3441"><a href="#cb237-3441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3442"><a href="#cb237-3442" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_list_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-3443"><a href="#cb237-3443" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb237-3444"><a href="#cb237-3444" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> element <span class="kw">in</span> adjacency_list_text:</span>
<span id="cb237-3445"><a href="#cb237-3445" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, element)</span>
<span id="cb237-3446"><a href="#cb237-3446" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb237-3447"><a href="#cb237-3447" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb237-3448"><a href="#cb237-3448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3449"><a href="#cb237-3449" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-3450"><a href="#cb237-3450" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb237-3451"><a href="#cb237-3451" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb237-3452"><a href="#cb237-3452" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb237-3453"><a href="#cb237-3453" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb237-3454"><a href="#cb237-3454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3455"><a href="#cb237-3455" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-3456"><a href="#cb237-3456" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Form a cycle by randomly walking in the graph</span></span>
<span id="cb237-3457"><a href="#cb237-3457" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb237-3458"><a href="#cb237-3458" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3459"><a href="#cb237-3459" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb237-3460"><a href="#cb237-3460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3461"><a href="#cb237-3461" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb237-3462"><a href="#cb237-3462" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb237-3463"><a href="#cb237-3463" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb237-3464"><a href="#cb237-3464" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb237-3465"><a href="#cb237-3465" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3466"><a href="#cb237-3466" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb237-3467"><a href="#cb237-3467" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb237-3468"><a href="#cb237-3468" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb237-3469"><a href="#cb237-3469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3470"><a href="#cb237-3470" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb237-3471"><a href="#cb237-3471" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb237-3472"><a href="#cb237-3472" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb237-3473"><a href="#cb237-3473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3474"><a href="#cb237-3474" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Form new_cycle by traversing cycle (starting at new_start) and then randomly walking</span></span>
<span id="cb237-3475"><a href="#cb237-3475" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb237-3476"><a href="#cb237-3476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3477"><a href="#cb237-3477" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb237-3478"><a href="#cb237-3478" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb237-3479"><a href="#cb237-3479" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb237-3480"><a href="#cb237-3480" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb237-3481"><a href="#cb237-3481" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb237-3482"><a href="#cb237-3482" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb237-3483"><a href="#cb237-3483" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3484"><a href="#cb237-3484" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb237-3485"><a href="#cb237-3485" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb237-3486"><a href="#cb237-3486" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb237-3487"><a href="#cb237-3487" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb237-3488"><a href="#cb237-3488" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb237-3489"><a href="#cb237-3489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3490"><a href="#cb237-3490" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-3491"><a href="#cb237-3491" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 3</span></span>
<span id="cb237-3492"><a href="#cb237-3492" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 0</span></span>
<span id="cb237-3493"><a href="#cb237-3493" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1,6</span></span>
<span id="cb237-3494"><a href="#cb237-3494" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 2</span></span>
<span id="cb237-3495"><a href="#cb237-3495" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; 2</span></span>
<span id="cb237-3496"><a href="#cb237-3496" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 4</span></span>
<span id="cb237-3497"><a href="#cb237-3497" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 5,8</span></span>
<span id="cb237-3498"><a href="#cb237-3498" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 9</span></span>
<span id="cb237-3499"><a href="#cb237-3499" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 7</span></span>
<span id="cb237-3500"><a href="#cb237-3500" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb237-3501"><a href="#cb237-3501" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-3502"><a href="#cb237-3502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3503"><a href="#cb237-3503" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-3504"><a href="#cb237-3504" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb237-3505"><a href="#cb237-3505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3506"><a href="#cb237-3506" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_cycle(adjacency_list)))</span>
<span id="cb237-3507"><a href="#cb237-3507" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3508"><a href="#cb237-3508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3509"><a href="#cb237-3509" aria-hidden="true" tabindex="-1"></a><span class="co"># Find an Eulerian Path in a Graph</span></span>
<span id="cb237-3510"><a href="#cb237-3510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3511"><a href="#cb237-3511" aria-hidden="true" tabindex="-1"></a>Eulerian Path Problem, Find an Eulerian path <span class="kw">in</span> a graph.</span>
<span id="cb237-3512"><a href="#cb237-3512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3513"><a href="#cb237-3513" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[directed graph](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>directed<span class="op">-</span>graph<span class="op">/</span>)&nbsp;that contains an Eulerian path, where the graph <span class="kw">is</span> given <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb237-3514"><a href="#cb237-3514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3515"><a href="#cb237-3515" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An Eulerian path <span class="kw">in</span> this graph.</span>
<span id="cb237-3516"><a href="#cb237-3516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3517"><a href="#cb237-3517" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-3518"><a href="#cb237-3518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3519"><a href="#cb237-3519" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3520"><a href="#cb237-3520" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb237-3521"><a href="#cb237-3521" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb237-3522"><a href="#cb237-3522" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">1</span></span>
<span id="cb237-3523"><a href="#cb237-3523" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">0</span>,<span class="dv">4</span></span>
<span id="cb237-3524"><a href="#cb237-3524" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">-&gt;</span> <span class="dv">3</span>,<span class="dv">7</span></span>
<span id="cb237-3525"><a href="#cb237-3525" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="op">-&gt;</span> <span class="dv">8</span></span>
<span id="cb237-3526"><a href="#cb237-3526" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="op">-&gt;</span> <span class="dv">9</span></span>
<span id="cb237-3527"><a href="#cb237-3527" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span> <span class="op">-&gt;</span> <span class="dv">6</span></span>
<span id="cb237-3528"><a href="#cb237-3528" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3529"><a href="#cb237-3529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3530"><a href="#cb237-3530" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-3531"><a href="#cb237-3531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3532"><a href="#cb237-3532" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3533"><a href="#cb237-3533" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">7</span><span class="op">-&gt;</span><span class="dv">8</span><span class="op">-&gt;</span><span class="dv">9</span><span class="op">-&gt;</span><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">1</span><span class="op">-&gt;</span><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">4</span></span>
<span id="cb237-3534"><a href="#cb237-3534" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3535"><a href="#cb237-3535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3536"><a href="#cb237-3536" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-3537"><a href="#cb237-3537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3538"><a href="#cb237-3538" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-3539"><a href="#cb237-3539" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb237-3540"><a href="#cb237-3540" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb237-3541"><a href="#cb237-3541" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb237-3542"><a href="#cb237-3542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3543"><a href="#cb237-3543" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-3544"><a href="#cb237-3544" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb237-3545"><a href="#cb237-3545" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb237-3546"><a href="#cb237-3546" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb237-3547"><a href="#cb237-3547" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb237-3548"><a href="#cb237-3548" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb237-3549"><a href="#cb237-3549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3550"><a href="#cb237-3550" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-3551"><a href="#cb237-3551" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb237-3552"><a href="#cb237-3552" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb237-3553"><a href="#cb237-3553" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb237-3554"><a href="#cb237-3554" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb237-3555"><a href="#cb237-3555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3556"><a href="#cb237-3556" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-3557"><a href="#cb237-3557" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb237-3558"><a href="#cb237-3558" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3559"><a href="#cb237-3559" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb237-3560"><a href="#cb237-3560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3561"><a href="#cb237-3561" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb237-3562"><a href="#cb237-3562" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb237-3563"><a href="#cb237-3563" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb237-3564"><a href="#cb237-3564" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb237-3565"><a href="#cb237-3565" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3566"><a href="#cb237-3566" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb237-3567"><a href="#cb237-3567" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb237-3568"><a href="#cb237-3568" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb237-3569"><a href="#cb237-3569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3570"><a href="#cb237-3570" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb237-3571"><a href="#cb237-3571" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb237-3572"><a href="#cb237-3572" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb237-3573"><a href="#cb237-3573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3574"><a href="#cb237-3574" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb237-3575"><a href="#cb237-3575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3576"><a href="#cb237-3576" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb237-3577"><a href="#cb237-3577" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb237-3578"><a href="#cb237-3578" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb237-3579"><a href="#cb237-3579" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb237-3580"><a href="#cb237-3580" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb237-3581"><a href="#cb237-3581" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb237-3582"><a href="#cb237-3582" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3583"><a href="#cb237-3583" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb237-3584"><a href="#cb237-3584" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb237-3585"><a href="#cb237-3585" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb237-3586"><a href="#cb237-3586" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb237-3587"><a href="#cb237-3587" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb237-3588"><a href="#cb237-3588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3589"><a href="#cb237-3589" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-3590"><a href="#cb237-3590" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-3591"><a href="#cb237-3591" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb237-3592"><a href="#cb237-3592" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb237-3593"><a href="#cb237-3593" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb237-3594"><a href="#cb237-3594" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb237-3595"><a href="#cb237-3595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3596"><a href="#cb237-3596" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb237-3597"><a href="#cb237-3597" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb237-3598"><a href="#cb237-3598" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-3599"><a href="#cb237-3599" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb237-3600"><a href="#cb237-3600" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb237-3601"><a href="#cb237-3601" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb237-3602"><a href="#cb237-3602" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb237-3603"><a href="#cb237-3603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3604"><a href="#cb237-3604" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb237-3605"><a href="#cb237-3605" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb237-3606"><a href="#cb237-3606" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb237-3607"><a href="#cb237-3607" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb237-3608"><a href="#cb237-3608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3609"><a href="#cb237-3609" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb237-3610"><a href="#cb237-3610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3611"><a href="#cb237-3611" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-3612"><a href="#cb237-3612" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 2</span></span>
<span id="cb237-3613"><a href="#cb237-3613" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 3</span></span>
<span id="cb237-3614"><a href="#cb237-3614" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1</span></span>
<span id="cb237-3615"><a href="#cb237-3615" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 0,4</span></span>
<span id="cb237-3616"><a href="#cb237-3616" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 3,7</span></span>
<span id="cb237-3617"><a href="#cb237-3617" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 8</span></span>
<span id="cb237-3618"><a href="#cb237-3618" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 9</span></span>
<span id="cb237-3619"><a href="#cb237-3619" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb237-3620"><a href="#cb237-3620" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-3621"><a href="#cb237-3621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3622"><a href="#cb237-3622" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-3623"><a href="#cb237-3623" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb237-3624"><a href="#cb237-3624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3625"><a href="#cb237-3625" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_path(adjacency_list)))</span>
<span id="cb237-3626"><a href="#cb237-3626" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3627"><a href="#cb237-3627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3628"><a href="#cb237-3628" aria-hidden="true" tabindex="-1"></a><span class="co"># Reconstruct a String from its k-mer Composition</span></span>
<span id="cb237-3629"><a href="#cb237-3629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3630"><a href="#cb237-3630" aria-hidden="true" tabindex="-1"></a>String Reconstruction Problem. Reconstruct a string <span class="im">from</span> its k<span class="op">-</span>mer composition.</span>
<span id="cb237-3631"><a href="#cb237-3631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3632"><a href="#cb237-3632" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;followed by a <span class="bu">list</span> of&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>.</span>
<span id="cb237-3633"><a href="#cb237-3633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3634"><a href="#cb237-3634" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;with&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer composition equal to&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb237-3635"><a href="#cb237-3635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3636"><a href="#cb237-3636" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-3637"><a href="#cb237-3637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3638"><a href="#cb237-3638" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3639"><a href="#cb237-3639" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb237-3640"><a href="#cb237-3640" aria-hidden="true" tabindex="-1"></a>CTTA</span>
<span id="cb237-3641"><a href="#cb237-3641" aria-hidden="true" tabindex="-1"></a>ACCA</span>
<span id="cb237-3642"><a href="#cb237-3642" aria-hidden="true" tabindex="-1"></a>TACC</span>
<span id="cb237-3643"><a href="#cb237-3643" aria-hidden="true" tabindex="-1"></a>GGCT</span>
<span id="cb237-3644"><a href="#cb237-3644" aria-hidden="true" tabindex="-1"></a>GCTT</span>
<span id="cb237-3645"><a href="#cb237-3645" aria-hidden="true" tabindex="-1"></a>TTAC</span>
<span id="cb237-3646"><a href="#cb237-3646" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3647"><a href="#cb237-3647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3648"><a href="#cb237-3648" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-3649"><a href="#cb237-3649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3650"><a href="#cb237-3650" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3651"><a href="#cb237-3651" aria-hidden="true" tabindex="-1"></a>GGCTTACCA</span>
<span id="cb237-3652"><a href="#cb237-3652" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3653"><a href="#cb237-3653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3654"><a href="#cb237-3654" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-3655"><a href="#cb237-3655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3656"><a href="#cb237-3656" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-3657"><a href="#cb237-3657" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb237-3658"><a href="#cb237-3658" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb237-3659"><a href="#cb237-3659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3660"><a href="#cb237-3660" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-3661"><a href="#cb237-3661" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb237-3662"><a href="#cb237-3662" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb237-3663"><a href="#cb237-3663" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb237-3664"><a href="#cb237-3664" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb237-3665"><a href="#cb237-3665" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb237-3666"><a href="#cb237-3666" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb237-3667"><a href="#cb237-3667" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-3668"><a href="#cb237-3668" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb237-3669"><a href="#cb237-3669" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb237-3670"><a href="#cb237-3670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3671"><a href="#cb237-3671" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-3672"><a href="#cb237-3672" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb237-3673"><a href="#cb237-3673" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb237-3674"><a href="#cb237-3674" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb237-3675"><a href="#cb237-3675" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb237-3676"><a href="#cb237-3676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3677"><a href="#cb237-3677" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-3678"><a href="#cb237-3678" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb237-3679"><a href="#cb237-3679" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3680"><a href="#cb237-3680" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb237-3681"><a href="#cb237-3681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3682"><a href="#cb237-3682" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb237-3683"><a href="#cb237-3683" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb237-3684"><a href="#cb237-3684" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb237-3685"><a href="#cb237-3685" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb237-3686"><a href="#cb237-3686" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3687"><a href="#cb237-3687" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb237-3688"><a href="#cb237-3688" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb237-3689"><a href="#cb237-3689" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb237-3690"><a href="#cb237-3690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3691"><a href="#cb237-3691" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb237-3692"><a href="#cb237-3692" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb237-3693"><a href="#cb237-3693" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb237-3694"><a href="#cb237-3694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3695"><a href="#cb237-3695" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb237-3696"><a href="#cb237-3696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3697"><a href="#cb237-3697" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb237-3698"><a href="#cb237-3698" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb237-3699"><a href="#cb237-3699" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb237-3700"><a href="#cb237-3700" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb237-3701"><a href="#cb237-3701" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb237-3702"><a href="#cb237-3702" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb237-3703"><a href="#cb237-3703" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3704"><a href="#cb237-3704" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb237-3705"><a href="#cb237-3705" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb237-3706"><a href="#cb237-3706" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb237-3707"><a href="#cb237-3707" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb237-3708"><a href="#cb237-3708" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb237-3709"><a href="#cb237-3709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3710"><a href="#cb237-3710" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-3711"><a href="#cb237-3711" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-3712"><a href="#cb237-3712" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb237-3713"><a href="#cb237-3713" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb237-3714"><a href="#cb237-3714" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb237-3715"><a href="#cb237-3715" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb237-3716"><a href="#cb237-3716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3717"><a href="#cb237-3717" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb237-3718"><a href="#cb237-3718" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb237-3719"><a href="#cb237-3719" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-3720"><a href="#cb237-3720" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb237-3721"><a href="#cb237-3721" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb237-3722"><a href="#cb237-3722" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb237-3723"><a href="#cb237-3723" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb237-3724"><a href="#cb237-3724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3725"><a href="#cb237-3725" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb237-3726"><a href="#cb237-3726" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb237-3727"><a href="#cb237-3727" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb237-3728"><a href="#cb237-3728" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb237-3729"><a href="#cb237-3729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3730"><a href="#cb237-3730" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb237-3731"><a href="#cb237-3731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3732"><a href="#cb237-3732" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-3733"><a href="#cb237-3733" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb237-3734"><a href="#cb237-3734" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(adjacency_list)</span>
<span id="cb237-3735"><a href="#cb237-3735" aria-hidden="true" tabindex="-1"></a>    reconstructed_string <span class="op">=</span> path[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb237-3736"><a href="#cb237-3736" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> path:</span>
<span id="cb237-3737"><a href="#cb237-3737" aria-hidden="true" tabindex="-1"></a>        reconstructed_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb237-3738"><a href="#cb237-3738" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_string</span>
<span id="cb237-3739"><a href="#cb237-3739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3740"><a href="#cb237-3740" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-3741"><a href="#cb237-3741" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb237-3742"><a href="#cb237-3742" aria-hidden="true" tabindex="-1"></a><span class="st">CTTA</span></span>
<span id="cb237-3743"><a href="#cb237-3743" aria-hidden="true" tabindex="-1"></a><span class="st">ACCA</span></span>
<span id="cb237-3744"><a href="#cb237-3744" aria-hidden="true" tabindex="-1"></a><span class="st">TACC</span></span>
<span id="cb237-3745"><a href="#cb237-3745" aria-hidden="true" tabindex="-1"></a><span class="st">GGCT</span></span>
<span id="cb237-3746"><a href="#cb237-3746" aria-hidden="true" tabindex="-1"></a><span class="st">GCTT</span></span>
<span id="cb237-3747"><a href="#cb237-3747" aria-hidden="true" tabindex="-1"></a><span class="st">TTAC</span></span>
<span id="cb237-3748"><a href="#cb237-3748" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-3749"><a href="#cb237-3749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3750"><a href="#cb237-3750" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-3751"><a href="#cb237-3751" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb237-3752"><a href="#cb237-3752" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">1</span>:]</span>
<span id="cb237-3753"><a href="#cb237-3753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3754"><a href="#cb237-3754" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string(kmers))</span>
<span id="cb237-3755"><a href="#cb237-3755" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3756"><a href="#cb237-3756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3757"><a href="#cb237-3757" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a k-Universal Circular String</span></span>
<span id="cb237-3758"><a href="#cb237-3758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3759"><a href="#cb237-3759" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span>k<span class="op">*-</span>Universal Circular String Problem. Find a k<span class="op">-</span>universal circular binary string.</span>
<span id="cb237-3760"><a href="#cb237-3760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3761"><a href="#cb237-3761" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>k<span class="op">*</span>.</span>
<span id="cb237-3762"><a href="#cb237-3762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3763"><a href="#cb237-3763" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A&nbsp;<span class="op">*</span>k<span class="op">*-</span>universal circular string. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb237-3764"><a href="#cb237-3764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3765"><a href="#cb237-3765" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-3766"><a href="#cb237-3766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3767"><a href="#cb237-3767" aria-hidden="true" tabindex="-1"></a>```<span class="dv">4</span>```</span>
<span id="cb237-3768"><a href="#cb237-3768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3769"><a href="#cb237-3769" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-3770"><a href="#cb237-3770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3771"><a href="#cb237-3771" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3772"><a href="#cb237-3772" aria-hidden="true" tabindex="-1"></a><span class="dv">1111010010110000</span></span>
<span id="cb237-3773"><a href="#cb237-3773" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3774"><a href="#cb237-3774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3775"><a href="#cb237-3775" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-3776"><a href="#cb237-3776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3777"><a href="#cb237-3777" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-3778"><a href="#cb237-3778" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb237-3779"><a href="#cb237-3779" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb237-3780"><a href="#cb237-3780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3781"><a href="#cb237-3781" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-3782"><a href="#cb237-3782" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb237-3783"><a href="#cb237-3783" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb237-3784"><a href="#cb237-3784" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb237-3785"><a href="#cb237-3785" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb237-3786"><a href="#cb237-3786" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb237-3787"><a href="#cb237-3787" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb237-3788"><a href="#cb237-3788" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-3789"><a href="#cb237-3789" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb237-3790"><a href="#cb237-3790" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb237-3791"><a href="#cb237-3791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3792"><a href="#cb237-3792" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-3793"><a href="#cb237-3793" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb237-3794"><a href="#cb237-3794" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb237-3795"><a href="#cb237-3795" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb237-3796"><a href="#cb237-3796" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb237-3797"><a href="#cb237-3797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3798"><a href="#cb237-3798" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-3799"><a href="#cb237-3799" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb237-3800"><a href="#cb237-3800" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3801"><a href="#cb237-3801" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb237-3802"><a href="#cb237-3802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3803"><a href="#cb237-3803" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb237-3804"><a href="#cb237-3804" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb237-3805"><a href="#cb237-3805" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb237-3806"><a href="#cb237-3806" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb237-3807"><a href="#cb237-3807" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3808"><a href="#cb237-3808" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb237-3809"><a href="#cb237-3809" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb237-3810"><a href="#cb237-3810" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb237-3811"><a href="#cb237-3811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3812"><a href="#cb237-3812" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb237-3813"><a href="#cb237-3813" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb237-3814"><a href="#cb237-3814" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb237-3815"><a href="#cb237-3815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3816"><a href="#cb237-3816" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb237-3817"><a href="#cb237-3817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3818"><a href="#cb237-3818" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb237-3819"><a href="#cb237-3819" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb237-3820"><a href="#cb237-3820" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb237-3821"><a href="#cb237-3821" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb237-3822"><a href="#cb237-3822" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb237-3823"><a href="#cb237-3823" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb237-3824"><a href="#cb237-3824" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3825"><a href="#cb237-3825" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb237-3826"><a href="#cb237-3826" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb237-3827"><a href="#cb237-3827" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb237-3828"><a href="#cb237-3828" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb237-3829"><a href="#cb237-3829" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb237-3830"><a href="#cb237-3830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3831"><a href="#cb237-3831" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_k_universal_circular_string(k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-3832"><a href="#cb237-3832" aria-hidden="true" tabindex="-1"></a>    kmers: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb237-3833"><a href="#cb237-3833" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span> <span class="op">**</span> k):</span>
<span id="cb237-3834"><a href="#cb237-3834" aria-hidden="true" tabindex="-1"></a>        kmer <span class="op">=</span> <span class="bu">format</span>(i, <span class="ss">f'0</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">b'</span>)</span>
<span id="cb237-3835"><a href="#cb237-3835" aria-hidden="true" tabindex="-1"></a>        kmers.append(kmer)</span>
<span id="cb237-3836"><a href="#cb237-3836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3837"><a href="#cb237-3837" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb237-3838"><a href="#cb237-3838" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(adjacency_list)</span>
<span id="cb237-3839"><a href="#cb237-3839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3840"><a href="#cb237-3840" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> cycle[:<span class="bu">len</span>(cycle) <span class="op">-</span> k <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb237-3841"><a href="#cb237-3841" aria-hidden="true" tabindex="-1"></a>    circular_string <span class="op">=</span> cycle[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb237-3842"><a href="#cb237-3842" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> cycle:</span>
<span id="cb237-3843"><a href="#cb237-3843" aria-hidden="true" tabindex="-1"></a>        circular_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb237-3844"><a href="#cb237-3844" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> circular_string</span>
<span id="cb237-3845"><a href="#cb237-3845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3846"><a href="#cb237-3846" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-3847"><a href="#cb237-3847" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb237-3848"><a href="#cb237-3848" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-3849"><a href="#cb237-3849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3850"><a href="#cb237-3850" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-3851"><a href="#cb237-3851" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb237-3852"><a href="#cb237-3852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3853"><a href="#cb237-3853" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generate_k_universal_circular_string(k))</span>
<span id="cb237-3854"><a href="#cb237-3854" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3855"><a href="#cb237-3855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3856"><a href="#cb237-3856" aria-hidden="true" tabindex="-1"></a><span class="co"># Reconstruct a String from its Paired Composition</span></span>
<span id="cb237-3857"><a href="#cb237-3857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3858"><a href="#cb237-3858" aria-hidden="true" tabindex="-1"></a>String Reconstruction <span class="im">from</span> Read<span class="op">-</span>Pairs Problem. Reconstruct a string <span class="im">from</span> its paired composition.</span>
<span id="cb237-3859"><a href="#cb237-3859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3860"><a href="#cb237-3860" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>d<span class="op">*</span>&nbsp;followed by a collection of paired&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers&nbsp;<span class="op">*</span>PairedReads<span class="op">*</span>.</span>
<span id="cb237-3861"><a href="#cb237-3861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3862"><a href="#cb237-3862" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;with (<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>d<span class="op">*</span>)<span class="op">-</span>mer composition equal to&nbsp;<span class="op">*</span>PairedReads<span class="op">*</span>. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb237-3863"><a href="#cb237-3863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3864"><a href="#cb237-3864" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-3865"><a href="#cb237-3865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3866"><a href="#cb237-3866" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3867"><a href="#cb237-3867" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">2</span></span>
<span id="cb237-3868"><a href="#cb237-3868" aria-hidden="true" tabindex="-1"></a>GAGA<span class="op">|</span>TTGA</span>
<span id="cb237-3869"><a href="#cb237-3869" aria-hidden="true" tabindex="-1"></a>TCGT<span class="op">|</span>GATG</span>
<span id="cb237-3870"><a href="#cb237-3870" aria-hidden="true" tabindex="-1"></a>CGTG<span class="op">|</span>ATGT</span>
<span id="cb237-3871"><a href="#cb237-3871" aria-hidden="true" tabindex="-1"></a>TGGT<span class="op">|</span>TGAG</span>
<span id="cb237-3872"><a href="#cb237-3872" aria-hidden="true" tabindex="-1"></a>GTGA<span class="op">|</span>TGTT</span>
<span id="cb237-3873"><a href="#cb237-3873" aria-hidden="true" tabindex="-1"></a>GTGG<span class="op">|</span>GTGA</span>
<span id="cb237-3874"><a href="#cb237-3874" aria-hidden="true" tabindex="-1"></a>TGAG<span class="op">|</span>GTTG</span>
<span id="cb237-3875"><a href="#cb237-3875" aria-hidden="true" tabindex="-1"></a>GGTC<span class="op">|</span>GAGA</span>
<span id="cb237-3876"><a href="#cb237-3876" aria-hidden="true" tabindex="-1"></a>GTCG<span class="op">|</span>AGAT</span>
<span id="cb237-3877"><a href="#cb237-3877" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3878"><a href="#cb237-3878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3879"><a href="#cb237-3879" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-3880"><a href="#cb237-3880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3881"><a href="#cb237-3881" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3882"><a href="#cb237-3882" aria-hidden="true" tabindex="-1"></a>GTGGTCGTGAGATGTTGA</span>
<span id="cb237-3883"><a href="#cb237-3883" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3884"><a href="#cb237-3884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3885"><a href="#cb237-3885" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-3886"><a href="#cb237-3886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3887"><a href="#cb237-3887" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-3888"><a href="#cb237-3888" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb237-3889"><a href="#cb237-3889" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb237-3890"><a href="#cb237-3890" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb237-3891"><a href="#cb237-3891" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb237-3892"><a href="#cb237-3892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3893"><a href="#cb237-3893" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-3894"><a href="#cb237-3894" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb237-3895"><a href="#cb237-3895" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb237-3896"><a href="#cb237-3896" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb237-3897"><a href="#cb237-3897" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb237-3898"><a href="#cb237-3898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3899"><a href="#cb237-3899" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-3900"><a href="#cb237-3900" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb237-3901"><a href="#cb237-3901" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3902"><a href="#cb237-3902" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb237-3903"><a href="#cb237-3903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3904"><a href="#cb237-3904" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb237-3905"><a href="#cb237-3905" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb237-3906"><a href="#cb237-3906" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb237-3907"><a href="#cb237-3907" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb237-3908"><a href="#cb237-3908" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3909"><a href="#cb237-3909" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb237-3910"><a href="#cb237-3910" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb237-3911"><a href="#cb237-3911" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb237-3912"><a href="#cb237-3912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3913"><a href="#cb237-3913" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb237-3914"><a href="#cb237-3914" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb237-3915"><a href="#cb237-3915" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb237-3916"><a href="#cb237-3916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3917"><a href="#cb237-3917" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb237-3918"><a href="#cb237-3918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3919"><a href="#cb237-3919" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb237-3920"><a href="#cb237-3920" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb237-3921"><a href="#cb237-3921" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb237-3922"><a href="#cb237-3922" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb237-3923"><a href="#cb237-3923" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb237-3924"><a href="#cb237-3924" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb237-3925"><a href="#cb237-3925" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb237-3926"><a href="#cb237-3926" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb237-3927"><a href="#cb237-3927" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb237-3928"><a href="#cb237-3928" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb237-3929"><a href="#cb237-3929" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb237-3930"><a href="#cb237-3930" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb237-3931"><a href="#cb237-3931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3932"><a href="#cb237-3932" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-3933"><a href="#cb237-3933" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-3934"><a href="#cb237-3934" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb237-3935"><a href="#cb237-3935" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb237-3936"><a href="#cb237-3936" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb237-3937"><a href="#cb237-3937" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb237-3938"><a href="#cb237-3938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3939"><a href="#cb237-3939" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb237-3940"><a href="#cb237-3940" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb237-3941"><a href="#cb237-3941" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-3942"><a href="#cb237-3942" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb237-3943"><a href="#cb237-3943" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb237-3944"><a href="#cb237-3944" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb237-3945"><a href="#cb237-3945" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb237-3946"><a href="#cb237-3946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3947"><a href="#cb237-3947" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb237-3948"><a href="#cb237-3948" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb237-3949"><a href="#cb237-3949" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb237-3950"><a href="#cb237-3950" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb237-3951"><a href="#cb237-3951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3952"><a href="#cb237-3952" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb237-3953"><a href="#cb237-3953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3954"><a href="#cb237-3954" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph_paired_reads(paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]]:</span>
<span id="cb237-3955"><a href="#cb237-3955" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb237-3956"><a href="#cb237-3956" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pair <span class="kw">in</span> paired_reads:</span>
<span id="cb237-3957"><a href="#cb237-3957" aria-hidden="true" tabindex="-1"></a>        graph[(pair[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>], pair[<span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>])].append((pair[<span class="dv">0</span>][<span class="dv">1</span>:], pair[<span class="dv">1</span>][<span class="dv">1</span>:]))</span>
<span id="cb237-3958"><a href="#cb237-3958" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb237-3959"><a href="#cb237-3959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3960"><a href="#cb237-3960" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> string_spelled_by_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-3961"><a href="#cb237-3961" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb237-3962"><a href="#cb237-3962" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">1</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>]</span>
<span id="cb237-3963"><a href="#cb237-3963" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-3964"><a href="#cb237-3964" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb237-3965"><a href="#cb237-3965" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb237-3966"><a href="#cb237-3966" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb237-3967"><a href="#cb237-3967" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb237-3968"><a href="#cb237-3968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3969"><a href="#cb237-3969" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_read_pairs(k: <span class="bu">int</span>, d: <span class="bu">int</span>, paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-3970"><a href="#cb237-3970" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph_paired_reads(paired_reads)</span>
<span id="cb237-3971"><a href="#cb237-3971" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(graph)</span>
<span id="cb237-3972"><a href="#cb237-3972" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> string_spelled_by_gapped_patterns(path, k <span class="op">-</span> <span class="dv">1</span>, d)</span>
<span id="cb237-3973"><a href="#cb237-3973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3974"><a href="#cb237-3974" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-3975"><a href="#cb237-3975" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb237-3976"><a href="#cb237-3976" aria-hidden="true" tabindex="-1"></a><span class="st">GAGA|TTGA</span></span>
<span id="cb237-3977"><a href="#cb237-3977" aria-hidden="true" tabindex="-1"></a><span class="st">TCGT|GATG</span></span>
<span id="cb237-3978"><a href="#cb237-3978" aria-hidden="true" tabindex="-1"></a><span class="st">CGTG|ATGT</span></span>
<span id="cb237-3979"><a href="#cb237-3979" aria-hidden="true" tabindex="-1"></a><span class="st">TGGT|TGAG</span></span>
<span id="cb237-3980"><a href="#cb237-3980" aria-hidden="true" tabindex="-1"></a><span class="st">GTGA|TGTT</span></span>
<span id="cb237-3981"><a href="#cb237-3981" aria-hidden="true" tabindex="-1"></a><span class="st">GTGG|GTGA</span></span>
<span id="cb237-3982"><a href="#cb237-3982" aria-hidden="true" tabindex="-1"></a><span class="st">TGAG|GTTG</span></span>
<span id="cb237-3983"><a href="#cb237-3983" aria-hidden="true" tabindex="-1"></a><span class="st">GGTC|GAGA</span></span>
<span id="cb237-3984"><a href="#cb237-3984" aria-hidden="true" tabindex="-1"></a><span class="st">GTCG|AGAT</span></span>
<span id="cb237-3985"><a href="#cb237-3985" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-3986"><a href="#cb237-3986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3987"><a href="#cb237-3987" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-3988"><a href="#cb237-3988" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb237-3989"><a href="#cb237-3989" aria-hidden="true" tabindex="-1"></a>paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb237-3990"><a href="#cb237-3990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3991"><a href="#cb237-3991" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_read_pairs(k, d, paired_reads))</span>
<span id="cb237-3992"><a href="#cb237-3992" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-3993"><a href="#cb237-3993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3994"><a href="#cb237-3994" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Contigs from a Collection of Reads</span></span>
<span id="cb237-3995"><a href="#cb237-3995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3996"><a href="#cb237-3996" aria-hidden="true" tabindex="-1"></a>Contig Generation Problem. Generate the contigs <span class="im">from</span> a collection of reads (<span class="cf">with</span> imperfect coverage).</span>
<span id="cb237-3997"><a href="#cb237-3997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3998"><a href="#cb237-3998" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection of k<span class="op">-</span>mers&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>.</span>
<span id="cb237-3999"><a href="#cb237-3999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4000"><a href="#cb237-4000" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All contigs in&nbsp;<span class="op">*</span>DeBruijn(Patterns)<span class="op">*</span>. (You may <span class="cf">return</span> the strings <span class="kw">in</span> <span class="bu">any</span> order.)</span>
<span id="cb237-4001"><a href="#cb237-4001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4002"><a href="#cb237-4002" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-4003"><a href="#cb237-4003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4004"><a href="#cb237-4004" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4005"><a href="#cb237-4005" aria-hidden="true" tabindex="-1"></a>ATG</span>
<span id="cb237-4006"><a href="#cb237-4006" aria-hidden="true" tabindex="-1"></a>ATG</span>
<span id="cb237-4007"><a href="#cb237-4007" aria-hidden="true" tabindex="-1"></a>TGT</span>
<span id="cb237-4008"><a href="#cb237-4008" aria-hidden="true" tabindex="-1"></a>TGG</span>
<span id="cb237-4009"><a href="#cb237-4009" aria-hidden="true" tabindex="-1"></a>CAT</span>
<span id="cb237-4010"><a href="#cb237-4010" aria-hidden="true" tabindex="-1"></a>GGA</span>
<span id="cb237-4011"><a href="#cb237-4011" aria-hidden="true" tabindex="-1"></a>GAT</span>
<span id="cb237-4012"><a href="#cb237-4012" aria-hidden="true" tabindex="-1"></a>AGA</span>
<span id="cb237-4013"><a href="#cb237-4013" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4014"><a href="#cb237-4014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4015"><a href="#cb237-4015" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-4016"><a href="#cb237-4016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4017"><a href="#cb237-4017" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4018"><a href="#cb237-4018" aria-hidden="true" tabindex="-1"></a>AGA ATG ATG CAT GAT TGGA TGT</span>
<span id="cb237-4019"><a href="#cb237-4019" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4020"><a href="#cb237-4020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4021"><a href="#cb237-4021" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-4022"><a href="#cb237-4022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4023"><a href="#cb237-4023" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-4024"><a href="#cb237-4024" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb237-4025"><a href="#cb237-4025" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb237-4026"><a href="#cb237-4026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4027"><a href="#cb237-4027" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-4028"><a href="#cb237-4028" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb237-4029"><a href="#cb237-4029" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb237-4030"><a href="#cb237-4030" aria-hidden="true" tabindex="-1"></a>        prefix, suffix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>], kmer[<span class="dv">1</span>:]</span>
<span id="cb237-4031"><a href="#cb237-4031" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[prefix].append(suffix)</span>
<span id="cb237-4032"><a href="#cb237-4032" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb237-4033"><a href="#cb237-4033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4034"><a href="#cb237-4034" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-4035"><a href="#cb237-4035" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb237-4036"><a href="#cb237-4036" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb237-4037"><a href="#cb237-4037" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb237-4038"><a href="#cb237-4038" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb237-4039"><a href="#cb237-4039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4040"><a href="#cb237-4040" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb237-4041"><a href="#cb237-4041" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb237-4042"><a href="#cb237-4042" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb237-4043"><a href="#cb237-4043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4044"><a href="#cb237-4044" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb237-4045"><a href="#cb237-4045" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb237-4046"><a href="#cb237-4046" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb237-4047"><a href="#cb237-4047" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(targets)]</span>
<span id="cb237-4048"><a href="#cb237-4048" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-4049"><a href="#cb237-4049" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(targets)</span>
<span id="cb237-4050"><a href="#cb237-4050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4051"><a href="#cb237-4051" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb237-4052"><a href="#cb237-4052" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> target <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb237-4053"><a href="#cb237-4053" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb237-4054"><a href="#cb237-4054" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb237-4055"><a href="#cb237-4055" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-4056"><a href="#cb237-4056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4057"><a href="#cb237-4057" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb237-4058"><a href="#cb237-4058" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb237-4059"><a href="#cb237-4059" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb237-4060"><a href="#cb237-4060" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb237-4061"><a href="#cb237-4061" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb237-4062"><a href="#cb237-4062" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb237-4063"><a href="#cb237-4063" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb237-4064"><a href="#cb237-4064" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb237-4065"><a href="#cb237-4065" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb237-4066"><a href="#cb237-4066" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb237-4067"><a href="#cb237-4067" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb237-4068"><a href="#cb237-4068" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb237-4069"><a href="#cb237-4069" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb237-4070"><a href="#cb237-4070" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb237-4071"><a href="#cb237-4071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4072"><a href="#cb237-4072" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb237-4073"><a href="#cb237-4073" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb237-4074"><a href="#cb237-4074" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb237-4075"><a href="#cb237-4075" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb237-4076"><a href="#cb237-4076" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb237-4077"><a href="#cb237-4077" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb237-4078"><a href="#cb237-4078" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb237-4079"><a href="#cb237-4079" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb237-4080"><a href="#cb237-4080" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb237-4081"><a href="#cb237-4081" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb237-4082"><a href="#cb237-4082" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb237-4083"><a href="#cb237-4083" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb237-4084"><a href="#cb237-4084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4085"><a href="#cb237-4085" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb237-4086"><a href="#cb237-4086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4087"><a href="#cb237-4087" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_contigs(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-4088"><a href="#cb237-4088" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb237-4089"><a href="#cb237-4089" aria-hidden="true" tabindex="-1"></a>    paths <span class="op">=</span> find_maximal_non_branching_paths(graph)</span>
<span id="cb237-4090"><a href="#cb237-4090" aria-hidden="true" tabindex="-1"></a>    contigs: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb237-4091"><a href="#cb237-4091" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> path <span class="kw">in</span> paths:</span>
<span id="cb237-4092"><a href="#cb237-4092" aria-hidden="true" tabindex="-1"></a>        contig <span class="op">=</span> path[<span class="dv">0</span>]</span>
<span id="cb237-4093"><a href="#cb237-4093" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> path[<span class="dv">1</span>:]:</span>
<span id="cb237-4094"><a href="#cb237-4094" aria-hidden="true" tabindex="-1"></a>            contig <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb237-4095"><a href="#cb237-4095" aria-hidden="true" tabindex="-1"></a>        contigs.append(contig)</span>
<span id="cb237-4096"><a href="#cb237-4096" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> contigs</span>
<span id="cb237-4097"><a href="#cb237-4097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4098"><a href="#cb237-4098" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-4099"><a href="#cb237-4099" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb237-4100"><a href="#cb237-4100" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb237-4101"><a href="#cb237-4101" aria-hidden="true" tabindex="-1"></a><span class="st">TGT</span></span>
<span id="cb237-4102"><a href="#cb237-4102" aria-hidden="true" tabindex="-1"></a><span class="st">TGG</span></span>
<span id="cb237-4103"><a href="#cb237-4103" aria-hidden="true" tabindex="-1"></a><span class="st">CAT</span></span>
<span id="cb237-4104"><a href="#cb237-4104" aria-hidden="true" tabindex="-1"></a><span class="st">GGA</span></span>
<span id="cb237-4105"><a href="#cb237-4105" aria-hidden="true" tabindex="-1"></a><span class="st">GAT</span></span>
<span id="cb237-4106"><a href="#cb237-4106" aria-hidden="true" tabindex="-1"></a><span class="st">AGA</span></span>
<span id="cb237-4107"><a href="#cb237-4107" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-4108"><a href="#cb237-4108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4109"><a href="#cb237-4109" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-4110"><a href="#cb237-4110" aria-hidden="true" tabindex="-1"></a>contigs <span class="op">=</span> generate_contigs(kmers)</span>
<span id="cb237-4111"><a href="#cb237-4111" aria-hidden="true" tabindex="-1"></a>contigs.sort()</span>
<span id="cb237-4112"><a href="#cb237-4112" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(contigs))</span>
<span id="cb237-4113"><a href="#cb237-4113" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4114"><a href="#cb237-4114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4115"><a href="#cb237-4115" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct a String Spelled by a Gapped Genome Path</span></span>
<span id="cb237-4116"><a href="#cb237-4116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4117"><a href="#cb237-4117" aria-hidden="true" tabindex="-1"></a>Gapped Genome Path String Problem. Reconstruct a string <span class="im">from</span> a sequence of (k,d)<span class="op">-</span>mers corresponding to a path <span class="kw">in</span> a paired de Bruijn graph.</span>
<span id="cb237-4118"><a href="#cb237-4118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4119"><a href="#cb237-4119" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of&nbsp;<span class="op">*</span>(k, d)<span class="op">*-</span>mers (<span class="op">*</span>a1<span class="op">|</span>b1<span class="op">*</span>),..., (<span class="op">*</span>an<span class="op">|</span>bn<span class="op">*</span>) such that&nbsp;<span class="op">*</span>Suffix(ai<span class="op">|</span>bi) <span class="op">=</span> Prefix(ai<span class="op">+</span><span class="dv">1</span><span class="op">|</span>bi<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>&nbsp;for all&nbsp;<span class="op">*</span>i<span class="op">*</span>&nbsp;from <span class="dv">1</span> to n<span class="op">-</span><span class="fl">1.</span></span>
<span id="cb237-4120"><a href="#cb237-4120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4121"><a href="#cb237-4121" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;where the&nbsp;<span class="op">*</span>i<span class="op">*-</span>th&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer in&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;is equal to&nbsp;<span class="op">*</span>Suffix(ai<span class="op">|</span>bi)<span class="op">*</span>&nbsp;for all&nbsp;<span class="op">*</span>i<span class="op">*</span>&nbsp;from <span class="dv">1</span> to n, <span class="cf">if</span> such a string exists.</span>
<span id="cb237-4122"><a href="#cb237-4122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4123"><a href="#cb237-4123" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-4124"><a href="#cb237-4124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4125"><a href="#cb237-4125" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4126"><a href="#cb237-4126" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">2</span></span>
<span id="cb237-4127"><a href="#cb237-4127" aria-hidden="true" tabindex="-1"></a>GACC<span class="op">|</span>GCGC</span>
<span id="cb237-4128"><a href="#cb237-4128" aria-hidden="true" tabindex="-1"></a>ACCG<span class="op">|</span>CGCC</span>
<span id="cb237-4129"><a href="#cb237-4129" aria-hidden="true" tabindex="-1"></a>CCGA<span class="op">|</span>GCCG</span>
<span id="cb237-4130"><a href="#cb237-4130" aria-hidden="true" tabindex="-1"></a>CGAG<span class="op">|</span>CCGG</span>
<span id="cb237-4131"><a href="#cb237-4131" aria-hidden="true" tabindex="-1"></a>GAGC<span class="op">|</span>CGGA</span>
<span id="cb237-4132"><a href="#cb237-4132" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4133"><a href="#cb237-4133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4134"><a href="#cb237-4134" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-4135"><a href="#cb237-4135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4136"><a href="#cb237-4136" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4137"><a href="#cb237-4137" aria-hidden="true" tabindex="-1"></a>GACCGAGCGCCGGA</span>
<span id="cb237-4138"><a href="#cb237-4138" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4139"><a href="#cb237-4139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4140"><a href="#cb237-4140" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-4141"><a href="#cb237-4141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4142"><a href="#cb237-4142" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-4143"><a href="#cb237-4143" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb237-4144"><a href="#cb237-4144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4145"><a href="#cb237-4145" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-4146"><a href="#cb237-4146" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb237-4147"><a href="#cb237-4147" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb237-4148"><a href="#cb237-4148" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (prefix, suffix) <span class="kw">in</span> <span class="bu">enumerate</span>(gapped_patterns):</span>
<span id="cb237-4149"><a href="#cb237-4149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">!=</span> <span class="bu">len</span>(gapped_patterns) <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb237-4150"><a href="#cb237-4150" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix[<span class="dv">0</span>]</span>
<span id="cb237-4151"><a href="#cb237-4151" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix[<span class="dv">0</span>]</span>
<span id="cb237-4152"><a href="#cb237-4152" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-4153"><a href="#cb237-4153" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix</span>
<span id="cb237-4154"><a href="#cb237-4154" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix</span>
<span id="cb237-4155"><a href="#cb237-4155" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4156"><a href="#cb237-4156" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb237-4157"><a href="#cb237-4157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb237-4158"><a href="#cb237-4158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb237-4159"><a href="#cb237-4159" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4160"><a href="#cb237-4160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb237-4161"><a href="#cb237-4161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4162"><a href="#cb237-4162" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-4163"><a href="#cb237-4163" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb237-4164"><a href="#cb237-4164" aria-hidden="true" tabindex="-1"></a><span class="st">GACC|GCGC</span></span>
<span id="cb237-4165"><a href="#cb237-4165" aria-hidden="true" tabindex="-1"></a><span class="st">ACCG|CGCC</span></span>
<span id="cb237-4166"><a href="#cb237-4166" aria-hidden="true" tabindex="-1"></a><span class="st">CCGA|GCCG</span></span>
<span id="cb237-4167"><a href="#cb237-4167" aria-hidden="true" tabindex="-1"></a><span class="st">CGAG|CCGG</span></span>
<span id="cb237-4168"><a href="#cb237-4168" aria-hidden="true" tabindex="-1"></a><span class="st">GAGC|CGGA</span></span>
<span id="cb237-4169"><a href="#cb237-4169" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-4170"><a href="#cb237-4170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4171"><a href="#cb237-4171" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-4172"><a href="#cb237-4172" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb237-4173"><a href="#cb237-4173" aria-hidden="true" tabindex="-1"></a>gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb237-4174"><a href="#cb237-4174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4175"><a href="#cb237-4175" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_gapped_patterns(gapped_patterns, k <span class="op">-</span> <span class="dv">1</span>, d))</span>
<span id="cb237-4176"><a href="#cb237-4176" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4177"><a href="#cb237-4177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4178"><a href="#cb237-4178" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate All Maximal Non-Branching Paths in a Graph</span></span>
<span id="cb237-4179"><a href="#cb237-4179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4180"><a href="#cb237-4180" aria-hidden="true" tabindex="-1"></a> Maximal Non<span class="op">-</span>Branching Path Problem. Find <span class="bu">all</span> maximal non<span class="op">-</span>branching paths <span class="kw">in</span> a graph.</span>
<span id="cb237-4181"><a href="#cb237-4181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4182"><a href="#cb237-4182" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;The adjacency <span class="bu">list</span> of a graph whose nodes are integers.</span>
<span id="cb237-4183"><a href="#cb237-4183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4184"><a href="#cb237-4184" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The collection of <span class="bu">all</span> maximal non<span class="op">-</span>branching paths <span class="kw">in</span> the graph.</span>
<span id="cb237-4185"><a href="#cb237-4185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4186"><a href="#cb237-4186" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-4187"><a href="#cb237-4187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4188"><a href="#cb237-4188" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4189"><a href="#cb237-4189" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb237-4190"><a href="#cb237-4190" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb237-4191"><a href="#cb237-4191" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">4</span>,<span class="dv">5</span></span>
<span id="cb237-4192"><a href="#cb237-4192" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">-&gt;</span> <span class="dv">7</span></span>
<span id="cb237-4193"><a href="#cb237-4193" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="op">-&gt;</span> <span class="dv">6</span></span>
<span id="cb237-4194"><a href="#cb237-4194" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4195"><a href="#cb237-4195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4196"><a href="#cb237-4196" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-4197"><a href="#cb237-4197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4198"><a href="#cb237-4198" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4199"><a href="#cb237-4199" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb237-4200"><a href="#cb237-4200" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">4</span></span>
<span id="cb237-4201"><a href="#cb237-4201" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">5</span></span>
<span id="cb237-4202"><a href="#cb237-4202" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">-&gt;</span> <span class="dv">7</span> <span class="op">-&gt;</span> <span class="dv">6</span></span>
<span id="cb237-4203"><a href="#cb237-4203" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4204"><a href="#cb237-4204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4205"><a href="#cb237-4205" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-4206"><a href="#cb237-4206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4207"><a href="#cb237-4207" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-4208"><a href="#cb237-4208" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb237-4209"><a href="#cb237-4209" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb237-4210"><a href="#cb237-4210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4211"><a href="#cb237-4211" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-4212"><a href="#cb237-4212" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb237-4213"><a href="#cb237-4213" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb237-4214"><a href="#cb237-4214" aria-hidden="true" tabindex="-1"></a>        source, targets <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb237-4215"><a href="#cb237-4215" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[source] <span class="op">=</span> targets.split(<span class="st">','</span>)</span>
<span id="cb237-4216"><a href="#cb237-4216" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb237-4217"><a href="#cb237-4217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4218"><a href="#cb237-4218" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-4219"><a href="#cb237-4219" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb237-4220"><a href="#cb237-4220" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb237-4221"><a href="#cb237-4221" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb237-4222"><a href="#cb237-4222" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb237-4223"><a href="#cb237-4223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4224"><a href="#cb237-4224" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb237-4225"><a href="#cb237-4225" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb237-4226"><a href="#cb237-4226" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb237-4227"><a href="#cb237-4227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4228"><a href="#cb237-4228" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb237-4229"><a href="#cb237-4229" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb237-4230"><a href="#cb237-4230" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb237-4231"><a href="#cb237-4231" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(neighbors)]</span>
<span id="cb237-4232"><a href="#cb237-4232" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-4233"><a href="#cb237-4233" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(neighbors)</span>
<span id="cb237-4234"><a href="#cb237-4234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4235"><a href="#cb237-4235" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb237-4236"><a href="#cb237-4236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb237-4237"><a href="#cb237-4237" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb237-4238"><a href="#cb237-4238" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb237-4239"><a href="#cb237-4239" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-4240"><a href="#cb237-4240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4241"><a href="#cb237-4241" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb237-4242"><a href="#cb237-4242" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb237-4243"><a href="#cb237-4243" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb237-4244"><a href="#cb237-4244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb237-4245"><a href="#cb237-4245" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb237-4246"><a href="#cb237-4246" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb237-4247"><a href="#cb237-4247" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb237-4248"><a href="#cb237-4248" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb237-4249"><a href="#cb237-4249" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb237-4250"><a href="#cb237-4250" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb237-4251"><a href="#cb237-4251" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb237-4252"><a href="#cb237-4252" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb237-4253"><a href="#cb237-4253" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb237-4254"><a href="#cb237-4254" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb237-4255"><a href="#cb237-4255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4256"><a href="#cb237-4256" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb237-4257"><a href="#cb237-4257" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb237-4258"><a href="#cb237-4258" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb237-4259"><a href="#cb237-4259" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb237-4260"><a href="#cb237-4260" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb237-4261"><a href="#cb237-4261" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb237-4262"><a href="#cb237-4262" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb237-4263"><a href="#cb237-4263" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb237-4264"><a href="#cb237-4264" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb237-4265"><a href="#cb237-4265" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb237-4266"><a href="#cb237-4266" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb237-4267"><a href="#cb237-4267" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb237-4268"><a href="#cb237-4268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4269"><a href="#cb237-4269" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb237-4270"><a href="#cb237-4270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4271"><a href="#cb237-4271" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-4272"><a href="#cb237-4272" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 2</span></span>
<span id="cb237-4273"><a href="#cb237-4273" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 3</span></span>
<span id="cb237-4274"><a href="#cb237-4274" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 4,5</span></span>
<span id="cb237-4275"><a href="#cb237-4275" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 7</span></span>
<span id="cb237-4276"><a href="#cb237-4276" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 6</span></span>
<span id="cb237-4277"><a href="#cb237-4277" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-4278"><a href="#cb237-4278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4279"><a href="#cb237-4279" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-4280"><a href="#cb237-4280" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb237-4281"><a href="#cb237-4281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4282"><a href="#cb237-4282" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_maximal_non_branching_paths(adjacency_list)</span>
<span id="cb237-4283"><a href="#cb237-4283" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> path <span class="kw">in</span> result:</span>
<span id="cb237-4284"><a href="#cb237-4284" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">" -&gt; "</span>.join(path))</span>
<span id="cb237-4285"><a href="#cb237-4285" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4286"><a href="#cb237-4286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4287"><a href="#cb237-4287" aria-hidden="true" tabindex="-1"></a><span class="co"># Translate an RNA String into an Amino Acid String</span></span>
<span id="cb237-4288"><a href="#cb237-4288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4289"><a href="#cb237-4289" aria-hidden="true" tabindex="-1"></a>Protein Translation Problem. Translate an&nbsp;[RNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>rna<span class="op">-</span>string<span class="op">/</span>)&nbsp;into an&nbsp;[amino acid string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>).</span>
<span id="cb237-4290"><a href="#cb237-4290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4291"><a href="#cb237-4291" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An RNA string&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>.</span>
<span id="cb237-4292"><a href="#cb237-4292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4293"><a href="#cb237-4293" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The translation of&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>&nbsp;into an amino acid string&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>.</span>
<span id="cb237-4294"><a href="#cb237-4294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4295"><a href="#cb237-4295" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-4296"><a href="#cb237-4296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4297"><a href="#cb237-4297" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4298"><a href="#cb237-4298" aria-hidden="true" tabindex="-1"></a>AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA</span>
<span id="cb237-4299"><a href="#cb237-4299" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4300"><a href="#cb237-4300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4301"><a href="#cb237-4301" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-4302"><a href="#cb237-4302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4303"><a href="#cb237-4303" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4304"><a href="#cb237-4304" aria-hidden="true" tabindex="-1"></a>MAMAPRTEINSTRING</span>
<span id="cb237-4305"><a href="#cb237-4305" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4306"><a href="#cb237-4306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4307"><a href="#cb237-4307" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-4308"><a href="#cb237-4308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4309"><a href="#cb237-4309" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-4310"><a href="#cb237-4310" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb237-4311"><a href="#cb237-4311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4312"><a href="#cb237-4312" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> translate_rna_to_protein(rna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-4313"><a href="#cb237-4313" aria-hidden="true" tabindex="-1"></a>    <span class="co"># RNA 코돈을 아미노산으로 변환하는 딕셔너리</span></span>
<span id="cb237-4314"><a href="#cb237-4314" aria-hidden="true" tabindex="-1"></a>    codon_table: Dict[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> {</span>
<span id="cb237-4315"><a href="#cb237-4315" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UUU'</span>: <span class="st">'F'</span>, <span class="st">'UUC'</span>: <span class="st">'F'</span>, <span class="st">'UUA'</span>: <span class="st">'L'</span>, <span class="st">'UUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb237-4316"><a href="#cb237-4316" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UCU'</span>: <span class="st">'S'</span>, <span class="st">'UCC'</span>: <span class="st">'S'</span>, <span class="st">'UCA'</span>: <span class="st">'S'</span>, <span class="st">'UCG'</span>: <span class="st">'S'</span>,</span>
<span id="cb237-4317"><a href="#cb237-4317" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UAU'</span>: <span class="st">'Y'</span>, <span class="st">'UAC'</span>: <span class="st">'Y'</span>, <span class="st">'UAA'</span>: <span class="st">'*'</span>, <span class="st">'UAG'</span>: <span class="st">'*'</span>,</span>
<span id="cb237-4318"><a href="#cb237-4318" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UGU'</span>: <span class="st">'C'</span>, <span class="st">'UGC'</span>: <span class="st">'C'</span>, <span class="st">'UGA'</span>: <span class="st">'*'</span>, <span class="st">'UGG'</span>: <span class="st">'W'</span>,</span>
<span id="cb237-4319"><a href="#cb237-4319" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CUU'</span>: <span class="st">'L'</span>, <span class="st">'CUC'</span>: <span class="st">'L'</span>, <span class="st">'CUA'</span>: <span class="st">'L'</span>, <span class="st">'CUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb237-4320"><a href="#cb237-4320" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CCU'</span>: <span class="st">'P'</span>, <span class="st">'CCC'</span>: <span class="st">'P'</span>, <span class="st">'CCA'</span>: <span class="st">'P'</span>, <span class="st">'CCG'</span>: <span class="st">'P'</span>,</span>
<span id="cb237-4321"><a href="#cb237-4321" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CAU'</span>: <span class="st">'H'</span>, <span class="st">'CAC'</span>: <span class="st">'H'</span>, <span class="st">'CAA'</span>: <span class="st">'Q'</span>, <span class="st">'CAG'</span>: <span class="st">'Q'</span>,</span>
<span id="cb237-4322"><a href="#cb237-4322" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CGU'</span>: <span class="st">'R'</span>, <span class="st">'CGC'</span>: <span class="st">'R'</span>, <span class="st">'CGA'</span>: <span class="st">'R'</span>, <span class="st">'CGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb237-4323"><a href="#cb237-4323" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AUU'</span>: <span class="st">'I'</span>, <span class="st">'AUC'</span>: <span class="st">'I'</span>, <span class="st">'AUA'</span>: <span class="st">'I'</span>, <span class="st">'AUG'</span>: <span class="st">'M'</span>,</span>
<span id="cb237-4324"><a href="#cb237-4324" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ACU'</span>: <span class="st">'T'</span>, <span class="st">'ACC'</span>: <span class="st">'T'</span>, <span class="st">'ACA'</span>: <span class="st">'T'</span>, <span class="st">'ACG'</span>: <span class="st">'T'</span>,</span>
<span id="cb237-4325"><a href="#cb237-4325" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AAU'</span>: <span class="st">'N'</span>, <span class="st">'AAC'</span>: <span class="st">'N'</span>, <span class="st">'AAA'</span>: <span class="st">'K'</span>, <span class="st">'AAG'</span>: <span class="st">'K'</span>,</span>
<span id="cb237-4326"><a href="#cb237-4326" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AGU'</span>: <span class="st">'S'</span>, <span class="st">'AGC'</span>: <span class="st">'S'</span>, <span class="st">'AGA'</span>: <span class="st">'R'</span>, <span class="st">'AGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb237-4327"><a href="#cb237-4327" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GUU'</span>: <span class="st">'V'</span>, <span class="st">'GUC'</span>: <span class="st">'V'</span>, <span class="st">'GUA'</span>: <span class="st">'V'</span>, <span class="st">'GUG'</span>: <span class="st">'V'</span>,</span>
<span id="cb237-4328"><a href="#cb237-4328" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GCU'</span>: <span class="st">'A'</span>, <span class="st">'GCC'</span>: <span class="st">'A'</span>, <span class="st">'GCA'</span>: <span class="st">'A'</span>, <span class="st">'GCG'</span>: <span class="st">'A'</span>,</span>
<span id="cb237-4329"><a href="#cb237-4329" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GAU'</span>: <span class="st">'D'</span>, <span class="st">'GAC'</span>: <span class="st">'D'</span>, <span class="st">'GAA'</span>: <span class="st">'E'</span>, <span class="st">'GAG'</span>: <span class="st">'E'</span>,</span>
<span id="cb237-4330"><a href="#cb237-4330" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GGU'</span>: <span class="st">'G'</span>, <span class="st">'GGC'</span>: <span class="st">'G'</span>, <span class="st">'GGA'</span>: <span class="st">'G'</span>, <span class="st">'GGG'</span>: <span class="st">'G'</span></span>
<span id="cb237-4331"><a href="#cb237-4331" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb237-4332"><a href="#cb237-4332" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4333"><a href="#cb237-4333" aria-hidden="true" tabindex="-1"></a>    protein_sequence: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb237-4334"><a href="#cb237-4334" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4335"><a href="#cb237-4335" aria-hidden="true" tabindex="-1"></a>    <span class="co"># RNA 서열을 3개의 뉴클레오티드(코돈)씩 나누어 처리</span></span>
<span id="cb237-4336"><a href="#cb237-4336" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(rna_sequence), <span class="dv">3</span>):</span>
<span id="cb237-4337"><a href="#cb237-4337" aria-hidden="true" tabindex="-1"></a>        codon: <span class="bu">str</span> <span class="op">=</span> rna_sequence[i:i<span class="op">+</span><span class="dv">3</span>]</span>
<span id="cb237-4338"><a href="#cb237-4338" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-4339"><a href="#cb237-4339" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 코돈이 3개의 뉴클레오티드로 완전하지 않으면 중단</span></span>
<span id="cb237-4340"><a href="#cb237-4340" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(codon) <span class="op">!=</span> <span class="dv">3</span>:</span>
<span id="cb237-4341"><a href="#cb237-4341" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb237-4342"><a href="#cb237-4342" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-4343"><a href="#cb237-4343" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 코돈을 아미노산으로 변환</span></span>
<span id="cb237-4344"><a href="#cb237-4344" aria-hidden="true" tabindex="-1"></a>        amino_acid: <span class="bu">str</span> <span class="op">=</span> codon_table.get(codon, <span class="st">''</span>)</span>
<span id="cb237-4345"><a href="#cb237-4345" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-4346"><a href="#cb237-4346" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 종결 코돈('*')을 만나면 번역 중단</span></span>
<span id="cb237-4347"><a href="#cb237-4347" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> amino_acid <span class="op">==</span> <span class="st">'*'</span>:</span>
<span id="cb237-4348"><a href="#cb237-4348" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb237-4349"><a href="#cb237-4349" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-4350"><a href="#cb237-4350" aria-hidden="true" tabindex="-1"></a>        protein_sequence <span class="op">+=</span> amino_acid</span>
<span id="cb237-4351"><a href="#cb237-4351" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4352"><a href="#cb237-4352" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> protein_sequence</span>
<span id="cb237-4353"><a href="#cb237-4353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4354"><a href="#cb237-4354" aria-hidden="true" tabindex="-1"></a><span class="co"># 입력 RNA 서열</span></span>
<span id="cb237-4355"><a href="#cb237-4355" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-4356"><a href="#cb237-4356" aria-hidden="true" tabindex="-1"></a><span class="st">AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA</span></span>
<span id="cb237-4357"><a href="#cb237-4357" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-4358"><a href="#cb237-4358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4359"><a href="#cb237-4359" aria-hidden="true" tabindex="-1"></a>rna_sequence: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span>.join(sample_input.strip().split())</span>
<span id="cb237-4360"><a href="#cb237-4360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4361"><a href="#cb237-4361" aria-hidden="true" tabindex="-1"></a><span class="co"># RNA를 단백질로 번역</span></span>
<span id="cb237-4362"><a href="#cb237-4362" aria-hidden="true" tabindex="-1"></a>protein: <span class="bu">str</span> <span class="op">=</span> translate_rna_to_protein(rna_sequence)</span>
<span id="cb237-4363"><a href="#cb237-4363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4364"><a href="#cb237-4364" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(protein)</span>
<span id="cb237-4365"><a href="#cb237-4365" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4366"><a href="#cb237-4366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4367"><a href="#cb237-4367" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Substrings of a Genome Encoding a Given Amino Acid String</span></span>
<span id="cb237-4368"><a href="#cb237-4368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4369"><a href="#cb237-4369" aria-hidden="true" tabindex="-1"></a>Peptide Encoding Problem, Find substrings of a genome encoding a given amino acid sequence.</span>
<span id="cb237-4370"><a href="#cb237-4370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4371"><a href="#cb237-4371" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[DNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;and an&nbsp;[amino acid string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>.</span>
<span id="cb237-4372"><a href="#cb237-4372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4373"><a href="#cb237-4373" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All substrings of&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;encoding&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>&nbsp;(<span class="cf">if</span> <span class="bu">any</span> such substrings exist).</span>
<span id="cb237-4374"><a href="#cb237-4374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4375"><a href="#cb237-4375" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-4376"><a href="#cb237-4376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4377"><a href="#cb237-4377" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4378"><a href="#cb237-4378" aria-hidden="true" tabindex="-1"></a>ATGGCCATGGCCCCCAGAACTGAGATCAATAGTACCCGTATTAACGGGTGA</span>
<span id="cb237-4379"><a href="#cb237-4379" aria-hidden="true" tabindex="-1"></a>MA</span>
<span id="cb237-4380"><a href="#cb237-4380" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4381"><a href="#cb237-4381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4382"><a href="#cb237-4382" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-4383"><a href="#cb237-4383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4384"><a href="#cb237-4384" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4385"><a href="#cb237-4385" aria-hidden="true" tabindex="-1"></a>ATGGCC</span>
<span id="cb237-4386"><a href="#cb237-4386" aria-hidden="true" tabindex="-1"></a>GGCCAT</span>
<span id="cb237-4387"><a href="#cb237-4387" aria-hidden="true" tabindex="-1"></a>ATGGCC</span>
<span id="cb237-4388"><a href="#cb237-4388" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4389"><a href="#cb237-4389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4390"><a href="#cb237-4390" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-4391"><a href="#cb237-4391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4392"><a href="#cb237-4392" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-4393"><a href="#cb237-4393" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb237-4394"><a href="#cb237-4394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4395"><a href="#cb237-4395" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> translate_rna_to_protein(rna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-4396"><a href="#cb237-4396" aria-hidden="true" tabindex="-1"></a>    codon_to_amino_acid: Dict[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> {</span>
<span id="cb237-4397"><a href="#cb237-4397" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UUU'</span>: <span class="st">'F'</span>, <span class="st">'UUC'</span>: <span class="st">'F'</span>, <span class="st">'UUA'</span>: <span class="st">'L'</span>, <span class="st">'UUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb237-4398"><a href="#cb237-4398" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UCU'</span>: <span class="st">'S'</span>, <span class="st">'UCC'</span>: <span class="st">'S'</span>, <span class="st">'UCA'</span>: <span class="st">'S'</span>, <span class="st">'UCG'</span>: <span class="st">'S'</span>,</span>
<span id="cb237-4399"><a href="#cb237-4399" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UAU'</span>: <span class="st">'Y'</span>, <span class="st">'UAC'</span>: <span class="st">'Y'</span>, <span class="st">'UAA'</span>: <span class="st">'*'</span>, <span class="st">'UAG'</span>: <span class="st">'*'</span>,</span>
<span id="cb237-4400"><a href="#cb237-4400" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UGU'</span>: <span class="st">'C'</span>, <span class="st">'UGC'</span>: <span class="st">'C'</span>, <span class="st">'UGA'</span>: <span class="st">'*'</span>, <span class="st">'UGG'</span>: <span class="st">'W'</span>,</span>
<span id="cb237-4401"><a href="#cb237-4401" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CUU'</span>: <span class="st">'L'</span>, <span class="st">'CUC'</span>: <span class="st">'L'</span>, <span class="st">'CUA'</span>: <span class="st">'L'</span>, <span class="st">'CUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb237-4402"><a href="#cb237-4402" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CCU'</span>: <span class="st">'P'</span>, <span class="st">'CCC'</span>: <span class="st">'P'</span>, <span class="st">'CCA'</span>: <span class="st">'P'</span>, <span class="st">'CCG'</span>: <span class="st">'P'</span>,</span>
<span id="cb237-4403"><a href="#cb237-4403" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CAU'</span>: <span class="st">'H'</span>, <span class="st">'CAC'</span>: <span class="st">'H'</span>, <span class="st">'CAA'</span>: <span class="st">'Q'</span>, <span class="st">'CAG'</span>: <span class="st">'Q'</span>,</span>
<span id="cb237-4404"><a href="#cb237-4404" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CGU'</span>: <span class="st">'R'</span>, <span class="st">'CGC'</span>: <span class="st">'R'</span>, <span class="st">'CGA'</span>: <span class="st">'R'</span>, <span class="st">'CGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb237-4405"><a href="#cb237-4405" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AUU'</span>: <span class="st">'I'</span>, <span class="st">'AUC'</span>: <span class="st">'I'</span>, <span class="st">'AUA'</span>: <span class="st">'I'</span>, <span class="st">'AUG'</span>: <span class="st">'M'</span>,</span>
<span id="cb237-4406"><a href="#cb237-4406" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ACU'</span>: <span class="st">'T'</span>, <span class="st">'ACC'</span>: <span class="st">'T'</span>, <span class="st">'ACA'</span>: <span class="st">'T'</span>, <span class="st">'ACG'</span>: <span class="st">'T'</span>,</span>
<span id="cb237-4407"><a href="#cb237-4407" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AAU'</span>: <span class="st">'N'</span>, <span class="st">'AAC'</span>: <span class="st">'N'</span>, <span class="st">'AAA'</span>: <span class="st">'K'</span>, <span class="st">'AAG'</span>: <span class="st">'K'</span>,</span>
<span id="cb237-4408"><a href="#cb237-4408" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AGU'</span>: <span class="st">'S'</span>, <span class="st">'AGC'</span>: <span class="st">'S'</span>, <span class="st">'AGA'</span>: <span class="st">'R'</span>, <span class="st">'AGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb237-4409"><a href="#cb237-4409" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GUU'</span>: <span class="st">'V'</span>, <span class="st">'GUC'</span>: <span class="st">'V'</span>, <span class="st">'GUA'</span>: <span class="st">'V'</span>, <span class="st">'GUG'</span>: <span class="st">'V'</span>,</span>
<span id="cb237-4410"><a href="#cb237-4410" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GCU'</span>: <span class="st">'A'</span>, <span class="st">'GCC'</span>: <span class="st">'A'</span>, <span class="st">'GCA'</span>: <span class="st">'A'</span>, <span class="st">'GCG'</span>: <span class="st">'A'</span>,</span>
<span id="cb237-4411"><a href="#cb237-4411" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GAU'</span>: <span class="st">'D'</span>, <span class="st">'GAC'</span>: <span class="st">'D'</span>, <span class="st">'GAA'</span>: <span class="st">'E'</span>, <span class="st">'GAG'</span>: <span class="st">'E'</span>,</span>
<span id="cb237-4412"><a href="#cb237-4412" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GGU'</span>: <span class="st">'G'</span>, <span class="st">'GGC'</span>: <span class="st">'G'</span>, <span class="st">'GGA'</span>: <span class="st">'G'</span>, <span class="st">'GGG'</span>: <span class="st">'G'</span></span>
<span id="cb237-4413"><a href="#cb237-4413" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb237-4414"><a href="#cb237-4414" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4415"><a href="#cb237-4415" aria-hidden="true" tabindex="-1"></a>    protein_sequence: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb237-4416"><a href="#cb237-4416" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4417"><a href="#cb237-4417" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(rna_sequence), <span class="dv">3</span>):</span>
<span id="cb237-4418"><a href="#cb237-4418" aria-hidden="true" tabindex="-1"></a>        codon: <span class="bu">str</span> <span class="op">=</span> rna_sequence[i:i<span class="op">+</span><span class="dv">3</span>]</span>
<span id="cb237-4419"><a href="#cb237-4419" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-4420"><a href="#cb237-4420" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(codon) <span class="op">!=</span> <span class="dv">3</span>:</span>
<span id="cb237-4421"><a href="#cb237-4421" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb237-4422"><a href="#cb237-4422" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-4423"><a href="#cb237-4423" aria-hidden="true" tabindex="-1"></a>        amino_acid: <span class="bu">str</span> <span class="op">=</span> codon_to_amino_acid.get(codon, <span class="st">''</span>)</span>
<span id="cb237-4424"><a href="#cb237-4424" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-4425"><a href="#cb237-4425" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> amino_acid <span class="op">==</span> <span class="st">'*'</span>:</span>
<span id="cb237-4426"><a href="#cb237-4426" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb237-4427"><a href="#cb237-4427" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-4428"><a href="#cb237-4428" aria-hidden="true" tabindex="-1"></a>        protein_sequence.append(amino_acid)</span>
<span id="cb237-4429"><a href="#cb237-4429" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4430"><a href="#cb237-4430" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span>.join(protein_sequence)</span>
<span id="cb237-4431"><a href="#cb237-4431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4432"><a href="#cb237-4432" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(dna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-4433"><a href="#cb237-4433" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb237-4434"><a href="#cb237-4434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4435"><a href="#cb237-4435" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dna_to_rna(dna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-4436"><a href="#cb237-4436" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence.replace(<span class="st">"T"</span>, <span class="st">"U"</span>)</span>
<span id="cb237-4437"><a href="#cb237-4437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4438"><a href="#cb237-4438" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_peptide_encoding_substrings(dna_sequence: <span class="bu">str</span>, peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-4439"><a href="#cb237-4439" aria-hidden="true" tabindex="-1"></a>    substring_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(peptide) <span class="op">*</span> <span class="dv">3</span></span>
<span id="cb237-4440"><a href="#cb237-4440" aria-hidden="true" tabindex="-1"></a>    encoding_substrings: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb237-4441"><a href="#cb237-4441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4442"><a href="#cb237-4442" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-4443"><a href="#cb237-4443" aria-hidden="true" tabindex="-1"></a>        dna_substring: <span class="bu">str</span> <span class="op">=</span> dna_sequence[i:i <span class="op">+</span> substring_length]</span>
<span id="cb237-4444"><a href="#cb237-4444" aria-hidden="true" tabindex="-1"></a>        reverse_complement_substring: <span class="bu">str</span> <span class="op">=</span> reverse_complement(dna_substring)</span>
<span id="cb237-4445"><a href="#cb237-4445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4446"><a href="#cb237-4446" aria-hidden="true" tabindex="-1"></a>        rna_substring: <span class="bu">str</span> <span class="op">=</span> dna_to_rna(dna_substring)</span>
<span id="cb237-4447"><a href="#cb237-4447" aria-hidden="true" tabindex="-1"></a>        reverse_complement_rna: <span class="bu">str</span> <span class="op">=</span> dna_to_rna(reverse_complement_substring)</span>
<span id="cb237-4448"><a href="#cb237-4448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4449"><a href="#cb237-4449" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (translate_rna_to_protein(rna_substring) <span class="op">==</span> peptide <span class="kw">or</span> </span>
<span id="cb237-4450"><a href="#cb237-4450" aria-hidden="true" tabindex="-1"></a>            translate_rna_to_protein(reverse_complement_rna) <span class="op">==</span> peptide):</span>
<span id="cb237-4451"><a href="#cb237-4451" aria-hidden="true" tabindex="-1"></a>            encoding_substrings.append(dna_substring)</span>
<span id="cb237-4452"><a href="#cb237-4452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4453"><a href="#cb237-4453" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> encoding_substrings</span>
<span id="cb237-4454"><a href="#cb237-4454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4455"><a href="#cb237-4455" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-4456"><a href="#cb237-4456" aria-hidden="true" tabindex="-1"></a><span class="st">ATGGCCATGGCCCCCAGAACTGAGATCAATAGTACCCGTATTAACGGGTGA</span></span>
<span id="cb237-4457"><a href="#cb237-4457" aria-hidden="true" tabindex="-1"></a><span class="st">MA</span></span>
<span id="cb237-4458"><a href="#cb237-4458" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-4459"><a href="#cb237-4459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4460"><a href="#cb237-4460" aria-hidden="true" tabindex="-1"></a>dna_sequence, peptide <span class="op">=</span> sample_input.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb237-4461"><a href="#cb237-4461" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> find_peptide_encoding_substrings(dna_sequence, peptide)</span>
<span id="cb237-4462"><a href="#cb237-4462" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(result))</span>
<span id="cb237-4463"><a href="#cb237-4463" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4464"><a href="#cb237-4464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4465"><a href="#cb237-4465" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the Theoretical Spectrum of a Cyclic Peptide</span></span>
<span id="cb237-4466"><a href="#cb237-4466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4467"><a href="#cb237-4467" aria-hidden="true" tabindex="-1"></a> Generating Theoretical Spectrum Problem, Generate the theoretical spectrum of a cyclic peptide.</span>
<span id="cb237-4468"><a href="#cb237-4468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4469"><a href="#cb237-4469" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An amino acid string&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>.</span>
<span id="cb237-4470"><a href="#cb237-4470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4471"><a href="#cb237-4471" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>Cyclospectrum<span class="op">*</span>(<span class="op">*</span>Peptide<span class="op">*</span>).</span>
<span id="cb237-4472"><a href="#cb237-4472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4473"><a href="#cb237-4473" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-4474"><a href="#cb237-4474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4475"><a href="#cb237-4475" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4476"><a href="#cb237-4476" aria-hidden="true" tabindex="-1"></a>LEQN</span>
<span id="cb237-4477"><a href="#cb237-4477" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4478"><a href="#cb237-4478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4479"><a href="#cb237-4479" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-4480"><a href="#cb237-4480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4481"><a href="#cb237-4481" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4482"><a href="#cb237-4482" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">113</span> <span class="dv">114</span> <span class="dv">128</span> <span class="dv">129</span> <span class="dv">227</span> <span class="dv">242</span> <span class="dv">242</span> <span class="dv">257</span> <span class="dv">355</span> <span class="dv">356</span> <span class="dv">370</span> <span class="dv">371</span> <span class="dv">484</span></span>
<span id="cb237-4483"><a href="#cb237-4483" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4484"><a href="#cb237-4484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4485"><a href="#cb237-4485" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-4486"><a href="#cb237-4486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4487"><a href="#cb237-4487" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-4488"><a href="#cb237-4488" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb237-4489"><a href="#cb237-4489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4490"><a href="#cb237-4490" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb237-4491"><a href="#cb237-4491" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb237-4492"><a href="#cb237-4492" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb237-4493"><a href="#cb237-4493" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb237-4494"><a href="#cb237-4494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4495"><a href="#cb237-4495" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-4496"><a href="#cb237-4496" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[amino_acid] <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide)</span>
<span id="cb237-4497"><a href="#cb237-4497" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb237-4498"><a href="#cb237-4498" aria-hidden="true" tabindex="-1"></a>    circular_peptide: <span class="bu">str</span> <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb237-4499"><a href="#cb237-4499" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4500"><a href="#cb237-4500" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> subpeptide_length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb237-4501"><a href="#cb237-4501" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb237-4502"><a href="#cb237-4502" aria-hidden="true" tabindex="-1"></a>            subpeptide: <span class="bu">str</span> <span class="op">=</span> circular_peptide[start_index:start_index <span class="op">+</span> subpeptide_length]</span>
<span id="cb237-4503"><a href="#cb237-4503" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[amino_acid] <span class="cf">for</span> amino_acid <span class="kw">in</span> subpeptide)</span>
<span id="cb237-4504"><a href="#cb237-4504" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb237-4505"><a href="#cb237-4505" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4506"><a href="#cb237-4506" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(spectrum)</span>
<span id="cb237-4507"><a href="#cb237-4507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4508"><a href="#cb237-4508" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-4509"><a href="#cb237-4509" aria-hidden="true" tabindex="-1"></a><span class="st">LEQN</span></span>
<span id="cb237-4510"><a href="#cb237-4510" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-4511"><a href="#cb237-4511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4512"><a href="#cb237-4512" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb237-4513"><a href="#cb237-4513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4514"><a href="#cb237-4514" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(input_peptide)</span>
<span id="cb237-4515"><a href="#cb237-4515" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span>
<span id="cb237-4516"><a href="#cb237-4516" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4517"><a href="#cb237-4517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4518"><a href="#cb237-4518" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Number of Peptides of Given Total Mass</span></span>
<span id="cb237-4519"><a href="#cb237-4519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4520"><a href="#cb237-4520" aria-hidden="true" tabindex="-1"></a>Counting Peptides <span class="cf">with</span> Given Mass Problem, Compute the number of peptides of given total mass.</span>
<span id="cb237-4521"><a href="#cb237-4521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4522"><a href="#cb237-4522" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>m<span class="op">*</span>.</span>
<span id="cb237-4523"><a href="#cb237-4523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4524"><a href="#cb237-4524" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The number of linear peptides having integer mass&nbsp;<span class="op">*</span>m<span class="op">*</span>.</span>
<span id="cb237-4525"><a href="#cb237-4525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4526"><a href="#cb237-4526" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-4527"><a href="#cb237-4527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4528"><a href="#cb237-4528" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4529"><a href="#cb237-4529" aria-hidden="true" tabindex="-1"></a><span class="dv">1024</span></span>
<span id="cb237-4530"><a href="#cb237-4530" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4531"><a href="#cb237-4531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4532"><a href="#cb237-4532" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-4533"><a href="#cb237-4533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4534"><a href="#cb237-4534" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4535"><a href="#cb237-4535" aria-hidden="true" tabindex="-1"></a><span class="dv">14712706211</span></span>
<span id="cb237-4536"><a href="#cb237-4536" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4537"><a href="#cb237-4537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4538"><a href="#cb237-4538" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-4539"><a href="#cb237-4539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4540"><a href="#cb237-4540" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-4541"><a href="#cb237-4541" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb237-4542"><a href="#cb237-4542" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb237-4543"><a href="#cb237-4543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4544"><a href="#cb237-4544" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb237-4545"><a href="#cb237-4545" aria-hidden="true" tabindex="-1"></a>LIGHTEST_AMINO_ACID: <span class="bu">int</span> <span class="op">=</span> <span class="bu">min</span>(AMINO_ACID_MASSES)</span>
<span id="cb237-4546"><a href="#cb237-4546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4547"><a href="#cb237-4547" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_possible_peptides(target_mass: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-4548"><a href="#cb237-4548" aria-hidden="true" tabindex="-1"></a>    peptide_count: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb237-4549"><a href="#cb237-4549" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4550"><a href="#cb237-4550" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_mass <span class="kw">in</span> <span class="bu">range</span>(LIGHTEST_AMINO_ACID, target_mass <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-4551"><a href="#cb237-4551" aria-hidden="true" tabindex="-1"></a>        peptide_count[current_mass] <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> amino_acid_mass <span class="kw">in</span> AMINO_ACID_MASSES <span class="cf">if</span> amino_acid_mass <span class="op">==</span> current_mass)</span>
<span id="cb237-4552"><a href="#cb237-4552" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-4553"><a href="#cb237-4553" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> amino_acid_mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb237-4554"><a href="#cb237-4554" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_mass <span class="op">&gt;=</span> amino_acid_mass:</span>
<span id="cb237-4555"><a href="#cb237-4555" aria-hidden="true" tabindex="-1"></a>                peptide_count[current_mass] <span class="op">+=</span> peptide_count[current_mass <span class="op">-</span> amino_acid_mass]</span>
<span id="cb237-4556"><a href="#cb237-4556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4557"><a href="#cb237-4557" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide_count[target_mass]</span>
<span id="cb237-4558"><a href="#cb237-4558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4559"><a href="#cb237-4559" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-4560"><a href="#cb237-4560" aria-hidden="true" tabindex="-1"></a><span class="st">1024</span></span>
<span id="cb237-4561"><a href="#cb237-4561" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-4562"><a href="#cb237-4562" aria-hidden="true" tabindex="-1"></a>target_peptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(sample_input.strip())</span>
<span id="cb237-4563"><a href="#cb237-4563" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> count_possible_peptides(target_peptide_mass)</span>
<span id="cb237-4564"><a href="#cb237-4564" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb237-4565"><a href="#cb237-4565" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4566"><a href="#cb237-4566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4567"><a href="#cb237-4567" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Cyclic Peptide with Theoretical Spectrum Matching an Ideal Spectrum</span></span>
<span id="cb237-4568"><a href="#cb237-4568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4569"><a href="#cb237-4569" aria-hidden="true" tabindex="-1"></a>Cyclopeptide Sequencing Problem, Given an ideal experimental spectrum, find a cyclic peptide whose theoretical spectrum matches the experimental spectrum.</span>
<span id="cb237-4570"><a href="#cb237-4570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4571"><a href="#cb237-4571" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection of (possibly repeated) integers&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>&nbsp;corresponding to an ideal experimental spectrum.</span>
<span id="cb237-4572"><a href="#cb237-4572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4573"><a href="#cb237-4573" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;Every amino acid string&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>&nbsp;such that&nbsp;<span class="op">*</span>Cyclospectrum<span class="op">*</span>(<span class="op">*</span>Peptide<span class="op">*</span>) <span class="op">=</span>&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>&nbsp;(<span class="cf">if</span> such a string exists).</span>
<span id="cb237-4574"><a href="#cb237-4574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4575"><a href="#cb237-4575" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-4576"><a href="#cb237-4576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4577"><a href="#cb237-4577" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4578"><a href="#cb237-4578" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">113</span> <span class="dv">128</span> <span class="dv">186</span> <span class="dv">241</span> <span class="dv">299</span> <span class="dv">314</span> <span class="dv">427</span></span>
<span id="cb237-4579"><a href="#cb237-4579" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4580"><a href="#cb237-4580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4581"><a href="#cb237-4581" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-4582"><a href="#cb237-4582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4583"><a href="#cb237-4583" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4584"><a href="#cb237-4584" aria-hidden="true" tabindex="-1"></a><span class="dv">113</span><span class="op">-</span><span class="dv">128</span><span class="op">-</span><span class="dv">186</span> <span class="dv">113</span><span class="op">-</span><span class="dv">186</span><span class="op">-</span><span class="dv">128</span> <span class="dv">186</span><span class="op">-</span><span class="dv">128</span><span class="op">-</span><span class="dv">113</span> <span class="dv">128</span><span class="op">-</span><span class="dv">186</span><span class="op">-</span><span class="dv">113</span> <span class="dv">186</span><span class="op">-</span><span class="dv">113</span><span class="op">-</span><span class="dv">128</span> <span class="dv">128</span><span class="op">-</span><span class="dv">113</span><span class="op">-</span><span class="dv">186</span></span>
<span id="cb237-4585"><a href="#cb237-4585" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4586"><a href="#cb237-4586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4587"><a href="#cb237-4587" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-4588"><a href="#cb237-4588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4589"><a href="#cb237-4589" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-4590"><a href="#cb237-4590" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set</span>
<span id="cb237-4591"><a href="#cb237-4591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4592"><a href="#cb237-4592" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb237-4593"><a href="#cb237-4593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4594"><a href="#cb237-4594" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-4595"><a href="#cb237-4595" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">sum</span>(peptide)]</span>
<span id="cb237-4596"><a href="#cb237-4596" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb237-4597"><a href="#cb237-4597" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb237-4598"><a href="#cb237-4598" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb237-4599"><a href="#cb237-4599" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[i:i <span class="op">+</span> k]</span>
<span id="cb237-4600"><a href="#cb237-4600" aria-hidden="true" tabindex="-1"></a>            spectrum.append(<span class="bu">sum</span>(subpeptide))</span>
<span id="cb237-4601"><a href="#cb237-4601" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb237-4602"><a href="#cb237-4602" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb237-4603"><a href="#cb237-4603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4604"><a href="#cb237-4604" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-4605"><a href="#cb237-4605" aria-hidden="true" tabindex="-1"></a>    prefix_mass: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb237-4606"><a href="#cb237-4606" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> peptide:</span>
<span id="cb237-4607"><a href="#cb237-4607" aria-hidden="true" tabindex="-1"></a>        prefix_mass.append(prefix_mass[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> mass)</span>
<span id="cb237-4608"><a href="#cb237-4608" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb237-4609"><a href="#cb237-4609" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb237-4610"><a href="#cb237-4610" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-4611"><a href="#cb237-4611" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(prefix_mass[j] <span class="op">-</span> prefix_mass[i])</span>
<span id="cb237-4612"><a href="#cb237-4612" aria-hidden="true" tabindex="-1"></a>    linear_spectrum.sort()</span>
<span id="cb237-4613"><a href="#cb237-4613" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linear_spectrum</span>
<span id="cb237-4614"><a href="#cb237-4614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4615"><a href="#cb237-4615" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb237-4616"><a href="#cb237-4616" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb237-4617"><a href="#cb237-4617" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb237-4618"><a href="#cb237-4618" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb237-4619"><a href="#cb237-4619" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb237-4620"><a href="#cb237-4620" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb237-4621"><a href="#cb237-4621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4622"><a href="#cb237-4622" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_consistent(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb237-4623"><a href="#cb237-4623" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> AMINO_ACID_MASSES[<span class="dv">0</span>]:</span>
<span id="cb237-4624"><a href="#cb237-4624" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb237-4625"><a href="#cb237-4625" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb237-4626"><a href="#cb237-4626" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(mass <span class="kw">in</span> spectrum <span class="cf">for</span> mass <span class="kw">in</span> peptide_spectrum)</span>
<span id="cb237-4627"><a href="#cb237-4627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4628"><a href="#cb237-4628" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb237-4629"><a href="#cb237-4629" aria-hidden="true" tabindex="-1"></a>    candidate_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb237-4630"><a href="#cb237-4630" aria-hidden="true" tabindex="-1"></a>    result: Set[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb237-4631"><a href="#cb237-4631" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4632"><a href="#cb237-4632" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> candidate_peptides:</span>
<span id="cb237-4633"><a href="#cb237-4633" aria-hidden="true" tabindex="-1"></a>        candidate_peptides <span class="op">=</span> expand_peptides(candidate_peptides)</span>
<span id="cb237-4634"><a href="#cb237-4634" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> candidate_peptides[:]:</span>
<span id="cb237-4635"><a href="#cb237-4635" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb237-4636"><a href="#cb237-4636" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_cyclospectrum(peptide) <span class="op">==</span> spectrum:</span>
<span id="cb237-4637"><a href="#cb237-4637" aria-hidden="true" tabindex="-1"></a>                    result.add(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, peptide)))</span>
<span id="cb237-4638"><a href="#cb237-4638" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb237-4639"><a href="#cb237-4639" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="kw">not</span> is_consistent(peptide, spectrum):</span>
<span id="cb237-4640"><a href="#cb237-4640" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb237-4641"><a href="#cb237-4641" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4642"><a href="#cb237-4642" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb237-4643"><a href="#cb237-4643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4644"><a href="#cb237-4644" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-4645"><a href="#cb237-4645" aria-hidden="true" tabindex="-1"></a><span class="st">0 113 128 186 241 299 314 427</span></span>
<span id="cb237-4646"><a href="#cb237-4646" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-4647"><a href="#cb237-4647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4648"><a href="#cb237-4648" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb237-4649"><a href="#cb237-4649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4650"><a href="#cb237-4650" aria-hidden="true" tabindex="-1"></a>result: Set[<span class="bu">str</span>] <span class="op">=</span> cyclopeptide_sequencing(input_spectrum)</span>
<span id="cb237-4651"><a href="#cb237-4651" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(result))</span>
<span id="cb237-4652"><a href="#cb237-4652" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4653"><a href="#cb237-4653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4654"><a href="#cb237-4654" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Score of a Cyclic Peptide Against a Spectrum</span></span>
<span id="cb237-4655"><a href="#cb237-4655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4656"><a href="#cb237-4656" aria-hidden="true" tabindex="-1"></a>Cyclic Peptide Scoring Problem, Compute the score of a cyclic peptide against a spectrum.</span>
<span id="cb237-4657"><a href="#cb237-4657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4658"><a href="#cb237-4658" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An amino acid string&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>&nbsp;and a collection of integers&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>.</span>
<span id="cb237-4659"><a href="#cb237-4659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4660"><a href="#cb237-4660" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The score of&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>&nbsp;against&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>,&nbsp;<span class="op">*</span>Score<span class="op">*</span>(<span class="op">*</span>Peptide<span class="op">*</span>,&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>).</span>
<span id="cb237-4661"><a href="#cb237-4661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4662"><a href="#cb237-4662" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-4663"><a href="#cb237-4663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4664"><a href="#cb237-4664" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4665"><a href="#cb237-4665" aria-hidden="true" tabindex="-1"></a>NQEL</span>
<span id="cb237-4666"><a href="#cb237-4666" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">99</span> <span class="dv">113</span> <span class="dv">114</span> <span class="dv">128</span> <span class="dv">227</span> <span class="dv">257</span> <span class="dv">299</span> <span class="dv">355</span> <span class="dv">356</span> <span class="dv">370</span> <span class="dv">371</span> <span class="dv">484</span></span>
<span id="cb237-4667"><a href="#cb237-4667" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4668"><a href="#cb237-4668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4669"><a href="#cb237-4669" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-4670"><a href="#cb237-4670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4671"><a href="#cb237-4671" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4672"><a href="#cb237-4672" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span></span>
<span id="cb237-4673"><a href="#cb237-4673" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4674"><a href="#cb237-4674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4675"><a href="#cb237-4675" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-4676"><a href="#cb237-4676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4677"><a href="#cb237-4677" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-4678"><a href="#cb237-4678" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb237-4679"><a href="#cb237-4679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4680"><a href="#cb237-4680" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb237-4681"><a href="#cb237-4681" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb237-4682"><a href="#cb237-4682" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb237-4683"><a href="#cb237-4683" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb237-4684"><a href="#cb237-4684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4685"><a href="#cb237-4685" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-4686"><a href="#cb237-4686" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[aa] <span class="cf">for</span> aa <span class="kw">in</span> peptide)</span>
<span id="cb237-4687"><a href="#cb237-4687" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb237-4688"><a href="#cb237-4688" aria-hidden="true" tabindex="-1"></a>    extended_peptide: <span class="bu">str</span> <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb237-4689"><a href="#cb237-4689" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4690"><a href="#cb237-4690" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb237-4691"><a href="#cb237-4691" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb237-4692"><a href="#cb237-4692" aria-hidden="true" tabindex="-1"></a>            subpeptide: <span class="bu">str</span> <span class="op">=</span> extended_peptide[start:start <span class="op">+</span> length]</span>
<span id="cb237-4693"><a href="#cb237-4693" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[aa] <span class="cf">for</span> aa <span class="kw">in</span> subpeptide)</span>
<span id="cb237-4694"><a href="#cb237-4694" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb237-4695"><a href="#cb237-4695" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4696"><a href="#cb237-4696" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb237-4697"><a href="#cb237-4697" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb237-4698"><a href="#cb237-4698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4699"><a href="#cb237-4699" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-4700"><a href="#cb237-4700" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb237-4701"><a href="#cb237-4701" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-4702"><a href="#cb237-4702" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb237-4703"><a href="#cb237-4703" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4704"><a href="#cb237-4704" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb237-4705"><a href="#cb237-4705" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb237-4706"><a href="#cb237-4706" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4707"><a href="#cb237-4707" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb237-4708"><a href="#cb237-4708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4709"><a href="#cb237-4709" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-4710"><a href="#cb237-4710" aria-hidden="true" tabindex="-1"></a><span class="st">NQEL</span></span>
<span id="cb237-4711"><a href="#cb237-4711" aria-hidden="true" tabindex="-1"></a><span class="st">0 99 113 114 128 227 257 299 355 356 370 371 484</span></span>
<span id="cb237-4712"><a href="#cb237-4712" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-4713"><a href="#cb237-4713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4714"><a href="#cb237-4714" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-4715"><a href="#cb237-4715" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb237-4716"><a href="#cb237-4716" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb237-4717"><a href="#cb237-4717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4718"><a href="#cb237-4718" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> calculate_score(input_peptide, input_spectrum)</span>
<span id="cb237-4719"><a href="#cb237-4719" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb237-4720"><a href="#cb237-4720" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4721"><a href="#cb237-4721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4722"><a href="#cb237-4722" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement LeaderboardCyclopeptideSequencing</span></span>
<span id="cb237-4723"><a href="#cb237-4723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4724"><a href="#cb237-4724" aria-hidden="true" tabindex="-1"></a>Implement&nbsp;<span class="op">*</span>LeaderboardCyclopeptideSequencing<span class="op">*</span></span>
<span id="cb237-4725"><a href="#cb237-4725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4726"><a href="#cb237-4726" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>N<span class="op">*</span>&nbsp;and a collection of integers&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>.</span>
<span id="cb237-4727"><a href="#cb237-4727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4728"><a href="#cb237-4728" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>LeaderPeptide<span class="op">*</span>&nbsp;after running&nbsp;<span class="op">*</span>LeaderboardCyclopeptideSequencing<span class="op">*</span>(<span class="op">*</span>Spectrum<span class="op">*</span>,&nbsp;<span class="op">*</span>N<span class="op">*</span>).</span>
<span id="cb237-4729"><a href="#cb237-4729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4730"><a href="#cb237-4730" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-4731"><a href="#cb237-4731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4732"><a href="#cb237-4732" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4733"><a href="#cb237-4733" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span>
<span id="cb237-4734"><a href="#cb237-4734" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">71</span> <span class="dv">113</span> <span class="dv">129</span> <span class="dv">147</span> <span class="dv">200</span> <span class="dv">218</span> <span class="dv">260</span> <span class="dv">313</span> <span class="dv">331</span> <span class="dv">347</span> <span class="dv">389</span> <span class="dv">460</span></span>
<span id="cb237-4735"><a href="#cb237-4735" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4736"><a href="#cb237-4736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4737"><a href="#cb237-4737" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-4738"><a href="#cb237-4738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4739"><a href="#cb237-4739" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4740"><a href="#cb237-4740" aria-hidden="true" tabindex="-1"></a><span class="dv">113</span><span class="op">-</span><span class="dv">147</span><span class="op">-</span><span class="dv">71</span><span class="op">-</span><span class="dv">129</span></span>
<span id="cb237-4741"><a href="#cb237-4741" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4742"><a href="#cb237-4742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4743"><a href="#cb237-4743" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-4744"><a href="#cb237-4744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4745"><a href="#cb237-4745" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-4746"><a href="#cb237-4746" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Dict</span>
<span id="cb237-4747"><a href="#cb237-4747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4748"><a href="#cb237-4748" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb237-4749"><a href="#cb237-4749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4750"><a href="#cb237-4750" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb237-4751"><a href="#cb237-4751" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb237-4752"><a href="#cb237-4752" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb237-4753"><a href="#cb237-4753" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb237-4754"><a href="#cb237-4754" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb237-4755"><a href="#cb237-4755" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb237-4756"><a href="#cb237-4756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4757"><a href="#cb237-4757" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-4758"><a href="#cb237-4758" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(peptide)</span>
<span id="cb237-4759"><a href="#cb237-4759" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb237-4760"><a href="#cb237-4760" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb237-4761"><a href="#cb237-4761" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4762"><a href="#cb237-4762" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb237-4763"><a href="#cb237-4763" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb237-4764"><a href="#cb237-4764" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[start:start <span class="op">+</span> length]</span>
<span id="cb237-4765"><a href="#cb237-4765" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(subpeptide)</span>
<span id="cb237-4766"><a href="#cb237-4766" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb237-4767"><a href="#cb237-4767" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4768"><a href="#cb237-4768" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb237-4769"><a href="#cb237-4769" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb237-4770"><a href="#cb237-4770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4771"><a href="#cb237-4771" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_consistent(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb237-4772"><a href="#cb237-4772" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb237-4773"><a href="#cb237-4773" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(peptide_spectrum.count(mass) <span class="op">&lt;=</span> spectrum.count(mass) <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(peptide_spectrum))</span>
<span id="cb237-4774"><a href="#cb237-4774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4775"><a href="#cb237-4775" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb237-4776"><a href="#cb237-4776" aria-hidden="true" tabindex="-1"></a>    result: Set[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb237-4777"><a href="#cb237-4777" aria-hidden="true" tabindex="-1"></a>    candidate_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb237-4778"><a href="#cb237-4778" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> candidate_peptides:</span>
<span id="cb237-4779"><a href="#cb237-4779" aria-hidden="true" tabindex="-1"></a>        candidate_peptides <span class="op">=</span> expand_peptides(candidate_peptides)</span>
<span id="cb237-4780"><a href="#cb237-4780" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> candidate_peptides[:]:</span>
<span id="cb237-4781"><a href="#cb237-4781" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb237-4782"><a href="#cb237-4782" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_cyclospectrum(peptide) <span class="op">==</span> spectrum:</span>
<span id="cb237-4783"><a href="#cb237-4783" aria-hidden="true" tabindex="-1"></a>                    result.add(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, peptide)))</span>
<span id="cb237-4784"><a href="#cb237-4784" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb237-4785"><a href="#cb237-4785" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="kw">not</span> is_consistent(peptide, spectrum):</span>
<span id="cb237-4786"><a href="#cb237-4786" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb237-4787"><a href="#cb237-4787" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb237-4788"><a href="#cb237-4788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4789"><a href="#cb237-4789" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-4790"><a href="#cb237-4790" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb237-4791"><a href="#cb237-4791" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-4792"><a href="#cb237-4792" aria-hidden="true" tabindex="-1"></a>    unique_masses: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(peptide_spectrum <span class="op">+</span> spectrum)</span>
<span id="cb237-4793"><a href="#cb237-4793" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb237-4794"><a href="#cb237-4794" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(peptide_spectrum.count(mass), spectrum.count(mass))</span>
<span id="cb237-4795"><a href="#cb237-4795" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb237-4796"><a href="#cb237-4796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4797"><a href="#cb237-4797" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[List[<span class="bu">int</span>]], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb237-4798"><a href="#cb237-4798" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb237-4799"><a href="#cb237-4799" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb237-4800"><a href="#cb237-4800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4801"><a href="#cb237-4801" aria-hidden="true" tabindex="-1"></a>    scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-4802"><a href="#cb237-4802" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb237-4803"><a href="#cb237-4803" aria-hidden="true" tabindex="-1"></a>        scores[i] <span class="op">=</span> calculate_score(peptide, spectrum)</span>
<span id="cb237-4804"><a href="#cb237-4804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4805"><a href="#cb237-4805" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb237-4806"><a href="#cb237-4806" aria-hidden="true" tabindex="-1"></a>    threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>] <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="bu">len</span>(sorted_scores) <span class="cf">else</span> sorted_scores[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb237-4807"><a href="#cb237-4807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4808"><a href="#cb237-4808" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> threshold]</span>
<span id="cb237-4809"><a href="#cb237-4809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4810"><a href="#cb237-4810" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> leaderboard_cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-4811"><a href="#cb237-4811" aria-hidden="true" tabindex="-1"></a>    leaderboard: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb237-4812"><a href="#cb237-4812" aria-hidden="true" tabindex="-1"></a>    leader_peptide: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb237-4813"><a href="#cb237-4813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4814"><a href="#cb237-4814" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> leaderboard:</span>
<span id="cb237-4815"><a href="#cb237-4815" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> expand_peptides(leaderboard)</span>
<span id="cb237-4816"><a href="#cb237-4816" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> leaderboard[:]:</span>
<span id="cb237-4817"><a href="#cb237-4817" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb237-4818"><a href="#cb237-4818" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_score(peptide, spectrum) <span class="op">&gt;</span> calculate_score(leader_peptide, spectrum):</span>
<span id="cb237-4819"><a href="#cb237-4819" aria-hidden="true" tabindex="-1"></a>                    leader_peptide <span class="op">=</span> peptide</span>
<span id="cb237-4820"><a href="#cb237-4820" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb237-4821"><a href="#cb237-4821" aria-hidden="true" tabindex="-1"></a>                leaderboard.remove(peptide)</span>
<span id="cb237-4822"><a href="#cb237-4822" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> trim_leaderboard(leaderboard, spectrum, n)</span>
<span id="cb237-4823"><a href="#cb237-4823" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> leader_peptide</span>
<span id="cb237-4824"><a href="#cb237-4824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4825"><a href="#cb237-4825" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-4826"><a href="#cb237-4826" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb237-4827"><a href="#cb237-4827" aria-hidden="true" tabindex="-1"></a><span class="st">0 71 113 129 147 200 218 260 313 331 347 389 460</span></span>
<span id="cb237-4828"><a href="#cb237-4828" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-4829"><a href="#cb237-4829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4830"><a href="#cb237-4830" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-4831"><a href="#cb237-4831" aria-hidden="true" tabindex="-1"></a>n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb237-4832"><a href="#cb237-4832" aria-hidden="true" tabindex="-1"></a>spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb237-4833"><a href="#cb237-4833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4834"><a href="#cb237-4834" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> leaderboard_cyclopeptide_sequencing(spectrum, n)</span>
<span id="cb237-4835"><a href="#cb237-4835" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span>
<span id="cb237-4836"><a href="#cb237-4836" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4837"><a href="#cb237-4837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4838"><a href="#cb237-4838" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the Convolution of a Spectrum</span></span>
<span id="cb237-4839"><a href="#cb237-4839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4840"><a href="#cb237-4840" aria-hidden="true" tabindex="-1"></a>Spectral Convolution Problem, Compute the convolution of a spectrum.</span>
<span id="cb237-4841"><a href="#cb237-4841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4842"><a href="#cb237-4842" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection of integers&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>.</span>
<span id="cb237-4843"><a href="#cb237-4843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4844"><a href="#cb237-4844" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The <span class="bu">list</span> of elements <span class="kw">in</span> the convolution of&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>&nbsp;in decreasing order of their multiplicities. If an element has multiplicity&nbsp;<span class="op">*</span>k<span class="op">*</span>, it should appear exactly&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;times.</span>
<span id="cb237-4845"><a href="#cb237-4845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4846"><a href="#cb237-4846" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-4847"><a href="#cb237-4847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4848"><a href="#cb237-4848" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4849"><a href="#cb237-4849" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">137</span> <span class="dv">186</span> <span class="dv">323</span></span>
<span id="cb237-4850"><a href="#cb237-4850" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4851"><a href="#cb237-4851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4852"><a href="#cb237-4852" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-4853"><a href="#cb237-4853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4854"><a href="#cb237-4854" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4855"><a href="#cb237-4855" aria-hidden="true" tabindex="-1"></a><span class="dv">137</span> <span class="dv">137</span> <span class="dv">186</span> <span class="dv">186</span> <span class="dv">323</span> <span class="dv">49</span></span>
<span id="cb237-4856"><a href="#cb237-4856" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4857"><a href="#cb237-4857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4858"><a href="#cb237-4858" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-4859"><a href="#cb237-4859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4860"><a href="#cb237-4860" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-4861"><a href="#cb237-4861" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb237-4862"><a href="#cb237-4862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4863"><a href="#cb237-4863" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectrum_convolution(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-4864"><a href="#cb237-4864" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb237-4865"><a href="#cb237-4865" aria-hidden="true" tabindex="-1"></a>    convolution_list: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb237-4866"><a href="#cb237-4866" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4867"><a href="#cb237-4867" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectrum) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb237-4868"><a href="#cb237-4868" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(spectrum)):</span>
<span id="cb237-4869"><a href="#cb237-4869" aria-hidden="true" tabindex="-1"></a>            mass_difference: <span class="bu">int</span> <span class="op">=</span> spectrum[j] <span class="op">-</span> spectrum[i]</span>
<span id="cb237-4870"><a href="#cb237-4870" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> mass_difference <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb237-4871"><a href="#cb237-4871" aria-hidden="true" tabindex="-1"></a>                convolution_list.append(mass_difference)</span>
<span id="cb237-4872"><a href="#cb237-4872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4873"><a href="#cb237-4873" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-4874"><a href="#cb237-4874" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(convolution_list):</span>
<span id="cb237-4875"><a href="#cb237-4875" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> convolution_list.count(mass)</span>
<span id="cb237-4876"><a href="#cb237-4876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4877"><a href="#cb237-4877" aria-hidden="true" tabindex="-1"></a>    sorted_masses: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(frequency_dict, key<span class="op">=</span>frequency_dict.get, reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb237-4878"><a href="#cb237-4878" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4879"><a href="#cb237-4879" aria-hidden="true" tabindex="-1"></a>    result: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb237-4880"><a href="#cb237-4880" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> sorted_masses:</span>
<span id="cb237-4881"><a href="#cb237-4881" aria-hidden="true" tabindex="-1"></a>        result.extend([mass] <span class="op">*</span> frequency_dict[mass])</span>
<span id="cb237-4882"><a href="#cb237-4882" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4883"><a href="#cb237-4883" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb237-4884"><a href="#cb237-4884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4885"><a href="#cb237-4885" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-4886"><a href="#cb237-4886" aria-hidden="true" tabindex="-1"></a><span class="st">0 137 186 323</span></span>
<span id="cb237-4887"><a href="#cb237-4887" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-4888"><a href="#cb237-4888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4889"><a href="#cb237-4889" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb237-4890"><a href="#cb237-4890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4891"><a href="#cb237-4891" aria-hidden="true" tabindex="-1"></a>convolution_result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_spectrum_convolution(input_spectrum)</span>
<span id="cb237-4892"><a href="#cb237-4892" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, convolution_result)))</span>
<span id="cb237-4893"><a href="#cb237-4893" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4894"><a href="#cb237-4894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4895"><a href="#cb237-4895" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement ConvolutionCyclopeptideSequencing</span></span>
<span id="cb237-4896"><a href="#cb237-4896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4897"><a href="#cb237-4897" aria-hidden="true" tabindex="-1"></a>Implement&nbsp;<span class="op">*</span>ConvolutionCyclopeptideSequencing<span class="op">*</span>.</span>
<span id="cb237-4898"><a href="#cb237-4898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4899"><a href="#cb237-4899" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>M<span class="op">*</span>, an integer&nbsp;<span class="op">*</span>N<span class="op">*</span>, <span class="kw">and</span> a collection of (possibly repeated) integers&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>.</span>
<span id="cb237-4900"><a href="#cb237-4900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4901"><a href="#cb237-4901" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A cyclic peptide LeaderPeptide <span class="cf">with</span> amino acids taken only <span class="im">from</span> the top&nbsp;<span class="op">*</span>M<span class="op">*</span>&nbsp;elements (<span class="kw">and</span> ties) of the convolution of&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>&nbsp;that fall between <span class="dv">57</span> <span class="kw">and</span> <span class="dv">200</span>, <span class="kw">and</span> where the size of&nbsp;<span class="op">*</span>Leaderboard<span class="op">*</span>&nbsp;is restricted to the top&nbsp;<span class="op">*</span>N<span class="op">*</span>&nbsp;(<span class="kw">and</span> ties).</span>
<span id="cb237-4902"><a href="#cb237-4902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4903"><a href="#cb237-4903" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-4904"><a href="#cb237-4904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4905"><a href="#cb237-4905" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4906"><a href="#cb237-4906" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span></span>
<span id="cb237-4907"><a href="#cb237-4907" aria-hidden="true" tabindex="-1"></a><span class="dv">60</span></span>
<span id="cb237-4908"><a href="#cb237-4908" aria-hidden="true" tabindex="-1"></a><span class="dv">57</span> <span class="dv">57</span> <span class="dv">71</span> <span class="dv">99</span> <span class="dv">129</span> <span class="dv">137</span> <span class="dv">170</span> <span class="dv">186</span> <span class="dv">194</span> <span class="dv">208</span> <span class="dv">228</span> <span class="dv">265</span> <span class="dv">285</span> <span class="dv">299</span> <span class="dv">307</span> <span class="dv">323</span> <span class="dv">356</span> <span class="dv">364</span> <span class="dv">394</span> <span class="dv">422</span> <span class="dv">493</span></span>
<span id="cb237-4909"><a href="#cb237-4909" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4910"><a href="#cb237-4910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4911"><a href="#cb237-4911" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-4912"><a href="#cb237-4912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4913"><a href="#cb237-4913" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4914"><a href="#cb237-4914" aria-hidden="true" tabindex="-1"></a><span class="dv">99</span><span class="op">-</span><span class="dv">71</span><span class="op">-</span><span class="dv">137</span><span class="op">-</span><span class="dv">57</span><span class="op">-</span><span class="dv">72</span><span class="op">-</span><span class="dv">57</span></span>
<span id="cb237-4915"><a href="#cb237-4915" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-4916"><a href="#cb237-4916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4917"><a href="#cb237-4917" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-4918"><a href="#cb237-4918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4919"><a href="#cb237-4919" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-4920"><a href="#cb237-4920" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb237-4921"><a href="#cb237-4921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4922"><a href="#cb237-4922" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectrum_convolution(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-4923"><a href="#cb237-4923" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb237-4924"><a href="#cb237-4924" aria-hidden="true" tabindex="-1"></a>    convolution_list: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb237-4925"><a href="#cb237-4925" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectrum) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb237-4926"><a href="#cb237-4926" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectrum)):</span>
<span id="cb237-4927"><a href="#cb237-4927" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> spectrum[j] <span class="op">-</span> spectrum[i] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb237-4928"><a href="#cb237-4928" aria-hidden="true" tabindex="-1"></a>                convolution_list.append(spectrum[j] <span class="op">-</span> spectrum[i])</span>
<span id="cb237-4929"><a href="#cb237-4929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4930"><a href="#cb237-4930" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-4931"><a href="#cb237-4931" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(convolution_list):</span>
<span id="cb237-4932"><a href="#cb237-4932" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> convolution_list.count(mass)</span>
<span id="cb237-4933"><a href="#cb237-4933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4934"><a href="#cb237-4934" aria-hidden="true" tabindex="-1"></a>    sorted_masses: List[<span class="bu">int</span>] <span class="op">=</span> [k <span class="cf">for</span> k, _ <span class="kw">in</span> <span class="bu">sorted</span>(frequency_dict.items(), key<span class="op">=</span><span class="kw">lambda</span> item: item[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)]</span>
<span id="cb237-4935"><a href="#cb237-4935" aria-hidden="true" tabindex="-1"></a>    result: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb237-4936"><a href="#cb237-4936" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> sorted_masses:</span>
<span id="cb237-4937"><a href="#cb237-4937" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> [mass] <span class="op">*</span> frequency_dict[mass]</span>
<span id="cb237-4938"><a href="#cb237-4938" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb237-4939"><a href="#cb237-4939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4940"><a href="#cb237-4940" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[List[<span class="bu">int</span>]], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb237-4941"><a href="#cb237-4941" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb237-4942"><a href="#cb237-4942" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb237-4943"><a href="#cb237-4943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4944"><a href="#cb237-4944" aria-hidden="true" tabindex="-1"></a>    scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-4945"><a href="#cb237-4945" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb237-4946"><a href="#cb237-4946" aria-hidden="true" tabindex="-1"></a>        scores[i] <span class="op">=</span> calculate_score(peptide, spectrum)</span>
<span id="cb237-4947"><a href="#cb237-4947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4948"><a href="#cb237-4948" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb237-4949"><a href="#cb237-4949" aria-hidden="true" tabindex="-1"></a>    threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb237-4950"><a href="#cb237-4950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4951"><a href="#cb237-4951" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> threshold]</span>
<span id="cb237-4952"><a href="#cb237-4952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4953"><a href="#cb237-4953" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-4954"><a href="#cb237-4954" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">sum</span>(peptide)]</span>
<span id="cb237-4955"><a href="#cb237-4955" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb237-4956"><a href="#cb237-4956" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb237-4957"><a href="#cb237-4957" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb237-4958"><a href="#cb237-4958" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[i:i <span class="op">+</span> k]</span>
<span id="cb237-4959"><a href="#cb237-4959" aria-hidden="true" tabindex="-1"></a>            spectrum.append(<span class="bu">sum</span>(subpeptide))</span>
<span id="cb237-4960"><a href="#cb237-4960" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb237-4961"><a href="#cb237-4961" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb237-4962"><a href="#cb237-4962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4963"><a href="#cb237-4963" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-4964"><a href="#cb237-4964" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb237-4965"><a href="#cb237-4965" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-4966"><a href="#cb237-4966" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(peptide_spectrum <span class="op">+</span> spectrum)</span>
<span id="cb237-4967"><a href="#cb237-4967" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb237-4968"><a href="#cb237-4968" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(peptide_spectrum.count(mass), spectrum.count(mass))</span>
<span id="cb237-4969"><a href="#cb237-4969" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb237-4970"><a href="#cb237-4970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4971"><a href="#cb237-4971" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_top_masses(spectrum: List[<span class="bu">int</span>], m: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-4972"><a href="#cb237-4972" aria-hidden="true" tabindex="-1"></a>    convolution: List[<span class="bu">int</span>] <span class="op">=</span> calculate_spectrum_convolution(spectrum)</span>
<span id="cb237-4973"><a href="#cb237-4973" aria-hidden="true" tabindex="-1"></a>    filtered_convolution: List[<span class="bu">int</span>] <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> convolution <span class="cf">if</span> <span class="dv">57</span> <span class="op">&lt;=</span> x <span class="op">&lt;=</span> <span class="dv">200</span>]</span>
<span id="cb237-4974"><a href="#cb237-4974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4975"><a href="#cb237-4975" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-4976"><a href="#cb237-4976" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(filtered_convolution):</span>
<span id="cb237-4977"><a href="#cb237-4977" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> filtered_convolution.count(mass)</span>
<span id="cb237-4978"><a href="#cb237-4978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4979"><a href="#cb237-4979" aria-hidden="true" tabindex="-1"></a>    sorted_elements: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> <span class="bu">sorted</span>(frequency_dict.items(), key<span class="op">=</span><span class="kw">lambda</span> kv: kv[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb237-4980"><a href="#cb237-4980" aria-hidden="true" tabindex="-1"></a>    top_masses: List[<span class="bu">int</span>] <span class="op">=</span> [mass <span class="cf">for</span> mass, freq <span class="kw">in</span> sorted_elements <span class="cf">if</span> freq <span class="op">&gt;=</span> sorted_elements[m <span class="op">-</span> <span class="dv">1</span>][<span class="dv">1</span>]]</span>
<span id="cb237-4981"><a href="#cb237-4981" aria-hidden="true" tabindex="-1"></a>    top_masses.sort()</span>
<span id="cb237-4982"><a href="#cb237-4982" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> top_masses</span>
<span id="cb237-4983"><a href="#cb237-4983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4984"><a href="#cb237-4984" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]], masses: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb237-4985"><a href="#cb237-4985" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb237-4986"><a href="#cb237-4986" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb237-4987"><a href="#cb237-4987" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> masses:</span>
<span id="cb237-4988"><a href="#cb237-4988" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb237-4989"><a href="#cb237-4989" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb237-4990"><a href="#cb237-4990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4991"><a href="#cb237-4991" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convolution_cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>], m: <span class="bu">int</span>, n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-4992"><a href="#cb237-4992" aria-hidden="true" tabindex="-1"></a>    masses: List[<span class="bu">int</span>] <span class="op">=</span> find_top_masses(spectrum, m)</span>
<span id="cb237-4993"><a href="#cb237-4993" aria-hidden="true" tabindex="-1"></a>    leaderboard: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb237-4994"><a href="#cb237-4994" aria-hidden="true" tabindex="-1"></a>    leader_peptide: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb237-4995"><a href="#cb237-4995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4996"><a href="#cb237-4996" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> leaderboard:</span>
<span id="cb237-4997"><a href="#cb237-4997" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> expand_peptides(leaderboard, masses)</span>
<span id="cb237-4998"><a href="#cb237-4998" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> leaderboard[:]:</span>
<span id="cb237-4999"><a href="#cb237-4999" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb237-5000"><a href="#cb237-5000" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_score(peptide, spectrum) <span class="op">&gt;</span> calculate_score(leader_peptide, spectrum):</span>
<span id="cb237-5001"><a href="#cb237-5001" aria-hidden="true" tabindex="-1"></a>                    leader_peptide <span class="op">=</span> peptide</span>
<span id="cb237-5002"><a href="#cb237-5002" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb237-5003"><a href="#cb237-5003" aria-hidden="true" tabindex="-1"></a>                leaderboard.remove(peptide)</span>
<span id="cb237-5004"><a href="#cb237-5004" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> trim_leaderboard(leaderboard, spectrum, n)</span>
<span id="cb237-5005"><a href="#cb237-5005" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> leader_peptide</span>
<span id="cb237-5006"><a href="#cb237-5006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5007"><a href="#cb237-5007" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-5008"><a href="#cb237-5008" aria-hidden="true" tabindex="-1"></a><span class="st">20</span></span>
<span id="cb237-5009"><a href="#cb237-5009" aria-hidden="true" tabindex="-1"></a><span class="st">60</span></span>
<span id="cb237-5010"><a href="#cb237-5010" aria-hidden="true" tabindex="-1"></a><span class="st">57 57 71 99 129 137 170 186 194 208 228 265 285 299 307 323 356 364 394 422 493</span></span>
<span id="cb237-5011"><a href="#cb237-5011" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-5012"><a href="#cb237-5012" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-5013"><a href="#cb237-5013" aria-hidden="true" tabindex="-1"></a>m: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb237-5014"><a href="#cb237-5014" aria-hidden="true" tabindex="-1"></a>n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">1</span>])</span>
<span id="cb237-5015"><a href="#cb237-5015" aria-hidden="true" tabindex="-1"></a>spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">2</span>].split()]</span>
<span id="cb237-5016"><a href="#cb237-5016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5017"><a href="#cb237-5017" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> convolution_cyclopeptide_sequencing(spectrum, m, n)</span>
<span id="cb237-5018"><a href="#cb237-5018" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span>
<span id="cb237-5019"><a href="#cb237-5019" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5020"><a href="#cb237-5020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5021"><a href="#cb237-5021" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the Theoretical Spectrum of a Linear Peptide</span></span>
<span id="cb237-5022"><a href="#cb237-5022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5023"><a href="#cb237-5023" aria-hidden="true" tabindex="-1"></a>Linear Spectrum Problem, Generate the ideal linear spectrum of a peptide.</span>
<span id="cb237-5024"><a href="#cb237-5024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5025"><a href="#cb237-5025" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An&nbsp;[amino acid string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>.</span>
<span id="cb237-5026"><a href="#cb237-5026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5027"><a href="#cb237-5027" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The linear spectrum of&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>.</span>
<span id="cb237-5028"><a href="#cb237-5028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5029"><a href="#cb237-5029" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-5030"><a href="#cb237-5030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5031"><a href="#cb237-5031" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5032"><a href="#cb237-5032" aria-hidden="true" tabindex="-1"></a>NQEL</span>
<span id="cb237-5033"><a href="#cb237-5033" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5034"><a href="#cb237-5034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5035"><a href="#cb237-5035" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-5036"><a href="#cb237-5036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5037"><a href="#cb237-5037" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5038"><a href="#cb237-5038" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">113</span> <span class="dv">114</span> <span class="dv">128</span> <span class="dv">129</span> <span class="dv">242</span> <span class="dv">242</span> <span class="dv">257</span> <span class="dv">370</span> <span class="dv">371</span> <span class="dv">484</span></span>
<span id="cb237-5039"><a href="#cb237-5039" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5040"><a href="#cb237-5040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5041"><a href="#cb237-5041" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-5042"><a href="#cb237-5042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5043"><a href="#cb237-5043" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-5044"><a href="#cb237-5044" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb237-5045"><a href="#cb237-5045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5046"><a href="#cb237-5046" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb237-5047"><a href="#cb237-5047" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb237-5048"><a href="#cb237-5048" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb237-5049"><a href="#cb237-5049" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb237-5050"><a href="#cb237-5050" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb237-5051"><a href="#cb237-5051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5052"><a href="#cb237-5052" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-5053"><a href="#cb237-5053" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb237-5054"><a href="#cb237-5054" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5055"><a href="#cb237-5055" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb237-5056"><a href="#cb237-5056" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb237-5057"><a href="#cb237-5057" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb237-5058"><a href="#cb237-5058" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5059"><a href="#cb237-5059" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb237-5060"><a href="#cb237-5060" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5061"><a href="#cb237-5061" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb237-5062"><a href="#cb237-5062" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-5063"><a href="#cb237-5063" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb237-5064"><a href="#cb237-5064" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb237-5065"><a href="#cb237-5065" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5066"><a href="#cb237-5066" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb237-5067"><a href="#cb237-5067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5068"><a href="#cb237-5068" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-5069"><a href="#cb237-5069" aria-hidden="true" tabindex="-1"></a>sample_peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">"NQEL"</span></span>
<span id="cb237-5070"><a href="#cb237-5070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5071"><a href="#cb237-5071" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the linear spectrum</span></span>
<span id="cb237-5072"><a href="#cb237-5072" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(sample_peptide)</span>
<span id="cb237-5073"><a href="#cb237-5073" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span>
<span id="cb237-5074"><a href="#cb237-5074" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5075"><a href="#cb237-5075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5076"><a href="#cb237-5076" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Score of a Linear Peptide</span></span>
<span id="cb237-5077"><a href="#cb237-5077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5078"><a href="#cb237-5078" aria-hidden="true" tabindex="-1"></a>Linear Peptide Scoring Problem, Compute the score of a linear peptide <span class="cf">with</span> respect to a spectrum.</span>
<span id="cb237-5079"><a href="#cb237-5079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5080"><a href="#cb237-5080" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An amino acid string&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>&nbsp;and a collection of integers&nbsp;<span class="op">*</span>LinearSpectrum<span class="op">*</span>.</span>
<span id="cb237-5081"><a href="#cb237-5081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5082"><a href="#cb237-5082" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The linear score of&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>&nbsp;against&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>,&nbsp;<span class="op">*</span>LinearScore<span class="op">*</span>(<span class="op">*</span>Peptide<span class="op">*</span>,&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>).</span>
<span id="cb237-5083"><a href="#cb237-5083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5084"><a href="#cb237-5084" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-5085"><a href="#cb237-5085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5086"><a href="#cb237-5086" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5087"><a href="#cb237-5087" aria-hidden="true" tabindex="-1"></a>NQEL</span>
<span id="cb237-5088"><a href="#cb237-5088" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">99</span> <span class="dv">113</span> <span class="dv">114</span> <span class="dv">128</span> <span class="dv">227</span> <span class="dv">257</span> <span class="dv">299</span> <span class="dv">355</span> <span class="dv">356</span> <span class="dv">370</span> <span class="dv">371</span> <span class="dv">484</span></span>
<span id="cb237-5089"><a href="#cb237-5089" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5090"><a href="#cb237-5090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5091"><a href="#cb237-5091" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-5092"><a href="#cb237-5092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5093"><a href="#cb237-5093" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5094"><a href="#cb237-5094" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span></span>
<span id="cb237-5095"><a href="#cb237-5095" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5096"><a href="#cb237-5096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5097"><a href="#cb237-5097" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-5098"><a href="#cb237-5098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5099"><a href="#cb237-5099" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-5100"><a href="#cb237-5100" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb237-5101"><a href="#cb237-5101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5102"><a href="#cb237-5102" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb237-5103"><a href="#cb237-5103" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb237-5104"><a href="#cb237-5104" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb237-5105"><a href="#cb237-5105" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb237-5106"><a href="#cb237-5106" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb237-5107"><a href="#cb237-5107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5108"><a href="#cb237-5108" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-5109"><a href="#cb237-5109" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb237-5110"><a href="#cb237-5110" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5111"><a href="#cb237-5111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb237-5112"><a href="#cb237-5112" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb237-5113"><a href="#cb237-5113" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb237-5114"><a href="#cb237-5114" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5115"><a href="#cb237-5115" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb237-5116"><a href="#cb237-5116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5117"><a href="#cb237-5117" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb237-5118"><a href="#cb237-5118" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-5119"><a href="#cb237-5119" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb237-5120"><a href="#cb237-5120" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb237-5121"><a href="#cb237-5121" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5122"><a href="#cb237-5122" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb237-5123"><a href="#cb237-5123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5124"><a href="#cb237-5124" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-5125"><a href="#cb237-5125" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb237-5126"><a href="#cb237-5126" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-5127"><a href="#cb237-5127" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb237-5128"><a href="#cb237-5128" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5129"><a href="#cb237-5129" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb237-5130"><a href="#cb237-5130" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb237-5131"><a href="#cb237-5131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5132"><a href="#cb237-5132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb237-5133"><a href="#cb237-5133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5134"><a href="#cb237-5134" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-5135"><a href="#cb237-5135" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-5136"><a href="#cb237-5136" aria-hidden="true" tabindex="-1"></a><span class="st">NQEL</span></span>
<span id="cb237-5137"><a href="#cb237-5137" aria-hidden="true" tabindex="-1"></a><span class="st">0 99 113 114 128 227 257 299 355 356 370 371 484</span></span>
<span id="cb237-5138"><a href="#cb237-5138" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-5139"><a href="#cb237-5139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5140"><a href="#cb237-5140" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-5141"><a href="#cb237-5141" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb237-5142"><a href="#cb237-5142" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb237-5143"><a href="#cb237-5143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5144"><a href="#cb237-5144" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the linear score</span></span>
<span id="cb237-5145"><a href="#cb237-5145" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> calculate_linear_score(input_peptide, input_spectrum)</span>
<span id="cb237-5146"><a href="#cb237-5146" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb237-5147"><a href="#cb237-5147" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5148"><a href="#cb237-5148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5149"><a href="#cb237-5149" aria-hidden="true" tabindex="-1"></a><span class="co"># Trim a Peptide Leaderboard</span></span>
<span id="cb237-5150"><a href="#cb237-5150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5151"><a href="#cb237-5151" aria-hidden="true" tabindex="-1"></a>Trim Problem, Trim a leaderboard of peptides.</span>
<span id="cb237-5152"><a href="#cb237-5152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5153"><a href="#cb237-5153" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A leaderboard of linear peptides&nbsp;<span class="op">*</span>Leaderboard<span class="op">*</span>, a linear spectrum&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>, <span class="kw">and</span> an integer&nbsp;<span class="op">*</span>N<span class="op">*</span>.</span>
<span id="cb237-5154"><a href="#cb237-5154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5155"><a href="#cb237-5155" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The top&nbsp;<span class="op">*</span>N<span class="op">*</span>&nbsp;peptides from&nbsp;<span class="op">*</span>Leaderboard<span class="op">*</span>&nbsp;scored against&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>. Remember to use&nbsp;<span class="op">*</span>LinearScore<span class="op">*</span>.</span>
<span id="cb237-5156"><a href="#cb237-5156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5157"><a href="#cb237-5157" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-5158"><a href="#cb237-5158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5159"><a href="#cb237-5159" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5160"><a href="#cb237-5160" aria-hidden="true" tabindex="-1"></a>LAST ALST TLLT TQAS</span>
<span id="cb237-5161"><a href="#cb237-5161" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">71</span> <span class="dv">87</span> <span class="dv">101</span> <span class="dv">113</span> <span class="dv">158</span> <span class="dv">184</span> <span class="dv">188</span> <span class="dv">259</span> <span class="dv">271</span> <span class="dv">372</span></span>
<span id="cb237-5162"><a href="#cb237-5162" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span></span>
<span id="cb237-5163"><a href="#cb237-5163" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5164"><a href="#cb237-5164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5165"><a href="#cb237-5165" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-5166"><a href="#cb237-5166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5167"><a href="#cb237-5167" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5168"><a href="#cb237-5168" aria-hidden="true" tabindex="-1"></a>LAST ALST</span>
<span id="cb237-5169"><a href="#cb237-5169" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5170"><a href="#cb237-5170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5171"><a href="#cb237-5171" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-5172"><a href="#cb237-5172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5173"><a href="#cb237-5173" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-5174"><a href="#cb237-5174" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb237-5175"><a href="#cb237-5175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5176"><a href="#cb237-5176" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb237-5177"><a href="#cb237-5177" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb237-5178"><a href="#cb237-5178" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb237-5179"><a href="#cb237-5179" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb237-5180"><a href="#cb237-5180" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb237-5181"><a href="#cb237-5181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5182"><a href="#cb237-5182" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-5183"><a href="#cb237-5183" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb237-5184"><a href="#cb237-5184" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5185"><a href="#cb237-5185" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb237-5186"><a href="#cb237-5186" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb237-5187"><a href="#cb237-5187" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb237-5188"><a href="#cb237-5188" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5189"><a href="#cb237-5189" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb237-5190"><a href="#cb237-5190" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5191"><a href="#cb237-5191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb237-5192"><a href="#cb237-5192" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-5193"><a href="#cb237-5193" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb237-5194"><a href="#cb237-5194" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb237-5195"><a href="#cb237-5195" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5196"><a href="#cb237-5196" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb237-5197"><a href="#cb237-5197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5198"><a href="#cb237-5198" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-5199"><a href="#cb237-5199" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb237-5200"><a href="#cb237-5200" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-5201"><a href="#cb237-5201" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb237-5202"><a href="#cb237-5202" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5203"><a href="#cb237-5203" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb237-5204"><a href="#cb237-5204" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb237-5205"><a href="#cb237-5205" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5206"><a href="#cb237-5206" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb237-5207"><a href="#cb237-5207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5208"><a href="#cb237-5208" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[<span class="bu">str</span>], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-5209"><a href="#cb237-5209" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb237-5210"><a href="#cb237-5210" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb237-5211"><a href="#cb237-5211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5212"><a href="#cb237-5212" aria-hidden="true" tabindex="-1"></a>    peptide_scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-5213"><a href="#cb237-5213" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb237-5214"><a href="#cb237-5214" aria-hidden="true" tabindex="-1"></a>        peptide_scores[i] <span class="op">=</span> calculate_linear_score(peptide, spectrum)</span>
<span id="cb237-5215"><a href="#cb237-5215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5216"><a href="#cb237-5216" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(peptide_scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb237-5217"><a href="#cb237-5217" aria-hidden="true" tabindex="-1"></a>    score_threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb237-5218"><a href="#cb237-5218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5219"><a href="#cb237-5219" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> peptide_scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> score_threshold]</span>
<span id="cb237-5220"><a href="#cb237-5220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5221"><a href="#cb237-5221" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-5222"><a href="#cb237-5222" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-5223"><a href="#cb237-5223" aria-hidden="true" tabindex="-1"></a><span class="st">LAST ALST TLLT TQAS</span></span>
<span id="cb237-5224"><a href="#cb237-5224" aria-hidden="true" tabindex="-1"></a><span class="st">0 71 87 101 113 158 184 188 259 271 372</span></span>
<span id="cb237-5225"><a href="#cb237-5225" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb237-5226"><a href="#cb237-5226" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-5227"><a href="#cb237-5227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5228"><a href="#cb237-5228" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-5229"><a href="#cb237-5229" aria-hidden="true" tabindex="-1"></a>input_leaderboard: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">0</span>].split()</span>
<span id="cb237-5230"><a href="#cb237-5230" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb237-5231"><a href="#cb237-5231" aria-hidden="true" tabindex="-1"></a>input_n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb237-5232"><a href="#cb237-5232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5233"><a href="#cb237-5233" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> trim_leaderboard(input_leaderboard, input_spectrum, input_n)</span>
<span id="cb237-5234"><a href="#cb237-5234" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(result))</span>
<span id="cb237-5235"><a href="#cb237-5235" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5236"><a href="#cb237-5236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5237"><a href="#cb237-5237" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the Turnpike Problem</span></span>
<span id="cb237-5238"><a href="#cb237-5238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5239"><a href="#cb237-5239" aria-hidden="true" tabindex="-1"></a>Turnpike Problem. Given <span class="bu">all</span> pairwise distances between points on a line segment, reconstruct the positions of those points.</span>
<span id="cb237-5240"><a href="#cb237-5240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5241"><a href="#cb237-5241" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection of integers&nbsp;<span class="op">*</span>L<span class="op">*</span>.</span>
<span id="cb237-5242"><a href="#cb237-5242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5243"><a href="#cb237-5243" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A set&nbsp;<span class="op">*</span>A<span class="op">*</span>&nbsp;such that $∆A$&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span>L<span class="op">*</span>.</span>
<span id="cb237-5244"><a href="#cb237-5244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5245"><a href="#cb237-5245" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-5246"><a href="#cb237-5246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5247"><a href="#cb237-5247" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5248"><a href="#cb237-5248" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="dv">10</span> <span class="op">-</span><span class="dv">8</span> <span class="op">-</span><span class="dv">7</span> <span class="op">-</span><span class="dv">6</span> <span class="op">-</span><span class="dv">5</span> <span class="op">-</span><span class="dv">4</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">2</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">10</span></span>
<span id="cb237-5249"><a href="#cb237-5249" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5250"><a href="#cb237-5250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5251"><a href="#cb237-5251" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-5252"><a href="#cb237-5252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5253"><a href="#cb237-5253" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5254"><a href="#cb237-5254" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">10</span></span>
<span id="cb237-5255"><a href="#cb237-5255" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5256"><a href="#cb237-5256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5257"><a href="#cb237-5257" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-5258"><a href="#cb237-5258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5259"><a href="#cb237-5259" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-5260"><a href="#cb237-5260" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Optional</span>
<span id="cb237-5261"><a href="#cb237-5261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5262"><a href="#cb237-5262" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_absolute_differences(set_a: Set[<span class="bu">int</span>], set_b: Set[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-5263"><a href="#cb237-5263" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">abs</span>(a <span class="op">-</span> b) <span class="cf">for</span> a <span class="kw">in</span> set_a <span class="cf">for</span> b <span class="kw">in</span> set_b]</span>
<span id="cb237-5264"><a href="#cb237-5264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5265"><a href="#cb237-5265" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_multiset_subset(subset: List[<span class="bu">int</span>], superset: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb237-5266"><a href="#cb237-5266" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(subset.count(elem) <span class="op">&lt;=</span> superset.count(elem) <span class="cf">for</span> elem <span class="kw">in</span> <span class="bu">set</span>(subset))</span>
<span id="cb237-5267"><a href="#cb237-5267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5268"><a href="#cb237-5268" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiset_difference(set_a: List[<span class="bu">int</span>], set_b: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-5269"><a href="#cb237-5269" aria-hidden="true" tabindex="-1"></a>    difference: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb237-5270"><a href="#cb237-5270" aria-hidden="true" tabindex="-1"></a>    unique_elements: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(set_a)</span>
<span id="cb237-5271"><a href="#cb237-5271" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> elem <span class="kw">in</span> unique_elements:</span>
<span id="cb237-5272"><a href="#cb237-5272" aria-hidden="true" tabindex="-1"></a>        count_difference <span class="op">=</span> set_a.count(elem) <span class="op">-</span> set_b.count(elem)</span>
<span id="cb237-5273"><a href="#cb237-5273" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count_difference <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb237-5274"><a href="#cb237-5274" aria-hidden="true" tabindex="-1"></a>            difference.extend([elem] <span class="op">*</span> count_difference)</span>
<span id="cb237-5275"><a href="#cb237-5275" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(difference)</span>
<span id="cb237-5276"><a href="#cb237-5276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5277"><a href="#cb237-5277" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> place_elements(distances: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Optional[Set[<span class="bu">int</span>]]:</span>
<span id="cb237-5278"><a href="#cb237-5278" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> distances:</span>
<span id="cb237-5279"><a href="#cb237-5279" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> placed_elements</span>
<span id="cb237-5280"><a href="#cb237-5280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5281"><a href="#cb237-5281" aria-hidden="true" tabindex="-1"></a>    current_distance: <span class="bu">int</span> <span class="op">=</span> distances[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb237-5282"><a href="#cb237-5282" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5283"><a href="#cb237-5283" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Try placing on the left</span></span>
<span id="cb237-5284"><a href="#cb237-5284" aria-hidden="true" tabindex="-1"></a>    left_differences: List[<span class="bu">int</span>] <span class="op">=</span> calculate_absolute_differences({current_distance}, placed_elements)</span>
<span id="cb237-5285"><a href="#cb237-5285" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_multiset_subset(left_differences, distances):</span>
<span id="cb237-5286"><a href="#cb237-5286" aria-hidden="true" tabindex="-1"></a>        placed_elements.add(current_distance)</span>
<span id="cb237-5287"><a href="#cb237-5287" aria-hidden="true" tabindex="-1"></a>        remaining_distances_left: List[<span class="bu">int</span>] <span class="op">=</span> multiset_difference(distances, left_differences)</span>
<span id="cb237-5288"><a href="#cb237-5288" aria-hidden="true" tabindex="-1"></a>        left_result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(remaining_distances_left)</span>
<span id="cb237-5289"><a href="#cb237-5289" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> left_result:</span>
<span id="cb237-5290"><a href="#cb237-5290" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> left_result</span>
<span id="cb237-5291"><a href="#cb237-5291" aria-hidden="true" tabindex="-1"></a>        placed_elements.remove(current_distance)</span>
<span id="cb237-5292"><a href="#cb237-5292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5293"><a href="#cb237-5293" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Try placing on the right</span></span>
<span id="cb237-5294"><a href="#cb237-5294" aria-hidden="true" tabindex="-1"></a>    right_differences: List[<span class="bu">int</span>] <span class="op">=</span> calculate_absolute_differences({total_width <span class="op">-</span> current_distance}, placed_elements)</span>
<span id="cb237-5295"><a href="#cb237-5295" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_multiset_subset(right_differences, distances):</span>
<span id="cb237-5296"><a href="#cb237-5296" aria-hidden="true" tabindex="-1"></a>        placed_elements.add(total_width <span class="op">-</span> current_distance)</span>
<span id="cb237-5297"><a href="#cb237-5297" aria-hidden="true" tabindex="-1"></a>        remaining_distances_right: List[<span class="bu">int</span>] <span class="op">=</span> multiset_difference(distances, right_differences)</span>
<span id="cb237-5298"><a href="#cb237-5298" aria-hidden="true" tabindex="-1"></a>        right_result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(remaining_distances_right)</span>
<span id="cb237-5299"><a href="#cb237-5299" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> right_result:</span>
<span id="cb237-5300"><a href="#cb237-5300" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> right_result</span>
<span id="cb237-5301"><a href="#cb237-5301" aria-hidden="true" tabindex="-1"></a>        placed_elements.remove(total_width <span class="op">-</span> current_distance)</span>
<span id="cb237-5302"><a href="#cb237-5302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5303"><a href="#cb237-5303" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb237-5304"><a href="#cb237-5304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5305"><a href="#cb237-5305" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-5306"><a href="#cb237-5306" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-5307"><a href="#cb237-5307" aria-hidden="true" tabindex="-1"></a><span class="st">-10 -8 -7 -6 -5 -4 -3 -3 -2 -2 0 0 0 0 0 2 2 3 3 4 5 6 7 8 10</span></span>
<span id="cb237-5308"><a href="#cb237-5308" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-5309"><a href="#cb237-5309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5310"><a href="#cb237-5310" aria-hidden="true" tabindex="-1"></a>input_distances: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb237-5311"><a href="#cb237-5311" aria-hidden="true" tabindex="-1"></a>positive_distances: List[<span class="bu">int</span>] <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> input_distances <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb237-5312"><a href="#cb237-5312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5313"><a href="#cb237-5313" aria-hidden="true" tabindex="-1"></a>total_width: <span class="bu">int</span> <span class="op">=</span> positive_distances.pop(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb237-5314"><a href="#cb237-5314" aria-hidden="true" tabindex="-1"></a>placed_elements: Set[<span class="bu">int</span>] <span class="op">=</span> {<span class="dv">0</span>, total_width}</span>
<span id="cb237-5315"><a href="#cb237-5315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5316"><a href="#cb237-5316" aria-hidden="true" tabindex="-1"></a>result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(positive_distances)</span>
<span id="cb237-5317"><a href="#cb237-5317" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, <span class="bu">sorted</span>(result))))</span>
<span id="cb237-5318"><a href="#cb237-5318" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5319"><a href="#cb237-5319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5320"><a href="#cb237-5320" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the Minimum Number of Coins Needed to Make Change</span></span>
<span id="cb237-5321"><a href="#cb237-5321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5322"><a href="#cb237-5322" aria-hidden="true" tabindex="-1"></a>The Change Problem, Find the minimum number of coins needed to make change</span>
<span id="cb237-5323"><a href="#cb237-5323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5324"><a href="#cb237-5324" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>money<span class="op">*</span>&nbsp;and an array&nbsp;<span class="op">*</span>Coins<span class="op">*</span>&nbsp;of positive integers.</span>
<span id="cb237-5325"><a href="#cb237-5325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5326"><a href="#cb237-5326" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The minimum number of coins <span class="cf">with</span> denominations&nbsp;<span class="op">*</span>Coins<span class="op">*</span>&nbsp;that changes&nbsp;<span class="op">*</span>money<span class="op">*</span>.</span>
<span id="cb237-5327"><a href="#cb237-5327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5328"><a href="#cb237-5328" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-5329"><a href="#cb237-5329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5330"><a href="#cb237-5330" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5331"><a href="#cb237-5331" aria-hidden="true" tabindex="-1"></a><span class="dv">40</span></span>
<span id="cb237-5332"><a href="#cb237-5332" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">50</span></span>
<span id="cb237-5333"><a href="#cb237-5333" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5334"><a href="#cb237-5334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5335"><a href="#cb237-5335" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-5336"><a href="#cb237-5336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5337"><a href="#cb237-5337" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5338"><a href="#cb237-5338" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span></span>
<span id="cb237-5339"><a href="#cb237-5339" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5340"><a href="#cb237-5340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5341"><a href="#cb237-5341" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-5342"><a href="#cb237-5342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5343"><a href="#cb237-5343" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-5344"><a href="#cb237-5344" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb237-5345"><a href="#cb237-5345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5346"><a href="#cb237-5346" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> min_coins_for_change(target_amount: <span class="bu">int</span>, available_coins: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-5347"><a href="#cb237-5347" aria-hidden="true" tabindex="-1"></a>    min_coins_needed <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb237-5348"><a href="#cb237-5348" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_amount <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, target_amount <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-5349"><a href="#cb237-5349" aria-hidden="true" tabindex="-1"></a>        min_coins_needed.append(target_amount <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb237-5350"><a href="#cb237-5350" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> coin <span class="kw">in</span> available_coins:</span>
<span id="cb237-5351"><a href="#cb237-5351" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_amount <span class="op">&gt;=</span> coin:</span>
<span id="cb237-5352"><a href="#cb237-5352" aria-hidden="true" tabindex="-1"></a>                coins_for_current <span class="op">=</span> min_coins_needed[current_amount <span class="op">-</span> coin] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb237-5353"><a href="#cb237-5353" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> coins_for_current <span class="op">&lt;</span> min_coins_needed[current_amount]:</span>
<span id="cb237-5354"><a href="#cb237-5354" aria-hidden="true" tabindex="-1"></a>                    min_coins_needed[current_amount] <span class="op">=</span> coins_for_current</span>
<span id="cb237-5355"><a href="#cb237-5355" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> min_coins_needed[target_amount]</span>
<span id="cb237-5356"><a href="#cb237-5356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5357"><a href="#cb237-5357" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-5358"><a href="#cb237-5358" aria-hidden="true" tabindex="-1"></a><span class="st">40</span></span>
<span id="cb237-5359"><a href="#cb237-5359" aria-hidden="true" tabindex="-1"></a><span class="st">1,5,10,20,25,50</span></span>
<span id="cb237-5360"><a href="#cb237-5360" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-5361"><a href="#cb237-5361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5362"><a href="#cb237-5362" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-5363"><a href="#cb237-5363" aria-hidden="true" tabindex="-1"></a>target_amount <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb237-5364"><a href="#cb237-5364" aria-hidden="true" tabindex="-1"></a>available_coins <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split(<span class="st">","</span>)]</span>
<span id="cb237-5365"><a href="#cb237-5365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5366"><a href="#cb237-5366" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(min_coins_for_change(target_amount, available_coins))</span>
<span id="cb237-5367"><a href="#cb237-5367" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5368"><a href="#cb237-5368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5369"><a href="#cb237-5369" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the Length of a Longest Path in a Manhattan-like Grid</span></span>
<span id="cb237-5370"><a href="#cb237-5370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5371"><a href="#cb237-5371" aria-hidden="true" tabindex="-1"></a>Length of a Longest Path <span class="kw">in</span> the Manhattan Tourist Problem. Find the length of a longest path <span class="kw">in</span> a rectangular city.</span>
<span id="cb237-5372"><a href="#cb237-5372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5373"><a href="#cb237-5373" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>m<span class="op">*</span>, followed by an&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;× (<span class="op">*</span>m<span class="op">*+</span><span class="dv">1</span>) matrix&nbsp;<span class="op">*</span>Down<span class="op">*</span>&nbsp;and an (<span class="op">*</span>n<span class="op">*+</span><span class="dv">1</span>) ×&nbsp;<span class="op">*</span>m<span class="op">*</span>&nbsp;matrix&nbsp;<span class="op">*</span>Right<span class="op">*</span>. The two matrices are separated by the<span class="st">"-"</span>symbol.</span>
<span id="cb237-5374"><a href="#cb237-5374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5375"><a href="#cb237-5375" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The length of a longest path <span class="im">from</span> source (<span class="dv">0</span>, <span class="dv">0</span>) to sink (<span class="op">*</span>n<span class="op">*</span>,&nbsp;<span class="op">*</span>m<span class="op">*</span>) <span class="kw">in</span> the&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;×&nbsp;<span class="op">*</span>m<span class="op">*</span>&nbsp;rectangular grid whose edges are defined by the matrices&nbsp;<span class="op">*</span>Down<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>Right<span class="op">*</span>.</span>
<span id="cb237-5376"><a href="#cb237-5376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5377"><a href="#cb237-5377" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-5378"><a href="#cb237-5378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5379"><a href="#cb237-5379" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5380"><a href="#cb237-5380" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">4</span></span>
<span id="cb237-5381"><a href="#cb237-5381" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">0</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">3</span></span>
<span id="cb237-5382"><a href="#cb237-5382" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">1</span></span>
<span id="cb237-5383"><a href="#cb237-5383" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">1</span></span>
<span id="cb237-5384"><a href="#cb237-5384" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">5</span> <span class="dv">3</span></span>
<span id="cb237-5385"><a href="#cb237-5385" aria-hidden="true" tabindex="-1"></a><span class="op">-</span></span>
<span id="cb237-5386"><a href="#cb237-5386" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">0</span></span>
<span id="cb237-5387"><a href="#cb237-5387" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">2</span></span>
<span id="cb237-5388"><a href="#cb237-5388" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">7</span> <span class="dv">3</span> <span class="dv">3</span></span>
<span id="cb237-5389"><a href="#cb237-5389" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">3</span> <span class="dv">0</span> <span class="dv">2</span></span>
<span id="cb237-5390"><a href="#cb237-5390" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">2</span></span>
<span id="cb237-5391"><a href="#cb237-5391" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5392"><a href="#cb237-5392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5393"><a href="#cb237-5393" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-5394"><a href="#cb237-5394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5395"><a href="#cb237-5395" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5396"><a href="#cb237-5396" aria-hidden="true" tabindex="-1"></a><span class="dv">34</span></span>
<span id="cb237-5397"><a href="#cb237-5397" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5398"><a href="#cb237-5398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5399"><a href="#cb237-5399" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-5400"><a href="#cb237-5400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5401"><a href="#cb237-5401" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-5402"><a href="#cb237-5402" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb237-5403"><a href="#cb237-5403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5404"><a href="#cb237-5404" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_manhattan_tourist_input(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>, List[List[<span class="bu">int</span>]], List[List[<span class="bu">int</span>]]]:</span>
<span id="cb237-5405"><a href="#cb237-5405" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_text.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb237-5406"><a href="#cb237-5406" aria-hidden="true" tabindex="-1"></a>    rows, cols <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, lines[<span class="dv">0</span>].split())</span>
<span id="cb237-5407"><a href="#cb237-5407" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5408"><a href="#cb237-5408" aria-hidden="true" tabindex="-1"></a>    down_weights <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> (cols <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows)]</span>
<span id="cb237-5409"><a href="#cb237-5409" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(rows):</span>
<span id="cb237-5410"><a href="#cb237-5410" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[i <span class="op">+</span> <span class="dv">1</span>].split()))</span>
<span id="cb237-5411"><a href="#cb237-5411" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-5412"><a href="#cb237-5412" aria-hidden="true" tabindex="-1"></a>            down_weights[i][j] <span class="op">=</span> line[j]</span>
<span id="cb237-5413"><a href="#cb237-5413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5414"><a href="#cb237-5414" aria-hidden="true" tabindex="-1"></a>    separator_index <span class="op">=</span> rows <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb237-5415"><a href="#cb237-5415" aria-hidden="true" tabindex="-1"></a>    right_weights <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> cols <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-5416"><a href="#cb237-5416" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-5417"><a href="#cb237-5417" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[i <span class="op">+</span> separator_index <span class="op">+</span> <span class="dv">1</span>].split()))</span>
<span id="cb237-5418"><a href="#cb237-5418" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(cols):</span>
<span id="cb237-5419"><a href="#cb237-5419" aria-hidden="true" tabindex="-1"></a>            right_weights[i][j] <span class="op">=</span> line[j]</span>
<span id="cb237-5420"><a href="#cb237-5420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5421"><a href="#cb237-5421" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rows, cols, down_weights, right_weights</span>
<span id="cb237-5422"><a href="#cb237-5422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5423"><a href="#cb237-5423" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_longest_manhattan_path(rows: <span class="bu">int</span>, cols: <span class="bu">int</span>, down_weights: List[List[<span class="bu">int</span>]], right_weights: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-5424"><a href="#cb237-5424" aria-hidden="true" tabindex="-1"></a>    path_scores <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> (cols <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-5425"><a href="#cb237-5425" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5426"><a href="#cb237-5426" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-5427"><a href="#cb237-5427" aria-hidden="true" tabindex="-1"></a>        path_scores[i][<span class="dv">0</span>] <span class="op">=</span> path_scores[i <span class="op">-</span> <span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> down_weights[i <span class="op">-</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb237-5428"><a href="#cb237-5428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5429"><a href="#cb237-5429" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-5430"><a href="#cb237-5430" aria-hidden="true" tabindex="-1"></a>        path_scores[<span class="dv">0</span>][j] <span class="op">=</span> path_scores[<span class="dv">0</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> right_weights[<span class="dv">0</span>][j <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb237-5431"><a href="#cb237-5431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5432"><a href="#cb237-5432" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-5433"><a href="#cb237-5433" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-5434"><a href="#cb237-5434" aria-hidden="true" tabindex="-1"></a>            path_scores[i][j] <span class="op">=</span> <span class="bu">max</span>(path_scores[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">+</span> down_weights[i <span class="op">-</span> <span class="dv">1</span>][j],</span>
<span id="cb237-5435"><a href="#cb237-5435" aria-hidden="true" tabindex="-1"></a>                                    path_scores[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> right_weights[i][j <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb237-5436"><a href="#cb237-5436" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5437"><a href="#cb237-5437" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path_scores[rows][cols]</span>
<span id="cb237-5438"><a href="#cb237-5438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5439"><a href="#cb237-5439" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-5440"><a href="#cb237-5440" aria-hidden="true" tabindex="-1"></a><span class="st">4 4</span></span>
<span id="cb237-5441"><a href="#cb237-5441" aria-hidden="true" tabindex="-1"></a><span class="st">1 0 2 4 3</span></span>
<span id="cb237-5442"><a href="#cb237-5442" aria-hidden="true" tabindex="-1"></a><span class="st">4 6 5 2 1</span></span>
<span id="cb237-5443"><a href="#cb237-5443" aria-hidden="true" tabindex="-1"></a><span class="st">4 4 5 2 1</span></span>
<span id="cb237-5444"><a href="#cb237-5444" aria-hidden="true" tabindex="-1"></a><span class="st">5 6 8 5 3</span></span>
<span id="cb237-5445"><a href="#cb237-5445" aria-hidden="true" tabindex="-1"></a><span class="st">-</span></span>
<span id="cb237-5446"><a href="#cb237-5446" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 4 0</span></span>
<span id="cb237-5447"><a href="#cb237-5447" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 4 2</span></span>
<span id="cb237-5448"><a href="#cb237-5448" aria-hidden="true" tabindex="-1"></a><span class="st">0 7 3 3</span></span>
<span id="cb237-5449"><a href="#cb237-5449" aria-hidden="true" tabindex="-1"></a><span class="st">3 3 0 2</span></span>
<span id="cb237-5450"><a href="#cb237-5450" aria-hidden="true" tabindex="-1"></a><span class="st">1 3 2 2</span></span>
<span id="cb237-5451"><a href="#cb237-5451" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-5452"><a href="#cb237-5452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5453"><a href="#cb237-5453" aria-hidden="true" tabindex="-1"></a>rows, cols, down_weights, right_weights <span class="op">=</span> parse_manhattan_tourist_input(sample_input)</span>
<span id="cb237-5454"><a href="#cb237-5454" aria-hidden="true" tabindex="-1"></a>longest_path_score <span class="op">=</span> calculate_longest_manhattan_path(rows, cols, down_weights, right_weights)</span>
<span id="cb237-5455"><a href="#cb237-5455" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>longest_path_score<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb237-5456"><a href="#cb237-5456" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5457"><a href="#cb237-5457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5458"><a href="#cb237-5458" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Longest Common Subsequence of Two Strings</span></span>
<span id="cb237-5459"><a href="#cb237-5459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5460"><a href="#cb237-5460" aria-hidden="true" tabindex="-1"></a>Longest Common Subsequence Problem.</span>
<span id="cb237-5461"><a href="#cb237-5461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5462"><a href="#cb237-5462" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two strings.</span>
<span id="cb237-5463"><a href="#cb237-5463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5464"><a href="#cb237-5464" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A longest common subsequence of these strings.</span>
<span id="cb237-5465"><a href="#cb237-5465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5466"><a href="#cb237-5466" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-5467"><a href="#cb237-5467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5468"><a href="#cb237-5468" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5469"><a href="#cb237-5469" aria-hidden="true" tabindex="-1"></a>AACCTTGG</span>
<span id="cb237-5470"><a href="#cb237-5470" aria-hidden="true" tabindex="-1"></a>ACACTGTGA</span>
<span id="cb237-5471"><a href="#cb237-5471" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5472"><a href="#cb237-5472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5473"><a href="#cb237-5473" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-5474"><a href="#cb237-5474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5475"><a href="#cb237-5475" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5476"><a href="#cb237-5476" aria-hidden="true" tabindex="-1"></a>AACTGG</span>
<span id="cb237-5477"><a href="#cb237-5477" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5478"><a href="#cb237-5478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5479"><a href="#cb237-5479" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-5480"><a href="#cb237-5480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5481"><a href="#cb237-5481" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-5482"><a href="#cb237-5482" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb237-5483"><a href="#cb237-5483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5484"><a href="#cb237-5484" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> longest_common_subsequence(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-5485"><a href="#cb237-5485" aria-hidden="true" tabindex="-1"></a>    padded_seq1 <span class="op">=</span> <span class="st">'-'</span> <span class="op">+</span> sequence1</span>
<span id="cb237-5486"><a href="#cb237-5486" aria-hidden="true" tabindex="-1"></a>    padded_seq2 <span class="op">=</span> <span class="st">'-'</span> <span class="op">+</span> sequence2</span>
<span id="cb237-5487"><a href="#cb237-5487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5488"><a href="#cb237-5488" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb237-5489"><a href="#cb237-5489" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[<span class="bu">str</span>]] <span class="op">=</span> [[<span class="st">''</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb237-5490"><a href="#cb237-5490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5491"><a href="#cb237-5491" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb237-5492"><a href="#cb237-5492" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb237-5493"><a href="#cb237-5493" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="cf">if</span> padded_seq1[i] <span class="op">==</span> padded_seq2[j] <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb237-5494"><a href="#cb237-5494" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j], score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>], match_score)</span>
<span id="cb237-5495"><a href="#cb237-5495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5496"><a href="#cb237-5496" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j]:</span>
<span id="cb237-5497"><a href="#cb237-5497" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb237-5498"><a href="#cb237-5498" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb237-5499"><a href="#cb237-5499" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb237-5500"><a href="#cb237-5500" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb237-5501"><a href="#cb237-5501" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diag"</span></span>
<span id="cb237-5502"><a href="#cb237-5502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5503"><a href="#cb237-5503" aria-hidden="true" tabindex="-1"></a>    lcs <span class="op">=</span> <span class="st">""</span></span>
<span id="cb237-5504"><a href="#cb237-5504" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span>, <span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb237-5505"><a href="#cb237-5505" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> j <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb237-5506"><a href="#cb237-5506" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> backtrack_matrix[i][j] <span class="op">==</span> <span class="st">"diag"</span>:</span>
<span id="cb237-5507"><a href="#cb237-5507" aria-hidden="true" tabindex="-1"></a>            lcs <span class="op">=</span> padded_seq1[i] <span class="op">+</span> lcs</span>
<span id="cb237-5508"><a href="#cb237-5508" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-5509"><a href="#cb237-5509" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-5510"><a href="#cb237-5510" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> backtrack_matrix[i][j] <span class="op">==</span> <span class="st">"left"</span>:</span>
<span id="cb237-5511"><a href="#cb237-5511" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-5512"><a href="#cb237-5512" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-5513"><a href="#cb237-5513" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-5514"><a href="#cb237-5514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5515"><a href="#cb237-5515" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lcs</span>
<span id="cb237-5516"><a href="#cb237-5516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5517"><a href="#cb237-5517" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-5518"><a href="#cb237-5518" aria-hidden="true" tabindex="-1"></a><span class="st">AACCTTGG</span></span>
<span id="cb237-5519"><a href="#cb237-5519" aria-hidden="true" tabindex="-1"></a><span class="st">ACACTGTGA</span></span>
<span id="cb237-5520"><a href="#cb237-5520" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-5521"><a href="#cb237-5521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5522"><a href="#cb237-5522" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-5523"><a href="#cb237-5523" aria-hidden="true" tabindex="-1"></a>sequence1 <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb237-5524"><a href="#cb237-5524" aria-hidden="true" tabindex="-1"></a>sequence2 <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb237-5525"><a href="#cb237-5525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5526"><a href="#cb237-5526" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(longest_common_subsequence(sequence1, sequence2))</span>
<span id="cb237-5527"><a href="#cb237-5527" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5528"><a href="#cb237-5528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5529"><a href="#cb237-5529" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the Longest Path in a DAG</span></span>
<span id="cb237-5530"><a href="#cb237-5530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5531"><a href="#cb237-5531" aria-hidden="true" tabindex="-1"></a>Longest Path <span class="kw">in</span> a DAG Problem. Find a longest path between two nodes <span class="kw">in</span> an edge<span class="op">-</span>weighted DAG.</span>
<span id="cb237-5532"><a href="#cb237-5532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5533"><a href="#cb237-5533" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer representing the source node of a graph, followed by an integer representing the sink node of the graph, followed by an edge<span class="op">-</span>weighted graph. The graph <span class="kw">is</span> represented by a modified&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>)&nbsp;in which the notation<span class="st">"0-&gt;1:7"</span>indicates that an edge connects node <span class="dv">0</span> to node <span class="dv">1</span> <span class="cf">with</span> weight <span class="fl">7.</span></span>
<span id="cb237-5534"><a href="#cb237-5534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5535"><a href="#cb237-5535" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The length of a longest path <span class="kw">in</span> the graph, followed by a longest path. (If multiple longest paths exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb237-5536"><a href="#cb237-5536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5537"><a href="#cb237-5537" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-5538"><a href="#cb237-5538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5539"><a href="#cb237-5539" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5540"><a href="#cb237-5540" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span></span>
<span id="cb237-5541"><a href="#cb237-5541" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb237-5542"><a href="#cb237-5542" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">1</span>:<span class="dv">7</span></span>
<span id="cb237-5543"><a href="#cb237-5543" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">2</span>:<span class="dv">4</span></span>
<span id="cb237-5544"><a href="#cb237-5544" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">3</span>:<span class="dv">2</span></span>
<span id="cb237-5545"><a href="#cb237-5545" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="dv">1</span></span>
<span id="cb237-5546"><a href="#cb237-5546" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="dv">3</span></span>
<span id="cb237-5547"><a href="#cb237-5547" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5548"><a href="#cb237-5548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5549"><a href="#cb237-5549" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-5550"><a href="#cb237-5550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5551"><a href="#cb237-5551" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5552"><a href="#cb237-5552" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span></span>
<span id="cb237-5553"><a href="#cb237-5553" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">4</span></span>
<span id="cb237-5554"><a href="#cb237-5554" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5555"><a href="#cb237-5555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5556"><a href="#cb237-5556" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-5557"><a href="#cb237-5557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5558"><a href="#cb237-5558" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-5559"><a href="#cb237-5559" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Optional</span>
<span id="cb237-5560"><a href="#cb237-5560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5561"><a href="#cb237-5561" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Node:</span>
<span id="cb237-5562"><a href="#cb237-5562" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, label: <span class="bu">str</span>):</span>
<span id="cb237-5563"><a href="#cb237-5563" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label: <span class="bu">str</span> <span class="op">=</span> label</span>
<span id="cb237-5564"><a href="#cb237-5564" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.parent_nodes: List[Tuple[<span class="st">'Node'</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb237-5565"><a href="#cb237-5565" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.target_nodes: List[Tuple[<span class="st">'Node'</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb237-5566"><a href="#cb237-5566" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.visited: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span></span>
<span id="cb237-5567"><a href="#cb237-5567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5568"><a href="#cb237-5568" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DAG:</span>
<span id="cb237-5569"><a href="#cb237-5569" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb237-5570"><a href="#cb237-5570" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nodes_dict: Dict[<span class="bu">str</span>, Node] <span class="op">=</span> {}</span>
<span id="cb237-5571"><a href="#cb237-5571" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.distances: Dict[<span class="bu">str</span>, <span class="bu">float</span>] <span class="op">=</span> {}</span>
<span id="cb237-5572"><a href="#cb237-5572" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.backtrack: Dict[<span class="bu">str</span>, Optional[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb237-5573"><a href="#cb237-5573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5574"><a href="#cb237-5574" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_node(<span class="va">self</span>, label: <span class="bu">str</span>) <span class="op">-&gt;</span> Node:</span>
<span id="cb237-5575"><a href="#cb237-5575" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> label <span class="kw">in</span> <span class="va">self</span>.nodes_dict:</span>
<span id="cb237-5576"><a href="#cb237-5576" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.nodes_dict[label]</span>
<span id="cb237-5577"><a href="#cb237-5577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5578"><a href="#cb237-5578" aria-hidden="true" tabindex="-1"></a>        new_node <span class="op">=</span> Node(label)</span>
<span id="cb237-5579"><a href="#cb237-5579" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nodes_dict[label] <span class="op">=</span> new_node</span>
<span id="cb237-5580"><a href="#cb237-5580" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_node</span>
<span id="cb237-5581"><a href="#cb237-5581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5582"><a href="#cb237-5582" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_dag(<span class="va">self</span>, adjacency_list: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-5583"><a href="#cb237-5583" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> adjacency_list:</span>
<span id="cb237-5584"><a href="#cb237-5584" aria-hidden="true" tabindex="-1"></a>            source_label, temp <span class="op">=</span> line.split(<span class="st">"-&gt;"</span>)</span>
<span id="cb237-5585"><a href="#cb237-5585" aria-hidden="true" tabindex="-1"></a>            target_label, weight_str <span class="op">=</span> temp.split(<span class="st">":"</span>)</span>
<span id="cb237-5586"><a href="#cb237-5586" aria-hidden="true" tabindex="-1"></a>            weight <span class="op">=</span> <span class="bu">int</span>(weight_str)</span>
<span id="cb237-5587"><a href="#cb237-5587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5588"><a href="#cb237-5588" aria-hidden="true" tabindex="-1"></a>            source_node <span class="op">=</span> <span class="va">self</span>.add_node(source_label)</span>
<span id="cb237-5589"><a href="#cb237-5589" aria-hidden="true" tabindex="-1"></a>            target_node <span class="op">=</span> <span class="va">self</span>.add_node(target_label)</span>
<span id="cb237-5590"><a href="#cb237-5590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5591"><a href="#cb237-5591" aria-hidden="true" tabindex="-1"></a>            source_node.target_nodes.append((target_node, weight))</span>
<span id="cb237-5592"><a href="#cb237-5592" aria-hidden="true" tabindex="-1"></a>            target_node.parent_nodes.append((source_node, weight))</span>
<span id="cb237-5593"><a href="#cb237-5593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5594"><a href="#cb237-5594" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> topological_sort_util(<span class="va">self</span>, current_node: Node, sorted_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-5595"><a href="#cb237-5595" aria-hidden="true" tabindex="-1"></a>        current_node.visited <span class="op">=</span> <span class="va">True</span></span>
<span id="cb237-5596"><a href="#cb237-5596" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor, _ <span class="kw">in</span> current_node.target_nodes:</span>
<span id="cb237-5597"><a href="#cb237-5597" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> neighbor.visited:</span>
<span id="cb237-5598"><a href="#cb237-5598" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.topological_sort_util(neighbor, sorted_labels)</span>
<span id="cb237-5599"><a href="#cb237-5599" aria-hidden="true" tabindex="-1"></a>        sorted_labels.insert(<span class="dv">0</span>, current_node.label)</span>
<span id="cb237-5600"><a href="#cb237-5600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5601"><a href="#cb237-5601" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> topological_sort(<span class="va">self</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-5602"><a href="#cb237-5602" aria-hidden="true" tabindex="-1"></a>        sorted_labels: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb237-5603"><a href="#cb237-5603" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> <span class="va">self</span>.nodes_dict.values():</span>
<span id="cb237-5604"><a href="#cb237-5604" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> node.visited:</span>
<span id="cb237-5605"><a href="#cb237-5605" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.topological_sort_util(node, sorted_labels)</span>
<span id="cb237-5606"><a href="#cb237-5606" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sorted_labels</span>
<span id="cb237-5607"><a href="#cb237-5607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5608"><a href="#cb237-5608" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> longest_path(<span class="va">self</span>, source: <span class="bu">str</span>, sink: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb237-5609"><a href="#cb237-5609" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> label <span class="kw">in</span> <span class="va">self</span>.nodes_dict:</span>
<span id="cb237-5610"><a href="#cb237-5610" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.distances[label] <span class="op">=</span> <span class="bu">float</span>(<span class="st">"-inf"</span>)</span>
<span id="cb237-5611"><a href="#cb237-5611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5612"><a href="#cb237-5612" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.distances[source] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-5613"><a href="#cb237-5613" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.backtrack[source] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb237-5614"><a href="#cb237-5614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5615"><a href="#cb237-5615" aria-hidden="true" tabindex="-1"></a>        topological_order <span class="op">=</span> <span class="va">self</span>.topological_sort()</span>
<span id="cb237-5616"><a href="#cb237-5616" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> label <span class="kw">in</span> topological_order:</span>
<span id="cb237-5617"><a href="#cb237-5617" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> <span class="va">self</span>.nodes_dict[label]</span>
<span id="cb237-5618"><a href="#cb237-5618" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> target_node, weight <span class="kw">in</span> current_node.target_nodes:</span>
<span id="cb237-5619"><a href="#cb237-5619" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>.distances[target_node.label] <span class="op">&lt;</span> <span class="va">self</span>.distances[label] <span class="op">+</span> weight:</span>
<span id="cb237-5620"><a href="#cb237-5620" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.distances[target_node.label] <span class="op">=</span> <span class="va">self</span>.distances[label] <span class="op">+</span> weight</span>
<span id="cb237-5621"><a href="#cb237-5621" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.backtrack[target_node.label] <span class="op">=</span> label</span>
<span id="cb237-5622"><a href="#cb237-5622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5623"><a href="#cb237-5623" aria-hidden="true" tabindex="-1"></a>        path: List[<span class="bu">str</span>] <span class="op">=</span> [sink]</span>
<span id="cb237-5624"><a href="#cb237-5624" aria-hidden="true" tabindex="-1"></a>        current_label <span class="op">=</span> <span class="va">self</span>.backtrack[sink]</span>
<span id="cb237-5625"><a href="#cb237-5625" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_label <span class="op">!=</span> source:</span>
<span id="cb237-5626"><a href="#cb237-5626" aria-hidden="true" tabindex="-1"></a>            path <span class="op">=</span> [current_label] <span class="op">+</span> path</span>
<span id="cb237-5627"><a href="#cb237-5627" aria-hidden="true" tabindex="-1"></a>            current_label <span class="op">=</span> <span class="va">self</span>.backtrack[current_label]</span>
<span id="cb237-5628"><a href="#cb237-5628" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> [source] <span class="op">+</span> path</span>
<span id="cb237-5629"><a href="#cb237-5629" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.distances[sink], path</span>
<span id="cb237-5630"><a href="#cb237-5630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5631"><a href="#cb237-5631" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-5632"><a href="#cb237-5632" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-5633"><a href="#cb237-5633" aria-hidden="true" tabindex="-1"></a><span class="st">0</span></span>
<span id="cb237-5634"><a href="#cb237-5634" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb237-5635"><a href="#cb237-5635" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;1:7</span></span>
<span id="cb237-5636"><a href="#cb237-5636" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;2:4</span></span>
<span id="cb237-5637"><a href="#cb237-5637" aria-hidden="true" tabindex="-1"></a><span class="st">2-&gt;3:2</span></span>
<span id="cb237-5638"><a href="#cb237-5638" aria-hidden="true" tabindex="-1"></a><span class="st">1-&gt;4:1</span></span>
<span id="cb237-5639"><a href="#cb237-5639" aria-hidden="true" tabindex="-1"></a><span class="st">3-&gt;4:3</span></span>
<span id="cb237-5640"><a href="#cb237-5640" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-5641"><a href="#cb237-5641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5642"><a href="#cb237-5642" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-5643"><a href="#cb237-5643" aria-hidden="true" tabindex="-1"></a>source_label: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb237-5644"><a href="#cb237-5644" aria-hidden="true" tabindex="-1"></a>sink_label: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb237-5645"><a href="#cb237-5645" aria-hidden="true" tabindex="-1"></a>adjacency_list: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">2</span>:]</span>
<span id="cb237-5646"><a href="#cb237-5646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5647"><a href="#cb237-5647" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> DAG()</span>
<span id="cb237-5648"><a href="#cb237-5648" aria-hidden="true" tabindex="-1"></a>graph.construct_dag(adjacency_list)</span>
<span id="cb237-5649"><a href="#cb237-5649" aria-hidden="true" tabindex="-1"></a>longest_distance, longest_path <span class="op">=</span> graph.longest_path(source_label, sink_label)</span>
<span id="cb237-5650"><a href="#cb237-5650" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(longest_distance)</span>
<span id="cb237-5651"><a href="#cb237-5651" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(longest_path))</span>
<span id="cb237-5652"><a href="#cb237-5652" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5653"><a href="#cb237-5653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5654"><a href="#cb237-5654" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Highest-Scoring Alignment of Two Strings</span></span>
<span id="cb237-5655"><a href="#cb237-5655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5656"><a href="#cb237-5656" aria-hidden="true" tabindex="-1"></a>Global Alignment Problem. Find the highest<span class="op">-</span>scoring alignment between two strings using a scoring matrix.</span>
<span id="cb237-5657"><a href="#cb237-5657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5658"><a href="#cb237-5658" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;[amino acid strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>).</span>
<span id="cb237-5659"><a href="#cb237-5659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5660"><a href="#cb237-5660" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The maximum alignment score of these strings followed by an alignment achieving this maximum score. Use the&nbsp;[BLOSUM62](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>blosum62<span class="op">/</span>)&nbsp;scoring matrix <span class="kw">and</span> indel penalty σ <span class="op">=</span> <span class="fl">5.</span> (If multiple alignments achieving the maximum score exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb237-5661"><a href="#cb237-5661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5662"><a href="#cb237-5662" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-5663"><a href="#cb237-5663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5664"><a href="#cb237-5664" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5665"><a href="#cb237-5665" aria-hidden="true" tabindex="-1"></a>PLEASANTLY</span>
<span id="cb237-5666"><a href="#cb237-5666" aria-hidden="true" tabindex="-1"></a>MEANLY</span>
<span id="cb237-5667"><a href="#cb237-5667" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5668"><a href="#cb237-5668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5669"><a href="#cb237-5669" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-5670"><a href="#cb237-5670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5671"><a href="#cb237-5671" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5672"><a href="#cb237-5672" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span></span>
<span id="cb237-5673"><a href="#cb237-5673" aria-hidden="true" tabindex="-1"></a>PLEASANTLY</span>
<span id="cb237-5674"><a href="#cb237-5674" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>MEA<span class="op">--</span>N<span class="op">-</span>LY</span>
<span id="cb237-5675"><a href="#cb237-5675" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5676"><a href="#cb237-5676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5677"><a href="#cb237-5677" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-5678"><a href="#cb237-5678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5679"><a href="#cb237-5679" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-5680"><a href="#cb237-5680" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb237-5681"><a href="#cb237-5681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5682"><a href="#cb237-5682" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb237-5683"><a href="#cb237-5683" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb237-5684"><a href="#cb237-5684" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-5685"><a href="#cb237-5685" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5686"><a href="#cb237-5686" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5687"><a href="#cb237-5687" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-5688"><a href="#cb237-5688" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb237-5689"><a href="#cb237-5689" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb237-5690"><a href="#cb237-5690" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5691"><a href="#cb237-5691" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5692"><a href="#cb237-5692" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5693"><a href="#cb237-5693" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-5694"><a href="#cb237-5694" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5695"><a href="#cb237-5695" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5696"><a href="#cb237-5696" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5697"><a href="#cb237-5697" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5698"><a href="#cb237-5698" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb237-5699"><a href="#cb237-5699" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb237-5700"><a href="#cb237-5700" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5701"><a href="#cb237-5701" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb237-5702"><a href="#cb237-5702" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-5703"><a href="#cb237-5703" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-5704"><a href="#cb237-5704" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb237-5705"><a href="#cb237-5705" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5706"><a href="#cb237-5706" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5707"><a href="#cb237-5707" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5708"><a href="#cb237-5708" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5709"><a href="#cb237-5709" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5710"><a href="#cb237-5710" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5711"><a href="#cb237-5711" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5712"><a href="#cb237-5712" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb237-5713"><a href="#cb237-5713" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5714"><a href="#cb237-5714" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb237-5715"><a href="#cb237-5715" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb237-5716"><a href="#cb237-5716" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5717"><a href="#cb237-5717" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb237-5718"><a href="#cb237-5718" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5719"><a href="#cb237-5719" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb237-5720"><a href="#cb237-5720" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb237-5721"><a href="#cb237-5721" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb237-5722"><a href="#cb237-5722" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb237-5723"><a href="#cb237-5723" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5724"><a href="#cb237-5724" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb237-5725"><a href="#cb237-5725" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5726"><a href="#cb237-5726" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5727"><a href="#cb237-5727" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5728"><a href="#cb237-5728" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-5729"><a href="#cb237-5729" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5730"><a href="#cb237-5730" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb237-5731"><a href="#cb237-5731" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5732"><a href="#cb237-5732" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-5733"><a href="#cb237-5733" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-5734"><a href="#cb237-5734" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5735"><a href="#cb237-5735" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-5736"><a href="#cb237-5736" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb237-5737"><a href="#cb237-5737" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb237-5738"><a href="#cb237-5738" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5739"><a href="#cb237-5739" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb237-5740"><a href="#cb237-5740" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb237-5741"><a href="#cb237-5741" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-5742"><a href="#cb237-5742" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5743"><a href="#cb237-5743" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5744"><a href="#cb237-5744" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5745"><a href="#cb237-5745" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-5746"><a href="#cb237-5746" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5747"><a href="#cb237-5747" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5748"><a href="#cb237-5748" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5749"><a href="#cb237-5749" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb237-5750"><a href="#cb237-5750" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-5751"><a href="#cb237-5751" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb237-5752"><a href="#cb237-5752" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb237-5753"><a href="#cb237-5753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5754"><a href="#cb237-5754" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> global_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, indel_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb237-5755"><a href="#cb237-5755" aria-hidden="true" tabindex="-1"></a>    padded_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence1</span>
<span id="cb237-5756"><a href="#cb237-5756" aria-hidden="true" tabindex="-1"></a>    padded_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence2</span>
<span id="cb237-5757"><a href="#cb237-5757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5758"><a href="#cb237-5758" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb237-5759"><a href="#cb237-5759" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[<span class="bu">str</span>]] <span class="op">=</span> [[<span class="st">''</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb237-5760"><a href="#cb237-5760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5761"><a href="#cb237-5761" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2)):</span>
<span id="cb237-5762"><a href="#cb237-5762" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>][j] <span class="op">=</span> <span class="op">-</span>indel_penalty <span class="op">*</span> j</span>
<span id="cb237-5763"><a href="#cb237-5763" aria-hidden="true" tabindex="-1"></a>        backtrack_matrix[<span class="dv">0</span>][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb237-5764"><a href="#cb237-5764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5765"><a href="#cb237-5765" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1)):</span>
<span id="cb237-5766"><a href="#cb237-5766" aria-hidden="true" tabindex="-1"></a>        score_matrix[i][<span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span>indel_penalty <span class="op">*</span> i</span>
<span id="cb237-5767"><a href="#cb237-5767" aria-hidden="true" tabindex="-1"></a>        backtrack_matrix[i][<span class="dv">0</span>] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb237-5768"><a href="#cb237-5768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5769"><a href="#cb237-5769" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb237-5770"><a href="#cb237-5770" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb237-5771"><a href="#cb237-5771" aria-hidden="true" tabindex="-1"></a>            key: Tuple[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> (padded_seq1[i], padded_seq2[j]) <span class="cf">if</span> (padded_seq1[i], padded_seq2[j]) <span class="kw">in</span> BLOSUM62 <span class="cf">else</span> (padded_seq2[j], padded_seq1[i])</span>
<span id="cb237-5772"><a href="#cb237-5772" aria-hidden="true" tabindex="-1"></a>            diagonal_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> BLOSUM62[key]</span>
<span id="cb237-5773"><a href="#cb237-5773" aria-hidden="true" tabindex="-1"></a>            up_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">-</span> indel_penalty</span>
<span id="cb237-5774"><a href="#cb237-5774" aria-hidden="true" tabindex="-1"></a>            left_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> indel_penalty</span>
<span id="cb237-5775"><a href="#cb237-5775" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(diagonal_score, up_score, left_score)</span>
<span id="cb237-5776"><a href="#cb237-5776" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb237-5777"><a href="#cb237-5777" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> diagonal_score:</span>
<span id="cb237-5778"><a href="#cb237-5778" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diagonal"</span></span>
<span id="cb237-5779"><a href="#cb237-5779" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> up_score:</span>
<span id="cb237-5780"><a href="#cb237-5780" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb237-5781"><a href="#cb237-5781" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb237-5782"><a href="#cb237-5782" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb237-5783"><a href="#cb237-5783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5784"><a href="#cb237-5784" aria-hidden="true" tabindex="-1"></a>    i: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb237-5785"><a href="#cb237-5785" aria-hidden="true" tabindex="-1"></a>    j: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb237-5786"><a href="#cb237-5786" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb237-5787"><a href="#cb237-5787" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb237-5788"><a href="#cb237-5788" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5789"><a href="#cb237-5789" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">!=</span> <span class="dv">0</span> <span class="kw">or</span> j <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb237-5790"><a href="#cb237-5790" aria-hidden="true" tabindex="-1"></a>        direction: <span class="bu">str</span> <span class="op">=</span> backtrack_matrix[i][j]</span>
<span id="cb237-5791"><a href="#cb237-5791" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"diagonal"</span>:</span>
<span id="cb237-5792"><a href="#cb237-5792" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb237-5793"><a href="#cb237-5793" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb237-5794"><a href="#cb237-5794" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-5795"><a href="#cb237-5795" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-5796"><a href="#cb237-5796" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"up"</span>:</span>
<span id="cb237-5797"><a href="#cb237-5797" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb237-5798"><a href="#cb237-5798" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq2</span>
<span id="cb237-5799"><a href="#cb237-5799" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-5800"><a href="#cb237-5800" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-5801"><a href="#cb237-5801" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq1</span>
<span id="cb237-5802"><a href="#cb237-5802" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb237-5803"><a href="#cb237-5803" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-5804"><a href="#cb237-5804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5805"><a href="#cb237-5805" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score_matrix[<span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span>][<span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span>], aligned_seq1, aligned_seq2</span>
<span id="cb237-5806"><a href="#cb237-5806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5807"><a href="#cb237-5807" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-5808"><a href="#cb237-5808" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-5809"><a href="#cb237-5809" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb237-5810"><a href="#cb237-5810" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb237-5811"><a href="#cb237-5811" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-5812"><a href="#cb237-5812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5813"><a href="#cb237-5813" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-5814"><a href="#cb237-5814" aria-hidden="true" tabindex="-1"></a>sequence1: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb237-5815"><a href="#cb237-5815" aria-hidden="true" tabindex="-1"></a>sequence2: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb237-5816"><a href="#cb237-5816" aria-hidden="true" tabindex="-1"></a>alignment_score: <span class="bu">int</span></span>
<span id="cb237-5817"><a href="#cb237-5817" aria-hidden="true" tabindex="-1"></a>aligned_sequence1: <span class="bu">str</span></span>
<span id="cb237-5818"><a href="#cb237-5818" aria-hidden="true" tabindex="-1"></a>aligned_sequence2: <span class="bu">str</span></span>
<span id="cb237-5819"><a href="#cb237-5819" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_sequence1, aligned_sequence2 <span class="op">=</span> global_alignment(sequence1, sequence2)</span>
<span id="cb237-5820"><a href="#cb237-5820" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb237-5821"><a href="#cb237-5821" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence1)</span>
<span id="cb237-5822"><a href="#cb237-5822" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence2)</span>
<span id="cb237-5823"><a href="#cb237-5823" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5824"><a href="#cb237-5824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5825"><a href="#cb237-5825" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Highest-Scoring Local Alignment of Two Strings</span></span>
<span id="cb237-5826"><a href="#cb237-5826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5827"><a href="#cb237-5827" aria-hidden="true" tabindex="-1"></a>Local Alignment Problem, Find the highest<span class="op">-</span>scoring local alignment between two strings.</span>
<span id="cb237-5828"><a href="#cb237-5828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5829"><a href="#cb237-5829" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;[amino acid strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>).</span>
<span id="cb237-5830"><a href="#cb237-5830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5831"><a href="#cb237-5831" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The maximum score of a local alignment of the strings, followed by a local alignment of these strings achieving the maximum score. Use the&nbsp;[PAM250](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>pam250<span class="op">/</span>)&nbsp;scoring matrix <span class="kw">and</span> indel penalty σ <span class="op">=</span> <span class="fl">5.</span> (If multiple local alignments achieving the maximum score exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb237-5832"><a href="#cb237-5832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5833"><a href="#cb237-5833" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-5834"><a href="#cb237-5834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5835"><a href="#cb237-5835" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5836"><a href="#cb237-5836" aria-hidden="true" tabindex="-1"></a>MEANLY</span>
<span id="cb237-5837"><a href="#cb237-5837" aria-hidden="true" tabindex="-1"></a>PENALTY</span>
<span id="cb237-5838"><a href="#cb237-5838" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5839"><a href="#cb237-5839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5840"><a href="#cb237-5840" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-5841"><a href="#cb237-5841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5842"><a href="#cb237-5842" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5843"><a href="#cb237-5843" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span></span>
<span id="cb237-5844"><a href="#cb237-5844" aria-hidden="true" tabindex="-1"></a>EANL<span class="op">-</span>Y</span>
<span id="cb237-5845"><a href="#cb237-5845" aria-hidden="true" tabindex="-1"></a>ENALTY</span>
<span id="cb237-5846"><a href="#cb237-5846" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5847"><a href="#cb237-5847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5848"><a href="#cb237-5848" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-5849"><a href="#cb237-5849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5850"><a href="#cb237-5850" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-5851"><a href="#cb237-5851" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Optional</span>
<span id="cb237-5852"><a href="#cb237-5852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5853"><a href="#cb237-5853" aria-hidden="true" tabindex="-1"></a>PAM250: Dict[<span class="bu">str</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> {</span>
<span id="cb237-5854"><a href="#cb237-5854" aria-hidden="true" tabindex="-1"></a>        <span class="st">'A'</span>: {<span class="st">'A'</span>: <span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb237-5855"><a href="#cb237-5855" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">0</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">1</span>, <span class="st">'V'</span>: <span class="dv">0</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb237-5856"><a href="#cb237-5856" aria-hidden="true" tabindex="-1"></a>          <span class="st">'C'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="dv">12</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">5</span>,</span>
<span id="cb237-5857"><a href="#cb237-5857" aria-hidden="true" tabindex="-1"></a>                <span class="st">'N'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'P'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">8</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb237-5858"><a href="#cb237-5858" aria-hidden="true" tabindex="-1"></a>          <span class="st">'D'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">4</span>, <span class="st">'E'</span>: <span class="dv">3</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb237-5859"><a href="#cb237-5859" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb237-5860"><a href="#cb237-5860" aria-hidden="true" tabindex="-1"></a>          <span class="st">'E'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">3</span>, <span class="st">'E'</span>: <span class="dv">4</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb237-5861"><a href="#cb237-5861" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb237-5862"><a href="#cb237-5862" aria-hidden="true" tabindex="-1"></a>          <span class="st">'F'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'F'</span>: <span class="dv">9</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-5863"><a href="#cb237-5863" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="dv">0</span>, <span class="st">'Y'</span>: <span class="dv">7</span>},</span>
<span id="cb237-5864"><a href="#cb237-5864" aria-hidden="true" tabindex="-1"></a>          <span class="st">'G'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="dv">1</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">5</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb237-5865"><a href="#cb237-5865" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">5</span>},</span>
<span id="cb237-5866"><a href="#cb237-5866" aria-hidden="true" tabindex="-1"></a>          <span class="st">'H'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="dv">1</span>, <span class="st">'E'</span>: <span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'H'</span>: <span class="dv">6</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb237-5867"><a href="#cb237-5867" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">3</span>, <span class="st">'R'</span>: <span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb237-5868"><a href="#cb237-5868" aria-hidden="true" tabindex="-1"></a>          <span class="st">'I'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="dv">1</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">5</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5869"><a href="#cb237-5869" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="dv">4</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">1</span>},</span>
<span id="cb237-5870"><a href="#cb237-5870" aria-hidden="true" tabindex="-1"></a>          <span class="st">'K'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">5</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb237-5871"><a href="#cb237-5871" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">3</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb237-5872"><a href="#cb237-5872" aria-hidden="true" tabindex="-1"></a>          <span class="st">'L'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'F'</span>: <span class="dv">2</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'L'</span>: <span class="dv">6</span>, <span class="st">'M'</span>: <span class="dv">4</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-5873"><a href="#cb237-5873" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'V'</span>: <span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">1</span>},</span>
<span id="cb237-5874"><a href="#cb237-5874" aria-hidden="true" tabindex="-1"></a>          <span class="st">'M'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="dv">0</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="dv">4</span>, <span class="st">'M'</span>: <span class="dv">6</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5875"><a href="#cb237-5875" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb237-5876"><a href="#cb237-5876" aria-hidden="true" tabindex="-1"></a>          <span class="st">'N'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="dv">2</span>, <span class="st">'E'</span>: <span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb237-5877"><a href="#cb237-5877" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb237-5878"><a href="#cb237-5878" aria-hidden="true" tabindex="-1"></a>          <span class="st">'P'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb237-5879"><a href="#cb237-5879" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">6</span>, <span class="st">'Q'</span>: <span class="dv">0</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">5</span>},</span>
<span id="cb237-5880"><a href="#cb237-5880" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Q'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">2</span>, <span class="st">'E'</span>: <span class="dv">2</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'H'</span>: <span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb237-5881"><a href="#cb237-5881" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">4</span>, <span class="st">'R'</span>: <span class="dv">1</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb237-5882"><a href="#cb237-5882" aria-hidden="true" tabindex="-1"></a>          <span class="st">'R'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">3</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb237-5883"><a href="#cb237-5883" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">6</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb237-5884"><a href="#cb237-5884" aria-hidden="true" tabindex="-1"></a>          <span class="st">'S'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="dv">0</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb237-5885"><a href="#cb237-5885" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">1</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">2</span>, <span class="st">'T'</span>: <span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb237-5886"><a href="#cb237-5886" aria-hidden="true" tabindex="-1"></a>          <span class="st">'T'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="dv">0</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb237-5887"><a href="#cb237-5887" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">3</span>, <span class="st">'V'</span>: <span class="dv">0</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb237-5888"><a href="#cb237-5888" aria-hidden="true" tabindex="-1"></a>          <span class="st">'V'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">4</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5889"><a href="#cb237-5889" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="dv">4</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb237-5890"><a href="#cb237-5890" aria-hidden="true" tabindex="-1"></a>          <span class="st">'W'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">8</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'F'</span>: <span class="dv">0</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb237-5891"><a href="#cb237-5891" aria-hidden="true" tabindex="-1"></a>                <span class="st">'N'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'P'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'W'</span>: <span class="dv">17</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb237-5892"><a href="#cb237-5892" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Y'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'C'</span>: <span class="dv">0</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'F'</span>: <span class="dv">7</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-5893"><a href="#cb237-5893" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="dv">0</span>, <span class="st">'Y'</span>: <span class="dv">10</span>}}</span>
<span id="cb237-5894"><a href="#cb237-5894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5895"><a href="#cb237-5895" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> local_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, indel_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb237-5896"><a href="#cb237-5896" aria-hidden="true" tabindex="-1"></a>    padded_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence1</span>
<span id="cb237-5897"><a href="#cb237-5897" aria-hidden="true" tabindex="-1"></a>    padded_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence2</span>
<span id="cb237-5898"><a href="#cb237-5898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5899"><a href="#cb237-5899" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb237-5900"><a href="#cb237-5900" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[Optional[<span class="bu">str</span>]]] <span class="op">=</span> [[<span class="va">None</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb237-5901"><a href="#cb237-5901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5902"><a href="#cb237-5902" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb237-5903"><a href="#cb237-5903" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb237-5904"><a href="#cb237-5904" aria-hidden="true" tabindex="-1"></a>            key1: <span class="bu">str</span> <span class="op">=</span> padded_seq1[i] <span class="cf">if</span> padded_seq1[i] <span class="kw">in</span> PAM250 <span class="cf">else</span> padded_seq2[j]</span>
<span id="cb237-5905"><a href="#cb237-5905" aria-hidden="true" tabindex="-1"></a>            key2: <span class="bu">str</span> <span class="op">=</span> padded_seq2[j] <span class="cf">if</span> padded_seq1[i] <span class="kw">in</span> PAM250 <span class="cf">else</span> padded_seq1[i]</span>
<span id="cb237-5906"><a href="#cb237-5906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5907"><a href="#cb237-5907" aria-hidden="true" tabindex="-1"></a>            diagonal_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> PAM250[key1][key2]</span>
<span id="cb237-5908"><a href="#cb237-5908" aria-hidden="true" tabindex="-1"></a>            up_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">-</span> indel_penalty</span>
<span id="cb237-5909"><a href="#cb237-5909" aria-hidden="true" tabindex="-1"></a>            left_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> indel_penalty</span>
<span id="cb237-5910"><a href="#cb237-5910" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(diagonal_score, up_score, left_score, <span class="dv">0</span>)</span>
<span id="cb237-5911"><a href="#cb237-5911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5912"><a href="#cb237-5912" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> diagonal_score:</span>
<span id="cb237-5913"><a href="#cb237-5913" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diagonal"</span></span>
<span id="cb237-5914"><a href="#cb237-5914" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> up_score:</span>
<span id="cb237-5915"><a href="#cb237-5915" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb237-5916"><a href="#cb237-5916" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> left_score:</span>
<span id="cb237-5917"><a href="#cb237-5917" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb237-5918"><a href="#cb237-5918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5919"><a href="#cb237-5919" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb237-5920"><a href="#cb237-5920" aria-hidden="true" tabindex="-1"></a>    max_i: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-5921"><a href="#cb237-5921" aria-hidden="true" tabindex="-1"></a>    max_j: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-5922"><a href="#cb237-5922" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1)):</span>
<span id="cb237-5923"><a href="#cb237-5923" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2)):</span>
<span id="cb237-5924"><a href="#cb237-5924" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">&gt;</span> max_score:</span>
<span id="cb237-5925"><a href="#cb237-5925" aria-hidden="true" tabindex="-1"></a>                max_score <span class="op">=</span> score_matrix[i][j]</span>
<span id="cb237-5926"><a href="#cb237-5926" aria-hidden="true" tabindex="-1"></a>                max_i, max_j <span class="op">=</span> i, j</span>
<span id="cb237-5927"><a href="#cb237-5927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5928"><a href="#cb237-5928" aria-hidden="true" tabindex="-1"></a>    i: <span class="bu">int</span> <span class="op">=</span> max_i</span>
<span id="cb237-5929"><a href="#cb237-5929" aria-hidden="true" tabindex="-1"></a>    j: <span class="bu">int</span> <span class="op">=</span> max_j</span>
<span id="cb237-5930"><a href="#cb237-5930" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb237-5931"><a href="#cb237-5931" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb237-5932"><a href="#cb237-5932" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> backtrack_matrix[i][j] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb237-5933"><a href="#cb237-5933" aria-hidden="true" tabindex="-1"></a>        direction: <span class="bu">str</span> <span class="op">=</span> backtrack_matrix[i][j]</span>
<span id="cb237-5934"><a href="#cb237-5934" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"diagonal"</span>:</span>
<span id="cb237-5935"><a href="#cb237-5935" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb237-5936"><a href="#cb237-5936" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb237-5937"><a href="#cb237-5937" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-5938"><a href="#cb237-5938" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-5939"><a href="#cb237-5939" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"up"</span>:</span>
<span id="cb237-5940"><a href="#cb237-5940" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb237-5941"><a href="#cb237-5941" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq2</span>
<span id="cb237-5942"><a href="#cb237-5942" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-5943"><a href="#cb237-5943" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-5944"><a href="#cb237-5944" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq1</span>
<span id="cb237-5945"><a href="#cb237-5945" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb237-5946"><a href="#cb237-5946" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-5947"><a href="#cb237-5947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5948"><a href="#cb237-5948" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1, aligned_seq2</span>
<span id="cb237-5949"><a href="#cb237-5949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5950"><a href="#cb237-5950" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb237-5951"><a href="#cb237-5951" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-5952"><a href="#cb237-5952" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb237-5953"><a href="#cb237-5953" aria-hidden="true" tabindex="-1"></a><span class="st">PENALTY</span></span>
<span id="cb237-5954"><a href="#cb237-5954" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-5955"><a href="#cb237-5955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5956"><a href="#cb237-5956" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-5957"><a href="#cb237-5957" aria-hidden="true" tabindex="-1"></a>sequence1: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb237-5958"><a href="#cb237-5958" aria-hidden="true" tabindex="-1"></a>sequence2: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb237-5959"><a href="#cb237-5959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5960"><a href="#cb237-5960" aria-hidden="true" tabindex="-1"></a>alignment_score: <span class="bu">int</span></span>
<span id="cb237-5961"><a href="#cb237-5961" aria-hidden="true" tabindex="-1"></a>aligned_sequence1: <span class="bu">str</span></span>
<span id="cb237-5962"><a href="#cb237-5962" aria-hidden="true" tabindex="-1"></a>aligned_sequence2: <span class="bu">str</span></span>
<span id="cb237-5963"><a href="#cb237-5963" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_sequence1, aligned_sequence2 <span class="op">=</span> local_alignment(sequence1, sequence2)</span>
<span id="cb237-5964"><a href="#cb237-5964" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb237-5965"><a href="#cb237-5965" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence1)</span>
<span id="cb237-5966"><a href="#cb237-5966" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence2)</span>
<span id="cb237-5967"><a href="#cb237-5967" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5968"><a href="#cb237-5968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5969"><a href="#cb237-5969" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Edit Distance Between Two Strings</span></span>
<span id="cb237-5970"><a href="#cb237-5970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5971"><a href="#cb237-5971" aria-hidden="true" tabindex="-1"></a>Edit Distance Problem. Find the edit distance between two strings.</span>
<span id="cb237-5972"><a href="#cb237-5972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5973"><a href="#cb237-5973" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;[amino acid strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>).</span>
<span id="cb237-5974"><a href="#cb237-5974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5975"><a href="#cb237-5975" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The&nbsp;[edit distance](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>edit<span class="op">-</span>distance<span class="op">/</span>)&nbsp;between these strings.</span>
<span id="cb237-5976"><a href="#cb237-5976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5977"><a href="#cb237-5977" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-5978"><a href="#cb237-5978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5979"><a href="#cb237-5979" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5980"><a href="#cb237-5980" aria-hidden="true" tabindex="-1"></a>PLEASANTLY</span>
<span id="cb237-5981"><a href="#cb237-5981" aria-hidden="true" tabindex="-1"></a>MEANLY</span>
<span id="cb237-5982"><a href="#cb237-5982" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5983"><a href="#cb237-5983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5984"><a href="#cb237-5984" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-5985"><a href="#cb237-5985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5986"><a href="#cb237-5986" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5987"><a href="#cb237-5987" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb237-5988"><a href="#cb237-5988" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-5989"><a href="#cb237-5989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5990"><a href="#cb237-5990" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-5991"><a href="#cb237-5991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5992"><a href="#cb237-5992" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-5993"><a href="#cb237-5993" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_edit_distance(source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-5994"><a href="#cb237-5994" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> {}</span>
<span id="cb237-5995"><a href="#cb237-5995" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5996"><a href="#cb237-5996" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(target) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-5997"><a href="#cb237-5997" aria-hidden="true" tabindex="-1"></a>        distance_matrix[target_index, <span class="dv">0</span>] <span class="op">=</span> target_index</span>
<span id="cb237-5998"><a href="#cb237-5998" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-5999"><a href="#cb237-5999" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(source) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-6000"><a href="#cb237-6000" aria-hidden="true" tabindex="-1"></a>        distance_matrix[<span class="dv">0</span>, source_index] <span class="op">=</span> source_index</span>
<span id="cb237-6001"><a href="#cb237-6001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6002"><a href="#cb237-6002" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(target)):</span>
<span id="cb237-6003"><a href="#cb237-6003" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(source)):</span>
<span id="cb237-6004"><a href="#cb237-6004" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> source[source_index] <span class="op">==</span> target[target_index]:</span>
<span id="cb237-6005"><a href="#cb237-6005" aria-hidden="true" tabindex="-1"></a>                distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> distance_matrix[target_index, source_index]</span>
<span id="cb237-6006"><a href="#cb237-6006" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb237-6007"><a href="#cb237-6007" aria-hidden="true" tabindex="-1"></a>                distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> <span class="bu">min</span>([</span>
<span id="cb237-6008"><a href="#cb237-6008" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index],</span>
<span id="cb237-6009"><a href="#cb237-6009" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index, source_index],</span>
<span id="cb237-6010"><a href="#cb237-6010" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index, source_index <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb237-6011"><a href="#cb237-6011" aria-hidden="true" tabindex="-1"></a>                ]) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb237-6012"><a href="#cb237-6012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6013"><a href="#cb237-6013" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distance_matrix[<span class="bu">len</span>(target), <span class="bu">len</span>(source)]</span>
<span id="cb237-6014"><a href="#cb237-6014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6015"><a href="#cb237-6015" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-6016"><a href="#cb237-6016" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb237-6017"><a href="#cb237-6017" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb237-6018"><a href="#cb237-6018" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-6019"><a href="#cb237-6019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6020"><a href="#cb237-6020" aria-hidden="true" tabindex="-1"></a>source, target <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-6021"><a href="#cb237-6021" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_edit_distance(source, target))</span>
<span id="cb237-6022"><a href="#cb237-6022" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6023"><a href="#cb237-6023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6024"><a href="#cb237-6024" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Highest-Scoring Fitting Alignment of Two Strings</span></span>
<span id="cb237-6025"><a href="#cb237-6025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6026"><a href="#cb237-6026" aria-hidden="true" tabindex="-1"></a>Fitting Alignment Problem. Construct a highest<span class="op">-</span>scoring fitting alignment between two strings.</span>
<span id="cb237-6027"><a href="#cb237-6027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6028"><a href="#cb237-6028" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;[DNA strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>, where&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;has length at most <span class="dv">10000</span> and&nbsp;<span class="op">*</span>w<span class="op">*</span>&nbsp;has length at most <span class="fl">1000.</span></span>
<span id="cb237-6029"><a href="#cb237-6029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6030"><a href="#cb237-6030" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The maximum score of a fitting alignment of&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>, followed by a fitting alignment achieving this maximum score. Use the simple scoring method <span class="kw">in</span> which matches count <span class="op">+</span><span class="dv">1</span> <span class="kw">and</span> both the mismatch <span class="kw">and</span> indel penalties are equal to <span class="fl">1.</span> (If multiple fitting alignments achieving the maximum score exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb237-6031"><a href="#cb237-6031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6032"><a href="#cb237-6032" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-6033"><a href="#cb237-6033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6034"><a href="#cb237-6034" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6035"><a href="#cb237-6035" aria-hidden="true" tabindex="-1"></a>GTAGGCTTAAGGTTA</span>
<span id="cb237-6036"><a href="#cb237-6036" aria-hidden="true" tabindex="-1"></a>TAGATA</span>
<span id="cb237-6037"><a href="#cb237-6037" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6038"><a href="#cb237-6038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6039"><a href="#cb237-6039" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-6040"><a href="#cb237-6040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6041"><a href="#cb237-6041" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6042"><a href="#cb237-6042" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span></span>
<span id="cb237-6043"><a href="#cb237-6043" aria-hidden="true" tabindex="-1"></a>TAGGCTTA</span>
<span id="cb237-6044"><a href="#cb237-6044" aria-hidden="true" tabindex="-1"></a>TAGA<span class="op">--</span>TA</span>
<span id="cb237-6045"><a href="#cb237-6045" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6046"><a href="#cb237-6046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6047"><a href="#cb237-6047" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-6048"><a href="#cb237-6048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6049"><a href="#cb237-6049" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-6050"><a href="#cb237-6050" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple, Dict</span>
<span id="cb237-6051"><a href="#cb237-6051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6052"><a href="#cb237-6052" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_fitting_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb237-6053"><a href="#cb237-6053" aria-hidden="true" tabindex="-1"></a>    score_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-6054"><a href="#cb237-6054" aria-hidden="true" tabindex="-1"></a>    path_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb237-6055"><a href="#cb237-6055" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6056"><a href="#cb237-6056" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-6057"><a href="#cb237-6057" aria-hidden="true" tabindex="-1"></a>        score_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span>seq2_index</span>
<span id="cb237-6058"><a href="#cb237-6058" aria-hidden="true" tabindex="-1"></a>        path_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="st">"↑"</span></span>
<span id="cb237-6059"><a href="#cb237-6059" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-6060"><a href="#cb237-6060" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-6061"><a href="#cb237-6061" aria-hidden="true" tabindex="-1"></a>        path_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="st">"←"</span></span>
<span id="cb237-6062"><a href="#cb237-6062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6063"><a href="#cb237-6063" aria-hidden="true" tabindex="-1"></a>    score_matrix[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-6064"><a href="#cb237-6064" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2)):</span>
<span id="cb237-6065"><a href="#cb237-6065" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1)):</span>
<span id="cb237-6066"><a href="#cb237-6066" aria-hidden="true" tabindex="-1"></a>            current_position <span class="op">=</span> (seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb237-6067"><a href="#cb237-6067" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> sequence1[seq1_index] <span class="op">==</span> sequence2[seq2_index] <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb237-6068"><a href="#cb237-6068" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb237-6069"><a href="#cb237-6069" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index] <span class="op">+</span> match_score,</span>
<span id="cb237-6070"><a href="#cb237-6070" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>,</span>
<span id="cb237-6071"><a href="#cb237-6071" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index] <span class="op">-</span> <span class="dv">1</span>,</span>
<span id="cb237-6072"><a href="#cb237-6072" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb237-6073"><a href="#cb237-6073" aria-hidden="true" tabindex="-1"></a>            score_matrix[current_position] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb237-6074"><a href="#cb237-6074" aria-hidden="true" tabindex="-1"></a>            path_matrix[current_position] <span class="op">=</span> [<span class="st">"↖"</span>, <span class="st">"↑"</span>, <span class="st">"←"</span>][options.index(<span class="bu">max</span>(options))]</span>
<span id="cb237-6075"><a href="#cb237-6075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6076"><a href="#cb237-6076" aria-hidden="true" tabindex="-1"></a>    final_scores <span class="op">=</span> [score_matrix[<span class="bu">len</span>(sequence2), i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-6077"><a href="#cb237-6077" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="bu">max</span>(final_scores)</span>
<span id="cb237-6078"><a href="#cb237-6078" aria-hidden="true" tabindex="-1"></a>    seq1_end_index <span class="op">=</span> final_scores.index(max_score)</span>
<span id="cb237-6079"><a href="#cb237-6079" aria-hidden="true" tabindex="-1"></a>    seq2_end_index <span class="op">=</span> <span class="bu">len</span>(sequence2)</span>
<span id="cb237-6080"><a href="#cb237-6080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6081"><a href="#cb237-6081" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb237-6082"><a href="#cb237-6082" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> seq1_end_index <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> seq2_end_index <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb237-6083"><a href="#cb237-6083" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↖"</span>:</span>
<span id="cb237-6084"><a href="#cb237-6084" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb237-6085"><a href="#cb237-6085" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb237-6086"><a href="#cb237-6086" aria-hidden="true" tabindex="-1"></a>            seq2_end_index, seq1_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span>, seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb237-6087"><a href="#cb237-6087" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"←"</span>:</span>
<span id="cb237-6088"><a href="#cb237-6088" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb237-6089"><a href="#cb237-6089" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb237-6090"><a href="#cb237-6090" aria-hidden="true" tabindex="-1"></a>            seq1_end_index <span class="op">=</span> seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb237-6091"><a href="#cb237-6091" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↑"</span>:</span>
<span id="cb237-6092"><a href="#cb237-6092" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb237-6093"><a href="#cb237-6093" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb237-6094"><a href="#cb237-6094" aria-hidden="true" tabindex="-1"></a>            seq2_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb237-6095"><a href="#cb237-6095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6096"><a href="#cb237-6096" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1[::<span class="op">-</span><span class="dv">1</span>], aligned_seq2[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb237-6097"><a href="#cb237-6097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6098"><a href="#cb237-6098" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-6099"><a href="#cb237-6099" aria-hidden="true" tabindex="-1"></a><span class="st">GTAGGCTTAAGGTTA</span></span>
<span id="cb237-6100"><a href="#cb237-6100" aria-hidden="true" tabindex="-1"></a><span class="st">TAGATA</span></span>
<span id="cb237-6101"><a href="#cb237-6101" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-6102"><a href="#cb237-6102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6103"><a href="#cb237-6103" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-6104"><a href="#cb237-6104" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>calculate_fitting_alignment(sequence1, sequence2), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-6105"><a href="#cb237-6105" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6106"><a href="#cb237-6106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6107"><a href="#cb237-6107" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Highest-Scoring Overlap Alignment of Two Strings</span></span>
<span id="cb237-6108"><a href="#cb237-6108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6109"><a href="#cb237-6109" aria-hidden="true" tabindex="-1"></a>Overlap Alignment Problem. Construct a highest<span class="op">-</span>scoring overlap alignment between two strings.</span>
<span id="cb237-6110"><a href="#cb237-6110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6111"><a href="#cb237-6111" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;[protein strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>, each of length at most <span class="fl">1000.</span></span>
<span id="cb237-6112"><a href="#cb237-6112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6113"><a href="#cb237-6113" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The score of an optimal overlap alignment of&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>, followed by an alignment of a suffix&nbsp;<span class="op">*</span>v<span class="st">'*&nbsp;of&nbsp;*v*&nbsp;and a prefix&nbsp;*w'</span><span class="op">*</span>&nbsp;of&nbsp;<span class="op">*</span>w<span class="op">*</span>&nbsp;achieving this maximum score. Use an alignment score <span class="kw">in</span> which matches count <span class="op">+</span><span class="dv">1</span> <span class="kw">and</span> both the mismatch <span class="kw">and</span> indel penalties are <span class="fl">2.</span> (If multiple overlap alignments achieving the maximum score exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb237-6114"><a href="#cb237-6114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6115"><a href="#cb237-6115" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-6116"><a href="#cb237-6116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6117"><a href="#cb237-6117" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6118"><a href="#cb237-6118" aria-hidden="true" tabindex="-1"></a>PAWHEAE</span>
<span id="cb237-6119"><a href="#cb237-6119" aria-hidden="true" tabindex="-1"></a>HEAGAWGHEE</span>
<span id="cb237-6120"><a href="#cb237-6120" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6121"><a href="#cb237-6121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6122"><a href="#cb237-6122" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-6123"><a href="#cb237-6123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6124"><a href="#cb237-6124" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6125"><a href="#cb237-6125" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb237-6126"><a href="#cb237-6126" aria-hidden="true" tabindex="-1"></a>HEAE</span>
<span id="cb237-6127"><a href="#cb237-6127" aria-hidden="true" tabindex="-1"></a>HEAG</span>
<span id="cb237-6128"><a href="#cb237-6128" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6129"><a href="#cb237-6129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6130"><a href="#cb237-6130" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-6131"><a href="#cb237-6131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6132"><a href="#cb237-6132" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-6133"><a href="#cb237-6133" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple, Dict</span>
<span id="cb237-6134"><a href="#cb237-6134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6135"><a href="#cb237-6135" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_overlap_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, mismatch_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">2</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb237-6136"><a href="#cb237-6136" aria-hidden="true" tabindex="-1"></a>    score_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-6137"><a href="#cb237-6137" aria-hidden="true" tabindex="-1"></a>    path_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb237-6138"><a href="#cb237-6138" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6139"><a href="#cb237-6139" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-6140"><a href="#cb237-6140" aria-hidden="true" tabindex="-1"></a>        score_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> seq2_index <span class="op">*</span> mismatch_penalty</span>
<span id="cb237-6141"><a href="#cb237-6141" aria-hidden="true" tabindex="-1"></a>        path_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="st">"↑"</span></span>
<span id="cb237-6142"><a href="#cb237-6142" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-6143"><a href="#cb237-6143" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-6144"><a href="#cb237-6144" aria-hidden="true" tabindex="-1"></a>        path_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="st">"←"</span></span>
<span id="cb237-6145"><a href="#cb237-6145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6146"><a href="#cb237-6146" aria-hidden="true" tabindex="-1"></a>    score_matrix[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-6147"><a href="#cb237-6147" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2)):</span>
<span id="cb237-6148"><a href="#cb237-6148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1)):</span>
<span id="cb237-6149"><a href="#cb237-6149" aria-hidden="true" tabindex="-1"></a>            current_position <span class="op">=</span> (seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb237-6150"><a href="#cb237-6150" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> sequence1[seq1_index] <span class="op">==</span> sequence2[seq2_index] <span class="cf">else</span> mismatch_penalty</span>
<span id="cb237-6151"><a href="#cb237-6151" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb237-6152"><a href="#cb237-6152" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index] <span class="op">+</span> match_score,</span>
<span id="cb237-6153"><a href="#cb237-6153" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">+</span> mismatch_penalty,</span>
<span id="cb237-6154"><a href="#cb237-6154" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index] <span class="op">+</span> mismatch_penalty,</span>
<span id="cb237-6155"><a href="#cb237-6155" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb237-6156"><a href="#cb237-6156" aria-hidden="true" tabindex="-1"></a>            score_matrix[current_position] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb237-6157"><a href="#cb237-6157" aria-hidden="true" tabindex="-1"></a>            path_matrix[current_position] <span class="op">=</span> [<span class="st">"↖"</span>, <span class="st">"↑"</span>, <span class="st">"←"</span>][options.index(<span class="bu">max</span>(options))]</span>
<span id="cb237-6158"><a href="#cb237-6158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6159"><a href="#cb237-6159" aria-hidden="true" tabindex="-1"></a>    final_scores <span class="op">=</span> [score_matrix[seq2_index, <span class="bu">len</span>(sequence1)] <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb237-6160"><a href="#cb237-6160" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="bu">max</span>(final_scores)</span>
<span id="cb237-6161"><a href="#cb237-6161" aria-hidden="true" tabindex="-1"></a>    seq2_end_index <span class="op">=</span> final_scores.index(max_score)</span>
<span id="cb237-6162"><a href="#cb237-6162" aria-hidden="true" tabindex="-1"></a>    seq1_end_index <span class="op">=</span> <span class="bu">len</span>(sequence1)</span>
<span id="cb237-6163"><a href="#cb237-6163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6164"><a href="#cb237-6164" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb237-6165"><a href="#cb237-6165" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> seq1_end_index <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> seq2_end_index <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb237-6166"><a href="#cb237-6166" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↖"</span>:</span>
<span id="cb237-6167"><a href="#cb237-6167" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb237-6168"><a href="#cb237-6168" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb237-6169"><a href="#cb237-6169" aria-hidden="true" tabindex="-1"></a>            seq2_end_index, seq1_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span>, seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb237-6170"><a href="#cb237-6170" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"←"</span>:</span>
<span id="cb237-6171"><a href="#cb237-6171" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb237-6172"><a href="#cb237-6172" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb237-6173"><a href="#cb237-6173" aria-hidden="true" tabindex="-1"></a>            seq1_end_index <span class="op">=</span> seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb237-6174"><a href="#cb237-6174" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↑"</span>:</span>
<span id="cb237-6175"><a href="#cb237-6175" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb237-6176"><a href="#cb237-6176" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb237-6177"><a href="#cb237-6177" aria-hidden="true" tabindex="-1"></a>            seq2_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb237-6178"><a href="#cb237-6178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6179"><a href="#cb237-6179" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1[::<span class="op">-</span><span class="dv">1</span>], aligned_seq2[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb237-6180"><a href="#cb237-6180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6181"><a href="#cb237-6181" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-6182"><a href="#cb237-6182" aria-hidden="true" tabindex="-1"></a><span class="st">PAWHEAE</span></span>
<span id="cb237-6183"><a href="#cb237-6183" aria-hidden="true" tabindex="-1"></a><span class="st">HEAGAWGHEE</span></span>
<span id="cb237-6184"><a href="#cb237-6184" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-6185"><a href="#cb237-6185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6186"><a href="#cb237-6186" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-6187"><a href="#cb237-6187" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>calculate_overlap_alignment(sequence1, sequence2), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-6188"><a href="#cb237-6188" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6189"><a href="#cb237-6189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6190"><a href="#cb237-6190" aria-hidden="true" tabindex="-1"></a><span class="co"># Align Two Strings Using Affine Gap Penalties</span></span>
<span id="cb237-6191"><a href="#cb237-6191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6192"><a href="#cb237-6192" aria-hidden="true" tabindex="-1"></a>Alignment <span class="cf">with</span> Affine Gap Penalties Problem. Construct a highest<span class="op">-</span>scoring <span class="kw">global</span> alignment of two strings (<span class="cf">with</span> affine gap penalties).</span>
<span id="cb237-6193"><a href="#cb237-6193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6194"><a href="#cb237-6194" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two amino acid strings&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>&nbsp;(each of length at most <span class="dv">100</span>).</span>
<span id="cb237-6195"><a href="#cb237-6195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6196"><a href="#cb237-6196" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The maximum alignment score between&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>, followed by an alignment of&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>&nbsp;achieving this maximum score. Use the&nbsp;[BLOSUM62](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>blosum62<span class="op">/</span>)&nbsp;scoring matrix, a gap opening penalty of <span class="dv">11</span>, <span class="kw">and</span> a gap extension penalty of <span class="fl">1.</span></span>
<span id="cb237-6197"><a href="#cb237-6197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6198"><a href="#cb237-6198" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-6199"><a href="#cb237-6199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6200"><a href="#cb237-6200" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6201"><a href="#cb237-6201" aria-hidden="true" tabindex="-1"></a>PRTEINS</span>
<span id="cb237-6202"><a href="#cb237-6202" aria-hidden="true" tabindex="-1"></a>PRTWPSEIN</span>
<span id="cb237-6203"><a href="#cb237-6203" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6204"><a href="#cb237-6204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6205"><a href="#cb237-6205" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-6206"><a href="#cb237-6206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6207"><a href="#cb237-6207" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6208"><a href="#cb237-6208" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span></span>
<span id="cb237-6209"><a href="#cb237-6209" aria-hidden="true" tabindex="-1"></a>PRT<span class="op">---</span>EINS</span>
<span id="cb237-6210"><a href="#cb237-6210" aria-hidden="true" tabindex="-1"></a>PRTWPSEIN<span class="op">-</span></span>
<span id="cb237-6211"><a href="#cb237-6211" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6212"><a href="#cb237-6212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6213"><a href="#cb237-6213" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-6214"><a href="#cb237-6214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6215"><a href="#cb237-6215" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-6216"><a href="#cb237-6216" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List, Optional</span>
<span id="cb237-6217"><a href="#cb237-6217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6218"><a href="#cb237-6218" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb237-6219"><a href="#cb237-6219" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6220"><a href="#cb237-6220" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6221"><a href="#cb237-6221" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6222"><a href="#cb237-6222" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6223"><a href="#cb237-6223" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6224"><a href="#cb237-6224" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb237-6225"><a href="#cb237-6225" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb237-6226"><a href="#cb237-6226" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6227"><a href="#cb237-6227" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6228"><a href="#cb237-6228" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6229"><a href="#cb237-6229" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6230"><a href="#cb237-6230" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6231"><a href="#cb237-6231" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6232"><a href="#cb237-6232" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6233"><a href="#cb237-6233" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6234"><a href="#cb237-6234" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6235"><a href="#cb237-6235" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6236"><a href="#cb237-6236" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6237"><a href="#cb237-6237" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb237-6238"><a href="#cb237-6238" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6239"><a href="#cb237-6239" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6240"><a href="#cb237-6240" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6241"><a href="#cb237-6241" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6242"><a href="#cb237-6242" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6243"><a href="#cb237-6243" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6244"><a href="#cb237-6244" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6245"><a href="#cb237-6245" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6246"><a href="#cb237-6246" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6247"><a href="#cb237-6247" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6248"><a href="#cb237-6248" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb237-6249"><a href="#cb237-6249" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6250"><a href="#cb237-6250" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6251"><a href="#cb237-6251" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6252"><a href="#cb237-6252" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6253"><a href="#cb237-6253" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6254"><a href="#cb237-6254" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6255"><a href="#cb237-6255" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb237-6256"><a href="#cb237-6256" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb237-6257"><a href="#cb237-6257" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb237-6258"><a href="#cb237-6258" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb237-6259"><a href="#cb237-6259" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6260"><a href="#cb237-6260" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb237-6261"><a href="#cb237-6261" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6262"><a href="#cb237-6262" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6263"><a href="#cb237-6263" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6264"><a href="#cb237-6264" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6265"><a href="#cb237-6265" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6266"><a href="#cb237-6266" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb237-6267"><a href="#cb237-6267" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6268"><a href="#cb237-6268" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6269"><a href="#cb237-6269" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6270"><a href="#cb237-6270" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6271"><a href="#cb237-6271" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6272"><a href="#cb237-6272" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6273"><a href="#cb237-6273" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb237-6274"><a href="#cb237-6274" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6275"><a href="#cb237-6275" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb237-6276"><a href="#cb237-6276" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb237-6277"><a href="#cb237-6277" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6278"><a href="#cb237-6278" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6279"><a href="#cb237-6279" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6280"><a href="#cb237-6280" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6281"><a href="#cb237-6281" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6282"><a href="#cb237-6282" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6283"><a href="#cb237-6283" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6284"><a href="#cb237-6284" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6285"><a href="#cb237-6285" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb237-6286"><a href="#cb237-6286" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6287"><a href="#cb237-6287" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb237-6288"><a href="#cb237-6288" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb237-6289"><a href="#cb237-6289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6290"><a href="#cb237-6290" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> insert_gap(sequence: <span class="bu">str</span>, position: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-6291"><a href="#cb237-6291" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Insert a gap ('-') into the sequence at the specified position."""</span></span>
<span id="cb237-6292"><a href="#cb237-6292" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[:position] <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> sequence[position:]</span>
<span id="cb237-6293"><a href="#cb237-6293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6294"><a href="#cb237-6294" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> global_alignment_affine(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>, gap_open_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">11</span>, gap_extend_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb237-6295"><a href="#cb237-6295" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="cb237-6296"><a href="#cb237-6296" aria-hidden="true" tabindex="-1"></a><span class="st">    Perform global sequence alignment with affine gap penalty.</span></span>
<span id="cb237-6297"><a href="#cb237-6297" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb237-6298"><a href="#cb237-6298" aria-hidden="true" tabindex="-1"></a><span class="st">    Args:</span></span>
<span id="cb237-6299"><a href="#cb237-6299" aria-hidden="true" tabindex="-1"></a><span class="st">    seq1 (str): First sequence to align</span></span>
<span id="cb237-6300"><a href="#cb237-6300" aria-hidden="true" tabindex="-1"></a><span class="st">    seq2 (str): Second sequence to align</span></span>
<span id="cb237-6301"><a href="#cb237-6301" aria-hidden="true" tabindex="-1"></a><span class="st">    gap_open_penalty (int): Penalty for opening a gap</span></span>
<span id="cb237-6302"><a href="#cb237-6302" aria-hidden="true" tabindex="-1"></a><span class="st">    gap_extend_penalty (int): Penalty for extending a gap</span></span>
<span id="cb237-6303"><a href="#cb237-6303" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb237-6304"><a href="#cb237-6304" aria-hidden="true" tabindex="-1"></a><span class="st">    Returns:</span></span>
<span id="cb237-6305"><a href="#cb237-6305" aria-hidden="true" tabindex="-1"></a><span class="st">    Tuple[int, str, str]: Alignment score and aligned sequences</span></span>
<span id="cb237-6306"><a href="#cb237-6306" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb237-6307"><a href="#cb237-6307" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> BLOSUM62</span>
<span id="cb237-6308"><a href="#cb237-6308" aria-hidden="true" tabindex="-1"></a>    match_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-6309"><a href="#cb237-6309" aria-hidden="true" tabindex="-1"></a>    gap_seq1_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-6310"><a href="#cb237-6310" aria-hidden="true" tabindex="-1"></a>    gap_seq2_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-6311"><a href="#cb237-6311" aria-hidden="true" tabindex="-1"></a>    prev_match: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-6312"><a href="#cb237-6312" aria-hidden="true" tabindex="-1"></a>    prev_gap_seq1: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-6313"><a href="#cb237-6313" aria-hidden="true" tabindex="-1"></a>    prev_gap_seq2: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-6314"><a href="#cb237-6314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6315"><a href="#cb237-6315" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize matrices</span></span>
<span id="cb237-6316"><a href="#cb237-6316" aria-hidden="true" tabindex="-1"></a>    gap_seq1_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> match_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> gap_seq2_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-6317"><a href="#cb237-6317" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-6318"><a href="#cb237-6318" aria-hidden="true" tabindex="-1"></a>        gap_seq1_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (i <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb237-6319"><a href="#cb237-6319" aria-hidden="true" tabindex="-1"></a>        match_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (i <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb237-6320"><a href="#cb237-6320" aria-hidden="true" tabindex="-1"></a>        gap_seq2_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">*</span> <span class="dv">10</span>  <span class="co"># Large penalty to avoid this case</span></span>
<span id="cb237-6321"><a href="#cb237-6321" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-6322"><a href="#cb237-6322" aria-hidden="true" tabindex="-1"></a>        gap_seq2_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (j <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb237-6323"><a href="#cb237-6323" aria-hidden="true" tabindex="-1"></a>        match_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (j <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb237-6324"><a href="#cb237-6324" aria-hidden="true" tabindex="-1"></a>        gap_seq1_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">*</span> <span class="dv">10</span>  <span class="co"># Large penalty to avoid this case</span></span>
<span id="cb237-6325"><a href="#cb237-6325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6326"><a href="#cb237-6326" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill matrices</span></span>
<span id="cb237-6327"><a href="#cb237-6327" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-6328"><a href="#cb237-6328" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-6329"><a href="#cb237-6329" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate scores for gap in seq1</span></span>
<span id="cb237-6330"><a href="#cb237-6330" aria-hidden="true" tabindex="-1"></a>            gap_seq1_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb237-6331"><a href="#cb237-6331" aria-hidden="true" tabindex="-1"></a>                gap_seq1_score[i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">+</span> gap_extend_penalty,</span>
<span id="cb237-6332"><a href="#cb237-6332" aria-hidden="true" tabindex="-1"></a>                match_score[i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">+</span> gap_open_penalty</span>
<span id="cb237-6333"><a href="#cb237-6333" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb237-6334"><a href="#cb237-6334" aria-hidden="true" tabindex="-1"></a>            gap_seq1_score[i, j] <span class="op">=</span> <span class="bu">max</span>(gap_seq1_options)</span>
<span id="cb237-6335"><a href="#cb237-6335" aria-hidden="true" tabindex="-1"></a>            prev_gap_seq1[i, j] <span class="op">=</span> gap_seq1_options.index(gap_seq1_score[i, j])</span>
<span id="cb237-6336"><a href="#cb237-6336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6337"><a href="#cb237-6337" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate scores for gap in seq2</span></span>
<span id="cb237-6338"><a href="#cb237-6338" aria-hidden="true" tabindex="-1"></a>            gap_seq2_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb237-6339"><a href="#cb237-6339" aria-hidden="true" tabindex="-1"></a>                gap_seq2_score[i, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_extend_penalty,</span>
<span id="cb237-6340"><a href="#cb237-6340" aria-hidden="true" tabindex="-1"></a>                match_score[i, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_open_penalty</span>
<span id="cb237-6341"><a href="#cb237-6341" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb237-6342"><a href="#cb237-6342" aria-hidden="true" tabindex="-1"></a>            gap_seq2_score[i, j] <span class="op">=</span> <span class="bu">max</span>(gap_seq2_options)</span>
<span id="cb237-6343"><a href="#cb237-6343" aria-hidden="true" tabindex="-1"></a>            prev_gap_seq2[i, j] <span class="op">=</span> gap_seq2_options.index(gap_seq2_score[i, j])</span>
<span id="cb237-6344"><a href="#cb237-6344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6345"><a href="#cb237-6345" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate match/mismatch score</span></span>
<span id="cb237-6346"><a href="#cb237-6346" aria-hidden="true" tabindex="-1"></a>            blosum_score: <span class="bu">int</span> <span class="op">=</span> scoring_matrix.get((seq1[i<span class="op">-</span><span class="dv">1</span>], seq2[j<span class="op">-</span><span class="dv">1</span>]), scoring_matrix.get((seq2[j<span class="op">-</span><span class="dv">1</span>], seq1[i<span class="op">-</span><span class="dv">1</span>]), <span class="dv">0</span>))</span>
<span id="cb237-6347"><a href="#cb237-6347" aria-hidden="true" tabindex="-1"></a>            match_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb237-6348"><a href="#cb237-6348" aria-hidden="true" tabindex="-1"></a>                gap_seq1_score[i, j],</span>
<span id="cb237-6349"><a href="#cb237-6349" aria-hidden="true" tabindex="-1"></a>                match_score[i <span class="op">-</span> <span class="dv">1</span>, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> blosum_score,</span>
<span id="cb237-6350"><a href="#cb237-6350" aria-hidden="true" tabindex="-1"></a>                gap_seq2_score[i, j]</span>
<span id="cb237-6351"><a href="#cb237-6351" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb237-6352"><a href="#cb237-6352" aria-hidden="true" tabindex="-1"></a>            match_score[i, j] <span class="op">=</span> <span class="bu">max</span>(match_options)</span>
<span id="cb237-6353"><a href="#cb237-6353" aria-hidden="true" tabindex="-1"></a>            prev_match[i, j] <span class="op">=</span> match_options.index(match_score[i, j])</span>
<span id="cb237-6354"><a href="#cb237-6354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6355"><a href="#cb237-6355" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback</span></span>
<span id="cb237-6356"><a href="#cb237-6356" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="bu">len</span>(seq1), <span class="bu">len</span>(seq2)</span>
<span id="cb237-6357"><a href="#cb237-6357" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> seq1, seq2</span>
<span id="cb237-6358"><a href="#cb237-6358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6359"><a href="#cb237-6359" aria-hidden="true" tabindex="-1"></a>    scores: List[<span class="bu">int</span>] <span class="op">=</span> [gap_seq1_score[i, j], match_score[i, j], gap_seq2_score[i, j]]</span>
<span id="cb237-6360"><a href="#cb237-6360" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">int</span> <span class="op">=</span> <span class="bu">max</span>(scores)</span>
<span id="cb237-6361"><a href="#cb237-6361" aria-hidden="true" tabindex="-1"></a>    current_matrix: <span class="bu">int</span> <span class="op">=</span> scores.index(max_score)</span>
<span id="cb237-6362"><a href="#cb237-6362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6363"><a href="#cb237-6363" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">*</span> j <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb237-6364"><a href="#cb237-6364" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_matrix <span class="op">==</span> <span class="dv">0</span>:  <span class="co"># In gap_seq1_score matrix</span></span>
<span id="cb237-6365"><a href="#cb237-6365" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_gap_seq1[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb237-6366"><a href="#cb237-6366" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb237-6367"><a href="#cb237-6367" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-6368"><a href="#cb237-6368" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> insert_gap(aligned_seq2, j)</span>
<span id="cb237-6369"><a href="#cb237-6369" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> current_matrix <span class="op">==</span> <span class="dv">1</span>:  <span class="co"># In match_score matrix</span></span>
<span id="cb237-6370"><a href="#cb237-6370" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_match[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb237-6371"><a href="#cb237-6371" aria-hidden="true" tabindex="-1"></a>                i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-6372"><a href="#cb237-6372" aria-hidden="true" tabindex="-1"></a>                j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-6373"><a href="#cb237-6373" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb237-6374"><a href="#cb237-6374" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> prev_match[i, j]</span>
<span id="cb237-6375"><a href="#cb237-6375" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:  <span class="co"># In gap_seq2_score matrix</span></span>
<span id="cb237-6376"><a href="#cb237-6376" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_gap_seq2[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb237-6377"><a href="#cb237-6377" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb237-6378"><a href="#cb237-6378" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-6379"><a href="#cb237-6379" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> insert_gap(aligned_seq1, i)</span>
<span id="cb237-6380"><a href="#cb237-6380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6381"><a href="#cb237-6381" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle remaining overhangs</span></span>
<span id="cb237-6382"><a href="#cb237-6382" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb237-6383"><a href="#cb237-6383" aria-hidden="true" tabindex="-1"></a>        aligned_seq2 <span class="op">=</span> insert_gap(aligned_seq2, <span class="dv">0</span>)</span>
<span id="cb237-6384"><a href="#cb237-6384" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-6385"><a href="#cb237-6385" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> j <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb237-6386"><a href="#cb237-6386" aria-hidden="true" tabindex="-1"></a>        aligned_seq1 <span class="op">=</span> insert_gap(aligned_seq1, <span class="dv">0</span>)</span>
<span id="cb237-6387"><a href="#cb237-6387" aria-hidden="true" tabindex="-1"></a>        j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb237-6388"><a href="#cb237-6388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6389"><a href="#cb237-6389" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1, aligned_seq2</span>
<span id="cb237-6390"><a href="#cb237-6390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6391"><a href="#cb237-6391" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb237-6392"><a href="#cb237-6392" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-6393"><a href="#cb237-6393" aria-hidden="true" tabindex="-1"></a><span class="st">PRTEINS</span></span>
<span id="cb237-6394"><a href="#cb237-6394" aria-hidden="true" tabindex="-1"></a><span class="st">PRTWPSEIN</span></span>
<span id="cb237-6395"><a href="#cb237-6395" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-6396"><a href="#cb237-6396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6397"><a href="#cb237-6397" aria-hidden="true" tabindex="-1"></a>seq1, seq2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-6398"><a href="#cb237-6398" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_seq1, aligned_seq2 <span class="op">=</span> global_alignment_affine(seq1, seq2)</span>
<span id="cb237-6399"><a href="#cb237-6399" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score, aligned_seq1, aligned_seq2, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-6400"><a href="#cb237-6400" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6401"><a href="#cb237-6401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6402"><a href="#cb237-6402" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Middle Edge in an Alignment Graph in Linear Space</span></span>
<span id="cb237-6403"><a href="#cb237-6403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6404"><a href="#cb237-6404" aria-hidden="true" tabindex="-1"></a>Middle Edge <span class="kw">in</span> Linear Space Problem. Find a middle edge <span class="kw">in</span> the alignment graph <span class="kw">in</span> linear space.</span>
<span id="cb237-6405"><a href="#cb237-6405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6406"><a href="#cb237-6406" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;[amino acid strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>).</span>
<span id="cb237-6407"><a href="#cb237-6407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6408"><a href="#cb237-6408" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A middle edge <span class="kw">in</span> the alignment graph of these strings, where the optimal path <span class="kw">is</span> defined by the&nbsp;[BLOSUM62](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>blosum62<span class="op">/</span>)&nbsp;scoring matrix <span class="kw">and</span> a linear indel penalty equal to <span class="fl">5.</span> Return the middle edge <span class="kw">in</span> the form<span class="st">"(*i*,&nbsp;*j*) (*k*,&nbsp;*l*)"</span>, where (<span class="op">*</span>i<span class="op">*</span>,&nbsp;<span class="op">*</span>j<span class="op">*</span>) connects to (<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>l<span class="op">*</span>).</span>
<span id="cb237-6409"><a href="#cb237-6409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6410"><a href="#cb237-6410" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-6411"><a href="#cb237-6411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6412"><a href="#cb237-6412" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6413"><a href="#cb237-6413" aria-hidden="true" tabindex="-1"></a>PLEASANTLY</span>
<span id="cb237-6414"><a href="#cb237-6414" aria-hidden="true" tabindex="-1"></a>MEASNLY</span>
<span id="cb237-6415"><a href="#cb237-6415" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6416"><a href="#cb237-6416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6417"><a href="#cb237-6417" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-6418"><a href="#cb237-6418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6419"><a href="#cb237-6419" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6420"><a href="#cb237-6420" aria-hidden="true" tabindex="-1"></a>(<span class="dv">4</span>, <span class="dv">3</span>) (<span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb237-6421"><a href="#cb237-6421" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6422"><a href="#cb237-6422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6423"><a href="#cb237-6423" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-6424"><a href="#cb237-6424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6425"><a href="#cb237-6425" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-6426"><a href="#cb237-6426" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> floor</span>
<span id="cb237-6427"><a href="#cb237-6427" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb237-6428"><a href="#cb237-6428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6429"><a href="#cb237-6429" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb237-6430"><a href="#cb237-6430" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6431"><a href="#cb237-6431" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6432"><a href="#cb237-6432" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6433"><a href="#cb237-6433" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6434"><a href="#cb237-6434" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6435"><a href="#cb237-6435" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb237-6436"><a href="#cb237-6436" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb237-6437"><a href="#cb237-6437" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6438"><a href="#cb237-6438" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6439"><a href="#cb237-6439" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6440"><a href="#cb237-6440" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6441"><a href="#cb237-6441" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6442"><a href="#cb237-6442" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6443"><a href="#cb237-6443" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6444"><a href="#cb237-6444" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6445"><a href="#cb237-6445" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6446"><a href="#cb237-6446" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6447"><a href="#cb237-6447" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6448"><a href="#cb237-6448" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb237-6449"><a href="#cb237-6449" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6450"><a href="#cb237-6450" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6451"><a href="#cb237-6451" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6452"><a href="#cb237-6452" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6453"><a href="#cb237-6453" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6454"><a href="#cb237-6454" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6455"><a href="#cb237-6455" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6456"><a href="#cb237-6456" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6457"><a href="#cb237-6457" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6458"><a href="#cb237-6458" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6459"><a href="#cb237-6459" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb237-6460"><a href="#cb237-6460" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6461"><a href="#cb237-6461" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6462"><a href="#cb237-6462" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6463"><a href="#cb237-6463" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6464"><a href="#cb237-6464" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6465"><a href="#cb237-6465" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6466"><a href="#cb237-6466" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb237-6467"><a href="#cb237-6467" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb237-6468"><a href="#cb237-6468" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb237-6469"><a href="#cb237-6469" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb237-6470"><a href="#cb237-6470" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6471"><a href="#cb237-6471" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb237-6472"><a href="#cb237-6472" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6473"><a href="#cb237-6473" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6474"><a href="#cb237-6474" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6475"><a href="#cb237-6475" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6476"><a href="#cb237-6476" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6477"><a href="#cb237-6477" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb237-6478"><a href="#cb237-6478" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6479"><a href="#cb237-6479" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6480"><a href="#cb237-6480" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6481"><a href="#cb237-6481" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6482"><a href="#cb237-6482" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6483"><a href="#cb237-6483" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6484"><a href="#cb237-6484" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb237-6485"><a href="#cb237-6485" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6486"><a href="#cb237-6486" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb237-6487"><a href="#cb237-6487" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb237-6488"><a href="#cb237-6488" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6489"><a href="#cb237-6489" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6490"><a href="#cb237-6490" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6491"><a href="#cb237-6491" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6492"><a href="#cb237-6492" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6493"><a href="#cb237-6493" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6494"><a href="#cb237-6494" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6495"><a href="#cb237-6495" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6496"><a href="#cb237-6496" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb237-6497"><a href="#cb237-6497" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6498"><a href="#cb237-6498" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb237-6499"><a href="#cb237-6499" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb237-6500"><a href="#cb237-6500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6501"><a href="#cb237-6501" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_scores(</span>
<span id="cb237-6502"><a href="#cb237-6502" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb237-6503"><a href="#cb237-6503" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb237-6504"><a href="#cb237-6504" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb237-6505"><a href="#cb237-6505" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb237-6506"><a href="#cb237-6506" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], List[<span class="bu">int</span>]]:</span>
<span id="cb237-6507"><a href="#cb237-6507" aria-hidden="true" tabindex="-1"></a>    current_scores <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> gap_penalty, gap_penalty))</span>
<span id="cb237-6508"><a href="#cb237-6508" aria-hidden="true" tabindex="-1"></a>    backtrack <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb237-6509"><a href="#cb237-6509" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6510"><a href="#cb237-6510" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-6511"><a href="#cb237-6511" aria-hidden="true" tabindex="-1"></a>        previous_scores <span class="op">=</span> current_scores[:]</span>
<span id="cb237-6512"><a href="#cb237-6512" aria-hidden="true" tabindex="-1"></a>        current_scores[<span class="dv">0</span>] <span class="op">=</span> previous_scores[<span class="dv">0</span>] <span class="op">+</span> gap_penalty</span>
<span id="cb237-6513"><a href="#cb237-6513" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-6514"><a href="#cb237-6514" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb237-6515"><a href="#cb237-6515" aria-hidden="true" tabindex="-1"></a>                previous_scores[i] <span class="op">+</span> gap_penalty,</span>
<span id="cb237-6516"><a href="#cb237-6516" aria-hidden="true" tabindex="-1"></a>                current_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_penalty,</span>
<span id="cb237-6517"><a href="#cb237-6517" aria-hidden="true" tabindex="-1"></a>                previous_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> scoring_matrix.get(</span>
<span id="cb237-6518"><a href="#cb237-6518" aria-hidden="true" tabindex="-1"></a>                    (sequence1[i <span class="op">-</span> <span class="dv">1</span>], sequence2[j <span class="op">-</span> <span class="dv">1</span>]),</span>
<span id="cb237-6519"><a href="#cb237-6519" aria-hidden="true" tabindex="-1"></a>                    scoring_matrix.get((sequence2[j <span class="op">-</span> <span class="dv">1</span>], sequence1[i <span class="op">-</span> <span class="dv">1</span>]), <span class="dv">0</span>)</span>
<span id="cb237-6520"><a href="#cb237-6520" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb237-6521"><a href="#cb237-6521" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb237-6522"><a href="#cb237-6522" aria-hidden="true" tabindex="-1"></a>            current_scores[i] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb237-6523"><a href="#cb237-6523" aria-hidden="true" tabindex="-1"></a>            backtrack[i] <span class="op">=</span> options.index(current_scores[i])</span>
<span id="cb237-6524"><a href="#cb237-6524" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6525"><a href="#cb237-6525" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> current_scores, backtrack</span>
<span id="cb237-6526"><a href="#cb237-6526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6527"><a href="#cb237-6527" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_middle_edge(</span>
<span id="cb237-6528"><a href="#cb237-6528" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb237-6529"><a href="#cb237-6529" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb237-6530"><a href="#cb237-6530" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb237-6531"><a href="#cb237-6531" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb237-6532"><a href="#cb237-6532" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb237-6533"><a href="#cb237-6533" aria-hidden="true" tabindex="-1"></a>    midpoint <span class="op">=</span> floor(<span class="bu">len</span>(sequence2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb237-6534"><a href="#cb237-6534" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6535"><a href="#cb237-6535" aria-hidden="true" tabindex="-1"></a>    forward_scores, _ <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb237-6536"><a href="#cb237-6536" aria-hidden="true" tabindex="-1"></a>        sequence1, sequence2[:midpoint], scoring_matrix, gap_penalty</span>
<span id="cb237-6537"><a href="#cb237-6537" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb237-6538"><a href="#cb237-6538" aria-hidden="true" tabindex="-1"></a>    reverse_scores, reverse_backtrack <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb237-6539"><a href="#cb237-6539" aria-hidden="true" tabindex="-1"></a>        sequence1[::<span class="op">-</span><span class="dv">1</span>], sequence2[midpoint:][::<span class="op">-</span><span class="dv">1</span>], scoring_matrix, gap_penalty</span>
<span id="cb237-6540"><a href="#cb237-6540" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb237-6541"><a href="#cb237-6541" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6542"><a href="#cb237-6542" aria-hidden="true" tabindex="-1"></a>    total_scores <span class="op">=</span> [f <span class="op">+</span> r <span class="cf">for</span> f, r <span class="kw">in</span> <span class="bu">zip</span>(forward_scores, reverse_scores[::<span class="op">-</span><span class="dv">1</span>])]</span>
<span id="cb237-6543"><a href="#cb237-6543" aria-hidden="true" tabindex="-1"></a>    best_score_index <span class="op">=</span> total_scores.index(<span class="bu">max</span>(total_scores))</span>
<span id="cb237-6544"><a href="#cb237-6544" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6545"><a href="#cb237-6545" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> (best_score_index, midpoint)</span>
<span id="cb237-6546"><a href="#cb237-6546" aria-hidden="true" tabindex="-1"></a>    possible_moves <span class="op">=</span> [</span>
<span id="cb237-6547"><a href="#cb237-6547" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>], start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb237-6548"><a href="#cb237-6548" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>]),</span>
<span id="cb237-6549"><a href="#cb237-6549" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb237-6550"><a href="#cb237-6550" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb237-6551"><a href="#cb237-6551" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> possible_moves[reverse_backtrack[::<span class="op">-</span><span class="dv">1</span>][best_score_index]]</span>
<span id="cb237-6552"><a href="#cb237-6552" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6553"><a href="#cb237-6553" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (start_node, end_node)</span>
<span id="cb237-6554"><a href="#cb237-6554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6555"><a href="#cb237-6555" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb237-6556"><a href="#cb237-6556" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-6557"><a href="#cb237-6557" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb237-6558"><a href="#cb237-6558" aria-hidden="true" tabindex="-1"></a><span class="st">MEASNLY</span></span>
<span id="cb237-6559"><a href="#cb237-6559" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-6560"><a href="#cb237-6560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6561"><a href="#cb237-6561" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-6562"><a href="#cb237-6562" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_middle_edge(sequence1, sequence2, BLOSUM62, <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb237-6563"><a href="#cb237-6563" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb237-6564"><a href="#cb237-6564" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6565"><a href="#cb237-6565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6566"><a href="#cb237-6566" aria-hidden="true" tabindex="-1"></a><span class="co"># Align Two Strings Using Linear Space</span></span>
<span id="cb237-6567"><a href="#cb237-6567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6568"><a href="#cb237-6568" aria-hidden="true" tabindex="-1"></a>Global Alignment <span class="kw">in</span> Linear Space Problem. Find the highest<span class="op">-</span>scoring alignment between two strings using a scoring matrix <span class="kw">in</span> linear space.</span>
<span id="cb237-6569"><a href="#cb237-6569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6570"><a href="#cb237-6570" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;<span class="op">**</span><span class="bu">long</span><span class="op">**</span>&nbsp;[amino acid strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>)&nbsp;(of length approximately <span class="dv">10</span>,<span class="dv">000</span>).</span>
<span id="cb237-6571"><a href="#cb237-6571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6572"><a href="#cb237-6572" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The maximum alignment score of these strings, followed by an alignment achieving this maximum score. Use the&nbsp;[BLOSUM62](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>blosum62<span class="op">/</span>)&nbsp;scoring matrix <span class="kw">and</span> indel penalty σ <span class="op">=</span> <span class="fl">5.</span></span>
<span id="cb237-6573"><a href="#cb237-6573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6574"><a href="#cb237-6574" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-6575"><a href="#cb237-6575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6576"><a href="#cb237-6576" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6577"><a href="#cb237-6577" aria-hidden="true" tabindex="-1"></a>PLEASANTLY</span>
<span id="cb237-6578"><a href="#cb237-6578" aria-hidden="true" tabindex="-1"></a>MEANLY</span>
<span id="cb237-6579"><a href="#cb237-6579" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6580"><a href="#cb237-6580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6581"><a href="#cb237-6581" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-6582"><a href="#cb237-6582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6583"><a href="#cb237-6583" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6584"><a href="#cb237-6584" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span></span>
<span id="cb237-6585"><a href="#cb237-6585" aria-hidden="true" tabindex="-1"></a>PLEASANTLY</span>
<span id="cb237-6586"><a href="#cb237-6586" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>MEA<span class="op">--</span>N<span class="op">-</span>LY</span>
<span id="cb237-6587"><a href="#cb237-6587" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6588"><a href="#cb237-6588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6589"><a href="#cb237-6589" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-6590"><a href="#cb237-6590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6591"><a href="#cb237-6591" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-6592"><a href="#cb237-6592" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> floor</span>
<span id="cb237-6593"><a href="#cb237-6593" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb237-6594"><a href="#cb237-6594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6595"><a href="#cb237-6595" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb237-6596"><a href="#cb237-6596" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6597"><a href="#cb237-6597" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6598"><a href="#cb237-6598" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6599"><a href="#cb237-6599" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6600"><a href="#cb237-6600" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6601"><a href="#cb237-6601" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb237-6602"><a href="#cb237-6602" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb237-6603"><a href="#cb237-6603" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6604"><a href="#cb237-6604" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6605"><a href="#cb237-6605" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6606"><a href="#cb237-6606" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6607"><a href="#cb237-6607" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6608"><a href="#cb237-6608" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6609"><a href="#cb237-6609" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6610"><a href="#cb237-6610" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6611"><a href="#cb237-6611" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6612"><a href="#cb237-6612" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6613"><a href="#cb237-6613" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6614"><a href="#cb237-6614" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb237-6615"><a href="#cb237-6615" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6616"><a href="#cb237-6616" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6617"><a href="#cb237-6617" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6618"><a href="#cb237-6618" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6619"><a href="#cb237-6619" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6620"><a href="#cb237-6620" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6621"><a href="#cb237-6621" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6622"><a href="#cb237-6622" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6623"><a href="#cb237-6623" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6624"><a href="#cb237-6624" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6625"><a href="#cb237-6625" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb237-6626"><a href="#cb237-6626" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6627"><a href="#cb237-6627" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6628"><a href="#cb237-6628" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6629"><a href="#cb237-6629" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6630"><a href="#cb237-6630" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6631"><a href="#cb237-6631" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6632"><a href="#cb237-6632" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb237-6633"><a href="#cb237-6633" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb237-6634"><a href="#cb237-6634" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb237-6635"><a href="#cb237-6635" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb237-6636"><a href="#cb237-6636" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6637"><a href="#cb237-6637" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb237-6638"><a href="#cb237-6638" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6639"><a href="#cb237-6639" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6640"><a href="#cb237-6640" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6641"><a href="#cb237-6641" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6642"><a href="#cb237-6642" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6643"><a href="#cb237-6643" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb237-6644"><a href="#cb237-6644" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6645"><a href="#cb237-6645" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6646"><a href="#cb237-6646" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6647"><a href="#cb237-6647" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6648"><a href="#cb237-6648" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6649"><a href="#cb237-6649" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb237-6650"><a href="#cb237-6650" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb237-6651"><a href="#cb237-6651" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb237-6652"><a href="#cb237-6652" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb237-6653"><a href="#cb237-6653" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb237-6654"><a href="#cb237-6654" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6655"><a href="#cb237-6655" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6656"><a href="#cb237-6656" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6657"><a href="#cb237-6657" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6658"><a href="#cb237-6658" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb237-6659"><a href="#cb237-6659" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6660"><a href="#cb237-6660" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6661"><a href="#cb237-6661" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6662"><a href="#cb237-6662" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb237-6663"><a href="#cb237-6663" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb237-6664"><a href="#cb237-6664" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb237-6665"><a href="#cb237-6665" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb237-6666"><a href="#cb237-6666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6667"><a href="#cb237-6667" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_scores(</span>
<span id="cb237-6668"><a href="#cb237-6668" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb237-6669"><a href="#cb237-6669" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb237-6670"><a href="#cb237-6670" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb237-6671"><a href="#cb237-6671" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb237-6672"><a href="#cb237-6672" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], List[<span class="bu">int</span>]]:</span>
<span id="cb237-6673"><a href="#cb237-6673" aria-hidden="true" tabindex="-1"></a>    current_scores <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> gap_penalty, gap_penalty))</span>
<span id="cb237-6674"><a href="#cb237-6674" aria-hidden="true" tabindex="-1"></a>    backtrack <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb237-6675"><a href="#cb237-6675" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6676"><a href="#cb237-6676" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-6677"><a href="#cb237-6677" aria-hidden="true" tabindex="-1"></a>        previous_scores <span class="op">=</span> current_scores[:]</span>
<span id="cb237-6678"><a href="#cb237-6678" aria-hidden="true" tabindex="-1"></a>        current_scores[<span class="dv">0</span>] <span class="op">=</span> previous_scores[<span class="dv">0</span>] <span class="op">+</span> gap_penalty</span>
<span id="cb237-6679"><a href="#cb237-6679" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb237-6680"><a href="#cb237-6680" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb237-6681"><a href="#cb237-6681" aria-hidden="true" tabindex="-1"></a>                previous_scores[i] <span class="op">+</span> gap_penalty,</span>
<span id="cb237-6682"><a href="#cb237-6682" aria-hidden="true" tabindex="-1"></a>                current_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_penalty,</span>
<span id="cb237-6683"><a href="#cb237-6683" aria-hidden="true" tabindex="-1"></a>                previous_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> scoring_matrix.get(</span>
<span id="cb237-6684"><a href="#cb237-6684" aria-hidden="true" tabindex="-1"></a>                    (sequence1[i <span class="op">-</span> <span class="dv">1</span>], sequence2[j <span class="op">-</span> <span class="dv">1</span>]),</span>
<span id="cb237-6685"><a href="#cb237-6685" aria-hidden="true" tabindex="-1"></a>                    scoring_matrix.get((sequence2[j <span class="op">-</span> <span class="dv">1</span>], sequence1[i <span class="op">-</span> <span class="dv">1</span>]), <span class="dv">0</span>)</span>
<span id="cb237-6686"><a href="#cb237-6686" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb237-6687"><a href="#cb237-6687" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb237-6688"><a href="#cb237-6688" aria-hidden="true" tabindex="-1"></a>            current_scores[i] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb237-6689"><a href="#cb237-6689" aria-hidden="true" tabindex="-1"></a>            backtrack[i] <span class="op">=</span> options.index(current_scores[i])</span>
<span id="cb237-6690"><a href="#cb237-6690" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6691"><a href="#cb237-6691" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> current_scores, backtrack</span>
<span id="cb237-6692"><a href="#cb237-6692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6693"><a href="#cb237-6693" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_middle_edge(</span>
<span id="cb237-6694"><a href="#cb237-6694" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb237-6695"><a href="#cb237-6695" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb237-6696"><a href="#cb237-6696" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb237-6697"><a href="#cb237-6697" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb237-6698"><a href="#cb237-6698" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb237-6699"><a href="#cb237-6699" aria-hidden="true" tabindex="-1"></a>    midpoint <span class="op">=</span> floor(<span class="bu">len</span>(sequence2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb237-6700"><a href="#cb237-6700" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6701"><a href="#cb237-6701" aria-hidden="true" tabindex="-1"></a>    forward_scores, _ <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb237-6702"><a href="#cb237-6702" aria-hidden="true" tabindex="-1"></a>        sequence1, sequence2[:midpoint], scoring_matrix, gap_penalty</span>
<span id="cb237-6703"><a href="#cb237-6703" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb237-6704"><a href="#cb237-6704" aria-hidden="true" tabindex="-1"></a>    reverse_scores, reverse_backtrack <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb237-6705"><a href="#cb237-6705" aria-hidden="true" tabindex="-1"></a>        sequence1[::<span class="op">-</span><span class="dv">1</span>], sequence2[midpoint:][::<span class="op">-</span><span class="dv">1</span>], scoring_matrix, gap_penalty</span>
<span id="cb237-6706"><a href="#cb237-6706" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb237-6707"><a href="#cb237-6707" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6708"><a href="#cb237-6708" aria-hidden="true" tabindex="-1"></a>    total_scores <span class="op">=</span> [f <span class="op">+</span> r <span class="cf">for</span> f, r <span class="kw">in</span> <span class="bu">zip</span>(forward_scores, reverse_scores[::<span class="op">-</span><span class="dv">1</span>])]</span>
<span id="cb237-6709"><a href="#cb237-6709" aria-hidden="true" tabindex="-1"></a>    best_score_index <span class="op">=</span> total_scores.index(<span class="bu">max</span>(total_scores))</span>
<span id="cb237-6710"><a href="#cb237-6710" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6711"><a href="#cb237-6711" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> (best_score_index, midpoint)</span>
<span id="cb237-6712"><a href="#cb237-6712" aria-hidden="true" tabindex="-1"></a>    possible_moves <span class="op">=</span> [</span>
<span id="cb237-6713"><a href="#cb237-6713" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>], start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb237-6714"><a href="#cb237-6714" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>]),</span>
<span id="cb237-6715"><a href="#cb237-6715" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb237-6716"><a href="#cb237-6716" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb237-6717"><a href="#cb237-6717" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> possible_moves[reverse_backtrack[::<span class="op">-</span><span class="dv">1</span>][best_score_index]]</span>
<span id="cb237-6718"><a href="#cb237-6718" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6719"><a href="#cb237-6719" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (start_node, end_node)</span>
<span id="cb237-6720"><a href="#cb237-6720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6721"><a href="#cb237-6721" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_score(</span>
<span id="cb237-6722"><a href="#cb237-6722" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span>,</span>
<span id="cb237-6723"><a href="#cb237-6723" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span>,</span>
<span id="cb237-6724"><a href="#cb237-6724" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb237-6725"><a href="#cb237-6725" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb237-6726"><a href="#cb237-6726" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-6727"><a href="#cb237-6727" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb237-6728"><a href="#cb237-6728" aria-hidden="true" tabindex="-1"></a>        gap_penalty <span class="cf">if</span> aligned_seq1[i] <span class="op">==</span> <span class="st">"-"</span> <span class="kw">or</span> aligned_seq2[i] <span class="op">==</span> <span class="st">"-"</span> <span class="cf">else</span></span>
<span id="cb237-6729"><a href="#cb237-6729" aria-hidden="true" tabindex="-1"></a>        scoring_matrix.get((aligned_seq1[i], aligned_seq2[i]),</span>
<span id="cb237-6730"><a href="#cb237-6730" aria-hidden="true" tabindex="-1"></a>                           scoring_matrix.get((aligned_seq2[i], aligned_seq1[i]), <span class="dv">0</span>))</span>
<span id="cb237-6731"><a href="#cb237-6731" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(aligned_seq1))</span>
<span id="cb237-6732"><a href="#cb237-6732" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb237-6733"><a href="#cb237-6733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6734"><a href="#cb237-6734" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_alignment_path(</span>
<span id="cb237-6735"><a href="#cb237-6735" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb237-6736"><a href="#cb237-6736" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb237-6737"><a href="#cb237-6737" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb237-6738"><a href="#cb237-6738" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb237-6739"><a href="#cb237-6739" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-6740"><a href="#cb237-6740" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> linear_space_alignment(top: <span class="bu">int</span>, bottom: <span class="bu">int</span>, left: <span class="bu">int</span>, right: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-6741"><a href="#cb237-6741" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> left <span class="op">==</span> right:</span>
<span id="cb237-6742"><a href="#cb237-6742" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"↓"</span> <span class="op">*</span> (bottom <span class="op">-</span> top)</span>
<span id="cb237-6743"><a href="#cb237-6743" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> top <span class="op">==</span> bottom:</span>
<span id="cb237-6744"><a href="#cb237-6744" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"→"</span> <span class="op">*</span> (right <span class="op">-</span> left)</span>
<span id="cb237-6745"><a href="#cb237-6745" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-6746"><a href="#cb237-6746" aria-hidden="true" tabindex="-1"></a>            ((i, j), (i2, j2)) <span class="op">=</span> find_middle_edge(</span>
<span id="cb237-6747"><a href="#cb237-6747" aria-hidden="true" tabindex="-1"></a>                sequence1[top:bottom], sequence2[left:right], scoring_matrix, gap_penalty</span>
<span id="cb237-6748"><a href="#cb237-6748" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb237-6749"><a href="#cb237-6749" aria-hidden="true" tabindex="-1"></a>            edge <span class="op">=</span> <span class="st">"↓"</span> <span class="cf">if</span> j <span class="op">==</span> j2 <span class="cf">else</span> <span class="st">"→"</span> <span class="cf">if</span> i <span class="op">==</span> i2 <span class="cf">else</span> <span class="st">"↘"</span></span>
<span id="cb237-6750"><a href="#cb237-6750" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> (</span>
<span id="cb237-6751"><a href="#cb237-6751" aria-hidden="true" tabindex="-1"></a>                linear_space_alignment(top, i <span class="op">+</span> top, left, j <span class="op">+</span> left) <span class="op">+</span></span>
<span id="cb237-6752"><a href="#cb237-6752" aria-hidden="true" tabindex="-1"></a>                edge <span class="op">+</span></span>
<span id="cb237-6753"><a href="#cb237-6753" aria-hidden="true" tabindex="-1"></a>                linear_space_alignment(i2 <span class="op">+</span> top, bottom, j2 <span class="op">+</span> left, right)</span>
<span id="cb237-6754"><a href="#cb237-6754" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb237-6755"><a href="#cb237-6755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6756"><a href="#cb237-6756" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linear_space_alignment(<span class="dv">0</span>, <span class="bu">len</span>(sequence1), <span class="dv">0</span>, <span class="bu">len</span>(sequence2))</span>
<span id="cb237-6757"><a href="#cb237-6757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6758"><a href="#cb237-6758" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_alignment(</span>
<span id="cb237-6759"><a href="#cb237-6759" aria-hidden="true" tabindex="-1"></a>    alignment_path: <span class="bu">str</span>,</span>
<span id="cb237-6760"><a href="#cb237-6760" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb237-6761"><a href="#cb237-6761" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span></span>
<span id="cb237-6762"><a href="#cb237-6762" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb237-6763"><a href="#cb237-6763" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb237-6764"><a href="#cb237-6764" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb237-6765"><a href="#cb237-6765" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> direction <span class="kw">in</span> alignment_path:</span>
<span id="cb237-6766"><a href="#cb237-6766" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"↘"</span>:</span>
<span id="cb237-6767"><a href="#cb237-6767" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[i]</span>
<span id="cb237-6768"><a href="#cb237-6768" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[j]</span>
<span id="cb237-6769"><a href="#cb237-6769" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-6770"><a href="#cb237-6770" aria-hidden="true" tabindex="-1"></a>            j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-6771"><a href="#cb237-6771" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"↓"</span>:</span>
<span id="cb237-6772"><a href="#cb237-6772" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[i]</span>
<span id="cb237-6773"><a href="#cb237-6773" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb237-6774"><a href="#cb237-6774" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-6775"><a href="#cb237-6775" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-6776"><a href="#cb237-6776" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb237-6777"><a href="#cb237-6777" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[j]</span>
<span id="cb237-6778"><a href="#cb237-6778" aria-hidden="true" tabindex="-1"></a>            j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-6779"><a href="#cb237-6779" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> aligned_seq1, aligned_seq2</span>
<span id="cb237-6780"><a href="#cb237-6780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6781"><a href="#cb237-6781" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb237-6782"><a href="#cb237-6782" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-6783"><a href="#cb237-6783" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb237-6784"><a href="#cb237-6784" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb237-6785"><a href="#cb237-6785" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-6786"><a href="#cb237-6786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6787"><a href="#cb237-6787" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-6788"><a href="#cb237-6788" aria-hidden="true" tabindex="-1"></a>scoring_matrix <span class="op">=</span> BLOSUM62</span>
<span id="cb237-6789"><a href="#cb237-6789" aria-hidden="true" tabindex="-1"></a>alignment_path <span class="op">=</span> find_alignment_path(sequence1, sequence2, scoring_matrix, <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb237-6790"><a href="#cb237-6790" aria-hidden="true" tabindex="-1"></a>aligned_seq1, aligned_seq2 <span class="op">=</span> construct_alignment(alignment_path, sequence1, sequence2)</span>
<span id="cb237-6791"><a href="#cb237-6791" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_alignment_score(aligned_seq1, aligned_seq2, scoring_matrix, <span class="op">-</span><span class="dv">5</span>))</span>
<span id="cb237-6792"><a href="#cb237-6792" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_seq1, aligned_seq2, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-6793"><a href="#cb237-6793" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6794"><a href="#cb237-6794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6795"><a href="#cb237-6795" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Highest-Scoring Multiple Sequence Alignment</span></span>
<span id="cb237-6796"><a href="#cb237-6796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6797"><a href="#cb237-6797" aria-hidden="true" tabindex="-1"></a>Multiple Longest Common Subsequence Problem. Find a longest common subsequence of multiple strings.</span>
<span id="cb237-6798"><a href="#cb237-6798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6799"><a href="#cb237-6799" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Three&nbsp;[DNA strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>).</span>
<span id="cb237-6800"><a href="#cb237-6800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6801"><a href="#cb237-6801" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The maximum score of a multiple alignment of these three strings, followed by a multiple alignment of the three strings achieving this maximum. Use a scoring function <span class="kw">in</span> which the score of an alignment column <span class="kw">is</span> <span class="dv">1</span> <span class="cf">if</span> <span class="bu">all</span> three symbols are identical <span class="kw">and</span> <span class="dv">0</span> otherwise. (If more than one multiple alignment achieve the maximum, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb237-6802"><a href="#cb237-6802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6803"><a href="#cb237-6803" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-6804"><a href="#cb237-6804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6805"><a href="#cb237-6805" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6806"><a href="#cb237-6806" aria-hidden="true" tabindex="-1"></a>ATATCCG</span>
<span id="cb237-6807"><a href="#cb237-6807" aria-hidden="true" tabindex="-1"></a>TCCGA</span>
<span id="cb237-6808"><a href="#cb237-6808" aria-hidden="true" tabindex="-1"></a>ATGTACTG</span>
<span id="cb237-6809"><a href="#cb237-6809" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6810"><a href="#cb237-6810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6811"><a href="#cb237-6811" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-6812"><a href="#cb237-6812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6813"><a href="#cb237-6813" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6814"><a href="#cb237-6814" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span>
<span id="cb237-6815"><a href="#cb237-6815" aria-hidden="true" tabindex="-1"></a>ATATCC<span class="op">-</span>G<span class="op">-</span></span>
<span id="cb237-6816"><a href="#cb237-6816" aria-hidden="true" tabindex="-1"></a><span class="op">---</span>TCC<span class="op">-</span>GA</span>
<span id="cb237-6817"><a href="#cb237-6817" aria-hidden="true" tabindex="-1"></a>ATGTACTG<span class="op">-</span></span>
<span id="cb237-6818"><a href="#cb237-6818" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6819"><a href="#cb237-6819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6820"><a href="#cb237-6820" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-6821"><a href="#cb237-6821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6822"><a href="#cb237-6822" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-6823"><a href="#cb237-6823" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb237-6824"><a href="#cb237-6824" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb237-6825"><a href="#cb237-6825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6826"><a href="#cb237-6826" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the coordinates are non-negative in the alignment matrix</span></span>
<span id="cb237-6827"><a href="#cb237-6827" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_valid_coordinate(pointer: Tuple[<span class="bu">int</span>, ...], position: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb237-6828"><a href="#cb237-6828" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>([i <span class="op">&gt;=</span> <span class="dv">0</span> <span class="cf">for</span> i <span class="kw">in</span> get_previous_position(position, pointer)])</span>
<span id="cb237-6829"><a href="#cb237-6829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6830"><a href="#cb237-6830" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the previous position given a current position and a pointer</span></span>
<span id="cb237-6831"><a href="#cb237-6831" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_previous_position(position: Tuple[<span class="bu">int</span>, ...], pointer: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, ...]:</span>
<span id="cb237-6832"><a href="#cb237-6832" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>([p <span class="op">+</span> d <span class="cf">for</span> p, d <span class="kw">in</span> <span class="bu">zip</span>(position, pointer)])</span>
<span id="cb237-6833"><a href="#cb237-6833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6834"><a href="#cb237-6834" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the score for a given position and pointer</span></span>
<span id="cb237-6835"><a href="#cb237-6835" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(sequences: List[<span class="bu">str</span>], position: Tuple[<span class="bu">int</span>, ...], pointer: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-6836"><a href="#cb237-6836" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pointer <span class="op">==</span> (<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb237-6837"><a href="#cb237-6837" aria-hidden="true" tabindex="-1"></a>        bases <span class="op">=</span> [sequences[i][j] <span class="cf">for</span> i, j <span class="kw">in</span> <span class="bu">enumerate</span>(get_previous_position(position, pointer))]</span>
<span id="cb237-6838"><a href="#cb237-6838" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">int</span>(<span class="bu">all</span>(base <span class="op">==</span> bases[<span class="dv">0</span>] <span class="cf">for</span> base <span class="kw">in</span> bases))</span>
<span id="cb237-6839"><a href="#cb237-6839" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb237-6840"><a href="#cb237-6840" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb237-6841"><a href="#cb237-6841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6842"><a href="#cb237-6842" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate possible previous cell pointers</span></span>
<span id="cb237-6843"><a href="#cb237-6843" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_moves(dimension: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">int</span>, ...]]:</span>
<span id="cb237-6844"><a href="#cb237-6844" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(product([<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>], repeat<span class="op">=</span>dimension))[<span class="dv">1</span>:]</span>
<span id="cb237-6845"><a href="#cb237-6845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6846"><a href="#cb237-6846" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiple_sequence_alignment(sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb237-6847"><a href="#cb237-6847" aria-hidden="true" tabindex="-1"></a>    scores: Dict[Tuple[<span class="bu">int</span>, ...], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb237-6848"><a href="#cb237-6848" aria-hidden="true" tabindex="-1"></a>    pointers: Dict[Tuple[<span class="bu">int</span>, ...], Tuple[<span class="bu">int</span>, ...]] <span class="op">=</span> {}</span>
<span id="cb237-6849"><a href="#cb237-6849" aria-hidden="true" tabindex="-1"></a>    scores[(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-6850"><a href="#cb237-6850" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6851"><a href="#cb237-6851" aria-hidden="true" tabindex="-1"></a>    ranges <span class="op">=</span> [<span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(seq) <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> seq <span class="kw">in</span> sequences]</span>
<span id="cb237-6852"><a href="#cb237-6852" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6853"><a href="#cb237-6853" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> position <span class="kw">in</span> product(<span class="op">*</span>ranges):</span>
<span id="cb237-6854"><a href="#cb237-6854" aria-hidden="true" tabindex="-1"></a>        valid_pointers <span class="op">=</span> <span class="bu">list</span>(<span class="bu">filter</span>(<span class="kw">lambda</span> x: is_valid_coordinate(x, position), generate_moves(<span class="dv">3</span>)))</span>
<span id="cb237-6855"><a href="#cb237-6855" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> valid_pointers:</span>
<span id="cb237-6856"><a href="#cb237-6856" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb237-6857"><a href="#cb237-6857" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-6858"><a href="#cb237-6858" aria-hidden="true" tabindex="-1"></a>        possible_scores <span class="op">=</span> [scores[get_previous_position(position, ptr)] <span class="op">+</span> calculate_score(sequences, position, ptr) <span class="cf">for</span> ptr <span class="kw">in</span> valid_pointers]</span>
<span id="cb237-6859"><a href="#cb237-6859" aria-hidden="true" tabindex="-1"></a>        scores[position] <span class="op">=</span> <span class="bu">max</span>(possible_scores)</span>
<span id="cb237-6860"><a href="#cb237-6860" aria-hidden="true" tabindex="-1"></a>        pointers[position] <span class="op">=</span> valid_pointers[possible_scores.index(<span class="bu">max</span>(possible_scores))]</span>
<span id="cb237-6861"><a href="#cb237-6861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6862"><a href="#cb237-6862" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback to recover alignment</span></span>
<span id="cb237-6863"><a href="#cb237-6863" aria-hidden="true" tabindex="-1"></a>    total_score <span class="op">=</span> scores[position]</span>
<span id="cb237-6864"><a href="#cb237-6864" aria-hidden="true" tabindex="-1"></a>    aligned_sequences <span class="op">=</span> [<span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>]</span>
<span id="cb237-6865"><a href="#cb237-6865" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-6866"><a href="#cb237-6866" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">any</span>([x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">for</span> x <span class="kw">in</span> position]):</span>
<span id="cb237-6867"><a href="#cb237-6867" aria-hidden="true" tabindex="-1"></a>        pointer <span class="op">=</span> pointers[position]</span>
<span id="cb237-6868"><a href="#cb237-6868" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, seq <span class="kw">in</span> <span class="bu">enumerate</span>(sequences):</span>
<span id="cb237-6869"><a href="#cb237-6869" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[i] <span class="op">+=</span> seq[position[i] <span class="op">-</span> <span class="dv">1</span>] <span class="cf">if</span> pointer[i] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span> <span class="cf">else</span> <span class="st">"-"</span></span>
<span id="cb237-6870"><a href="#cb237-6870" aria-hidden="true" tabindex="-1"></a>        position <span class="op">=</span> get_previous_position(position, pointer)</span>
<span id="cb237-6871"><a href="#cb237-6871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6872"><a href="#cb237-6872" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (total_score, </span>
<span id="cb237-6873"><a href="#cb237-6873" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">0</span>][::<span class="op">-</span><span class="dv">1</span>], </span>
<span id="cb237-6874"><a href="#cb237-6874" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">1</span>][::<span class="op">-</span><span class="dv">1</span>], </span>
<span id="cb237-6875"><a href="#cb237-6875" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">2</span>][::<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb237-6876"><a href="#cb237-6876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6877"><a href="#cb237-6877" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-6878"><a href="#cb237-6878" aria-hidden="true" tabindex="-1"></a><span class="st">ATATCCG</span></span>
<span id="cb237-6879"><a href="#cb237-6879" aria-hidden="true" tabindex="-1"></a><span class="st">TCCGA</span></span>
<span id="cb237-6880"><a href="#cb237-6880" aria-hidden="true" tabindex="-1"></a><span class="st">ATGTACTG</span></span>
<span id="cb237-6881"><a href="#cb237-6881" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-6882"><a href="#cb237-6882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6883"><a href="#cb237-6883" aria-hidden="true" tabindex="-1"></a>sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-6884"><a href="#cb237-6884" aria-hidden="true" tabindex="-1"></a>alignment_score, seq1, seq2, seq3 <span class="op">=</span> multiple_sequence_alignment(sequences)</span>
<span id="cb237-6885"><a href="#cb237-6885" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb237-6886"><a href="#cb237-6886" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq1)</span>
<span id="cb237-6887"><a href="#cb237-6887" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq2)</span>
<span id="cb237-6888"><a href="#cb237-6888" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq3)</span>
<span id="cb237-6889"><a href="#cb237-6889" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6890"><a href="#cb237-6890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6891"><a href="#cb237-6891" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Topological Ordering of a DAG</span></span>
<span id="cb237-6892"><a href="#cb237-6892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6893"><a href="#cb237-6893" aria-hidden="true" tabindex="-1"></a>Topological Ordering Problem. Find a topological ordering of a directed acyclic graph.</span>
<span id="cb237-6894"><a href="#cb237-6894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6895"><a href="#cb237-6895" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;The&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>)&nbsp;of a graph (<span class="cf">with</span> nodes represented by integers).</span>
<span id="cb237-6896"><a href="#cb237-6896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6897"><a href="#cb237-6897" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A topological ordering of this graph.</span>
<span id="cb237-6898"><a href="#cb237-6898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6899"><a href="#cb237-6899" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-6900"><a href="#cb237-6900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6901"><a href="#cb237-6901" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6902"><a href="#cb237-6902" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb237-6903"><a href="#cb237-6903" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb237-6904"><a href="#cb237-6904" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb237-6905"><a href="#cb237-6905" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb237-6906"><a href="#cb237-6906" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6907"><a href="#cb237-6907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6908"><a href="#cb237-6908" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-6909"><a href="#cb237-6909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6910"><a href="#cb237-6910" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6911"><a href="#cb237-6911" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">3</span></span>
<span id="cb237-6912"><a href="#cb237-6912" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6913"><a href="#cb237-6913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6914"><a href="#cb237-6914" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-6915"><a href="#cb237-6915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6916"><a href="#cb237-6916" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-6917"><a href="#cb237-6917" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Set</span>
<span id="cb237-6918"><a href="#cb237-6918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6919"><a href="#cb237-6919" aria-hidden="true" tabindex="-1"></a>NodeLabel <span class="op">=</span> <span class="bu">str</span></span>
<span id="cb237-6920"><a href="#cb237-6920" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[NodeLabel, List[NodeLabel]]</span>
<span id="cb237-6921"><a href="#cb237-6921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6922"><a href="#cb237-6922" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_graph(edge_list: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Graph:</span>
<span id="cb237-6923"><a href="#cb237-6923" aria-hidden="true" tabindex="-1"></a>    graph: Graph <span class="op">=</span> {}</span>
<span id="cb237-6924"><a href="#cb237-6924" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edge_list:</span>
<span id="cb237-6925"><a href="#cb237-6925" aria-hidden="true" tabindex="-1"></a>        source, targets <span class="op">=</span> edge.split(<span class="st">" -&gt; "</span>)</span>
<span id="cb237-6926"><a href="#cb237-6926" aria-hidden="true" tabindex="-1"></a>        target_list <span class="op">=</span> targets.split(<span class="st">","</span>)</span>
<span id="cb237-6927"><a href="#cb237-6927" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> graph:</span>
<span id="cb237-6928"><a href="#cb237-6928" aria-hidden="true" tabindex="-1"></a>            graph[source] <span class="op">=</span> []</span>
<span id="cb237-6929"><a href="#cb237-6929" aria-hidden="true" tabindex="-1"></a>        graph[source].extend(target_list)</span>
<span id="cb237-6930"><a href="#cb237-6930" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> target_list:</span>
<span id="cb237-6931"><a href="#cb237-6931" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> target <span class="kw">not</span> <span class="kw">in</span> graph:</span>
<span id="cb237-6932"><a href="#cb237-6932" aria-hidden="true" tabindex="-1"></a>                graph[target] <span class="op">=</span> []</span>
<span id="cb237-6933"><a href="#cb237-6933" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb237-6934"><a href="#cb237-6934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6935"><a href="#cb237-6935" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> depth_first_search(graph: Graph, node: NodeLabel, visited: Set[NodeLabel], stack: List[NodeLabel]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-6936"><a href="#cb237-6936" aria-hidden="true" tabindex="-1"></a>    visited.add(node)</span>
<span id="cb237-6937"><a href="#cb237-6937" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> graph.get(node, []):</span>
<span id="cb237-6938"><a href="#cb237-6938" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb237-6939"><a href="#cb237-6939" aria-hidden="true" tabindex="-1"></a>            depth_first_search(graph, neighbor, visited, stack)</span>
<span id="cb237-6940"><a href="#cb237-6940" aria-hidden="true" tabindex="-1"></a>    stack.insert(<span class="dv">0</span>, node)</span>
<span id="cb237-6941"><a href="#cb237-6941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6942"><a href="#cb237-6942" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> topological_sort(graph: Graph) <span class="op">-&gt;</span> List[NodeLabel]:</span>
<span id="cb237-6943"><a href="#cb237-6943" aria-hidden="true" tabindex="-1"></a>    visited: Set[NodeLabel] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb237-6944"><a href="#cb237-6944" aria-hidden="true" tabindex="-1"></a>    stack: List[NodeLabel] <span class="op">=</span> []</span>
<span id="cb237-6945"><a href="#cb237-6945" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> graph:</span>
<span id="cb237-6946"><a href="#cb237-6946" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb237-6947"><a href="#cb237-6947" aria-hidden="true" tabindex="-1"></a>            depth_first_search(graph, node, visited, stack)</span>
<span id="cb237-6948"><a href="#cb237-6948" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stack</span>
<span id="cb237-6949"><a href="#cb237-6949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6950"><a href="#cb237-6950" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb237-6951"><a href="#cb237-6951" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_text.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-6952"><a href="#cb237-6952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6953"><a href="#cb237-6953" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb237-6954"><a href="#cb237-6954" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-6955"><a href="#cb237-6955" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 2</span></span>
<span id="cb237-6956"><a href="#cb237-6956" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 3</span></span>
<span id="cb237-6957"><a href="#cb237-6957" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; 2</span></span>
<span id="cb237-6958"><a href="#cb237-6958" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 3</span></span>
<span id="cb237-6959"><a href="#cb237-6959" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-6960"><a href="#cb237-6960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6961"><a href="#cb237-6961" aria-hidden="true" tabindex="-1"></a>edge_list <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb237-6962"><a href="#cb237-6962" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> create_graph(edge_list)</span>
<span id="cb237-6963"><a href="#cb237-6963" aria-hidden="true" tabindex="-1"></a>sorted_nodes <span class="op">=</span> topological_sort(graph)</span>
<span id="cb237-6964"><a href="#cb237-6964" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">", "</span>.join(sorted_nodes))</span>
<span id="cb237-6965"><a href="#cb237-6965" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6966"><a href="#cb237-6966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6967"><a href="#cb237-6967" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement GreedySorting to Sort a Permutation by Reversals</span></span>
<span id="cb237-6968"><a href="#cb237-6968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6969"><a href="#cb237-6969" aria-hidden="true" tabindex="-1"></a>Implement&nbsp;<span class="op">*</span>GreedySorting<span class="op">*</span>.</span>
<span id="cb237-6970"><a href="#cb237-6970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6971"><a href="#cb237-6971" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[signed permutation](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>signed<span class="op">-</span>permutation<span class="op">/</span>)&nbsp;<span class="op">*</span>P<span class="op">*</span>.</span>
<span id="cb237-6972"><a href="#cb237-6972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6973"><a href="#cb237-6973" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The sequence of permutations corresponding to applying&nbsp;<span class="op">*</span>GreedySorting<span class="op">*</span>&nbsp;to&nbsp;<span class="op">*</span>P<span class="op">*</span>, ending <span class="cf">with</span> the identity permutation.</span>
<span id="cb237-6974"><a href="#cb237-6974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6975"><a href="#cb237-6975" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-6976"><a href="#cb237-6976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6977"><a href="#cb237-6977" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6978"><a href="#cb237-6978" aria-hidden="true" tabindex="-1"></a>(<span class="op">-</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span> <span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">5</span> <span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb237-6979"><a href="#cb237-6979" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6980"><a href="#cb237-6980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6981"><a href="#cb237-6981" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-6982"><a href="#cb237-6982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6983"><a href="#cb237-6983" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6984"><a href="#cb237-6984" aria-hidden="true" tabindex="-1"></a>(<span class="op">-</span><span class="dv">1</span> <span class="op">-</span><span class="dv">4</span> <span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">5</span> <span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb237-6985"><a href="#cb237-6985" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">4</span> <span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">5</span> <span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb237-6986"><a href="#cb237-6986" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">-</span><span class="dv">5</span> <span class="op">-</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb237-6987"><a href="#cb237-6987" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">5</span> <span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb237-6988"><a href="#cb237-6988" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">+</span><span class="dv">3</span> <span class="op">-</span><span class="dv">4</span> <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb237-6989"><a href="#cb237-6989" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span> <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb237-6990"><a href="#cb237-6990" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span> <span class="op">+</span><span class="dv">5</span>)</span>
<span id="cb237-6991"><a href="#cb237-6991" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-6992"><a href="#cb237-6992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6993"><a href="#cb237-6993" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-6994"><a href="#cb237-6994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6995"><a href="#cb237-6995" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-6996"><a href="#cb237-6996" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb237-6997"><a href="#cb237-6997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6998"><a href="#cb237-6998" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> perform_k_sorting_reversal(permutation: List[<span class="bu">int</span>], k: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-6999"><a href="#cb237-6999" aria-hidden="true" tabindex="-1"></a>    j <span class="op">=</span> k</span>
<span id="cb237-7000"><a href="#cb237-7000" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">abs</span>(permutation[j]) <span class="op">!=</span> k <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb237-7001"><a href="#cb237-7001" aria-hidden="true" tabindex="-1"></a>        j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-7002"><a href="#cb237-7002" aria-hidden="true" tabindex="-1"></a>    permutation[k:j<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> [<span class="op">-</span>x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">reversed</span>(permutation[k:j<span class="op">+</span><span class="dv">1</span>])]</span>
<span id="cb237-7003"><a href="#cb237-7003" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> permutation</span>
<span id="cb237-7004"><a href="#cb237-7004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7005"><a href="#cb237-7005" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_sorting(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb237-7006"><a href="#cb237-7006" aria-hidden="true" tabindex="-1"></a>    reversal_sequence: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb237-7007"><a href="#cb237-7007" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(permutation)):</span>
<span id="cb237-7008"><a href="#cb237-7008" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> permutation[k] <span class="op">!=</span> k <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb237-7009"><a href="#cb237-7009" aria-hidden="true" tabindex="-1"></a>            permutation <span class="op">=</span> perform_k_sorting_reversal(permutation, k)</span>
<span id="cb237-7010"><a href="#cb237-7010" aria-hidden="true" tabindex="-1"></a>            reversal_sequence.append(<span class="bu">list</span>(permutation))</span>
<span id="cb237-7011"><a href="#cb237-7011" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversal_sequence</span>
<span id="cb237-7012"><a href="#cb237-7012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7013"><a href="#cb237-7013" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_permutation(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-7014"><a href="#cb237-7014" aria-hidden="true" tabindex="-1"></a>    cleaned_input <span class="op">=</span> input_text.strip().replace(<span class="st">"("</span>, <span class="st">""</span>).replace(<span class="st">")"</span>, <span class="st">""</span>)</span>
<span id="cb237-7015"><a href="#cb237-7015" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> cleaned_input.split()]</span>
<span id="cb237-7016"><a href="#cb237-7016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7017"><a href="#cb237-7017" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_permutation(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-7018"><a href="#cb237-7018" aria-hidden="true" tabindex="-1"></a>    formatted_elements <span class="op">=</span> [(<span class="st">"+"</span> <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">""</span>) <span class="op">+</span> <span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> permutation]</span>
<span id="cb237-7019"><a href="#cb237-7019" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join(formatted_elements) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb237-7020"><a href="#cb237-7020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7021"><a href="#cb237-7021" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb237-7022"><a href="#cb237-7022" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-7023"><a href="#cb237-7023" aria-hidden="true" tabindex="-1"></a><span class="st">(-3 +4 +1 +5 -2)</span></span>
<span id="cb237-7024"><a href="#cb237-7024" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-7025"><a href="#cb237-7025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7026"><a href="#cb237-7026" aria-hidden="true" tabindex="-1"></a>initial_permutation <span class="op">=</span> parse_permutation(sample_input)</span>
<span id="cb237-7027"><a href="#cb237-7027" aria-hidden="true" tabindex="-1"></a>sorting_sequence <span class="op">=</span> greedy_sorting(initial_permutation)</span>
<span id="cb237-7028"><a href="#cb237-7028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7029"><a href="#cb237-7029" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> permutation <span class="kw">in</span> sorting_sequence:</span>
<span id="cb237-7030"><a href="#cb237-7030" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(format_permutation(permutation))</span>
<span id="cb237-7031"><a href="#cb237-7031" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7032"><a href="#cb237-7032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7033"><a href="#cb237-7033" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Number of Breakpoints in a Permutation</span></span>
<span id="cb237-7034"><a href="#cb237-7034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7035"><a href="#cb237-7035" aria-hidden="true" tabindex="-1"></a>Number of Breakpoints Problem. Find the number of breakpoints <span class="kw">in</span> a permutation.</span>
<span id="cb237-7036"><a href="#cb237-7036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7037"><a href="#cb237-7037" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[signed permutation](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>signed<span class="op">-</span>permutation<span class="op">/</span>)&nbsp;<span class="op">*</span>P<span class="op">*</span>.</span>
<span id="cb237-7038"><a href="#cb237-7038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7039"><a href="#cb237-7039" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The number of breakpoints in&nbsp;<span class="op">*</span>P<span class="op">*</span>.</span>
<span id="cb237-7040"><a href="#cb237-7040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7041"><a href="#cb237-7041" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-7042"><a href="#cb237-7042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7043"><a href="#cb237-7043" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7044"><a href="#cb237-7044" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span> <span class="op">+</span><span class="dv">5</span> <span class="op">-</span><span class="dv">12</span> <span class="op">-</span><span class="dv">8</span> <span class="op">-</span><span class="dv">7</span> <span class="op">-</span><span class="dv">6</span> <span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">+</span><span class="dv">10</span> <span class="op">+</span><span class="dv">9</span> <span class="op">-</span><span class="dv">11</span> <span class="op">+</span><span class="dv">13</span> <span class="op">+</span><span class="dv">14</span>)</span>
<span id="cb237-7045"><a href="#cb237-7045" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7046"><a href="#cb237-7046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7047"><a href="#cb237-7047" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-7048"><a href="#cb237-7048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7049"><a href="#cb237-7049" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7050"><a href="#cb237-7050" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span></span>
<span id="cb237-7051"><a href="#cb237-7051" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7052"><a href="#cb237-7052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7053"><a href="#cb237-7053" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-7054"><a href="#cb237-7054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7055"><a href="#cb237-7055" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-7056"><a href="#cb237-7056" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb237-7057"><a href="#cb237-7057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7058"><a href="#cb237-7058" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_breakpoints(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-7059"><a href="#cb237-7059" aria-hidden="true" tabindex="-1"></a>    augmented_permutation <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> permutation <span class="op">+</span> [<span class="bu">max</span>(permutation) <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb237-7060"><a href="#cb237-7060" aria-hidden="true" tabindex="-1"></a>    breakpoint_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-7061"><a href="#cb237-7061" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-7062"><a href="#cb237-7062" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(augmented_permutation) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb237-7063"><a href="#cb237-7063" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> augmented_permutation[i] <span class="op">!=</span> augmented_permutation[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb237-7064"><a href="#cb237-7064" aria-hidden="true" tabindex="-1"></a>            breakpoint_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-7065"><a href="#cb237-7065" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-7066"><a href="#cb237-7066" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> breakpoint_count</span>
<span id="cb237-7067"><a href="#cb237-7067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7068"><a href="#cb237-7068" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-7069"><a href="#cb237-7069" aria-hidden="true" tabindex="-1"></a><span class="st">(+3 +4 +5 -12 -8 -7 -6 +1 +2 +10 +9 -11 +13 +14)</span></span>
<span id="cb237-7070"><a href="#cb237-7070" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-7071"><a href="#cb237-7071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7072"><a href="#cb237-7072" aria-hidden="true" tabindex="-1"></a>permutation_string <span class="op">=</span> sample_input.strip()</span>
<span id="cb237-7073"><a href="#cb237-7073" aria-hidden="true" tabindex="-1"></a>permutation_string <span class="op">=</span> permutation_string.replace(<span class="st">"("</span>, <span class="st">""</span>).replace(<span class="st">")"</span>, <span class="st">""</span>)</span>
<span id="cb237-7074"><a href="#cb237-7074" aria-hidden="true" tabindex="-1"></a>permutation <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> permutation_string.split()]</span>
<span id="cb237-7075"><a href="#cb237-7075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7076"><a href="#cb237-7076" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_breakpoints(permutation))</span>
<span id="cb237-7077"><a href="#cb237-7077" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7078"><a href="#cb237-7078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7079"><a href="#cb237-7079" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the 2-Break Distance Between a Pair of Genomes</span></span>
<span id="cb237-7080"><a href="#cb237-7080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7081"><a href="#cb237-7081" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">-</span>Break Distance Problem. Find the <span class="dv">2</span><span class="op">-</span><span class="cf">break</span> distance between two genomes.</span>
<span id="cb237-7082"><a href="#cb237-7082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7083"><a href="#cb237-7083" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two genomes <span class="cf">with</span> circular chromosomes on the same <span class="bu">set</span> of synteny blocks.</span>
<span id="cb237-7084"><a href="#cb237-7084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7085"><a href="#cb237-7085" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The <span class="dv">2</span><span class="op">-</span><span class="cf">break</span> distance between these two genomes.</span>
<span id="cb237-7086"><a href="#cb237-7086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7087"><a href="#cb237-7087" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-7088"><a href="#cb237-7088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7089"><a href="#cb237-7089" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7090"><a href="#cb237-7090" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span> <span class="op">+</span><span class="dv">5</span> <span class="op">+</span><span class="dv">6</span>)</span>
<span id="cb237-7091"><a href="#cb237-7091" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">6</span> <span class="op">-</span><span class="dv">5</span>)(<span class="op">+</span><span class="dv">2</span> <span class="op">-</span><span class="dv">4</span>)</span>
<span id="cb237-7092"><a href="#cb237-7092" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7093"><a href="#cb237-7093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7094"><a href="#cb237-7094" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-7095"><a href="#cb237-7095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7096"><a href="#cb237-7096" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7097"><a href="#cb237-7097" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span>
<span id="cb237-7098"><a href="#cb237-7098" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7099"><a href="#cb237-7099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7100"><a href="#cb237-7100" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-7101"><a href="#cb237-7101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7102"><a href="#cb237-7102" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-7103"><a href="#cb237-7103" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb237-7104"><a href="#cb237-7104" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb237-7105"><a href="#cb237-7105" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, DefaultDict</span>
<span id="cb237-7106"><a href="#cb237-7106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7107"><a href="#cb237-7107" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb237-7108"><a href="#cb237-7108" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb237-7109"><a href="#cb237-7109" aria-hidden="true" tabindex="-1"></a>    visited: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb237-7110"><a href="#cb237-7110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb237-7111"><a href="#cb237-7111" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb237-7112"><a href="#cb237-7112" aria-hidden="true" tabindex="-1"></a>        visited.add(current_node)</span>
<span id="cb237-7113"><a href="#cb237-7113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb237-7114"><a href="#cb237-7114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb237-7115"><a href="#cb237-7115" aria-hidden="true" tabindex="-1"></a>                queue.append(neighbor)</span>
<span id="cb237-7116"><a href="#cb237-7116" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb237-7117"><a href="#cb237-7117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7118"><a href="#cb237-7118" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_genome_graph(genome_string: <span class="bu">str</span>) <span class="op">-&gt;</span> DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb237-7119"><a href="#cb237-7119" aria-hidden="true" tabindex="-1"></a>    genome_graph: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb237-7120"><a href="#cb237-7120" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, genome_string):</span>
<span id="cb237-7121"><a href="#cb237-7121" aria-hidden="true" tabindex="-1"></a>        chromosome <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, component.split()))</span>
<span id="cb237-7122"><a href="#cb237-7122" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb237-7123"><a href="#cb237-7123" aria-hidden="true" tabindex="-1"></a>            genome_graph[chromosome[i]].append(<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb237-7124"><a href="#cb237-7124" aria-hidden="true" tabindex="-1"></a>            genome_graph[<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>]].append(chromosome[i])</span>
<span id="cb237-7125"><a href="#cb237-7125" aria-hidden="true" tabindex="-1"></a>        genome_graph[chromosome[<span class="op">-</span><span class="dv">1</span>]].append(<span class="op">-</span>chromosome[<span class="dv">0</span>])</span>
<span id="cb237-7126"><a href="#cb237-7126" aria-hidden="true" tabindex="-1"></a>        genome_graph[<span class="op">-</span>chromosome[<span class="dv">0</span>]].append(chromosome[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb237-7127"><a href="#cb237-7127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome_graph</span>
<span id="cb237-7128"><a href="#cb237-7128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7129"><a href="#cb237-7129" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> breakpoint_graph(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb237-7130"><a href="#cb237-7130" aria-hidden="true" tabindex="-1"></a>    combined_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb237-7131"><a href="#cb237-7131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> genome1.keys():</span>
<span id="cb237-7132"><a href="#cb237-7132" aria-hidden="true" tabindex="-1"></a>        combined_graph[node] <span class="op">=</span> genome1[node] <span class="op">+</span> genome2[node]</span>
<span id="cb237-7133"><a href="#cb237-7133" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> combined_graph</span>
<span id="cb237-7134"><a href="#cb237-7134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7135"><a href="#cb237-7135" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_two_break_distance(genomes: List[DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb237-7136"><a href="#cb237-7136" aria-hidden="true" tabindex="-1"></a>    combined_graph <span class="op">=</span> breakpoint_graph(<span class="op">*</span>genomes)</span>
<span id="cb237-7137"><a href="#cb237-7137" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(combined_graph.keys())</span>
<span id="cb237-7138"><a href="#cb237-7138" aria-hidden="true" tabindex="-1"></a>    num_blocks <span class="op">=</span> <span class="bu">len</span>(nodes) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb237-7139"><a href="#cb237-7139" aria-hidden="true" tabindex="-1"></a>    num_components <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-7140"><a href="#cb237-7140" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb237-7141"><a href="#cb237-7141" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), combined_graph)</span>
<span id="cb237-7142"><a href="#cb237-7142" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">-=</span> component</span>
<span id="cb237-7143"><a href="#cb237-7143" aria-hidden="true" tabindex="-1"></a>        num_components <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb237-7144"><a href="#cb237-7144" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> num_blocks <span class="op">-</span> num_components</span>
<span id="cb237-7145"><a href="#cb237-7145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7146"><a href="#cb237-7146" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-7147"><a href="#cb237-7147" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 +2 +3 +4 +5 +6)</span></span>
<span id="cb237-7148"><a href="#cb237-7148" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 -3 -6 -5)(+2 -4)</span></span>
<span id="cb237-7149"><a href="#cb237-7149" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-7150"><a href="#cb237-7150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7151"><a href="#cb237-7151" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb237-7152"><a href="#cb237-7152" aria-hidden="true" tabindex="-1"></a>genomes <span class="op">=</span> [parse_genome_graph(genome_string) <span class="cf">for</span> genome_string <span class="kw">in</span> input_lines]</span>
<span id="cb237-7153"><a href="#cb237-7153" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_two_break_distance(genomes))</span>
<span id="cb237-7154"><a href="#cb237-7154" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7155"><a href="#cb237-7155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7156"><a href="#cb237-7156" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Shortest Transformation of One Genome into Another by 2-Breaks</span></span>
<span id="cb237-7157"><a href="#cb237-7157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7158"><a href="#cb237-7158" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">-</span>Break Sorting Problem. Find a shortest transformation of one genome into another by <span class="dv">2</span><span class="op">-</span>breaks.</span>
<span id="cb237-7159"><a href="#cb237-7159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7160"><a href="#cb237-7160" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two genomes <span class="cf">with</span> circular chromosomes on the same <span class="bu">set</span> of synteny blocks.</span>
<span id="cb237-7161"><a href="#cb237-7161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7162"><a href="#cb237-7162" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The sequence of genomes resulting <span class="im">from</span> applying a shortest sequence of <span class="dv">2</span><span class="op">-</span>breaks transforming one genome into the other.</span>
<span id="cb237-7163"><a href="#cb237-7163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7164"><a href="#cb237-7164" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-7165"><a href="#cb237-7165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7166"><a href="#cb237-7166" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7167"><a href="#cb237-7167" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb237-7168"><a href="#cb237-7168" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">-</span><span class="dv">4</span> <span class="op">-</span><span class="dv">3</span>)</span>
<span id="cb237-7169"><a href="#cb237-7169" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7170"><a href="#cb237-7170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7171"><a href="#cb237-7171" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-7172"><a href="#cb237-7172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7173"><a href="#cb237-7173" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7174"><a href="#cb237-7174" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb237-7175"><a href="#cb237-7175" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">-</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb237-7176"><a href="#cb237-7176" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">-</span><span class="dv">4</span> <span class="op">+</span><span class="dv">3</span>)</span>
<span id="cb237-7177"><a href="#cb237-7177" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">-</span><span class="dv">4</span> <span class="op">-</span><span class="dv">3</span>)</span>
<span id="cb237-7178"><a href="#cb237-7178" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7179"><a href="#cb237-7179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7180"><a href="#cb237-7180" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-7181"><a href="#cb237-7181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7182"><a href="#cb237-7182" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-7183"><a href="#cb237-7183" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb237-7184"><a href="#cb237-7184" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb237-7185"><a href="#cb237-7185" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, Generator, DefaultDict</span>
<span id="cb237-7186"><a href="#cb237-7186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7187"><a href="#cb237-7187" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb237-7188"><a href="#cb237-7188" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb237-7189"><a href="#cb237-7189" aria-hidden="true" tabindex="-1"></a>    visited: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb237-7190"><a href="#cb237-7190" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb237-7191"><a href="#cb237-7191" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb237-7192"><a href="#cb237-7192" aria-hidden="true" tabindex="-1"></a>        visited.add(current_node)</span>
<span id="cb237-7193"><a href="#cb237-7193" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb237-7194"><a href="#cb237-7194" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb237-7195"><a href="#cb237-7195" aria-hidden="true" tabindex="-1"></a>                queue.append(neighbor)</span>
<span id="cb237-7196"><a href="#cb237-7196" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb237-7197"><a href="#cb237-7197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7198"><a href="#cb237-7198" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_genome_graph(genome_string: <span class="bu">str</span>) <span class="op">-&gt;</span> DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb237-7199"><a href="#cb237-7199" aria-hidden="true" tabindex="-1"></a>    genome_graph: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb237-7200"><a href="#cb237-7200" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, genome_string):</span>
<span id="cb237-7201"><a href="#cb237-7201" aria-hidden="true" tabindex="-1"></a>        chromosome <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, component.split()))</span>
<span id="cb237-7202"><a href="#cb237-7202" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb237-7203"><a href="#cb237-7203" aria-hidden="true" tabindex="-1"></a>            genome_graph[chromosome[i]].append(<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb237-7204"><a href="#cb237-7204" aria-hidden="true" tabindex="-1"></a>            genome_graph[<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>]].append(chromosome[i])</span>
<span id="cb237-7205"><a href="#cb237-7205" aria-hidden="true" tabindex="-1"></a>        genome_graph[chromosome[<span class="op">-</span><span class="dv">1</span>]].append(<span class="op">-</span>chromosome[<span class="dv">0</span>])</span>
<span id="cb237-7206"><a href="#cb237-7206" aria-hidden="true" tabindex="-1"></a>        genome_graph[<span class="op">-</span>chromosome[<span class="dv">0</span>]].append(chromosome[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb237-7207"><a href="#cb237-7207" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome_graph</span>
<span id="cb237-7208"><a href="#cb237-7208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7209"><a href="#cb237-7209" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> breakpoint_graph(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb237-7210"><a href="#cb237-7210" aria-hidden="true" tabindex="-1"></a>    combined_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb237-7211"><a href="#cb237-7211" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> genome1.keys():</span>
<span id="cb237-7212"><a href="#cb237-7212" aria-hidden="true" tabindex="-1"></a>        combined_graph[node] <span class="op">=</span> genome1[node] <span class="op">+</span> genome2[node]</span>
<span id="cb237-7213"><a href="#cb237-7213" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> combined_graph</span>
<span id="cb237-7214"><a href="#cb237-7214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7215"><a href="#cb237-7215" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_perm(perm: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-7216"><a href="#cb237-7216" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>x<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> x <span class="kw">in</span> perm]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb237-7217"><a href="#cb237-7217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7218"><a href="#cb237-7218" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_components(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Generator[Set[<span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb237-7219"><a href="#cb237-7219" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb237-7220"><a href="#cb237-7220" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb237-7221"><a href="#cb237-7221" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), graph)</span>
<span id="cb237-7222"><a href="#cb237-7222" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> component</span>
<span id="cb237-7223"><a href="#cb237-7223" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> component</span>
<span id="cb237-7224"><a href="#cb237-7224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7225"><a href="#cb237-7225" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> non_trivial_cycle_nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">int</span>] <span class="op">|</span> <span class="va">None</span>:</span>
<span id="cb237-7226"><a href="#cb237-7226" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> find_components(graph):</span>
<span id="cb237-7227"><a href="#cb237-7227" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(component) <span class="op">&gt;</span> <span class="dv">2</span>:</span>
<span id="cb237-7228"><a href="#cb237-7228" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">list</span>(component)</span>
<span id="cb237-7229"><a href="#cb237-7229" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb237-7230"><a href="#cb237-7230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7231"><a href="#cb237-7231" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_genome_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb237-7232"><a href="#cb237-7232" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb237-7233"><a href="#cb237-7233" aria-hidden="true" tabindex="-1"></a>    visited: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb237-7234"><a href="#cb237-7234" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb237-7235"><a href="#cb237-7235" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb237-7236"><a href="#cb237-7236" aria-hidden="true" tabindex="-1"></a>        visited.append(current_node)</span>
<span id="cb237-7237"><a href="#cb237-7237" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb237-7238"><a href="#cb237-7238" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">-</span>neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb237-7239"><a href="#cb237-7239" aria-hidden="true" tabindex="-1"></a>                queue.append(<span class="op">-</span>neighbor)</span>
<span id="cb237-7240"><a href="#cb237-7240" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb237-7241"><a href="#cb237-7241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7242"><a href="#cb237-7242" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_genome_graph(genome_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb237-7243"><a href="#cb237-7243" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(genome_graph.keys())</span>
<span id="cb237-7244"><a href="#cb237-7244" aria-hidden="true" tabindex="-1"></a>    components: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb237-7245"><a href="#cb237-7245" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb237-7246"><a href="#cb237-7246" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_genome_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), genome_graph)</span>
<span id="cb237-7247"><a href="#cb237-7247" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> <span class="bu">set</span>(component)</span>
<span id="cb237-7248"><a href="#cb237-7248" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> <span class="bu">set</span>(<span class="op">-</span>x <span class="cf">for</span> x <span class="kw">in</span> component)</span>
<span id="cb237-7249"><a href="#cb237-7249" aria-hidden="true" tabindex="-1"></a>        components.append(component)</span>
<span id="cb237-7250"><a href="#cb237-7250" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">""</span>.join([format_perm(c) <span class="cf">for</span> c <span class="kw">in</span> components])</span>
<span id="cb237-7251"><a href="#cb237-7251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7252"><a href="#cb237-7252" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_edge(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node1: <span class="bu">int</span>, node2: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-7253"><a href="#cb237-7253" aria-hidden="true" tabindex="-1"></a>    graph[node1].append(node2)</span>
<span id="cb237-7254"><a href="#cb237-7254" aria-hidden="true" tabindex="-1"></a>    graph[node2].append(node1)</span>
<span id="cb237-7255"><a href="#cb237-7255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7256"><a href="#cb237-7256" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> del_edge(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node1: <span class="bu">int</span>, node2: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb237-7257"><a href="#cb237-7257" aria-hidden="true" tabindex="-1"></a>    graph[node1].remove(node2)</span>
<span id="cb237-7258"><a href="#cb237-7258" aria-hidden="true" tabindex="-1"></a>    graph[node2].remove(node1)</span>
<span id="cb237-7259"><a href="#cb237-7259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7260"><a href="#cb237-7260" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ba6d(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb237-7261"><a href="#cb237-7261" aria-hidden="true" tabindex="-1"></a>    combined_graph <span class="op">=</span> breakpoint_graph(genome1, genome2)</span>
<span id="cb237-7262"><a href="#cb237-7262" aria-hidden="true" tabindex="-1"></a>    nodes <span class="op">=</span> non_trivial_cycle_nodes(combined_graph)</span>
<span id="cb237-7263"><a href="#cb237-7263" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> format_genome_graph(genome1)</span>
<span id="cb237-7264"><a href="#cb237-7264" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb237-7265"><a href="#cb237-7265" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> nodes[<span class="dv">0</span>]</span>
<span id="cb237-7266"><a href="#cb237-7266" aria-hidden="true" tabindex="-1"></a>        i2 <span class="op">=</span> genome2[nodes[<span class="dv">0</span>]][<span class="dv">0</span>]</span>
<span id="cb237-7267"><a href="#cb237-7267" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> genome1[j][<span class="dv">0</span>]</span>
<span id="cb237-7268"><a href="#cb237-7268" aria-hidden="true" tabindex="-1"></a>        j2 <span class="op">=</span> genome1[i2][<span class="dv">0</span>]</span>
<span id="cb237-7269"><a href="#cb237-7269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7270"><a href="#cb237-7270" aria-hidden="true" tabindex="-1"></a>        del_edge(genome1, i, j)</span>
<span id="cb237-7271"><a href="#cb237-7271" aria-hidden="true" tabindex="-1"></a>        del_edge(genome1, i2, j2)</span>
<span id="cb237-7272"><a href="#cb237-7272" aria-hidden="true" tabindex="-1"></a>        add_edge(genome1, j, i2)</span>
<span id="cb237-7273"><a href="#cb237-7273" aria-hidden="true" tabindex="-1"></a>        add_edge(genome1, j2, i)</span>
<span id="cb237-7274"><a href="#cb237-7274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7275"><a href="#cb237-7275" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> format_genome_graph(genome1)</span>
<span id="cb237-7276"><a href="#cb237-7276" aria-hidden="true" tabindex="-1"></a>        combined_graph <span class="op">=</span> breakpoint_graph(genome1, genome2)</span>
<span id="cb237-7277"><a href="#cb237-7277" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> non_trivial_cycle_nodes(combined_graph)</span>
<span id="cb237-7278"><a href="#cb237-7278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7279"><a href="#cb237-7279" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb237-7280"><a href="#cb237-7280" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 -2 -3 +4)</span></span>
<span id="cb237-7281"><a href="#cb237-7281" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 +2 -4 -3)</span></span>
<span id="cb237-7282"><a href="#cb237-7282" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb237-7283"><a href="#cb237-7283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7284"><a href="#cb237-7284" aria-hidden="true" tabindex="-1"></a>genome1, genome2 <span class="op">=</span> [parse_genome_graph(s) <span class="cf">for</span> s <span class="kw">in</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)]</span>
<span id="cb237-7285"><a href="#cb237-7285" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> genome <span class="kw">in</span> ba6d(genome1, genome2):</span>
<span id="cb237-7286"><a href="#cb237-7286" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(genome)</span>
<span id="cb237-7287"><a href="#cb237-7287" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7288"><a href="#cb237-7288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7289"><a href="#cb237-7289" aria-hidden="true" tabindex="-1"></a><span class="co"># Find All Shared k-mers of a Pair of Strings</span></span>
<span id="cb237-7290"><a href="#cb237-7290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7291"><a href="#cb237-7291" aria-hidden="true" tabindex="-1"></a>Shared&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers Problem. Given two strings, find <span class="bu">all</span> their shared k<span class="op">-</span>mers.</span>
<span id="cb237-7292"><a href="#cb237-7292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7293"><a href="#cb237-7293" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and two strings.</span>
<span id="cb237-7294"><a href="#cb237-7294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7295"><a href="#cb237-7295" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers shared by these strings, <span class="kw">in</span> the form of ordered pairs (<span class="op">*</span>x<span class="op">*</span>,&nbsp;<span class="op">*</span>y<span class="op">*</span>) corresponding to starting positions of these k<span class="op">-</span>mers <span class="kw">in</span> the respective strings.</span>
<span id="cb237-7296"><a href="#cb237-7296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7297"><a href="#cb237-7297" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb237-7298"><a href="#cb237-7298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7299"><a href="#cb237-7299" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7300"><a href="#cb237-7300" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span>
<span id="cb237-7301"><a href="#cb237-7301" aria-hidden="true" tabindex="-1"></a>AAACTCATC</span>
<span id="cb237-7302"><a href="#cb237-7302" aria-hidden="true" tabindex="-1"></a>TTTCAAATC</span>
<span id="cb237-7303"><a href="#cb237-7303" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7304"><a href="#cb237-7304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7305"><a href="#cb237-7305" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb237-7306"><a href="#cb237-7306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7307"><a href="#cb237-7307" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7308"><a href="#cb237-7308" aria-hidden="true" tabindex="-1"></a>(<span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb237-7309"><a href="#cb237-7309" aria-hidden="true" tabindex="-1"></a>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb237-7310"><a href="#cb237-7310" aria-hidden="true" tabindex="-1"></a>(<span class="dv">4</span>, <span class="dv">2</span>)</span>
<span id="cb237-7311"><a href="#cb237-7311" aria-hidden="true" tabindex="-1"></a>(<span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb237-7312"><a href="#cb237-7312" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb237-7313"><a href="#cb237-7313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7314"><a href="#cb237-7314" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb237-7315"><a href="#cb237-7315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7316"><a href="#cb237-7316" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb237-7317"><a href="#cb237-7317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7318"><a href="#cb237-7318" aria-hidden="true" tabindex="-1"></a>```</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>